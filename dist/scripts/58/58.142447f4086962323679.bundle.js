(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/graphics/data/QueryEngineCapabilities":"4/qq","esri/tasks/operations/pbfOptimizedFeatureSet":"6/KI","esri/core/HandleOwner":"7MDj","esri/views/2d/layers/features/controllers/StreamController":"A4oT","esri/tasks/operations/query":"B16N","esri/views/2d/layers/features/controllers/BaseController":"Btct","esri/tasks/operations/pbfQueryUtils":"G+Sd","esri/tasks/operations/PBFWorker":"J0rm","esri/views/2d/layers/features/controllers/support/DispatchQueue":"Wuf+","esri/tasks/operations/pbfFeatureServiceParser":"YhCz","esri/layers/graphics/data/FeatureFilter":"Z0JH","esri/tasks/operations/urlUtils":"cGHk","esri/core/throttle":"rMND","esri/geometry/support/quantizationUtils":"u90+","esri/core/pbf":"v7zm","esri/tasks/operations/pbfDehydratedFeatureSet":"yre/"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{"4/qq":function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}}.apply(null,n))||(e.exports=i)},"6/KI":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("/COu"),r("xJgq"),r("Jvs9")],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"]}return e.prototype.createFeatureResult=function(){return new n.default},e.prototype.prepareFeatures=function(){},e.prototype.finishFeatureResult=function(){},e.prototype.addFeature=function(e,t){e.features.push(t)},e.prototype.createFeature=function(){return new r.default},e.prototype.createSpatialReference=function(){return{wkid:0}},e.prototype.createGeometry=function(){return new i.default},e.prototype.addField=function(e,t){e.fields.push(t)},e.prototype.addCoordinate=function(e,t){e.coords.push(t)},e.prototype.addCoordinatePoint=function(e,t){e.coords.push(t)},e.prototype.addLength=function(e,t){e.lengths.push(t)},e.prototype.createPointGeometry=function(){return new i.default},e}();t.Context=o}.apply(null,n))||(e.exports=i)},"7MDj":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("9opi"),r("qKT0"),r("Gtr7"),r("eIBl"),r("Vx27")],void 0===(i=function(e,t,r,n,i,o,s){return function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.call(this)||this;return n.handles=new o,n}return r(t,e),t.prototype.destroy=function(){this.handles.destroy()},n([s.property({readOnly:!0})],t.prototype,"handles",void 0),n([s.subclass("esri.core.HandleOwner")],t)}(s.declared(i))}.apply(null,n))||(e.exports=i)},A4oT:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("9opi"),r("qKT0"),r("2Atf"),r("Q2wQ"),r("HZ3d"),r("ll/V"),r("xdHJ"),r("TMur"),r("zp6E"),r("ma1f"),r("qsST"),r("qMld"),r("rMND"),r("Vx27"),r("+6sX"),r("rfv1"),r("ZooB"),r("B16N"),r("IpeC"),r("Btct"),r("Wuf+")],void 0===(i=function(e,t,r,n,i,o,s,a,u,c,l,p,h,d,f,y,g,v,m,_,b,F,S){function w(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}Object.defineProperty(t,"__esModule",{value:!0});var k=h.getLogger("esri.views.2d.layers.features.controllers.StreamController"),x=5e3,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="stream",t.errorString=null,t._started=!1,t._idCounter=0,t._tileDispatchMap=new u.default,t._updateIntervalId=0,t._reconnectWebSocketT=f.throttle(t._reconnectWebSocket,x,t),t._featureIds=[],t}return r(t,e),t.prototype.initialize=function(){var e=this;this.handles.add(this.watch("processor",this._switchProcessor.bind(this))),["connectionStatus","errorString"].forEach(function(t){e.watch(t,function(r){return e.remoteClient.invoke("setProperty",{propertyName:t,value:r})})}),this._updateIntervalId=setInterval(function(){return e._checkForUpdates()},64)},t.prototype.destroy=function(){clearInterval(this._updateIntervalId),this._destroyWebSocket(),this._tileDispatchMap.forEach(function(e){return e.destroy()}),this.queryEngine&&(this.queryEngine.destroy(),this._set("queryEngine",null)),this._tempQueryEngine&&this._tempQueryEngine.destroy()},Object.defineProperty(t.prototype,"updating",{get:function(){return!this._started||this._tempQueryEngine&&!!this._tempQueryEngine.featureStore.numFeatures||this._anyUpdatesQueued()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connectionStatus",{get:function(){if(!this._websocket)return"disconnected";switch(this._websocket.readyState){case 0:case 1:return"connected";case 2:case 3:return"disconnected"}},enumerable:!0,configurable:!0}),t.prototype.onEdits=function(e){},t.prototype.queryFeatures=function(e){return this.queryEngine?this.queryEngine.executeQuery(e):d.resolve({features:[],fields:[]})},t.prototype.queryFeatureCount=function(e){return this.queryEngine?this.queryEngine.executeQueryForCount(e):d.resolve(0)},t.prototype.queryObjectIds=function(e){return this.queryEngine?this.queryEngine.executeQueryForIds(e):d.resolve([])},t.prototype.queryExtent=function(e){return this.queryEngine?this.queryEngine.executeQueryForExtent(e):d.reject({count:0,extent:null})},t.prototype.queryLatestObservations=function(e){return this.queryEngine?this.queryEngine.executeQueryForLatestObservations(e):d.resolve({features:[],fields:[]})},t.prototype.redraw=function(){},t.prototype.refresh=function(){},t.prototype.setFilter=function(e){var t=e.index,r=e.filter;return s(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this._flushQueues()];case 1:return e.sent(),[2,this.setFilterBase(t,r)]}})})},t.prototype.setViewState=function(e){},t.prototype.onTileUpdate=function(e){var t=this,r=e.added,n=e.removed;this._started&&(n.forEach(function(e){return t._handleTileRemove(e)}),r.forEach(function(e){return t._handleTileAdd(e)}))},t.prototype.enableEvent=function(e){"data-received"===e.name&&(this._shouldPushDataReceived=e.value)},t.prototype._flushQueues=function(){var e=[];return this._tileDispatchMap.forEach(function(t){return e.push(t)}),e.reduce(function(e,t){return e.then(function(){return t.flush()})},d.resolve())},t.prototype._start=function(){var e=this;this._started||this._queryBuddies().then(function(){e._startWebSocket(),e.tileStore.tiles.forEach(function(t){return e._handleTileAdd(t)}),e._started=!0,e._updateActiveTiles(e.queryEngine)})},t.prototype._getService=function(){var e=i({},this.service.content,{f:"json"});return l(this.service.source,{query:e,responseType:"json"}).then(function(e){return e.data})},t.prototype._startWebSocket=function(){var e=this;this._getService().then(function(t){return e._createWebSocket(t)}).then(function(t){return e._setFilter(t)}).catch(function(e){return k.error(new p("stream-socket","Encountered an error while creating listening stream",e))})},t.prototype._destroyWebSocket=function(){this._websocket&&(this._websocket.onmessage=null,this._websocket.onerror=null,this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.close(),this.notifyChange("connectionStatus"))},t.prototype._createWebSocket=function(e){var t=this;return d.create(function(r){for(var n=e.streamUrls.filter(function(e){return"ws"===e.transport})[0],i=n.token,o=null,s=null,a=0,u=n.urls;a<u.length;a++){var c=u[a];-1!==c.indexOf("wss")?o=c:s=c}var l=(o||s)+"/subscribe?outSR="+t.spatialReference.wkid+(i?"&token="+i:""),p=new WebSocket(l);p.onopen=function(){t.notifyChange("connectionStatus"),r(p)},p.onmessage=t._handleWebSocketMessage.bind(t),p.onclose=t._handleWebSocketClose.bind(t),t._destroyWebSocket(),t._websocket=p})},t.prototype._setFilter=function(e){var t=this,r={},n=this.processor.queryInfo.outFields;return this.configuration.serviceFilter.geometry&&(r.geometry=JSON.stringify(this.configuration.serviceFilter.geometry)),this.configuration.serviceFilter.where&&(r.where=this.configuration.serviceFilter.where),n.length/this.service.fields.length>=.75&&(r.outFields=n.join(",")),r.geometry||r.where||r.outFields||d.resolve(),d.create(function(n,i){var o=e.onmessage;e.onmessage=function(r){var s=JSON.parse(r.data);s.filter&&(e.onmessage=o,s.error?(t.set("errorString","Could not set service filter - "+s.error),i(new p("stream-socket-service-filter",t.errorString,{activeServiceFilter:s.filter}))):n())},e.send(JSON.stringify({filter:r}))})},t.prototype._reconnectWebSocket=function(e){this.set("errorString","Lost websocket connection - "+e+", attempting to reconnect"),k.error(new p("stream-socket",this.errorString)),this._startWebSocket()},t.prototype._handleWebSocketClose=function(e){var t=e.code;if(this.notifyChange("connectionStatus"),1001===t||t>=4e3){var r=this._getErrorMessage(t);this.set("errorString","Encountered a service error "+t+" - "+r+", terminating websocket connection"),k.error(new p("stream-socket",this.errorString))}else{if(1e3===t)return;this._reconnectWebSocketT(t)}},t.prototype._getErrorMessage=function(e){switch(e){case 1001:return"Service is going away";case 4400:return"Invalid URL parameters. Check filter properties.";case 4401:case 4403:return"Not authorized";case 4404:return"Service not found";default:return"Encountered error code "+e}},t.prototype._handleWebSocketMessage=function(e){try{var t=JSON.parse(e.data);if(this._normalizeFeatureId(t),this._enrichFeature(t),!t.geometry&&!t.centroid)return void k.error(new p("stream-socket","Found malformed feature"));this._shouldPushDataReceived&&this.remoteClient.invoke("emitEvent",{name:"data-received",event:t});var r=g.convertFromFeature(t,this.service.geometryType,!1,!1,this.service.objectIdField);this._featureIds.push(r.attributes[this.service.objectIdField]),this._tempQueryEngine.featureStore.add(r)}catch(e){k.error(new p("stream-socket","Encountered an error when parsing socket message",e))}},t.prototype._handleTileAdd=function(e){if(this._tileDispatchMap.has(e.id)){(t=this._tileDispatchMap.get(e.id)).up()}else{var t=new S.default;this._tileDispatchMap.set(e.id,t)}this._queryTileFeatures(e,!0,this.queryEngine)},t.prototype._handleTileRemove=function(e){this._tileDispatchMap.get(e.id).destroy(),this._tileDispatchMap.delete(e.id)},t.prototype._checkForUpdates=function(){if(this._started){var e=this._getFeaturesToAdd(),t=this._getFeaturesToRemove(),r=[];e.featureStore.forEach(function(e){return r.push(e)}),t.featureStore.addMany(r),this.processor.supportsTileUpdates?(this._updateActiveTiles(e,t),e.featureStore.transferAll(this.queryEngine.featureStore)):(e.featureStore.transferAll(this.queryEngine.featureStore),this._repushActiveTiles(e,t)),t.destroy()}},t.prototype._anyUpdatesQueued=function(){return a.from(this._tileDispatchMap).some(function(e){return e[0],e[1].hasAction()})},t.prototype._updateActiveTiles=function(e,t){for(var r=0,n=this.tileStore.tiles;r<n.length;r++){var i=n[r];this._queryTileFeatures(i,!1,e,t)}},t.prototype._repushActiveTiles=function(e,t){for(var r=0,n=this.tileStore.tiles;r<n.length;r++){var i=n[r];this._queryTileFeatures(i,!0,this.queryEngine)}},t.prototype._getFeaturesToAdd=function(){return this._tempQueryEngine},t.prototype._getFeaturesToRemove=function(){var e=this.configuration.purgeOptions,t=e.displayCount,r=e.age,n=this._createQueryEngine();return this._purgeByDisplayCount(t,n),this._purgeByAge(r,n),n},t.prototype._purgeByDisplayCount=function(e,t){if(null!=e){var r=this.queryEngine.featureStore.numFeatures;if(r>e){var n=r-e,i=this._featureIds.splice(0,n);this.queryEngine.featureStore.transferIds(t.featureStore,i)}}},t.prototype._purgeByAge=function(e,t){if(null==e)return d.resolve();var r=60*e*1e3,n=Date.now()-r,i=this.service.timeInfo.startTimeField;this.queryEngine.featureStore.transferIf(t.featureStore,function(e){return e.attributes[i]<n})},t.prototype._queryTileFeatures=function(e,t,r,n){var i=this,o={hasZ:!1,hasM:!1,transform:{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]}},s=this.processor.queryInfo,a=s.returnCentroid,u=s.returnGeometry,c=s.pixelBuffer,l=this._getFilterFlags.bind(this),p={returnCentroid:a,returnGeometry:u,pixelBuffer:c},h=this._tileDispatchMap.get(e.id),d=r&&r.executeTileQuery(e,p,l),f=d&&d.features,y=n&&n.executeTileQueryForIds(e,p);h.enqueue(function(){return i.processor.onTileData(e,{addOrUpdate:f,remove:y,clear:t,transformParams:o})})},t.prototype._queryBuddies=function(){var e=this,t=this.service.buddyLayers,r=t.relatedFeatures,n=t.keepLatestArchive,i=this._queryBuddy(r),o=this._queryBuddy(n);return d.all([i,o]).then(function(t){var r=t[0],n=t[1];return e._addBuddyFeatures(r,n)})},t.prototype._queryBuddy=function(e){if(!e)return d.resolve();var t=this._createQuery(this.processor.queryInfo);return _.executeQuery(e.source,t).then(function(e){return e.data})},t.prototype._addBuddyFeatures=function(e,t){e&&this._setEnrichmentData(e),t&&this._addFeatures(t)},t.prototype._setEnrichmentData=function(e){for(var t=e.features,r=new u.default,n=this.service.buddyLayers.relatedFeatures.joinField,i=0,o=t;i<o.length;i++){var s=o[i];n===this.service.objectIdField&&"string"==typeof n&&(s.attributes[n]=w(s.attributes[n])),r.set(s.attributes[n],s)}this._enrichmentData=r},t.prototype._enrichFeature=function(e){if(!this._enrichmentData)return e;var t=this.service.buddyLayers.relatedFeatures.joinField,r=e.attributes[t];if(this._enrichmentData.has(r)){var n=this._enrichmentData.get(r),i=n.attributes,o=n.geometry;for(var s in i)e.attributes[s]=i[s];o&&(e.geometry=o)}return e},t.prototype._normalizeFeatureId=function(e){var t;t="__OBJECTID"===this.service.objectIdField?this._idCounter++:"string"==typeof e.attributes[this.service.objectIdField]?w(e.attributes[this.service.objectIdField]):e.attributes[this.service.objectIdField],e.attributes[this.service.objectIdField]=t},t.prototype._addFeatures=function(e){e.objectIdFieldName=this.service.objectIdField;for(var t=0,r=e.features;t<r.length;t++){var n=r[t];this._normalizeFeatureId(n),this._enrichFeature(n)}var i=g.convertFromFeatureSet(e).features;this.queryEngine.featureStore.addMany(i)},t.prototype._createQuery=function(e){var t=new b,r=e.historicMoment,n=e.outFields;return t.historicMoment=null!=r?new Date(r):null,t.outFields=n.length/this.service.fields.length>=.75?["*"]:n,t.returnExceededLimitFeatures=!0,t.returnGeometry=!0,t.gdbVersion=e.gdbVersion,t.returnCentroid=e.returnCentroid,t.orderByFields=e.orderByFields,t.outSpatialReference=this.spatialReference,t.where=this.configuration.filter.where||"1=1",this.configuration.filter.geometry&&(t.geometry=c.Extent.fromJSON(this.configuration.filter.geometry)),t},t.prototype._createQueryEngine=function(){var e=this.processor.queryInfo,t=e.definitionExpression,r=e.gdbVersion,n=e.historicMoment;return new m.default({definitionExpression:t,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,gdbVersion:r,historicMoment:null!=n&&new Date(n),featureStore:new v.default({geometryType:this.service.geometryType,hasM:!1,hasZ:!1}),timeInfo:this.service.timeInfo})},t.prototype._resetTempStore=function(){this._tempQueryEngine&&this._tempQueryEngine.destroy(),this._tempQueryEngine=this._createQueryEngine()},t.prototype._switchProcessor=function(e,t){this.queryEngine&&this.queryEngine.destroy(),this._set("queryEngine",this._createQueryEngine()),this._resetTempStore(),this._start(),this.notifyChange("updating")},n([y.property()],t.prototype,"service",void 0),n([y.property({readOnly:!0})],t.prototype,"queryEngine",void 0),n([y.property()],t.prototype,"updating",null),n([y.property()],t.prototype,"connectionStatus",null),n([y.property()],t.prototype,"errorString",void 0),n([y.subclass()],t)}(y.declared(F.default));t.default=I}.apply(null,n))||(e.exports=i)},B16N:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("2Atf"),r("zp6E"),r("jfWY"),r("Lzvl"),r("fw2w"),r("G+Sd"),r("J0rm"),r("cGHk")],void 0===(i=function(e,t,r,n,i,o,s,a,u,c){function l(e,t){var r=e.geometry,n=e.toJSON(),i=n;if(r&&(i.geometry=JSON.stringify(r),i.geometryType=o.getJsonType(r),i.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),n.groupByFieldsForStatistics&&(i.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(i.objectIds=n.objectIds.join(",")),n.orderByFields&&(i.orderByFields=n.orderByFields.join(",")),!n.outFields||t&&(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)?delete i.outFields:-1!==n.outFields.indexOf("*")?i.outFields="*":i.outFields=n.outFields.join(","),n.outSR?i.outSR=n.outSR.wkid||JSON.stringify(n.outSR):r&&(n.returnGeometry||n.returnCentroid)&&(i.outSR=i.inSR),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(i.outStatistics=JSON.stringify(n.outStatistics)),n.pixelSize&&(i.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(i.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.source&&(i.layer=JSON.stringify({source:n.source}),delete n.source),n.timeExtent){var s=n.timeExtent,a=s.start,u=s.end;null==a&&null==u||(i.time=a===u?a:(null==a?"null":a)+","+(null==u?"null":u)),delete n.timeExtent}return i}function p(e,t,o,a,u){void 0===a&&(a={});var p="string"==typeof e?i.urlToObject(e):e,h=t.geometry?[t.geometry]:[];return a.responseType="pbf"===o?"array-buffer":"json",s.normalizeCentralMeridian(h,null,a).then(function(e){var i=e&&e[0];i&&((t=t.clone()).geometry=i);var s=c.mapParameters(r({},p.query,{f:o},u,l(t,u)));return n(p.path+"/query",r({},a,{query:s}))})}Object.defineProperty(t,"__esModule",{value:!0});var h,d="Layer does not support extent calculation.";t.queryToQueryStringParameters=l,t.executeQuery=function(e,t,r){return p(e,t,"json",r)},t.executeQueryPBF=function(e,t,r,n){return p(e,t,"pbf",n).then(function(e){var t=function(t){var r=e;return r.data=t,r};return r.useWorker?(null==h&&(h=new u.PBFWorker),h).parseFeatureQuery(e.data,r).then(function(e){return t(e)}):t(a.parsePBFFeatureQuery(e.data,r))})},t.executeQueryForIds=function(e,t,r){return p(e,t,"json",r,{returnIdsOnly:!0})},t.executeQueryForCount=function(e,t,r){return p(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})},t.executeQueryForExtent=function(e,t,r){return p(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then(function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(d);if(t.hasOwnProperty("count"))throw new Error(d);return e})}}.apply(null,n))||(e.exports=i)},Btct:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("qKT0"),r("Q2wQ"),r("HZ3d"),r("9opi"),r("Gtr7"),r("ma1f"),r("7MDj"),r("qsST"),r("LxLY"),r("Vx27"),r("Z0JH"),r("zDti"),r("tI6k")],void 0===(i=function(e,t,r,n,i,o,s,a,u,c,l,p,h,d,f){Object.defineProperty(t,"__esModule",{value:!0});var y=c.getLogger("esri.views.2d.layers.features.controllers.BaseController"),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.configuration=null,t.processor=null,t.remoteClient=null,t.service=null,t.tileStore=null,t.filters=new Array(f.MAX_FILTERS),t}return o(t,e),t.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])},t.prototype.destroy=function(){},Object.defineProperty(t.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},enumerable:!0,configurable:!0}),t.prototype.setFilterBase=function(e,t){return i(this,void 0,void 0,function(){var r,i,o,s;return n(this,function(n){switch(n.label){case 0:return[4,this._getFilter(e)];case 1:return r=n.sent(),[4,d.normalizeFilter(t,null,this.spatialReference)];case 2:return i=n.sent(),this.configuration.filter=i,i?[4,r.update(i)]:[2,r.clear()];case 3:n.sent(),n.label=4;case 4:return n.trys.push([4,6,,7]),[4,this.queryObjectIds(r.createQuery().toJSON())];case 5:return o=n.sent(),[2,r.setTrue(o)];case 6:return s=n.sent(),y.error(new a("featurelayer-controller:query-filter-error","An error occurred while executing the query",{error:s})),[2,{show:[],hide:[]}];case 7:return[2]}})})},t.prototype.enableEvent=function(e){},t.prototype._getFilter=function(e){return i(this,void 0,void 0,function(){var t,r,i;return n(this,function(n){switch(n.label){case 0:return t=this.filters[e],l.isSome(t)?[2,t]:(r=new h.default({geometryType:this.service.geometryType,hasM:!1,hasZ:!1,timeInfo:this.service.timeInfo}),this.filters[e]=r,[4,this.queryObjectIds({})]);case 1:return i=n.sent(),r.setKnownIds(i),[2,r]}})})},t.prototype._getFilterFlags=function(e){for(var t=0,r=0;r<this.filters.length;r++){var n=this.filters[r];t|=(l.isNone(n)||n.check(e)?1:0)<<r}return t},t.prototype.hasGeometryFilter=function(){return this.filters.some(function(e){return l.isSome(e)&&!!e.geometry})},r([p.property()],t.prototype,"configuration",void 0),r([p.property()],t.prototype,"processor",void 0),r([p.property({constructOnly:!0})],t.prototype,"remoteClient",void 0),r([p.property({constructOnly:!0})],t.prototype,"service",void 0),r([p.property({dependsOn:["tileStore"]})],t.prototype,"spatialReference",null),r([p.property({constructOnly:!0})],t.prototype,"tileInfo",void 0),r([p.property({constructOnly:!0})],t.prototype,"tileStore",void 0),r([p.property()],t.prototype,"filters",void 0),r([p.subclass()],t)}(p.declared(s,u));t.default=g}.apply(null,n))||(e.exports=i)},"G+Sd":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("YhCz")],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.parsePBFFeatureQuery=function(e,t){var n=r.parseFeatureQuery(e,t).queryResult.featureResult;if(n&&n.features&&n.features.length&&n.objectIdFieldName)for(var i=n.objectIdFieldName,o=0,s=n.features;o<s.length;o++){var a=s[o];a.attributes&&(a.objectId=a.attributes[i])}return n}}.apply(null,n))||(e.exports=i)},J0rm:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("xhoE"),r("jZlN"),r("qMld"),r("ADZV"),r("8V7H"),r("Z4y+"),r("G+Sd"),r.dj.m(e)],void 0===(i=function(e,t,r,n,i,o,s,a,u,c){Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){}return e.prototype._parseFeatureQuery=function(e){var t,r=u.parsePBFFeatureQuery(e.buffer,e.options);return e.options&&"dehydrated"===e.options.type&&(t=r.spatialReference.toJSON(),r.spatialReference=null),i.resolve({featureSet:r,sr:t})},e}(),p=function(t){function l(){var r=t.call(this)||this;return r._thread=void 0,s.open(o.getAbsMid("./PBFWorker",e,c),{strategy:"dedicated"}).then(function(e){void 0===r._thread?r._thread=e:e.close()}),r}return r(l,t),l.prototype.destroy=function(){this._thread&&this._thread.close(),this._thread=null},l.prototype.parseFeatureQuery=function(e,t){return e&&0!==e.byteLength?this._thread?this._thread.invoke("_parseFeatureQuery",{buffer:e,options:t},{transferList:[e]}).then(function(e){var t=e.featureSet;if(e.sr){var r=a.fromJSON(e.sr);t.spatialReference=r}for(var i=t.spatialReference,o=0,s=t.features;o<s.length;o++){var u=s[o];u.uid=n.generateUID(),u.geometry&&(u.geometry.spatialReference=i)}return e.featureSet}):i.resolve(u.parsePBFFeatureQuery(e,t)):i.resolve(null)},l}(l);t.PBFWorker=p,t.default=function(){return new l}}.apply(null,n))||(e.exports=i)},"Wuf+":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("qMld")],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._action=null,this._queue=[],this._refs=1}return e.prototype.up=function(){this._refs++},e.prototype.down=function(){return 0==--this._refs},e.prototype.destroy=function(){this._queue.length=0,this._action&&(this._action.cancel(),this._action=null)},e.prototype.enqueue=function(e){this._action?this._queue.push(e):this._setAction(e)},e.prototype.flush=function(){var e=this._action;if(!e)return r.resolve();var t=this._queue.reduce(function(e,t){return e.then(t)},e);return this._action=t.then(this._handleNext.bind(this)),this._queue.length=0,t},e.prototype.hasAction=function(){return!!this._action},e.prototype._setAction=function(e){this._action=e().then(this._handleNext.bind(this))},e.prototype._handleNext=function(){this._queue.length?this._setAction(this._queue.shift()):this._action=null},e}();t.default=n}.apply(null,n))||(e.exports=i)},YhCz:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("ma1f"),r("qsST"),r("v7zm"),r("yre/"),r("6/KI")],void 0===(i=function(e,t,r,n,i,o,s){function a(e){return e>=x.length?null:x[e]}function u(e){return e>=I.length?null:I[e]}function c(e){return e>=T.length?null:T[e]}function l(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function p(e,t,r){for(var n=e.createPointGeometry(t);r.next();)switch(r.tag()){case 3:for(var i=r.getUInt32(),o=r.pos()+i,s=0;r.pos()<o;)e.addCoordinatePoint(n,r.getSInt64(),0,s++);break;case 1:case 2:default:r.skip()}return n}function h(e,t,r){for(var n=e.createGeometry(t),i=2+(t.hasZ?1:0)+(t.hasM?1:0);r.next();)switch(r.tag()){case 2:for(var o=r.getUInt32(),s=r.pos()+o,a=0;r.pos()<s;)e.addLength(n,r.getUInt32(),a++);break;case 3:for(var u=r.getUInt32(),c=(s=r.pos()+u,0),l=0;r.pos()<s;)e.addCoordinate(n,r.getSInt64(),l,c),++c===i&&(l++,c=0);break;case 1:default:r.skip()}return n}function d(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function f(e){for(var t={type:a(0)};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=a(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=u(e.getEnum());break;case 5:case 6:default:e.skip()}return t}function y(e,t,r,n){for(var i=e.createFeature(t),o=0;r.next();)switch(r.tag()){case 1:var s=n[o++].name;i.attributes[s]=d(r.getMessage());break;case 2:i.geometry=h(e,t,r.getMessage());break;case 4:i.centroid=p(e,t,r.getMessage());break;default:r.skip()}return i}function g(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function v(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function m(e){for(var t={originPosition:c(0)};e.next();)switch(e.tag()){case 1:t.originPosition=c(e.getEnum());break;case 2:t.scale=g(e.getMessage());break;case 3:t.translate=v(e.getMessage());break;default:e.skip()}return t}function _(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function b(e,t){for(var r=e.createSpatialReference();t.next();)switch(t.tag()){case 1:r.wkid=t.getUInt32();break;case 5:r.wkt=t.getString();break;case 2:case 3:case 4:default:t.skip()}return r}function F(e,t){var r=e.createFeatureResult();r.geometryType=l(e,0);for(var n=!1;t.next();)switch(t.tag()){case 1:r.objectIdFieldName=t.getString();break;case 3:r.globalIdFieldName=t.getString();break;case 4:r.geohashFieldName=t.getString();break;case 5:r.geometryProperties=_(t.getMessage());break;case 7:r.geometryType=l(e,t.getEnum());break;case 8:r.spatialReference=b(e,t.getMessage());break;case 10:r.hasZ=t.getBool();break;case 11:r.hasM=t.getBool();break;case 12:r.transform=m(t.getMessage());break;case 9:var i=t.getBool();r.exceededTransferLimit=i;break;case 13:e.addField(r,f(t.getMessage()));break;case 15:n||(e.prepareFeatures(r),n=!0),e.addFeature(r,y(e,r,t.getMessage(),r.fields));break;case 2:case 6:default:t.skip()}return e.finishFeatureResult(r),r}function S(e,t){for(var r={};t.next();)switch(t.tag()){case 1:r.featureResult=F(e,t.getMessage());break;default:t.skip()}return r}function w(e){return e&&"dehydrated"===e.type?new o.Context(e):new s.Context(e)}Object.defineProperty(t,"__esModule",{value:!0});var k=n.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),x=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],I=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],T=["upperLeft","lowerLeft"];t.parseFeatureQuery=function(e,t){var n=w(t);try{for(var o=new i(new Uint8Array(e),new DataView(e)),s={};o.next();)switch(o.tag()){case 2:s.queryResult=S(n,o.getMessage());break;default:o.skip()}return s}catch(e){var a=new r("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e});return k.error(a),{queryResult:{featureResult:n.createFeatureResult()}}}}}.apply(null,n))||(e.exports=i)},Z0JH:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("HZ3d"),r("2Atf"),r("Q2wQ"),r("PND3"),r("ma1f"),r("qsST"),r("LxLY"),r("qMld"),r("lRq4"),r("hBh5"),r("Ytki"),r("V1i6"),r("/61J"),r("IpeC")],void 0===(i=function(e,t,r,n,i,o,s,a,u,c,l,p,h,d,f,y){Object.defineProperty(t,"__esModule",{value:!0});var g=a.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter"),v=1,m=2,_=function(){function e(e){var t=this;this._geometryBounds=l.create(),this._idToVisibility=new Map,this.check=function(e){var r=e.objectId,n=t._idToVisibility,i=t._applyFilter(e);return n.set(r,i?v|m:m),!!(n.get(r)&v)},this._serviceInfo=e}return e.prototype.clear=function(){var e=this._resetAllHiddenIds();return this.update(),{show:e,hide:[]}},e.prototype.invalidate=function(){var e=this;this._idToVisibility.forEach(function(t,r){e._idToVisibility.set(r,0)})},e.prototype.setKnownIds=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this._idToVisibility.set(n,v)}},e.prototype.setTrue=function(e){var t=this,r=[],n=[],i=new o.default(e);return this._idToVisibility.forEach(function(e,o){var s=!!(t._idToVisibility.get(o)&v),a=i.has(o);!s&&a?r.push(o):s&&!a&&n.push(o),t._idToVisibility.set(o,a?v|m:0)}),{show:r,hide:n}},e.prototype.createQuery=function(){var e=this,t=e.geometry,r=e.spatialRel,n=e.where,i=e.distance,o=e.units,s=e.timeExtent,a=e.objectIds;return y.fromJSON({geometry:t,spatialRel:r,where:n,distance:i,units:o,timeExtent:s,objectIds:a})},e.prototype.update=function(e){return void 0===e&&(e=null),r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,c.all([this._setGeometryFilter(e),this._setIdFilter(e),this._setAttributeFilter(e),this._setTimeFilter(e)])];case 1:return t.sent(),[2]}})})},e.prototype._setAttributeFilter=function(e){if(!e||!e.where)return this._clause=null,void(this.where=null);var t=h.getWhereClause(e.where);if(t.isStandardized())this._clause=t;else{var r=new s("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",t);g.error(r)}this.where=e.where},e.prototype._setIdFilter=function(e){this._idsToShow=e&&e.objectIds&&new o.default(e.objectIds),this._idsToHide=e&&e.hiddenIds&&new o.default(e.hiddenIds),this.objectIds=e&&e.objectIds},e.prototype._setGeometryFilter=function(e){return r(this,void 0,void 0,function(){var t,r,n;return i(this,function(i){switch(i.label){case 0:return e&&e.geometry?(t=e.geometry,r=e.spatialRel||"esriSpatialRelIntersects",[4,d.getSpatialQueryOperator(r,t,this._serviceInfo)]):(this._spatialQueryOperator=null,this.geometry=null,this.spatialRel=null,[2]);case 1:return n=i.sent(),p.getBoundsXY(this._geometryBounds,t),this._spatialQueryOperator=n,this.geometry=t,this.spatialRel=r,[2]}})})},e.prototype._setTimeFilter=function(e){if(this.timeExtent=this._timeOperator=null,e&&e.timeExtent){if(!this._serviceInfo.timeInfo){var t=new s("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",e.timeExtent);return void g.error(t)}this.timeExtent=e.timeExtent,this._timeOperator=f.getTimeOperator(this._serviceInfo.timeInfo,e.timeExtent)}},e.prototype._applyFilter=function(e){return this._filterByGeometry(e)&&this._filterById(e)&&this._filterByTime(e)&&this._filterByExpression(e)},e.prototype._filterByExpression=function(e){return!this.where||this._clause.testFeature(e.attributes)},e.prototype._filterById=function(e){return(!this._idsToHide||!this._idsToHide.has(e.objectId))&&(!this._idsToShow||this._idsToShow.has(e.objectId))},e.prototype._filterByGeometry=function(e){return!this.geometry||!!this._earlyGeometryReject(e)&&this._spatialQueryOperator(e.geometry)},e.prototype._filterByTime=function(e){return!u.isSome(this._timeOperator)||this._timeOperator(e)},e.prototype._earlyGeometryReject=function(e){return!(!e.geometry||!e.geometry.coords.length)&&(!e.centroid||"esriSpatialRelContains"!==this.spatialRel||l.containsPoint(this._geometryBounds,e.centroid.coords))},e.prototype._resetAllHiddenIds=function(){var e=this,t=[];return this._idToVisibility.forEach(function(r,n){r&v||(e._idToVisibility.set(n,v),t.push(n))}),t},e}();t.default=_}.apply(null,n))||(e.exports=i)},cGHk:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapParameters=function e(t){var r={};for(var n in t)if("declaredClass"!==n){var i=t[n];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){r[n]=[];for(var o=0;o<i.length;o++)r[n][o]=e(i[o])}else"object"==typeof i?i.toJSON&&(r[n]=JSON.stringify(i)):r[n]=i}return r}}.apply(null,n))||(e.exports=i)},rMND:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t,r,n){var i=null,o=1e3;"number"==typeof t?(o=t,n=r):(i=t,o=r);var s,a=0,u=function(){a=0,e.apply(n,s)},c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i&&i.apply(n,e),s=e,o?a||(a=setTimeout(u,o)):u()};return c.remove=function(){a&&(clearTimeout(a),a=0)},c.forceUpdate=function(){a&&(clearTimeout(a),u())},c.hasPendingUpdates=function(){return!!a},c}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=r,t.default=r}.apply(null,n))||(e.exports=i)},"u90+":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("Lzvl")],void 0===(i=function(e,t,r){function n(e){return e&&"upperLeft"===e.originPosition}function i(e,t){var r=e.scale,n=e.translate;return Math.round((t-n[0])/r[0])}function o(e,t){var r=e.scale,n=e.translate;return Math.round((n[1]-t)/r[1])}function s(e,t,r){for(var n,s,a,u,c=[],l=0;l<r.length;l++){var p=r[l];l>0?(a=i(e,p[0]),u=o(e,p[1]),a===n&&u===s||(c.push(t(p,a-n,u-s)),n=a,s=u)):(n=i(e,p[0]),s=o(e,p[1]),c.push(t(p,n,s)))}return c.length>0?c:null}function a(e,t,r,n){return s(e,r?n?I:x:n?x:k,t)}function u(e,t,r,n){for(var i=[],o=r?n?I:x:n?x:k,a=0;a<t.length;a++){var u=s(e,o,t[a]);u&&u.length>=3&&i.push(u)}return i.length?i:null}function c(e,t,r,n){for(var i=[],o=r?n?I:x:n?x:k,a=0;a<t.length;a++){var u=s(e,o,t[a]);u&&u.length>=2&&i.push(u)}return i.length?i:null}function l(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function p(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function h(e,t,r){var n=new Array(r.length);if(!r.length)return n;var i=e.scale,o=i[0],s=i[1],a=l(e,r[0][0]),u=p(e,r[0][1]);n[0]=t(r[0],a,u);for(var c=1;c<r.length;c++){var h=r[c];a+=h[0]*o,u-=h[1]*s,n[c]=t(h,a,u)}return n}function d(e,t,r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=h(e,t,r[i]);return n}function f(e,t,r,n){return h(e,r?n?I:x:n?x:k,t)}function y(e,t,r,n){return d(e,r?n?I:x:n?x:k,t)}function g(e,t,r,n){return d(e,r?n?I:x:n?x:k,t)}function v(e,t,r){for(var n=r[0],i=n[0],o=n[1],s=Math.min(i,t[0]),a=Math.min(o,t[1]),u=Math.max(i,t[2]),c=Math.max(o,t[3]),l=1;l<r.length;l++){var p=r[l],h=p[0],d=p[1];i+=h,o+=d,h<0&&(s=Math.min(s,i)),h>0&&(u=Math.max(u,i)),d<0?a=Math.min(a,o):d>0&&(c=Math.max(c,o))}return e[0]=s,e[1]=a,e[2]=u,e[3]=c,e}function m(e,t){if(!t.length)return null;e[0]=e[1]=Number.POSITIVE_INFINITY,e[2]=e[3]=Number.NEGATIVE_INFINITY;for(var r=0;r<t.length;r++)v(e,e,t[r]);return e}function _(e,t,r,n,s){return t.xmin=i(e,r.xmin),t.ymin=o(e,r.ymin),t.xmax=i(e,r.xmax),t.ymax=o(e,r.ymax),t!==r&&(n&&(t.zmin=r.zmin,t.zmax=r.zmax),s&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}function b(e,t,r,n,i){return t.points=a(e,r.points,n,i),t}function F(e,t,r,n,s){return t.x=i(e,r.x),t.y=o(e,r.y),t!==r&&(n&&(t.z=r.z),s&&(t.m=r.m)),t}function S(e,t,r,n,i){var o=u(e,r.rings,n,i);return o?(t.rings=o,t):null}function w(e,t,r,n,i){var o=c(e,r.paths,n,i);return o?(t.paths=o,t):null}Object.defineProperty(t,"__esModule",{value:!0});var k=function(e,t,r){return[t,r]},x=function(e,t,r){return[t,r,e[2]]},I=function(e,t,r){return[t,r,e[2],e[3]]};t.toQuantizationTransform=function(e){return e?{originPosition:"upperLeft",scale:[e.tolerance,e.tolerance],translate:[e.extent.xmin,e.extent.ymax]}:null},t.equals=function(e,t){return e===t||null==e&&null==t||null!=e&&null!=t&&(n(e)?(r=e.translate[0],i=e.translate[1],o=e.scale[0]):(r=e.extent.xmin,i=e.extent.ymax,o=e.tolerance),n(t)?(s=t.translate[0],a=t.translate[1],u=t.scale[0]):(s=t.extent.xmin,a=t.extent.ymax,u=t.tolerance),r===s&&i===a&&o===u);var r,i,o,s,a,u},t.quantizeX=i,t.quantizeY=o,t.quantizeBounds=function(e,t,r){return t[0]=i(e,r[0]),t[3]=o(e,r[1]),t[2]=i(e,r[2]),t[1]=o(e,r[3]),t},t.quantizePoints=a,t.quantizeRings=u,t.quantizePaths=c,t.hydrateX=l,t.hydrateY=p,t.hydrateCoordsArray=h,t.hydrateCoordsArrayArray=d,t.hydrateBounds=function(e,t,r){return r?(t[0]=l(e,r[0]),t[1]=p(e,r[3]),t[2]=l(e,r[2]),t[3]=p(e,r[1]),t):[l(e,t[0]),p(e,t[3]),l(e,t[2]),p(e,t[1])]},t.hydratePoints=f,t.hydratePaths=y,t.hydrateRings=g,t.getQuantizedBoundsCoordsArray=v,t.getQuantizedBoundsCoordsArrayArray=m,t.getQuantizedBoundsPoints=function(e){var t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return v(t,t,e)},t.getQuantizedBoundsPaths=function(e){return m([0,0,0,0],e)},t.getQuantizedBoundsRings=function(e){return m([0,0,0,0],e)},t.quantizeExtent=_,t.quantizeMultipoint=b,t.quantizePoint=F,t.quantizePolygon=S,t.quantizePolyline=w,t.quantizeGeometry=function(e,t){return e&&t?r.isPoint(t)?F(e,{},t,!1,!1):r.isPolyline(t)?w(e,{},t,!1,!1):r.isPolygon(t)?S(e,{},t,!1,!1):r.isMultipoint(t)?b(e,{},t,!1,!1):r.isExtent(t)?_(e,{},t,!1,!1):null:null},t.hydrateExtent=function(e,t,r,n,i){return t.xmin=l(e,r.xmin),t.ymin=p(e,r.ymin),t.xmax=l(e,r.xmax),t.ymax=p(e,r.ymax),t!==r&&(n&&(t.zmin=r.zmin,t.zmax=r.zmax),i&&(t.mmin=r.mmin,t.mmax=r.mmax)),t},t.hydrateMultipoint=function(e,t,r,n,i){return t.points=f(e,r.points,n,i),t},t.hydratePoint=function(e,t,r,n,i){return t.x=l(e,r.x),t.y=p(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m)),t},t.hydratePolygon=function(e,t,r,n,i){return t.rings=g(e,r.rings,n,i),t},t.hydratePolyline=function(e,t,r,n,i){return t.paths=y(e,r.paths,n,i),t}}.apply(null,n))||(e.exports=i)},v7zm:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(e,t,r,n){this._tag=0,this._dataType=99,this._data=e,this._dataView=t,this._pos=r||0,this._end=n||e.byteLength}return e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),r},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),r},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r},e.prototype.getMessage=function(){var t=this._getLength(),r=this._pos,n=new e(this._data,this._dataView,r,r+t);return this._skip(t),n},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,r=this._pos,n=0;if(this._end-r>=10)do{if(n|=127&(e=t[r++]),0==(128&e))break;if(n|=(127&(e=t[r++]))<<7,0==(128&e))break;if(n|=(127&(e=t[r++]))<<14,0==(128&e))break;if(n|=(127&(e=t[r++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[r++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var i=1;r!==this._end&&0!=(128&(e=t[r]));)++r,n+=(127&e)*i,i*=128;if(r===this._end)throw new Error("Varint overrun!");++r,n+=e*i}return this._pos=r,n},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,r){var n="",i="";r=Math.min(this._end,r);for(var o=t;o<r;++o){var s=e[o];128&s?i+="%"+s.toString(16):(n+=decodeURIComponent(i)+String.fromCharCode(s),i="")}return i.length&&(n+=decodeURIComponent(i)),n},e.prototype._toBytes=function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)},e}()}.apply(null,n))||(e.exports=i)},"yre/":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("jZlN"),r("pcDC"),r("Z4y+"),r("KQcO")],void 0===(i=function(e,t,r,n,i,o){function s(e,t,r,n){return t}function a(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return h(e,t+n,1)}}function u(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return h(e,t+n,1);case 2:return p(e,t,2)}}function c(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return h(e,t+n,1);case 2:return p(e,t,3)}}function l(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return h(e,t+n,1);case 2:case 3:return p(e,t,3)}}function p(e,t,r){var n=e.translate,i=e.scale;return n[r]+t*i[r]}function h(e,t,r){var n=e.translate,i=e.scale;return n[r]-t*i[r]}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e){this.options=e,this.geometryTypes=["point","multipoint","polyline","polygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=s,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0}return e.prototype.createFeatureResult=function(){return{exceededTransferLimit:!1,features:[],fields:[],hasM:!1,hasZ:!1,geometryType:null,objectIdFieldName:null,globalIdFieldName:null,geometryProperties:null,geohashFieldName:null,spatialReference:null,transform:null}},e.prototype.finishFeatureResult=function(e){this.options.applyTransform&&(e.transform=null)},e.prototype.createSpatialReference=function(){return new i},e.prototype.addField=function(e,t){e.fields.push(o.fromJSON(t))},e.prototype.addFeature=function(e,t){var r=this.options.maxStringAttributeLength?this.options.maxStringAttributeLength:0;if(r>0)for(var n in t.attributes){var i=t.attributes[n];"string"==typeof i&&i.length>r&&delete t.attributes[n]}e.features.push(t)},e.prototype.prepareFeatures=function(e){switch(this.options.applyTransform&&e.transform&&(this.transform=e.transform,this.applyTransform=this.deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"point":this.addCoordinate=this.addCoordinatePoint.bind(this),this.createGeometry=this.createPointGeometry.bind(this);break;case"polygon":this.addCoordinate=this.addCoordinatePolygon.bind(this),this.createGeometry=this.createPolygonGeometry.bind(this);break;case"polyline":this.addCoordinate=this.addCoordinatePolyline.bind(this),this.createGeometry=this.createPolylineGeometry.bind(this);break;case"multipoint":this.addCoordinate=this.addCoordinateMultipoint.bind(this),this.createGeometry=this.createMultipointGeometry.bind(this);break;default:n.neverReached(e.geometryType)}},e.prototype.createFeature=function(e){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,{uid:r.generateUID(),objectId:null,attributes:{},geometry:null,visible:!0}},e.prototype.addLength=function(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)},e.prototype.createPointGeometry=function(e){var t={type:"point",x:0,y:0,spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM};return t.hasZ&&(t.z=0),t.hasM&&(t.m=0),t},e.prototype.addCoordinatePoint=function(e,t,r,n){switch(t=this.applyTransform(this.transform,t,n,0),n){case 0:e.x=t;break;case 1:e.y=t;break;case 2:e.hasZ?e.z=t:e.m=t;break;case 3:e.m=t}},e.prototype.transformPathLikeValue=function(e,t){var r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)},e.prototype.addCoordinatePolyline=function(e,t,r,n){this.dehydratedAddPointsCoordinate(e.paths,t,r,n)},e.prototype.addCoordinatePolygon=function(e,t,r,n){this.dehydratedAddPointsCoordinate(e.rings,t,r,n)},e.prototype.addCoordinateMultipoint=function(e,t,r){0===r&&e.points.push([]);var n=this.transformPathLikeValue(t,r);e.points[e.points.length-1].push(n)},e.prototype.createPolygonGeometry=function(e){return{type:"polygon",rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createPolylineGeometry=function(e){return{type:"polyline",paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createMultipointGeometry=function(e){return{type:"multipoint",points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.dehydratedAddPointsCoordinate=function(e,t,r,n){if(null===this.coordinateBuffer){var i=this.lengths.reduce(function(e,t){return e+t},0);this.coordinateBuffer=new Float64Array(i*this.vertexDimension)}0===n&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);var o=this.transformPathLikeValue(t,n),s=e[e.length-1];0===n&&s.push(new Float64Array(this.coordinateBuffer.buffer,this.coordinateBufferPtr*Float64Array.BYTES_PER_ELEMENT,this.vertexDimension)),this.coordinateBuffer[this.coordinateBufferPtr++]=o},e.prototype.deriveApplyTransform=function(e){var t=e.hasZ,r=e.hasM;return t&&r?l:t?u:r?c:a},e}();t.Context=d}.apply(null,n))||(e.exports=i)}}]);