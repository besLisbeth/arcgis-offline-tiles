(function(){(this||window).webpackJsonp.registerAbsMids({"esri/renderers/support/clickToleranceUtils":"/E+R","esri/views/3d/layers/support/popupUtils3D":"2r2d","esri/core/HandleOwner":"7MDj","esri/views/layers/RefreshableLayerView":"7XLS","esri/core/requireUtils":"ADZV","esri/layers/ElevationLayer":"GAgw","esri/views/3d/layers/support/tiledLayerUtils":"IKbA","esri/layers/support/LercWorker":"S+mV","esri/views/3d/layers/TileLayerView3D":"Sh9N","esri/views/layers/TileLayerView":"wlZv"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[19,30],{"/E+R":function(e,r,t){var n,i;n=[t.dj.c(e.i),r],void 0===(i=function(e,r){function t(e,r){return r&&r.xoffset?Math.max(e,Math.abs(r.xoffset)):r&&r.yoffset?Math.max(e,Math.abs(r.yoffset)):e}Object.defineProperty(r,"__esModule",{value:!0}),r.calculateTolerance=function(e){if(!e)return 6;if("simple"===e.type)return t(6,e.symbol);if("unique-value"===e.type){var r=6;return e.uniqueValueInfos.forEach(function(e){r=t(r,e.symbol)}),r}if("class-breaks"===e.type){var n=6;return e.classBreakInfos.forEach(function(e){n=t(n,e.symbol)}),n}return e.type,6}}.apply(null,n))||(e.exports=i)},"2r2d":function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t("xhoE"),t("qKT0"),t("TMur"),t("LxLY"),t("8uEs"),t("/E+R")],void 0===(i=function(e,r,t,n,i,o,a,l){function s(e,r,t){var n=t.get("basemapTerrain"),o=t.get("basemapTerrain.overlayManager"),l=o?o.overlayPixelSizeInMapUnits(e):1,s=n&&!n.spatialReference.equals(t.spatialReference)?a.getMetersPerUnitForSR(n.spatialReference)/a.getMetersPerUnitForSR(t.spatialReference):r*l,u=e.x-s,p=e.y-s,c=e.x+s,d=e.y+s,y=t.spatialReference;return new i.Extent({xmin:Math.min(u,c),ymin:Math.min(p,d),xmax:Math.max(u,c),ymax:Math.max(p,d),spatialReference:y})}Object.defineProperty(r,"__esModule",{value:!0}),r.createQueryGeometry=s,r.intersectsDrapedGeometry=function(e,r,t){var n=t.toMap(e);return o.isNone(n)?null:s(n,l.calculateTolerance(),t).intersects(r)?n:null}}.apply(null,n))||(e.exports=i)},"7MDj":function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t("9opi"),t("qKT0"),t("Gtr7"),t("eIBl"),t("Vx27")],void 0===(i=function(e,r,t,n,i,o,a){return function(e){function r(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n=e.call(this)||this;return n.handles=new o,n}return t(r,e),r.prototype.destroy=function(){this.handles.destroy()},n([a.property({readOnly:!0})],r.prototype,"handles",void 0),n([a.subclass("esri.core.HandleOwner")],r)}(a.declared(i))}.apply(null,n))||(e.exports=i)},"7XLS":function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t("9opi"),t("qKT0"),t("Gtr7"),t("Vx27")],void 0===(i=function(e,r,t,n,i,o){return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.refreshTimestamp=null,r}return t(r,e),r.prototype.refresh=function(e){void 0===e&&(e=Date.now()),this._set("refreshTimestamp",e),this.doRefresh&&this.doRefresh()},n([o.property()],r.prototype,"layer",void 0),n([o.aliasOf("layer.refreshInterval")],r.prototype,"refreshInterval",void 0),n([o.property({readOnly:!0})],r.prototype,"refreshTimestamp",void 0),n([o.subclass("esri.layers.mixins.RefreshableLayerView")],r)}(o.declared(i))}.apply(null,n))||(e.exports=i)},ADZV:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t("qMld")],void 0===(i=function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.when=function e(r,n){return Array.isArray(n)?t.create(function(e){r(n,function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];e(r)})}):e(r,[n]).then(function(e){return e[0]})},r.getAbsMid=function(e,r,t){return r.toAbsMid?r.toAbsMid(e):t.id.replace(/\/[^\/]*$/gi,"/")+e}}.apply(null,n))||(e.exports=i)},GAgw:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t("2Atf"),t("9opi"),t("qKT0"),t("gyO4"),t("eMAb"),t("zp6E"),t("ma1f"),t("qMld"),t("Vx27"),t("MFVu"),t("0RER"),t("WhPF"),t("FEX1"),t("QJ8R"),t("EtsK"),t("S+mV")],void 0===(i=function(e,r,n,i,o,a,l,s,u,p,c,d,y,f,h,v,m,w){return function(e){function r(r){var t=e.call(this)||this;return t.copyright=null,t.heightModelInfo=null,t.path=null,t.opacity=1,t.operationalLayerType="ArcGISTiledElevationServiceLayer",t.type="elevation",t.url=null,t.version=null,t._lercWorker=w.acquireInstance(),t}return i(r,e),r.prototype.normalizeCtorArgs=function(e,r){return"string"==typeof e?n({url:e},r):e},r.prototype.destroy=function(){w.releaseInstance(this._lercWorker),this._lercWorker=null},Object.defineProperty(r.prototype,"minScale",{get:function(){},set:function(e){this.constructed&&l.deprecated(this.declaredClass+".minScale support has been removed.","","4.5")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxScale",{get:function(){},set:function(e){this.constructed&&l.deprecated(this.declaredClass+".maxScale support has been removed.","","4.5")},enumerable:!0,configurable:!0}),r.prototype.readVersion=function(e,r){var t=r.currentVersion;return t||(t=9.3),t},r.prototype.load=function(){var e=this;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:function(e){for(var r=0;r<e.typeKeywords.length;r++)if("elevation 3d layer"===e.typeKeywords[r].toLowerCase())return!0;throw new u("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}}).then(function(){return e._fetchImageService()},function(){return e._fetchImageService()})),this.when()},r.prototype.fetchTile=function(e,r,t,n){var i=this;return void 0===n&&(n=0),this.load().then(function(){return i._fetchTileAvailability(e,r,t)}).then(function(){return s(i.getTileUrl(e,r,t),{responseType:"array-buffer"})}).then(function(e){return i._lercWorker.decode(e.data,{noDataValue:n,returnFileInfo:!0})}).then(function(e){return{values:e.pixelData,width:e.width,height:e.height,maxZError:e.fileInfo.maxZError,noDataValue:e.noDataValue,minValue:e.minValue,maxValue:e.maxValue}})},r.prototype.getTileUrl=function(e,r,t){var i=!this.tilemapCache&&this.supportsBlankTile,o=a.objectToQuery(n({},this.parsedUrl.query,{blankTile:!i&&null}));return this.parsedUrl.path+"/tile/"+e+"/"+r+"/"+t+(o?"?"+o:"")},r.prototype.queryElevation=function(e,r){var t=this;return this._importElevationQuery().then(function(n){return(new n.ElevationQuery).query(t,e,r)})},r.prototype.createElevationSampler=function(e,r){var t=this;return this._importElevationQuery().then(function(n){return(new n.ElevationQuery).createSampler(t,e,r)})},r.prototype.importLayerViewModule=function(e){switch(e.type){case"2d":return p.reject(new u("elevation-layer:view-not-supported","ElevationLayer is only supported in 3D"));case"3d":return p.create(function(e){return Promise.all([t.e(0),t.e(6),t.e(9),t.e(72)]).then(function(){var r=[t("ujdx")];e.apply(null,r)}.bind(this)).catch(t.oe)})}},r.prototype._fetchTileAvailability=function(e,r,t){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,r,t):p.resolve("unknown")},r.prototype._fetchImageService=function(){var e=this;return p.resolve().then(function(){if(e.resourceInfo)return e.resourceInfo;var r={query:n({f:"json"},e.parsedUrl.query),responseType:"json"};return s(e.parsedUrl.path,r)}).then(function(r){r.ssl&&(e.url=e.url.replace(/^http:/i,"https:")),e.read(r.data,{origin:"service",url:e.parsedUrl})})},r.prototype._importElevationQuery=function(){return p.create(function(e){t.e(34).then(function(){var r=[t("T16p")];e.apply(null,r)}.bind(this)).catch(t.oe)})},o([c.property({json:{read:{source:"copyrightText"}}})],r.prototype,"copyright",void 0),o([c.property({readOnly:!0,type:d})],r.prototype,"heightModelInfo",void 0),o([c.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],r.prototype,"path",void 0),o([c.property({type:["show","hide"]})],r.prototype,"listMode",void 0),o([c.property({json:{read:!1,write:!1}})],r.prototype,"minScale",null),o([c.property({json:{read:!1,write:!1}})],r.prototype,"maxScale",null),o([c.property({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],r.prototype,"opacity",void 0),o([c.property({type:["ArcGISTiledElevationServiceLayer"]})],r.prototype,"operationalLayerType",void 0),o([c.property()],r.prototype,"resourceInfo",void 0),o([c.property({json:{read:!1},value:"elevation",readOnly:!0})],r.prototype,"type",void 0),o([c.property(m.url)],r.prototype,"url",void 0),o([c.property()],r.prototype,"version",void 0),o([c.reader("version",["currentVersion"])],r.prototype,"readVersion",null),o([c.subclass("esri.layers.ElevationLayer")],r)}(c.declared(y,f,h,v))}.apply(null,n))||(e.exports=i)},IKbA:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t("uGSk"),t("ma1f"),t("qMld"),t("8CIp")],void 0===(i=function(e,r,t,n,i,o){function a(e){var r=null,t=e.search(/\/rest\/services\//i);return t>0&&(r=e.substring(0,t+6)),r}Object.defineProperty(r,"__esModule",{value:!0}),r.checkArcGISServiceVersionCompatibility=function(e){if(!o.isHostedAgolService(e.url)){if(e.version<10.22){var r=new n("layerview:service-version-too-old","Tiled Map Layers on servers prior to 10.2.2 are not supported. Detected version: "+e.version,{minVersion:10.22,detectedVersion:e.version});return i.reject(r)}if(10.22===e.version&&!o.isHostedSecuredProxyService(e.url,e.get("portalItem.id"))){var l=a(e.url),s=new n("tiledlayerview3d:service-missing-cors-patch","Tiled Map Layers from 10.2.2 servers are only supported if all server updates have been applied.");return t(l+"self?f=json",{headers:{"X-Requested-With":null},timeout:1e4,handleAs:"json"}).then(function(e){if(!e||e.error)throw s}).catch(function(){throw s})}return i.resolve()}},r.throwIfError=function(e){if(e)throw e}}.apply(null,n))||(e.exports=i)},"S+mV":function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t("xhoE"),t("qMld"),t("ADZV"),t("8V7H"),t.dj.m(e)],void 0===(i=function(e,r,n,i,o,a,l){function s(){return i.create(function(e){t.e(89).then(function(){var r=[t("Rc7o")];e.apply(null,r)}.bind(this)).catch(t.oe)})}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(){}return e.prototype._decode=function(e){return s().then(function(r){var t=(0,r.decode)(e.buffer,e.options);return{result:t,transferList:[t.pixelData.buffer]}})},e}(),p=function(r){function t(t){var n=r.call(this)||this;return n.scheduler=t,n._thread=void 0,a.open(o.getAbsMid("./LercWorker",e,l),{strategy:"dedicated",scheduler:t}).then(function(e){void 0===n._thread?n._thread=e:e.close()}),n}return n(t,r),t.prototype.destroy=function(){this._thread&&this._thread.close(),this._thread=null},t.prototype.decode=function(e,r){return e&&0!==e.byteLength?this._thread?this._thread.invoke("_decode",{buffer:e,options:r},{transferList:[e]}):s().then(function(t){return(0,t.decode)(e,r)}):i.resolve(null)},t}(u),c=new Map;r.acquireInstance=function(e){var r=c.get(e);return r||(r={instance:new p(e),ref:0},c.set(e,r)),++r.ref,r.instance},r.releaseInstance=function(e){if(null!=e){var r=e.scheduler,t=c.get(r);t&&--t.ref<=0&&(t.instance.destroy(),c.delete(r))}},r.default=function(){return new u}}.apply(null,n))||(e.exports=i)},Sh9N:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t("9opi"),t("qKT0"),t("qMld"),t("8MXS"),t("Vx27"),t("T4YA"),t("2r2d"),t("IKbA"),t("KuzN"),t("wlZv")],void 0===(i=function(e,r,t,n,i,o,a,l,s,u,p,c){return function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,"imageFormatIsOpaque",{get:function(){return"jpg"===this.get("layer.tileInfo.format")},enumerable:!0,configurable:!0}),r.prototype.initialize=function(){var e=this,r=this._getTileInfoSupportError(this.tileInfo,this.layer.fullExtent);if(r)this.addResolvingPromise(i.reject(r));else{var t=o.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){var r=e.view.basemapTerrain.tilingScheme;u.throwIfError(e._getTileInfoCompatibilityError(e.tileInfo,r))});this.addResolvingPromise(t)}"version"in this.layer&&this.addResolvingPromise(u.checkArcGISServiceVersionCompatibility(this.layer)),this._updateMinMaxDataLevel(),this.maxDataLevel=Math.min(this.maxDataLevel,p.getKnownTiledServiceLevelCap(this.layer.url))},r.prototype.createFetchPopupFeaturesQueryGeometry=function(e,r){return s.createQueryGeometry(e,r,this.view)},r.prototype.doRefresh=function(){this.suspended||this.emit("data-changed")},n([a.property({readOnly:!0,dependsOn:["layer.tileInfo.format"]})],r.prototype,"imageFormatIsOpaque",null),n([a.property({aliasOf:"layer.fullExtent"})],r.prototype,"fullExtent",void 0),n([a.property()],r.prototype,"layer",void 0),n([a.property({aliasOf:"layer.tileInfo"})],r.prototype,"tileInfo",void 0),n([a.subclass("esri.views.3d.layers.TileLayerView3D")],r)}(a.declared(l,c))}.apply(null,n))||(e.exports=i)},wlZv:function(e,r,t){var n,i;n=[t.dj.c(e.i),r,t("9opi"),t("qKT0"),t("Q2wQ"),t("HZ3d"),t("ma1f"),t("qMld"),t("Vx27"),t("/E+R"),t("7XLS")],void 0===(i=function(e,r,t,n,i,o,a,l,s,u,p){return function(e){function r(r){return e.call(this,r)||this}return t(r,e),r.prototype.fetchPopupFeatures=function(e){return o(this,void 0,void 0,function(){var r,t,n,s=this;return i(this,function(p){return r=this.layer,e?"tile"!==r.type?[2,l.reject(new a("tilelayerview:fetchPopupFeatures","Layer type should be 'tile'",{type:r.type}))]:(t=this.get("view.scale"),n=r.allSublayers.toArray().filter(function(e){var r=0===e.minScale||t<=e.minScale,n=0===e.maxScale||t>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&n}),[2,l.eachAlways(n.map(function(r){return o(s,void 0,void 0,function(){var t,n,o;return i(this,function(i){switch(i.label){case 0:return t=r.createQuery(),n=u.calculateTolerance(r.renderer),t.geometry=this.createFetchPopupFeaturesQueryGeometry(e,n),o=t,[4,r.popupTemplate.getRequiredFields()];case 1:return o.outFields=i.sent(),[4,r.queryFeatures(t)];case 2:return[2,i.sent().features]}})})})).then(function(e){return[].concat.apply([],e.map(function(e){return e.value}).filter(Boolean))})]):[2,l.reject(new a("tilelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:r}))]})})},n([s.property()],r.prototype,"layer",void 0),n([s.subclass("esri.views.layers.TileLayerView")],r)}(s.declared(p))}.apply(null,n))||(e.exports=i)}}]);