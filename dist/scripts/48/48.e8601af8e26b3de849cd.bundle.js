(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/engine/webgl/BitBlitRenderer":"+P5t","esri/views/2d/engine/webgl/shaders/BitBlitPrograms":"/2xn","esri/views/webgl/FramebufferObject":"/f24","esri/views/2d/layers/support/GraphicsView2D":"0i+W","esri/core/libs/earcut/earcut":"1E+e","esri/views/2d/engine/Container":"1Mg+","esri/views/2d/engine/webgl/SpriteMosaic":"1ZJt","esri/core/libs/gl-matrix-2/mat4f64":"1m5D","esri/views/navigation/Momentum":"2JMt","esri/core/libs/gl-matrix-2/vec4":"2fXB","esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":"2pwJ","esri/views/2d/engine/webgl/brushes/WGLBrush":"3+7H","esri/views/webgl/capabilities/load":"37NJ","esri/views/webgl/RenderingContext":"3KT0","esri/core/libs/gl-matrix-2/factories/vec4f32":"3gjc","esri/views/2d/engine/webgl/GlyphMosaic":"3pdx","esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":"3u8V","esri/core/libs/gl-matrix-2/mat3f64":"51bw","esri/views/2d/engine/webgl/shaders/StencilPrograms":"5MKl","esri/views/2d/layers/graphics/GraphicStore":"5r4l","esri/views/2d/engine/webgl/Geometry":"6+ni","esri/views/2d/engine/webgl/brushes/WGLBrushInfo":"66cO","esri/views/navigation/ZoomMomentumEstimator":"6N7s","esri/views/2d/engine/webgl/Rect":"6cAc","esri/views/2d/layers/features/support/TileStore":"6kSU","esri/views/webgl/capabilities/isWebGL2Context":"7laH","esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":"8fgo","esri/views/2d/layers/graphics/GraphicStoreItem":"9gM4","esri/views/2d/engine/webgl/WGLTile":"AP+j","esri/views/2d/engine/webgl/MemoryRequirements":"AwqN","esri/views/vectorTiles/GeometryUtils":"BEeJ","esri/views/2d/engine/webgl/util/iterator":"Bbit","esri/views/2d/engine/DisplayObject":"Brhx","esri/views/3d/webgl-engine/lib/Util":"CIy2","esri/core/libs/gl-matrix-2/factories/mat4f64":"CIzB","esri/views/2d/RenderingCore2D":"DAnI","esri/views/2d/engine/webgl/WGLDisplayList":"Dikz","esri/views/webgl/capabilities/Instancing":"DlJW","esri/views/navigation/FilteredFiniteDifference":"E9c0","esri/views/2d/engine/webgl/util/Reader":"Ed/z","esri/views/navigation/MomentumEstimator":"F3FF","esri/core/libs/gl-matrix-2/mat4":"FXVB","esri/views/2d/navigation/actions/Pan":"G+IK","esri/views/2d/engine/webgl/TileClipper":"GDRe","esri/views/2d/engine/webgl/painter/WGLHighlightPainter":"H2OT","esri/views/2d/engine/webgl/GlyphSource":"Hoc/","esri/views/2d/engine/webgl/TextShaping":"Id87","esri/core/libs/gl-matrix-2/math/mat4":"Jl7l","esri/views/2d/engine/webgl/painter/highlight/HighlightSurfaces":"KU+h","esri/views/2d/engine/Stage":"LN/d","dojox/string/BidiEngine":"Nh3O","esri/views/2d/engine/webgl/VertexStream":"Nwkb","esri/core/libs/gl-matrix-2/vec4f64":"O7NG","esri/views/2d/engine/webgl/Painter":"OO/B","esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":"PDSL","esri/views/2d/navigation/MapViewNavigation":"PDtg","esri/views/2d/engine/webgl/RectangleBinPack":"PhOF","esri/views/2d/engine/webgl/TileBufferData":"PwbG","esri/views/webgl/Renderbuffer":"Rrc3","esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":"ST29","esri/views/2d/engine/webgl/DirtyMap":"SkDs","esri/views/2d/engine/webgl/DisplayRecordStore":"Sq9p","esri/views/webgl/InstanceCounter":"TCFx","esri/views/2d/engine/webgl/shaders/HighlightPrograms":"TEGq","esri/views/2d/engine/webgl/collisions/CollisionBucket":"TF9k","esri/core/libs/gl-matrix-2/factories/vec4f64":"TPlk","esri/views/2d/engine/webgl/shaders/BackgroundPrograms":"TQvW","esri/views/webgl/capabilities/DisjointTimerQuery":"U6iw","esri/views/2d/engine/webgl/painter/highlight/HighlightGradient":"UJGa","esri/views/2d/navigation/actions/Rotate":"UrSa","esri/views/2d/engine/webgl/shaders/sources/shaderRepository":"Uu9s","esri/views/2d/engine/webgl/GeometryUtils":"VY6u","esri/views/2d/engine/webgl/SDFConverter":"XCks","esri/views/2d/engine/webgl/GraphicContainer":"Y080","esri/views/2d/navigation/actions/Pinch":"Y6jg","esri/views/2d/engine/webgl/shaders/MagnifierPrograms":"YIDE","esri/views/2d/engine/webgl/FreeList":"Zry2","esri/core/libs/gl-matrix-2/math/vec4":"bH65","esri/views/2d/engine/webgl/shaders/TileInfoPrograms":"bqoF","esri/views/2d/engine/webgl/painter/highlight/parameters":"dtEy","esri/views/2d/engine/webgl/collisions/LayerViewSorter":"eFQu","esri/views/2d/engine/webgl/TextureManager":"eprR","esri/views/navigation/RotationMomentumEstimator":"f7cP","esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":"f93k","esri/views/2d/layers/features/support/Tile":"fUL3","esri/geometry/support/normalizeUtils":"fw2w","esri/views/2d/engine/webgl/collisions/CollisionEngine":"gm1X","esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":"gvME","esri/views/2d/engine/webgl/shaders/sources/resolver":"hPTP","esri/core/libs/gl-matrix-2/vec4f32":"j2SP","dojo/Stateful":"kDn6","esri/views/navigation/PanPlanarMomentumEstimator":"kLlh","esri/views/2d/LabelManager":"kUhT","esri/views/2d/engine/webgl/shaders/RasterPrograms":"nL6+","esri/views/2d/engine/webgl/WGLRendererInfo":"oDRR","esri/views/2d/engine/webgl/painter/highlight/HighlightRenderer":"oF5M","esri/views/2d/engine/webgl/brushes/WGLBrushStencil":"p2sx","esri/views/2d/engine/webgl/MaterialManager":"pvXx","esri/views/2d/navigation/ZoomBox":"q4Xm","esri/views/webgl/renderState":"qbr3","esri/views/2d/engine/webgl/Fader":"qe2g","esri/core/throttle":"rMND","esri/views/2d/engine/webgl/TileData":"rYkQ","esri/views/2d/engine/webgl/definitions":"tI6k","esri/views/2d/engine/webgl/TileDisplayData":"tTR7","esri/geometry/support/quantizationUtils":"u90+","esri/views/webgl/enums":"uwSd","esri/core/pbf":"v7zm","esri/views/webgl/capabilities/VertexArrayObjects":"veTl","esri/views/2d/layers/graphics/GraphicProcessingQueue":"vhZU","esri/views/2d/engine/magnifier/MagnifierView2D":"viuU","esri/views/2d/engine/webgl/LineTess":"wURW","esri/views/2d/engine/webgl/shaders/MaterialPrograms":"wdp+","esri/views/3d/support/imageUtils":"weRx","esri/core/libs/gl-matrix-2/factories/mat3f64":"xf8T","esri/views/2d/engine/webgl/WGLBuffers":"xxo4","esri/views/layers/GraphicsView":"zRH3"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[48,12],{"+P5t":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("/2xn"),i("QFi0"),i("U+8K"),i("z2+Q")],void 0===(r=function(e,t,i,n,r,o){return function(){function e(){this._initialized=!1}return e.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null),this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)},e.prototype.render=function(e,t,i,n){e&&(this._initialized||this._initialize(e),e.setBlendFunctionSeparate(1,771,1,771),e.bindVAO(this._vertexArrayObject),e.bindProgram(this._program),t.setSamplingMode(i),e.bindTexture(t,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",n),e.drawArrays(5,0,4),e.bindVAO())},e.prototype._initialize=function(e){if(this._initialized)return!0;var t=i.bitBlit.attributes,a=r.createProgram(e,i.bitBlit);if(!a)return!1;var s=new Int8Array(16);s[0]=-1,s[1]=-1,s[2]=0,s[3]=0,s[4]=1,s[5]=-1,s[6]=1,s[7]=0,s[8]=-1,s[9]=1,s[10]=0,s[11]=1,s[12]=1,s[13]=1,s[14]=1,s[15]=1;var l=new o(e,t,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:n.createVertex(e,35044,s)});return this._program=a,this._vertexArrayObject=l,this._initialized=!0},e}()}.apply(null,n))||(e.exports=r)},"/2xn":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("hPTP")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.bitBlit={name:"bitBlit",shaders:{vertexShader:i.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:i.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}}.apply(null,n))||(e.exports=r)},"/f24":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("H1tY"),i("Rrc3"),i("Zp3t")],void 0===(r=function(e,t,i,n,r){return function(){function e(t,o,a,s){if(this._context=null,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachment=null,this._initialized=!1,this._context=t,this._desc={colorTarget:o.colorTarget,depthStencilTarget:o.depthStencilTarget,width:o.width,height:o.height,multisampled:o.multisampled},this._id=e._nextId++,i("esri-webgl-debug")&&t.instanceCounter.incrementCount(4),a){var l=void 0;a instanceof r?(this._colorAttachment=a,l=a.descriptor):(l=a,this._colorAttachment=new r(this._context,l)),this._desc.colorTarget,e._validateTextureDimensions(l,this._desc)}if(s instanceof n)2===o.depthStencilTarget?this._stencilAttachment=s:(1===o.depthStencilTarget||3===o.depthStencilTarget)&&(this._depthAttachment=s),e._validateBufferDimensions(s.descriptor,this._desc);else if(s){this._context.capabilities.depthTexture;var u=void 0;s instanceof r?(this._depthStencilTexture=s,u=this._depthStencilTexture.descriptor):(u=s,this._depthStencilTexture=new r(this._context,u)),e._validateTextureDimensions(u,this._desc)}}return e.create=function(t,i){return new e(t,i)},e.createWithAttachments=function(t,i,n,r){return new e(t,n,i,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof r?this._colorAttachment:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorAttachment",{get:function(){return this._colorAttachment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthStencilAttachment",{get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){if(this._context){var e=this._context,t=e.getBoundFramebufferObject();this._disposeColorAttachment(),this._disposeDepthStencilAttachments(),this._glName&&(e.gl.deleteFramebuffer(this._glName),this._glName=null),i("esri-webgl-debug")&&e.instanceCounter.decrementCount(4),e.bindFramebuffer(t),this._context=null}},e.prototype.attachColorTexture=function(t){if(t){var i=t.descriptor;if(e._validateTextureDimensions(i,this._desc),this._disposeColorAttachment(),this._initialized){this._context.bindFramebuffer(this);var n=this._context.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t.glName,0)}this._colorAttachment=t}},e.prototype.detachColorTexture=function(){var e=void 0;if(this._colorAttachment instanceof r){if(e=this._colorAttachment,this._initialized){this._context.bindFramebuffer(this);var t=this._context.gl;this._context.gl.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}this._colorAttachment=null}return e},e.prototype.attachDepthStencilTexture=function(t){if(t){var i=t.descriptor;if(i.pixelFormat,i.dataType,this._context.capabilities.depthTexture,e._validateTextureDimensions(i,this._desc),4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);var n=this._context.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,t.glName,0)}this._depthStencilTexture=t}},e.prototype.detachDepthStencilTexture=function(){var e=this._depthStencilTexture;if(e&&this._initialized){this._context.bindFramebuffer(this);var t=this._context.gl;this._context.gl.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,null,0)}return this._depthStencilTexture=null,e},e.prototype.attachDepthStencilBuffer=function(t){if(t){var i=t.descriptor;if(34041!==i.internalFormat&&i.internalFormat,e._validateBufferDimensions(i,this._desc),this._disposeDepthStencilAttachments(),this._desc.depthStencilTarget=34041===i.internalFormat?3:1,this._initialized){this._context.bindFramebuffer(this);var n=this._context.gl,r=1===this._desc.depthStencilTarget?n.DEPTH_ATTACHMENT:n.DEPTH_STENCIL_ATTACHMENT;n.framebufferRenderbuffer(n.FRAMEBUFFER,r,n.RENDERBUFFER,t.glName)}this._depthAttachment=t}},e.prototype.detachDepthStencilBuffer=function(){var e=this._context.gl,t=this._depthAttachment;if(t&&this._initialized){this._context.bindFramebuffer(this);var i=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,i,e.RENDERBUFFER,null)}return this._depthAttachment=null,t},e.prototype.copyToTexture=function(e,t,i,n,r,o,a){var s=this._desc,l=a.descriptor;a.descriptor.target,e+i>s.width||t+n>s.height||r+i>l.width||l.height;var u=this._context;u.bindTexture(a),u.bindFramebuffer(this),u.gl.copyTexSubImage2D(3553,0,r,o,e,t,i,n)},e.prototype.readPixels=function(e,t,i,n,r,o,a){this._context.bindFramebuffer(this),this._context.gl.readPixels(e,t,i,n,r,o,a)},e.prototype.resize=function(t,i){var n=this._desc;if(n.width!==t||n.height!==i){if(!this._initialized){if(n.width=t,n.height=i,this._colorAttachment instanceof r)(o=this._colorAttachment).resize(t,i);return void(this._depthStencilTexture&&this._depthStencilTexture.resize(t,i))}var o,a;if(n.width=t,n.height=i,this._colorAttachment instanceof r)(a=(o=this._colorAttachment).descriptor).width=t,a.height=i,this._colorAttachment.dispose(),this._colorAttachment=new r(this._context,a),e._validateTextureDimensions(o.descriptor,this._desc);else this._colorAttachment&&this._disposeColorAttachment();if(null!=this._depthStencilTexture)(a=this._depthStencilTexture.descriptor).width=t,a.height=i,this._depthStencilTexture.dispose(),this._depthStencilTexture=new r(this._context,a);else(this._depthAttachment||this._stencilAttachment)&&this._disposeDepthStencilAttachments();this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1}},e.prototype.initialize=function(){if(this._initialized)return!1;var e=this._context.gl;this._glName&&e.deleteFramebuffer(this._glName);var t=e.createFramebuffer(),i=this._desc;if(e.bindFramebuffer(e.FRAMEBUFFER,t),!this._colorAttachment)if(0===i.colorTarget){var o={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:i.width,height:i.height};this._colorAttachment=new r(this._context,o)}else{var a=new n(this._context,{internalFormat:32854,width:i.width,height:i.height});e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,a.glName),this._colorAttachment=a}if(this._colorAttachment instanceof r){var s=this._colorAttachment;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s.glName,0)}switch(i.depthStencilTarget){case 1:case 3:this._depthAttachment||(this._depthAttachment=new n(this._context,{internalFormat:1===i.depthStencilTarget?33189:34041,width:i.width,height:i.height}));var l=1===i.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new n(this._context,{internalFormat:36168,width:i.width,height:i.height})),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:if(!this._depthStencilTexture){this._context.capabilities.depthTexture;var u={target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:i.width,height:i.height};this._depthStencilTexture=new r(this._context,u)}e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,this._depthStencilTexture.glName,0)}return e.checkFramebufferStatus(e.FRAMEBUFFER),e.FRAMEBUFFER_COMPLETE,this._glName=t,this._initialized=!0,!0},e.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof r){var e=this._colorAttachment;if(this._initialized)this._context.bindFramebuffer(this),(i=this._context.gl).framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,null,0);e.dispose()}else if(this._colorAttachment instanceof WebGLRenderbuffer){var t=this._colorAttachment,i=this._context.gl;this._initialized&&(this._context.bindFramebuffer(this),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(t)}this._colorAttachment=null},e.prototype._disposeDepthStencilAttachments=function(){var e=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var t=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,t,e.RENDERBUFFER,null)}this._depthAttachment.dispose(),this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null),this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)},e._validateBufferDimensions=function(e,t){void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&(t.height,e.height):(t.width=e.width,t.height=e.height)},e._validateTextureDimensions=function(e,t){e.target,void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&(t.height,e.height):(t.width=e.width,t.height=e.height)},e._nextId=0,e}()}.apply(null,n))||(e.exports=r)},"0i+W":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("qKT0"),i("2Atf"),i("7MDj"),i("NfRO"),i("loiZ"),i("qMld"),i("jBNx"),i("Vx27"),i("Vt+U"),i("lRq4"),i("Lzvl"),i("nrlZ"),i("Q2Em"),i("Y080"),i("rYkQ"),i("AP+j"),i("bLBh"),i("LCdb"),i("MGRT"),i("6kSU"),i("vhZU"),i("5r4l"),i("wjMf"),i("zRH3")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d,f,p,v,_,m,g,y,x,b,T,w,S,M,E){function C(e,t,i){if(i.has(e))return i.get(e);var n={tile:t,addedOrModified:[],removed:[]};return i.set(e,n),n}Object.defineProperty(t,"__esModule",{value:!0});var I=new Set,F=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return n._hiddenGraphics=[],n._tiles=new Map,n._graphicStoreUpdate=!1,n._highlightIDs=new Set,n._graphicsSet=new Set,n._matcher=null,n._tileUpdateSet=new Set,n._tilesToUpdate=new Map,n._pendingUpdates=0,n._attached=!1,n.lastUpdateId=-1,n.updateRequested=!1,n.graphicUpdateHandler=n.graphicUpdateHandler.bind(n),n._addOrUpdateGraphic=n._addOrUpdateGraphic.bind(n),n._processAnalyzedGraphics=n._processAnalyzedGraphics.bind(n),n._graphicsChangeHandler=n._graphicsChangeHandler.bind(n),n}return i(t,e),t.prototype.initialize=function(){var e=this;this._tileStore=new T.default(this.view.featuresTilingScheme),this.container=new _.default({tileInfoView:this.view.featuresTilingScheme,highlightIDs:this._highlightIDs}),this._graphicStore=new S.default(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.renderer,this.graphics),this._graphicProcessingQueue=new w.default({process:this._addOrUpdateGraphic});var t=new b.default(this.container.getMaterialItems);this.renderer&&(this._matcher=y.createMatcher(this.renderer,t,null)),this._meshFactory=new x.default(null,this.uid,null,null,window.devicePixelRatio,this.view.spatialReference,t,null,this._tileStore.tileScheme.tileInfo),this.watch("renderer",function(i){e._graphicStore.renderer=i,i&&(e._matcher=y.createMatcher(e.renderer,t,null))}),this._tileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",function(){e.graphics.items.length>0&&e._graphicsChangeHandler({target:e.graphics,added:e.graphics.items,removed:[],moved:[]}),e.handles.add(e.graphics.on("change",e._graphicsChangeHandler),"graphics"),e._attached=!0,e.notifyChange("updating")})},t.prototype.destroy=function(){this._set("graphics",null),this._graphicStore.clear(),this._tileStore.destroy()},Object.defineProperty(t.prototype,"updating",{get:function(){return!this._attached||0!==this._pendingUpdates||this._graphicProcessingQueue.updating||this._tileUpdateSet.size>0||this._tilesToUpdate.size>0},enumerable:!0,configurable:!0}),t.prototype.install=function(e){e.addChild(this.container)},t.prototype.uninstall=function(e){e.removeChild(this.container)},t.prototype.addHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t];this._highlightIDs.add(n)}this._buildHLList()},t.prototype.highlight=function(e){var t=this;return t.addHighlight(e),{remove:function(){t.removeHighlight(e)}}},t.prototype.hitTest=function(e,t){if(!this.view||!this.view.position)return l.resolve();var i=this.view.toMap(u.createScreenPoint(e,t));return this.searchFeatures(i).then(function(e){return e&&e.length?e[0]:null})},t.prototype.searchFeatures=function(e,t){var i=this;return void 0===t&&(t=2),l.create(function(n){n(i._graphicStore.hitTest(e.x,e.y,t,i.view.state.resolution,i.view.state.rotation))})},t.prototype.removeHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t];this._highlightIDs.delete(n)}this._buildHLList()},t.prototype.setHighlight=function(e){this._highlightIDs.clear(),this.addHighlight(e)},t.prototype.update=function(e){var t=e.state,i=this.view.featuresTilingScheme.getClosestInfoForScale(t.scale).level;this._graphicStore.updateLevel(i),this._tileStore.setViewState(t),this._graphicStoreUpdate=!0,this.updateRequested=!1},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate(this))},t.prototype.processUpdate=function(e){this.updateRequested&&(this.updateRequested=!1,this.update(e))},t.prototype.graphicUpdateHandler=function(e){var t=e.graphic,i=e.property,n=e.newValue;switch(i){case"attributes":break;case"geometry":case"symbol":this._graphicProcessingQueue.push(t,"update");break;case"visible":this._setVisible(t.uid,n)}},t.prototype._getIntersectingTiles=function(e){var t=this._graphicStore.getBounds(e);return t&&0!==d.width(t)&&0!==d.height(t)?this._tileStore.boundsIntersections(t):[]},t.prototype._updateTile=function(e){var t=this,i=e.tile,n=this._getGraphicsData(i,e.addedOrModified);return this._processGraphics(i.key,n).then(function(n){return t._patchTile(i.key,{addOrUpdate:n,remove:e.removed}),n})},t.prototype._graphicsChangeHandler=function(e){var t=this;if(this._pendingUpdates++,this.notifyChange("updating"),!this._graphicStoreUpdate){var i=this.view.state,n=this.view.featuresTilingScheme.getClosestInfoForScale(i.scale).level;this._graphicStore.updateLevel(n),this._tileStore.setViewState(i)}for(var r=e.added,o=e.removed,a=e.moved,s=this._tilesToUpdate,u=[],h=new Array(r.length),c=0;c<r.length;c++){var d=r[c];h[c]=d,this._graphicsSet.add(d),u.push(this._addOrUpdateGraphic(d,"add"))}for(var f=0,p=o;f<p.length;f++){for(var v=p[f],_=0,m=this._getIntersectingTiles(v);_<m.length;_++){var g=m[_];C(g.key.id,g,s).removed.push(v.uid)}this._graphicsSet.delete(v),this._graphicStore.remove(v)}for(var y=0,x=a;y<x.length;y++)for(var b=x[y],T=0,w=this._getIntersectingTiles(b);T<w.length;T++){g=w[T];C(g.key.id,g,s).addedOrModified.push(b)}l.all(u).then(function(){for(var e,i=0;i<h.length;i++){e=h[i];for(var n=0,r=t._getIntersectingTiles(e);n<r.length;n++){var o=r[n];C(o.key.id,o,s).addedOrModified.push(e)}}t._graphicStore.updateZ();var a=[];return s.forEach(function(e){return a.push(t._updateTile(e))}),l.all(a).then(function(){s.clear(),t._pendingUpdates--,t.notifyChange("updating")})}).catch(function(){t._pendingUpdates--})},t.prototype._buildHLList=function(){for(var e=0,t=this.container.children;e<t.length;e++)t[e].buildHLList(this._highlightIDs);this.container.requestRender()},t.prototype._getSymbolResources=function(e){var t=e.symbol;if(!t&&this.renderer&&(t=this.renderer.getSymbol(e,{scale:this.view.scale})),!t||t&&"text"!==t.type)return l.resolve(null);I.clear();for(var i=t,n=i.text,r=0;r<n.length;r++)I.add(n.charCodeAt(r));var o=[];I.forEach(function(e){return o.push(e)});var a=[];return a.push({symbol:i.toJSON(),id:0,glyphIds:o}),this.container.getMaterialItems(a).then(function(e){return e.length>0?e[0].mosaicItem:null})},t.prototype._projectAndNormalizeGeometry=function(e){var t=this;if(!e.geometry)return l.resolve(null);var i=e.geometry;if(f.isPolygon(i)){var n=i.rings;i.rings=n}else if(f.isPolyline(i)){var r=i.paths;i.paths=r}else f.isExtent(i)&&(i=c.fromExtent(i));return v.checkProjectionSupport(i.spatialReference,this.view.spatialReference).then(function(){var e=M.normalizeCentralMeridian(i),n=v.project(e,i.spatialReference,t.view.spatialReference);return M.ensureClosedRings(n),n})},t.prototype._onTileUpdate=function(e){var t=this,i=p.getInfo(this.view.spatialReference);if(e.added&&e.added.length>0)for(var n=this,r=0,o=e.added;r<o.length;r++){!function(e){var r=n._graphicStore.queryTileData(e);if(i)for(var o=Math.round((i.valid[1]-i.valid[0])/e.resolution),a=0,s=r;a<s.length;a++){var l=s[a];l.geometry&&f.isPoint(l.geometry)&&n._wrapPoints(l,o)}n._tileUpdateSet.add(e.key),n.notifyChange("updating"),n._processGraphics(e.key,r).then(function(i){t._addTile(e.key,i),t._tileUpdateSet.delete(e.key),t.notifyChange("updating")}).catch(function(){t._tileUpdateSet.delete(e.key),t.notifyChange("updating")})}(o[r])}if(e.removed&&e.removed.length>0)for(var a=0,s=e.removed;a<s.length;a++){var l=s[a];this._removeTile(l.key)}},t.prototype._addOrUpdateGraphic=function(e,t){var i=this,n=this._projectAndNormalizeGeometry(e),r=this._getSymbolResources(e);return l.all([n,r]).then(function(n){var r=n[0],o=n[1];return"add"===t?i._addProjectedGraphic(e,o,r):i._updateGraphic(e,o,r)})},t.prototype._addProjectedGraphic=function(e,t,i){if(!this._graphicsSet.has(e))return null;e.visible||this._hiddenGraphics.push(e.uid);var n=this._graphicStore.add(e,t,i);return!n||0===d.width(n)&&0===d.height(n)?null:n},t.prototype._updateGraphic=function(e,t,i){var n=this;if(!this._graphicStore.has(e))return l.resolve();for(var r=this._graphicStore.update(e,t,i),o=r.oldBounds,a=r.newBounds,u=0===d.width(o)&&0===d.height(o),h=0===d.width(a)&&0===d.height(a),c=u?[]:this._tileStore.boundsIntersections(o),f=h?[]:this._tileStore.boundsIntersections(a),p=s.acquire(),v=0,_=c;v<_.length;v++){var m=_[v];p.set(m.key,{addOrUpdate:null,remove:[e.uid]})}for(var g=0,y=f;g<y.length;g++){m=y[g];var x=this._getGraphicData(m,e);if(p.has(m.key)){var b=p.get(m.key);b.remove.length=0,b.addOrUpdate=x}else p.set(m.key,{addOrUpdate:x,remove:null})}var T=[];return p.forEach(function(e,t){var i=n._processGraphics(t,e.addOrUpdate).then(function(i){n._patchTile(t,{addOrUpdate:i,remove:e.remove})});T.push(i)}),s.release(p),l.all(T).then(function(){return a})},t.prototype._addTile=function(e,t){var i=d.create();this.view.featuresTilingScheme.getTileBounds(i,e);var n=new g(e,i,!0),r={clear:!0,addOrUpdate:t,remove:[]};n.setData(r,!1,!1),n.buildHLList(this._highlightIDs),this._hiddenGraphics.length>0&&n.setFilterFlag(0,[],this._hiddenGraphics),this._tiles.set(e,n),this.container.addChild(n)},t.prototype._removeTile=function(e){if(this._tiles.has(e)){var t=this._tiles.get(e);this.container.removeChild(t)}},t.prototype._patchTile=function(e,t){if(this._tiles.has(e)){var i=this._tiles.get(e);i.setData(t,!1,!1),i.buildHLList(this._highlightIDs),this._hiddenGraphics.length>0&&i.setFilterFlag(0,[],this._hiddenGraphics),this.container.requestRender()}},t.prototype._setVisible=function(e,t){var i=[],n=[],r=this._hiddenGraphics.indexOf(e);if(t){if(-1===r)return;this._hiddenGraphics.splice(r,1),i.push(e)}else{if(-1!==r)return;this._hiddenGraphics.push(e),n.push(e)}for(var o=0,a=this.container.children;o<a.length;o++){var s=a[o];s.data&&s.setFilterFlag(0,i,n)}},t.prototype._getGraphicsData=function(e,t){var i=p.getInfo(this.view.spatialReference),n=this._graphicStore.getGraphicsData(e,t);if(i)for(var r=Math.round((i.valid[1]-i.valid[0])/e.resolution),o=0,a=n;o<a.length;o++){var s=a[o];s.geometry&&f.isPoint(s.geometry)&&this._wrapPoints(s,r)}return n.sort(function(e,t){return e.insertAfter-t.insertAfter}),n},t.prototype._getGraphicData=function(e,t){var i=this._graphicStore.getGraphicData(e,t),n=[i],r=p.getInfo(this.view.spatialReference);if(r){var o=Math.round((r.valid[1]-r.valid[0])/e.resolution);i.geometry&&f.isPoint(i.geometry)&&this._wrapPoints(i,o)}return n},t.prototype._wrapPoints=function(e,t){var i=e.geometry;512===t?i.x<20?e.geometry={points:[[i.x,i.y],[t,0]]}:i.x>492&&(e.geometry={points:[[i.x,i.y],[-t,0]]}):i.x<-20?e.geometry={points:[[i.x,i.y],[t,0]]}:i.x>532&&(e.geometry={points:[[i.x,i.y],[-t,0]]})},t.prototype._processGraphics=function(e,t){var i=this;return t&&t.length&&this._meshFactory?this._meshFactory.analyze(t,this._matcher).then(function(t){return i._processAnalyzedGraphics(e,t)}):l.resolve(null)},t.prototype._processAnalyzedGraphics=function(e,t){for(var i=this._meshFactory,n=i.createMeshData(t.length),r=0,o=t;r<o.length;r++){var a=o[r];i.write(n,a,null,null,e.level)}return m.fromMeshData(n)},n([h.property()],t.prototype,"_graphicProcessingQueue",void 0),n([h.property({constructOnly:!0})],t.prototype,"graphics",void 0),n([h.property({dependsOn:["_graphicProcessingQueue.updating"]})],t.prototype,"updating",null),n([h.property()],t.prototype,"view",void 0),n([h.property()],t.prototype,"updateRequested",void 0),n([h.subclass("esri.views.2d.layers.support.GraphicsView2D")],t)}(h.declared(E,o,a.Identifiable));t.default=F}.apply(null,n))||(e.exports=r)},"1E+e":function(e,t,i){var n;void 0===(n=function(){"use strict";function e(e,i,r){r=r||2;var o,a,s,u,h,c,d,f=i&&i.length,p=f?i[0]*r:e.length,v=t(e,0,p,r,!0),_=[];if(!v||v.next===v.prev)return _;if(f&&(v=l(e,i,v,r)),e.length>80*r){o=s=e[0],a=u=e[1];for(var m=r;m<p;m+=r)(h=e[m])<o&&(o=h),(c=e[m+1])<a&&(a=c),h>s&&(s=h),c>u&&(u=c);d=0!==(d=Math.max(s-o,u-a))?1/d:0}return n(v,_,r,o,a,d),_}function t(e,t,i,n,r){var o,a;if(r===I(e,t,i,n)>0)for(o=t;o<i;o+=n)a=M(o,e[o],e[o+1],a);else for(o=i-n;o>=t;o-=n)a=M(o,e[o],e[o+1],a);return a&&y(a,a.next)&&(E(a),a=a.next),a}function i(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!y(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(E(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}function n(e,t,l,u,h,c,f){if(e){!f&&c&&d(e,u,h,c);for(var p,v,_=e;e.prev!==e.next;)if(p=e.prev,v=e.next,c?o(e,u,h,c):r(e))t.push(p.i/l),t.push(e.i/l),t.push(v.i/l),E(e),e=v.next,_=v.next;else if((e=v)===_){f?1===f?n(e=a(e,t,l),t,l,u,h,c,2):2===f&&s(e,t,l,u,h,c):n(i(e),t,l,u,h,c,1);break}}}function r(e){var t=e.prev,i=e,n=e.next;if(g(t,i,n)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(_(t.x,t.y,i.x,i.y,n.x,n.y,r.x,r.y)&&g(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function o(e,t,i,n){var r=e.prev,o=e,a=e.next;if(g(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,u=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,h=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,c=p(s,l,t,i,n),d=p(u,h,t,i,n),f=e.prevZ,v=e.nextZ;f&&f.z>=c&&v&&v.z<=d;){if(f!==e.prev&&f!==e.next&&_(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&g(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,v!==e.prev&&v!==e.next&&_(r.x,r.y,o.x,o.y,a.x,a.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;f&&f.z>=c;){if(f!==e.prev&&f!==e.next&&_(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&g(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;v&&v.z<=d;){if(v!==e.prev&&v!==e.next&&_(r.x,r.y,o.x,o.y,a.x,a.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function a(e,t,i){var n=e;do{var r=n.prev,o=n.next.next;!y(r,o)&&x(r,n,n.next,o)&&T(r,o)&&T(o,r)&&(t.push(r.i/i),t.push(n.i/i),t.push(o.i/i),E(n),E(n.next),n=e=o),n=n.next}while(n!==e);return n}function s(e,t,r,o,a,s){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&m(l,u)){var h=S(l,u);return l=i(l,l.next),h=i(h,h.next),n(l,t,r,o,a,s),void n(h,t,r,o,a,s)}u=u.next}l=l.next}while(l!==e)}function l(e,n,r,o){var a,s,l,c=[];for(a=0,s=n.length;a<s;a++)(l=t(e,n[a]*o,a<s-1?n[a+1]*o:e.length,o,!1))===l.next&&(l.steiner=!0),c.push(v(l));for(c.sort(u),a=0;a<c.length;a++)h(c[a],r),r=i(r,r.next);return r}function u(e,t){return e.x-t.x}function h(e,t){if(t=c(e,t)){var n=S(t,e);i(n,n.next)}}function c(e,t){var i,n=t,r=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>a){if(a=s,s===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!i)return null;if(r===a)return i.prev;var l,u=i,h=i.x,c=i.y,d=1/0;for(n=i.next;n!==u;)r>=n.x&&n.x>=h&&r!==n.x&&_(o<c?r:a,o,h,c,o<c?a:r,o,n.x,n.y)&&((l=Math.abs(o-n.y)/(r-n.x))<d||l===d&&n.x>i.x)&&T(n,e)&&(i=n,d=l),n=n.next;return i}function d(e,t,i,n){var r=e;do{null===r.z&&(r.z=p(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,f(r)}function f(e){var t,i,n,r,o,a,s,l,u=1;do{for(i=e,e=null,o=null,a=0;i;){for(a++,n=i,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;i=n}o.nextZ=null,u*=2}while(a>1);return e}function p(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function v(e){var t=e,i=e;do{t.x<i.x&&(i=t),t=t.next}while(t!==e);return i}function _(e,t,i,n,r,o,a,s){return(r-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(n-s)-(i-a)*(t-s)>=0&&(i-a)*(o-s)-(r-a)*(n-s)>=0}function m(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!b(e,t)&&T(e,t)&&T(t,e)&&w(e,t)}function g(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function x(e,t,i,n){return!!(y(e,t)&&y(i,n)||y(e,n)&&y(i,t))||g(e,t,i)>0!=g(e,t,n)>0&&g(i,n,e)>0!=g(i,n,t)>0}function b(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&x(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function T(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function w(e,t){var i=e,n=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}function S(e,t){var i=new C(e.i,e.x,e.y),n=new C(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function M(e,t,i,n){var r=new C(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function E(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(e,t,i,n){for(var r=0,o=t,a=i-n;o<i;o+=n)r+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return r}return e.deviation=function(e,t,i,n){var r=t&&t.length,o=r?t[0]*i:e.length,a=Math.abs(I(e,0,o,i));if(r)for(var s=0,l=t.length;s<l;s++){var u=t[s]*i,h=s<l-1?t[s+1]*i:e.length;a-=Math.abs(I(e,u,h,i))}var c=0;for(s=0;s<n.length;s+=3){var d=n[s]*i,f=n[s+1]*i,p=n[s+2]*i;c+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},e.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var o=0;o<e[r].length;o++)for(var a=0;a<t;a++)i.vertices.push(e[r][o][a]);r>0&&(n+=e[r-1].length,i.holes.push(n))}return i},e}.apply(null,[]))||(e.exports=n)},"1Mg+":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("Brhx")],void 0===(r=function(e,t,i,n){function r(e,t){e.delete(t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._childrenSet=new Set,t._childrenToAttach=[],t._childrenToDetach=[],t._renderPhase=3,t.children=[],t}return i(t,e),Object.defineProperty(t.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),t.prototype.detach=function(){for(var e=0,t=this.children.concat(this._childrenToDetach);e<t.length;e++){var i=t[e];i.attached&&(this.detachChild(i),i.attached=!1,i.parent=null)}},t.prototype.doRender=function(e){var t=e.globalOpacity;e.globalOpacity*=this.opacity,this._renderPhase=0,this.attachChildren(),this._renderPhase=1;for(var i=this._childrenToDetach;i.length>0;){var n=i.shift();this.detachChild(n),n.attached=!1,n.parent=null,n.stage=null}this._renderPhase=2,this.renderChildren(e),this._renderPhase=3,e.globalOpacity=t},t.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)},t.prototype.addChildAt=function(e,t){if(void 0===t&&(t=this.numChildren),!e)return e;if(this.contains(e))return e;var i=e.parent;i&&i!==this&&i.removeChild(e),t>=this.numChildren?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e);var n=this._childrenToDetach.indexOf(e);return n>-1&&this._childrenToDetach.splice(n,1),this._childrenToAttach.push(e),this._renderPhase>=2&&this.requestRender(),e},t.prototype.contains=function(e){return this._childrenSet.has(e)},t.prototype.getChildIndex=function(e){return this.children.indexOf(e)},t.prototype.getChildAt=function(e){return e<0||e>this.children.length?null:this.children[e]},t.prototype.removeAllChildren=function(){for(var e=this.numChildren;e--;)this.removeChildAt(0)},t.prototype.removeChild=function(e){return this.contains(e)?this.removeChildAt(this.getChildIndex(e)):e},t.prototype.removeChildAt=function(e){var t;if(e<0||e>=this.children.length)return null;if(t=this.children.splice(e,1)[0],r(this._childrenSet,t),t.attached)this._childrenToDetach.push(t),this._renderPhase>=2&&this.requestRender();else{var i=this._childrenToAttach.indexOf(t);i>-1&&this._childrenToAttach.splice(i,1)}return t},t.prototype.requestChildRender=function(e){e&&e.parent===this&&this._renderPhase>=2&&this.requestRender()},t.prototype.setChildIndex=function(e,t){var i=this.getChildIndex(e);i>-1&&(this.children.splice(i,1),this.children.splice(t,0,e),this._renderPhase>=2&&this.requestRender())},t.prototype.sortChildren=function(e){return this._renderPhase>2&&this.requestRender(),this.children.sort(e)},t.prototype.attachChildren=function(){var e=this._childrenToAttach;if(0!==e.length)for(var t=0,i=!1;!i;){var n=e[t];n.parent=this,n.stage=this.stage,this.attachChild(n)?(n.attached=!0,e.splice(t,1)):++t,i=e.length===t}},t.prototype.renderChildren=function(e){for(var t=this.children,i=t.length,n=0;n<i;n++)t[n].processRender(e)},t.prototype.attachChild=function(e){return e.attach()},t.prototype.detachChild=function(e){e.detach()},t}(n.DisplayObject);t.Container=o}.apply(null,n))||(e.exports=r)},"1ZJt":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("VY6u"),i("6cAc"),i("PhOF"),i("Zp3t")],void 0===(r=function(e,t,i,n,r,o){return function(){function e(e,t,i){void 0===i&&(i=0),this._size=[],this._mosaicsData=[],this._textures=[],this._dirties=[],this._maxItemSize=0,this._currentPage=0,this._pageWidth=0,this._pageHeight=0,this._mosaicRects=new Map,this._spriteCopyQueue=[],this.pixelRatio=1,this._pageWidth=e,this._pageHeight=t,0<i&&(this._maxItemSize=i),this.pixelRatio=window.devicePixelRatio||1,this._binPack=new r(this._pageWidth,this._pageHeight);var n=Math.floor(this._pageWidth),o=Math.floor(this._pageHeight);this._mosaicsData[0]=new Uint32Array(n*o),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0)}return e.prototype.getWidth=function(e){return e>=this._size.length?-1:this._size[e][0]},e.prototype.getHeight=function(e){return e>=this._size.length?-1:this._size[e][1]},e.prototype.getPage=function(e){return e<this._textures.length?this._textures[e]:null},e.prototype.has=function(e){return this._mosaicRects.has(e)},Object.defineProperty(e.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0}),e.prototype.getSpriteItem=function(e){return this._mosaicRects.get(e)},e.prototype.addSpriteItem=function(e,t,i,n,r,o,a){if(this._mosaicRects.has(e))return this._mosaicRects.get(e);var s=this._allocateImage(t[0],t[1]),l=s[0],u=s[1],h=s[2];if(l.width<=0||l.height<=0)return null;var c={rect:l,width:t[0],height:t[1],anchorX:i[0],anchorY:i[1],sdf:o,simplePattern:a,pixelRatio:1,page:u};return this._mosaicRects.set(e,c),this._copy({rect:l,spriteSize:t,spriteData:n,page:u,pageSize:h,repeat:r,sdf:o}),c},e.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length},e.prototype.processNextItem=function(){var e=this._spriteCopyQueue.pop();e&&this._copy(e)},e.prototype.getSpriteItems=function(e){for(var t={},i=0,n=e;i<n.length;i++){var r=n[i];t[r]=this.getSpriteItem(r)}return t},e.prototype.getMosaicItemPosition=function(e,t){var i=this.getSpriteItem(e),n=i&&i.rect;if(!n)return null;n.width=i.width,n.height=i.height;var r=i.width,o=i.height;return{size:[i.width,i.height],tl:[(n.x+1)/this._size[i.page][0],(n.y+1)/this._size[i.page][1]],br:[(n.x+1+r)/this._size[i.page][0],(n.y+1+o)/this._size[i.page][1]],page:i.page}},e.prototype.bind=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this._textures[i]||(this._textures[i]=new o(e,{pixelFormat:6408,dataType:5121,width:this._size[i][0],height:this._size[i][1]},new Uint8Array(this._mosaicsData[i].buffer)));var r=this._textures[i];r.setSamplingMode(t),this._dirties[i]&&(r.setData(new Uint8Array(this._mosaicsData[i].buffer)),r.generateMipmap()),e.bindTexture(r,n),this._dirties[i]=!1},e._copyBits=function(e,t,i,n,r,o,a,s,l,u,h){var c=n*t+i,d=s*o+a;if(h){d-=o;for(var f=-1;f<=u;c=((++f+u)%u+n)*t+i,d+=o)for(var p=-1;p<=l;p++)r[d+p]=e[c+(p+l)%l]}else for(f=0;f<u;f++){for(p=0;p<l;p++)r[d+p]=e[c+p];c+=t,d+=o}},e.prototype._copy=function(t){if(!(t.page>=this._mosaicsData.length)){var i=t.spriteData,n=this._mosaicsData[t.page];e._copyBits(i,t.spriteSize[0],0,0,n,t.pageSize[0],t.rect.x+1,t.rect.y+1,t.spriteSize[0],t.spriteSize[1],t.repeat),this._dirties[t.page]=!0}},e.prototype._allocateImage=function(e,t){e+=2,t+=2;var o=Math.max(e,t);if(this._maxItemSize&&this._maxItemSize<o){var a=Math.pow(2,Math.ceil(i.log2(e))),s=Math.pow(2,Math.ceil(i.log2(t))),l=new n(0,0,e,t);return this._mosaicsData.push(new Uint32Array(a*s)),this._dirties.push(!0),this._size.push([a,s]),this._textures.push(void 0),[l,this._mosaicsData.length-1,[a,s]]}var u=e%4?4-e%4:0,h=t%4?4-t%4:0,c=this._binPack.allocate(e+u,t+h);return c.width<=0?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new r(this._pageWidth,this._pageHeight),this._allocateImage(e,t)):[c,this._currentPage,[this._pageWidth,this._pageHeight]]},e.prototype.dispose=function(){this._binPack=null;for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0,this._mosaicsData.length=0,this._mosaicRects.clear()},e}()}.apply(null,n))||(e.exports=r)},"1m5D":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("CIzB")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.mat4f64=i}.apply(null,n))||(e.exports=r)},"2JMt":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i){this._initialVelocity=e,this._stopVelocity=t,this._friction=i,this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}return Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),e.prototype.isFinished=function(e){return e>this.duration},Object.defineProperty(e.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0}),e.prototype.value=function(e){return this.valueFromInitialVelocity(this._initialVelocity,e)},e.prototype.valueDelta=function(e,t){var i=this.value(e);return this.value(e+t)-i},e.prototype.valueFromInitialVelocity=function(e,t){t=Math.min(t,this.duration);var i=1-this.friction;return e*(Math.pow(i,t)-1)/Math.log(i)},e}();t.Momentum=n}.apply(null,n))||(e.exports=r)},"2fXB":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("bH65")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=i}.apply(null,n))||(e.exports=r)},"2pwJ":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("2Atf"),i("JNkf"),i("apbF"),i("PDSL"),i("m87x")],void 0===(r=function(e,t,i,n,r,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return r.WGLGeometryType.MARKER},t.prototype.drawGeometry=function(e,t,i,n){var r,a=e.context,l=e.painter,u=e.rendererInfo,h=e.drawPhase,c=e.state,d=i.indexCount,f=i.indexFrom,p=i.materialKey,v=s.MarkerMaterialKey.load(p),_=(r=v,o.createProgramDescriptor(r.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffsetAndTex",count:4,type:5120},{location:2,name:"a_id",count:4,type:5121,normalized:!0},{location:3,name:"a_color",count:4,type:5121,normalized:!0},{location:4,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:5,name:"a_sizeAndOutlineWidth",count:4,type:5121}].concat(r.hasVV()?[{location:6,name:"a_vv",count:4,type:5126}]:[]),visibility:[{location:8,name:"a_visible",count:1,type:5121}]})),m=l.materialManager.getProgram(v,h,u,"icon",_.attributes),g=this._getVAO(a,_.bufferLayouts,_.attributes,n);a.bindProgram(m),a.bindVAO(g),v.textureBinding&&l.textureManager.bindTextures(a,m,v,4),this._setSharedUniforms(m,e,t);var y=v.vvRotation?c.displayViewMat3:c.displayMat3;m.setUniformMatrix3fv("u_displayMat3",y),v.vvSizeMinMaxValue&&m.setUniform4fv("u_vvSizeMinMaxValue",u.vvSizeMinMaxValue),v.vvSizeScaleStops&&m.setUniform1f("u_vvSizeScaleStopsValue",u.vvSizeScaleStopsValue),v.vvSizeFieldStops&&(m.setUniform1fv("u_vvSizeFieldStopsValues",u.vvSizeFieldStopsValues),m.setUniform1fv("u_vvSizeFieldStopsSizes",u.vvSizeFieldStopsSizes)),v.vvSizeUnitValue&&m.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",u.vvSizeUnitValueToPixelsRatio),v.vvColor&&(m.setUniform1fv("u_vvColorValues",u.vvColorValues),m.setUniform4fv("u_vvColors",u.vvColors)),v.vvOpacity&&(m.setUniform1fv("u_vvOpacityValues",u.vvOpacityValues),m.setUniform1fv("u_vvOpacities",u.vvOpacities)),v.vvRotation&&m.setUniform1f("u_vvRotationType","geographic"===u.vvMaterialParameters.vvRotationType?0:1),a.drawElements(4,d,5125,4*f),a.bindVAO(null)},t}(a.default);t.default=l}.apply(null,n))||(e.exports=r)},"3+7H":function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){}}.apply(null,n))||(e.exports=r)},"37NJ":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("U6iw"),i("DlJW"),i("7laH"),i("veTl")],void 0===(r=function(e,t,i,n,r,o){function a(e,t){if(t.compressedTextureS3TC)return null;var i=e.getExtension("WEBGL_compressed_texture_s3tc");return i?{COMPRESSED_RGB_S3TC_DXT1:i.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:i.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:i.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:i.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}function s(e,t){if(r.default(e))return{MIN:e.MIN,MAX:e.MAX};if(t.blendMinMax)return null;var i=e.getExtension("EXT_blend_minmax");return i?{MIN:i.MIN_EXT,MAX:i.MAX_EXT}:null}function l(e,t){if(t.textureFilterAnisotropic)return null;var i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");return i?{MAX_TEXTURE_MAX_ANISOTROPY:i.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:i.TEXTURE_MAX_ANISOTROPY_EXT}:null}function u(e,t){if(r.default(e))return{textureFloat:!0,textureFloatLinear:!t.textureFloatLinear&&!!e.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!t.textureHalfFloatLinear&&!!e.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:e.HALF_FLOAT};if(e instanceof WebGLRenderingContext){var i=!t.textureHalfFloat&&e.getExtension("OES_texture_half_float");return{textureFloat:!t.textureFloat&&!!e.getExtension("OES_texture_float"),textureFloatLinear:!t.textureFloatLinear&&!!e.getExtension("OES_texture_float_linear"),textureHalfFloat:!!i,textureHalfFloatLinear:!t.textureHalfFloatLinear&&!!e.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:i?i.HALF_FLOAT_OES:void 0}}}function h(e,t){if(r.default(e)){var i=!t.colorBufferFloat&&e.getExtension("EXT_color_buffer_half_float"),n=!t.colorBufferFloat&&e.getExtension("EXT_color_buffer_float");return i||n?{textureFloat:!!n,textureHalfFloat:!!i,R16F:e.R16F,RG16F:e.RG16F,RGBA16F:e.RGBA16F,R32F:e.R32F,RG32F:e.RG32F,RGBA32F:e.RGBA32F,R11F_G11F_B10F:e.R11F_G11F_B10F,RGB16F:e.RGB16F}:null}if(e instanceof WebGLRenderingContext){i=!t.colorBufferFloat&&e.getExtension("EXT_color_buffer_half_float"),n=!t.colorBufferFloat&&e.getExtension("WEBGL_color_buffer_float");return i||n?{textureFloat:!!n,textureHalfFloat:!!i,RGBA16F:i?i.RGBA16F_EXT:void 0,RGB16F:i?i.RGB16F_EXT:void 0,RGBA32F:n?n.RGBA32F_EXT:void 0}:null}}function c(e,t,i,n,o){if(n&&r.default(e))return!0;if(t[i])return!1;for(var a=0,s=o;a<s.length;a++){var l=s[a];if(e.getExtension(l))return!0}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.loadCapabilities=function(e,t){var r=t&&t.disabledExtensions||{};return c(e,r,"standardDerivatives",!0,["OES_standard_derivatives"]),{instancing:n.load(e),vao:o.load(e,r),compressedTextureS3TC:a(e,r),textureFilterAnisotropic:l(e,r),disjointTimerQuery:i.load(e,r),textureFloat:u(e,r),colorBufferFloat:h(e,r),blendMinMax:s(e,r),depthTexture:c(e,r,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),standardDerivatives:!0,shaderTextureLOD:c(e,r,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]),fragDepth:c(e,r,"fragDepth",!0,["EXT_frag_depth"])}}}.apply(null,n))||(e.exports=r)},"3KT0":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("H1tY"),i("uwSd"),i("TCFx"),i("qbr3"),i("7laH"),i("37NJ")],void 0===(r=function(e,t,i,n,r,o,a,s){function l(e,t){switch(e){case 0:return 2*t;case 4:return t/3;case 5:case 6:return t-2}return 0}return function(){function e(e,t){var n=this;this.gl=null,this._blendEnabled=!1,this._blendColorState={r:0,g:0,b:0,a:0},this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0},this._blendEquationState={mode:32774,modeAlpha:32774},this._colorMaskState={r:!0,g:!0,b:!0,a:!0},this._polygonCullingEnabled=!1,this._cullFace=1029,this._frontFace=2305,this._scissorTestEnabled=!1,this._scissorRect={x:0,y:0,width:0,height:0},this._depthTestEnabled=!1,this._depthFunction=513,this._clearDepth=1,this._depthWriteEnabled=!0,this._depthRange={zNear:0,zFar:1},this._viewport=null,this._stencilTestEnabled=!1,this._polygonOffsetFillEnabled=!1,this._polygonOffset=[0,0],this._stencilFunction={face:1032,func:519,ref:0,mask:1},this._clearStencil=0,this._stencilWriteMask=1,this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680},this._clearColor={r:0,g:0,b:0,a:0},this._activeShaderProgram=null,this._activeVertexBuffer=null,this._activeIndexBuffer=null,this._activeFramebuffer=null,this._activeRenderbuffer=null,this._activeTextureUnit=0,this._textureUnitMap={},this._numOfDrawCalls=0,this._numOfTriangles=0,this.contextVersion=a.default(e)?"webgl2":"webgl",this.gl=e,e instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint"),this._capabilities=s.loadCapabilities(e,t);var l=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:l[0],y:l[1],width:l[2],height:l[3]};var u=this.capabilities.textureFilterAnisotropic;this._parameters={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:u?this.gl.getParameter(u.MAX_TEXTURE_MAX_ANISOTROPY):void 0,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)},i("esri-webgl-debug")&&(this.instanceCounter=new r),this._stateTracker=new o.StateTracker({setBlending:function(e){if(e){n.setBlendingEnabled(!0),n.setBlendEquationSeparate(e.opRgb,e.opAlpha),n.setBlendFunctionSeparate(e.srcRgb,e.dstRgb,e.srcAlpha,e.dstAlpha);var t=e.color;n.setBlendColor(t.r,t.g,t.b,t.a)}else n.setBlendingEnabled(!1)},setCulling:function(e){e?(n.setFaceCullingEnabled(!0),n.setCullFace(e.face),n.setFrontFace(e.mode)):n.setFaceCullingEnabled(!1)},setPolygonOffset:function(e){e?(n.setPolygonOffsetFillEnabled(!0),n.setPolygonOffset(e.factor,e.units)):n.setPolygonOffsetFillEnabled(!1)},setDepthTest:function(e){e?(n.setDepthTestEnabled(!0),n.setDepthFunction(e.func)):n.setDepthTestEnabled(!1)},setStencilTest:function(e){if(e){n.setStencilTestEnabled(!0);var t=e.function;n.setStencilFunction(t.func,t.ref,t.mask);var i=e.operation;n.setStencilOp(i.fail,i.zFail,i.zPass)}else n.setStencilTestEnabled(!1)},setDepthWrite:function(e){e?(n.setDepthWriteEnabled(!0),n.setDepthRange(e.zNear,e.zFar)):n.setDepthWriteEnabled(!1)},setColorWrite:function(e){e?n.setColorMask(e.r,e.g,e.b,e.a):n.setColorMask(!1,!1,!1,!1)},setStencilWrite:function(e){e?n.setStencilWriteMask(e.mask):n.setStencilWriteMask(0)}}),this.enforceState()}return Object.defineProperty(e.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.bindVAO(null),this.unbindBuffer(34962),this.unbindBuffer(34963),this._textureUnitMap={},i("esri-webgl-debug")&&this.instanceCounter.printResourceCount(),this.gl=null},e.prototype.setPipelineState=function(e){this._stateTracker.setPipeline(e)},e.prototype.setBlendingEnabled=function(e){this._blendEnabled!==e&&(!0===e?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=e,this._stateTracker.invalidateBlending())},e.prototype.setBlendColor=function(e,t,i,n){e===this._blendColorState.r&&t===this._blendColorState.g&&i===this._blendColorState.b&&n===this._blendColorState.a||(this.gl.blendColor(e,t,i,n),this._blendColorState.r=e,this._blendColorState.g=t,this._blendColorState.b=i,this._blendColorState.a=n,this._stateTracker.invalidateBlending())},e.prototype.setBlendFunction=function(e,t){e===this._blendFunctionState.srcRGB&&t===this._blendFunctionState.dstRGB||(this.gl.blendFunc(e,t),this._blendFunctionState.srcRGB=e,this._blendFunctionState.srcAlpha=e,this._blendFunctionState.dstRGB=t,this._blendFunctionState.dstAlpha=t,this._stateTracker.invalidateBlending())},e.prototype.setBlendFunctionSeparate=function(e,t,i,n){this._blendFunctionState.srcRGB===e&&this._blendFunctionState.srcAlpha===i&&this._blendFunctionState.dstRGB===t&&this._blendFunctionState.dstAlpha===n||(this.gl.blendFuncSeparate(e,t,i,n),this._blendFunctionState.srcRGB=e,this._blendFunctionState.srcAlpha=i,this._blendFunctionState.dstRGB=t,this._blendFunctionState.dstAlpha=n,this._stateTracker.invalidateBlending())},e.prototype.setBlendEquation=function(e){this._blendEquationState.mode!==e&&(this.gl.blendEquation(e),this._blendEquationState.mode=e,this._blendEquationState.modeAlpha=e,this._stateTracker.invalidateBlending())},e.prototype.setBlendEquationSeparate=function(e,t){this._blendEquationState.mode===e&&this._blendEquationState.modeAlpha===t||(this.gl.blendEquationSeparate(e,t),this._blendEquationState.mode=e,this._blendEquationState.modeAlpha=t,this._stateTracker.invalidateBlending())},e.prototype.setColorMask=function(e,t,i,n){this._colorMaskState.r===e&&this._colorMaskState.g===t&&this._colorMaskState.b===i&&this._colorMaskState.a===n||(this.gl.colorMask(e,t,i,n),this._colorMaskState.r=e,this._colorMaskState.g=t,this._colorMaskState.b=i,this._colorMaskState.a=n,this._stateTracker.invalidateColorWrite())},e.prototype.setClearColor=function(e,t,i,n){this._clearColor.r===e&&this._clearColor.g===t&&this._clearColor.b===i&&this._clearColor.a===n||(this.gl.clearColor(e,t,i,n),this._clearColor.r=e,this._clearColor.g=t,this._clearColor.b=i,this._clearColor.a=n)},e.prototype.setFaceCullingEnabled=function(e){this._polygonCullingEnabled!==e&&(!0===e?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=e,this._stateTracker.invalidateCulling())},e.prototype.setPolygonOffsetFillEnabled=function(e){this._polygonOffsetFillEnabled!==e&&(!0===e?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=e,this._stateTracker.invalidatePolygonOffset())},e.prototype.setPolygonOffset=function(e,t){this._polygonOffset[0]===e&&this._polygonOffset[1]===t||(this._polygonOffset[0]=e,this._polygonOffset[1]=t,this.gl.polygonOffset(e,t),this._stateTracker.invalidatePolygonOffset())},e.prototype.setCullFace=function(e){this._cullFace!==e&&(this.gl.cullFace(e),this._cullFace=e,this._stateTracker.invalidateCulling())},e.prototype.setFrontFace=function(e){this._frontFace!==e&&(this.gl.frontFace(e),this._frontFace=e,this._stateTracker.invalidateCulling())},e.prototype.setScissorTestEnabled=function(e){this._scissorTestEnabled!==e&&(!0===e?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=e)},e.prototype.setScissorRect=function(e,t,i,n){this._scissorRect.x===e&&this._scissorRect.y===t&&this._scissorRect.width===i&&this._scissorRect.height===n||(this.gl.scissor(e,t,i,n),this._scissorRect.x=e,this._scissorRect.y=t,this._scissorRect.width=i,this._scissorRect.height=n)},e.prototype.setDepthTestEnabled=function(e){this._depthTestEnabled!==e&&(!0===e?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=e,this._stateTracker.invalidateDepthTest())},e.prototype.setClearDepth=function(e){this._clearDepth!==e&&(this.gl.clearDepth(e),this._clearDepth=e)},e.prototype.setDepthFunction=function(e){this._depthFunction!==e&&(this.gl.depthFunc(e),this._depthFunction=e,this._stateTracker.invalidateDepthTest())},e.prototype.setDepthWriteEnabled=function(e){this._depthWriteEnabled!==e&&(this.gl.depthMask(e),this._depthWriteEnabled=e,this._stateTracker.invalidateDepthWrite())},e.prototype.setDepthRange=function(e,t){this._depthRange.zNear===e&&this._depthRange.zFar===t||(this.gl.depthRange(e,t),this._depthRange.zNear=e,this._depthRange.zFar=t,this._stateTracker.invalidateDepthWrite())},e.prototype.setStencilTestEnabled=function(e){this._stencilTestEnabled!==e&&(!0===e?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=e,this._stateTracker.invalidateStencilTest())},e.prototype.setClearStencil=function(e){e!==this._clearStencil&&(this.gl.clearStencil(e),this._clearStencil=e)},e.prototype.setStencilFunction=function(e,t,i){this._stencilFunction.func===e&&this._stencilFunction.ref===t&&this._stencilFunction.mask===i||(this.gl.stencilFunc(e,t,i),this._stencilFunction.face=1032,this._stencilFunction.func=e,this._stencilFunction.ref=t,this._stencilFunction.mask=i,this._stateTracker.invalidateStencilTest())},e.prototype.setStencilFunctionSeparate=function(e,t,i,n){this._stencilFunction.face===e&&this._stencilFunction.func===t&&this._stencilFunction.ref===i&&this._stencilFunction.mask===n||(this.gl.stencilFuncSeparate(e,t,i,n),this._stencilFunction.face=e,this._stencilFunction.func=t,this._stencilFunction.ref=i,this._stencilFunction.mask=n,this._stateTracker.invalidateStencilTest())},e.prototype.setStencilWriteMask=function(e){this._stencilWriteMask!==e&&(this.gl.stencilMask(e),this._stencilWriteMask=e,this._stateTracker.invalidateStencilWrite())},e.prototype.setStencilOp=function(e,t,i){this._stencilOperation.fail===e&&this._stencilOperation.zFail===t&&this._stencilOperation.zPass===i||(this.gl.stencilOp(e,t,i),this._stencilOperation.face=1032,this._stencilOperation.fail=e,this._stencilOperation.zFail=t,this._stencilOperation.zPass=i,this._stateTracker.invalidateStencilTest())},e.prototype.setStencilOpSeparate=function(e,t,i,n){this._stencilOperation.face===e&&this._stencilOperation.fail===t&&this._stencilOperation.zFail===i&&this._stencilOperation.zPass===n||(this.gl.stencilOpSeparate(e,t,i,n),this._stencilOperation.face=e,this._stencilOperation.face=e,this._stencilOperation.fail=t,this._stencilOperation.zFail=i,this._stencilOperation.zPass=n,this._stateTracker.invalidateStencilTest())},e.prototype.setActiveTexture=function(e){var t=this._activeTextureUnit;return e>=0&&e!==this._activeTextureUnit&&(this.gl.activeTexture(n.BASE_TEXTURE_UNIT+e),this._activeTextureUnit=e),t},e.prototype.clear=function(e){e&&this.gl.clear(e)},e.prototype.clearSafe=function(e){e&&(16384&e&&this.setColorMask(!0,!0,!0,!0),256&e&&this.setDepthWriteEnabled(!0),1024&e&&this.setStencilWriteMask(255),this.gl.clear(e))},e.prototype.drawArrays=function(e,t,n){i("esri-webgl-debug")&&(this._numOfDrawCalls++,this._numOfTriangles+=l(e,n)),this.gl.drawArrays(e,t,n)},e.prototype.drawElements=function(e,t,n,r){i("esri-webgl-debug")&&(this._numOfDrawCalls++,this._numOfTriangles+=l(e,t)),5123!==n?5125===n&&this.gl.drawElements(e,t,n,r):this.gl.drawElements(e,t,n,r)},e.prototype.logIno=function(){i("esri-webgl-debug")},Object.defineProperty(e.prototype,"capabilities",{get:function(){return this._capabilities},enumerable:!0,configurable:!0}),e.prototype.setViewport=function(e,t,i,n){var r=this._viewport;r.x===e&&r.y===t&&r.width===i&&r.height===n||(r.x=e,r.y=t,r.width=i,r.height=n,this.gl.viewport(e,t,i,n))},e.prototype.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}},e.prototype.bindProgram=function(e){if(!e)return this.gl.useProgram(null),void(this._activeShaderProgram=null);this._activeShaderProgram!==e&&(e.initialize(),this.gl.useProgram(e.glName),this._activeShaderProgram=e)},e.prototype.bindTexture=function(t,i){void 0===i&&(i=0),-1===e._MAX_TEXTURE_IMAGE_UNITS&&(e._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)),e._MAX_TEXTURE_IMAGE_UNITS;var n=this._textureUnitMap[i];return this.setActiveTexture(i),null==t||null==t.glName?(null!=n&&(this.gl.bindTexture(n.descriptor.target,null),n.setBoundToUnit(i,!1)),void(this._textureUnitMap[i]=null)):n&&n.id===t.id?void t.applyChanges():(this.gl.bindTexture(t.descriptor.target,t.glName),t.setBoundToUnit(i,!0),t.applyChanges(),void(this._textureUnitMap[i]=t))},e.prototype.bindFramebuffer=function(e){if(!e)return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),void(this._activeFramebuffer=null);this._activeFramebuffer!==e&&(e.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e.glName),this._activeFramebuffer=e)},e.prototype.bindBuffer=function(t){t&&(34962===t.bufferType?this._activeVertexBuffer=e._bindBuffer(this.gl,t,t.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=e._bindBuffer(this.gl,t,t.bufferType,this._activeIndexBuffer))},e.prototype.bindRenderbuffer=function(e){var t=this.gl;e||(t.bindRenderbuffer(t.RENDERBUFFER,null),this._activeRenderbuffer=null),this._activeRenderbuffer!==e&&(t.bindRenderbuffer(t.RENDERBUFFER,e.glName),this._activeRenderbuffer=e)},e.prototype.unbindBuffer=function(t){34962===t?this._activeVertexBuffer=e._bindBuffer(this.gl,null,t,this._activeVertexBuffer):this._activeIndexBuffer=e._bindBuffer(this.gl,null,t,this._activeIndexBuffer)},e.prototype.bindVAO=function(e){e?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===e.id||(e.bind(),this._activeVertexArrayObject=e):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)},e.prototype.getBoundTexture=function(e){return this._textureUnitMap[e]},e.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer},e.prototype.getBoundVAO=function(){return this._activeVertexArrayObject},e.prototype.resetState=function(){this.bindProgram(null),this.bindVAO(null),this.bindFramebuffer(null),this.unbindBuffer(34962),this.unbindBuffer(34963);for(var e=0;e<this.parameters.maxTextureImageUnits;e++)this.bindTexture(null,e);this.setBlendingEnabled(!1),this.setBlendFunction(1,0),this.setBlendEquation(32774),this.setBlendColor(0,0,0,0),this.setFaceCullingEnabled(!1),this.setCullFace(1029),this.setFrontFace(2305),this.setPolygonOffsetFillEnabled(!1),this.setPolygonOffset(0,0),this.setScissorTestEnabled(!1),this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height),this.setDepthTestEnabled(!1),this.setDepthFunction(513),this.setDepthRange(0,1),this.setStencilTestEnabled(!1),this.setStencilFunction(519,0,0),this.setStencilOp(7680,7680,7680),this.setClearColor(0,0,0,0),this.setClearDepth(1),this.setClearStencil(0),this.setColorMask(!0,!0,!0,!0),this.setStencilWriteMask(4294967295),this.setDepthWriteEnabled(!0),this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)},e.prototype.enforceState=function(){var e=this.gl,t=this._capabilities.vao;t&&t.bindVertexArray(null);for(var r=0;r<this.parameters.maxVertexAttributes;r++)e.disableVertexAttribArray(r);if(this._activeVertexBuffer?e.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):e.bindBuffer(34962,null),this._activeIndexBuffer?e.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):e.bindBuffer(34963,null),t&&this._activeVertexArrayObject){var o=this._activeVertexArrayObject;this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null),this.bindVAO(o)}e.bindFramebuffer(e.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null),e.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null),e.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a),e.bindRenderbuffer(e.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null),!0===this._blendEnabled?e.enable(this.gl.BLEND):e.disable(this.gl.BLEND),e.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha),e.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha),e.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),e.clearDepth(this._clearDepth),e.clearStencil(this._clearStencil),e.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a),e.cullFace(this._cullFace),e.depthFunc(this._depthFunction),e.depthRange(this._depthRange.zNear,this._depthRange.zFar),!0===this._depthTestEnabled?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(this._depthWriteEnabled),e.frontFace(this._frontFace),e.lineWidth(1),!0===this._polygonCullingEnabled?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]),!0===this._polygonOffsetFillEnabled?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),e.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height),!0===this._scissorTestEnabled?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),e.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask),e.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass),!0===this._stencilTestEnabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.stencilMask(this._stencilWriteMask);for(var a=0;a<this.parameters.maxTextureImageUnits;a++){e.activeTexture(n.BASE_TEXTURE_UNIT+a),e.bindTexture(3553,null);var s=this._textureUnitMap[a];s&&e.bindTexture(s.descriptor.target,s.glName)}e.activeTexture(n.BASE_TEXTURE_UNIT+this._activeTextureUnit),e.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height),i("esri-webgl-debug")&&(this._numOfDrawCalls=0,this._numOfTriangles=0)},e._bindBuffer=function(e,t,i,n){return t?n===t?n:(e.bindBuffer(i,t.glName),t):(e.bindBuffer(i,null),null)},e._MAX_TEXTURE_IMAGE_UNITS=-1,e}()}.apply(null,n))||(e.exports=r)},"3gjc":function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){return new Float32Array(4)},t.clone=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,i,n){var r=new Float32Array(4);return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r},t.createView=function(e,t){return new Float32Array(e,t,4)}}.apply(null,n))||(e.exports=r)},"3pdx":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("H1tY"),i("qMld"),i("6cAc"),i("PhOF"),i("Zp3t")],void 0===(r=function(e,t,i,n,r,o,a){var s;return i("stable-symbol-rendering")&&(s=new Set),function(){function e(e,t,n){this.width=0,this.height=0,this._dirties=[],this._glyphData=[],this._currentPage=0,this._glyphIndex={},this._textures=[],this._rangePromises=new Map,!s&&i("stable-symbol-rendering")&&(s=new Set),this.width=e,this.height=t,this._glyphSource=n,this._binPack=new o(e-4,t-4),this._glyphData.push(new Uint8Array(e*t)),this._dirties.push(!0),this._textures.push(void 0),this._addDecorationGlyph()}return e.prototype.getGlyphItems=function(e,t){for(var r=this,o=[],a=this._glyphSource,l=new Set,u=0,h=t;u<h.length;u++){var c=h[u],d=Math.floor(c*(1/256));l.add(d)}var f=[];return l.forEach(function(t){if(t<=256){var i=e+t;if(r._rangePromises.has(i))f.push(r._rangePromises.get(i));else{var n=a.getRange(e,t).then(function(){r._rangePromises.delete(i)}).catch(function(){throw r._rangePromises.delete(i),Error("Unable to query resource")});r._rangePromises.set(i,n),f.push(n)}}}),n.all(f).then(function(n){var u,h=r._glyphIndex[e];if(h||(h={},r._glyphIndex[e]=h),i("stable-symbol-rendering")){s.clear();for(var c=0,d=t;c<d.length;c++){var f=d[c];s.add(f)}var p=[];l.forEach(function(e){p.push(e)}),p.sort(),u=[];for(var v=0,_=p;v<_.length;v++)for(var m=_[v],g=0;g<256;++g)u.push(256*m+g)}else u=t;for(var y=0,x=u;y<x.length;y++){var b=h[f=x[y]];if(b)i("stable-symbol-rendering")&&!s.has(f)||(o[f]={sdf:!0,rect:b.rect,metrics:b.metrics,page:b.page});else{var T=a.getGlyph(e,f);if(T&&T.metrics){var w=r._recordGlyph(T,f);h[f]={rect:w,metrics:T.metrics,tileIDs:null,page:r._currentPage},i("stable-symbol-rendering")&&!s.has(f)||(o[f]={sdf:!0,rect:w,metrics:T.metrics,page:r._currentPage}),r._dirties[r._currentPage]=!0}}}return o})},e.prototype._recordGlyph=function(e,t){var i,n=e.metrics;if(0===n.width)i=new r(0,0,0,0);else{var a=n.width+6,s=n.height+6,l=a%4?4-a%4:4,u=s%4?4-s%4:4;1===l&&(l=5),1===u&&(u=5),(i=this._binPack.allocate(a+l,s+u)).isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new o(this.width-4,this.height-4),i=this._binPack.allocate(a+l,s+u));var h=this._glyphData[this._currentPage],c=e.bitmap,d=void 0,f=void 0;if(c)for(var p=0;p<s;p++){d=a*p,f=this.width*(i.y+p+1)+i.x;for(var v=0;v<a;v++)h[f+v+1]=c[d+v]}}return i},e.prototype._addDecorationGlyph=function(){for(var e=[117,149,181,207,207,181,149,117],t=[],i=0;i<e.length;i++)for(var n=e[i],r=0;r<11;r++)t.push(n);var o={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(t)};this._recordGlyph(o,0)},e.prototype.bind=function(e,t,i,n){this._textures[i]||(this._textures[i]=new a(e,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var r=this._textures[i];r.setSamplingMode(t),this._dirties[i]&&r.setData(this._glyphData[i]),e.bindTexture(r,n),this._dirties[i]=!1},e.prototype.dispose=function(){this._binPack=null;for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0,this._glyphData.length=0},e}()}.apply(null,n))||(e.exports=r)},"3u8V":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("JNkf"),i("apbF"),i("PDSL"),i("m87x")],void 0===(r=function(e,t,i,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.TEXT},t.prototype.drawGeometry=function(e,t,i,n){var o,s=e.context,l=e.painter,u=e.rendererInfo,h=e.drawPhase,c=e.state,d=i.indexCount,f=i.indexFrom,p=i.materialKey,v=a.TextMaterialKey.load(p),_=(o=v,r.createProgramDescriptor(o.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121,normalized:!0},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texFontSize",count:4,type:5120},{location:5,name:"a_aux",count:4,type:5120}].concat(o.hasVV()?[{location:6,name:"a_vv",count:4,type:5126}]:[]),visibility:[{location:7,name:"a_visible",count:1,type:5121}]})),m=l.materialManager.getProgram(v,h,u,"text",_.attributes),g=this._getVAO(s,_.bufferLayouts,_.attributes,n);s.bindProgram(m),s.bindVAO(g),this._setSharedUniforms(m,e,t),l.textureManager.bindTextures(s,m,v,4),m.setUniformMatrix3fv("u_displayMat3",c.displayMat3),v.vvSizeMinMaxValue&&m.setUniform4fv("u_vvSizeMinMaxValue",u.vvSizeMinMaxValue),v.vvSizeScaleStops&&m.setUniform1f("u_vvSizeScaleStopsValue",u.vvSizeScaleStopsValue),v.vvSizeFieldStops&&(m.setUniform1fv("u_vvSizeFieldStopsValues",u.vvSizeFieldStopsValues),m.setUniform1fv("u_vvSizeFieldStopsSizes",u.vvSizeFieldStopsSizes)),v.vvSizeUnitValue&&m.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",u.vvSizeUnitValueToPixelsRatio),v.vvColor&&(m.setUniform1fv("u_vvColorValues",u.vvColorValues),m.setUniform4fv("u_vvColors",u.vvColors)),v.vvOpacity&&(m.setUniform1fv("u_vvOpacityValues",u.vvOpacityValues),m.setUniform1fv("u_vvOpacities",u.vvOpacities)),v.vvRotation&&m.setUniform1f("u_vvRotationType","geographic"===u.vvMaterialParameters.vvRotationType?0:1),s.drawElements(4,d,5125,4*f),s.bindVAO(null)},t}(o.default);t.default=s}.apply(null,n))||(e.exports=r)},"51bw":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xf8T")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.mat3f64=i}.apply(null,n))||(e.exports=r)},"5MKl":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("hPTP")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.stencil={name:"stencil",shaders:{vertexShader:i.resolveIncludes("stencil/stencil.vert"),fragmentShader:i.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},"5r4l":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("2Atf"),i("xdHJ"),i("H1tY"),i("jBNx"),i("jEml"),i("lRq4"),i("k1EI"),i("Lzvl"),i("fw2w"),i("Bbit"),i("9gM4"),i("wjMf")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d,f){function p(e,t,i,n,r){return v.minX=t,v.minY=i,v.maxX=n,v.maxY=r,e.search(v)}Object.defineProperty(t,"__esModule",{value:!0});var v={minX:0,minY:0,maxX:0,maxY:0},_=s.create(),m=[],g=function(){function e(e,t,i,o,s){this.renderer=o,this._graphics=s,this._index=a(9,r("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this._itemByGraphic=new n.default,this._currentLevel=-1/0,this._tileInfoView=e,this._uidFieldName=i;var l=e.getClosestInfoForScale(t);l&&(this._currentLevel=l.level,this._resolution=this._tileInfoView.getTileResolution(l.level))}return e.prototype.hitTest=function(e,t,i,n,r){e=h.normalizeMapX(e,this._tileInfoView.spatialReference);var a=.5*n*i;_[0]=e-a,_[1]=t-a,_[2]=e+a,_[3]=t+a;var c=.5*n*(i+50),d=p(this._index,e-c,t-c,e+c,t+c);if(!d||0===d.length)return[];for(var v,m={x:e,y:t},g=[],y=0,x=d;y<x.length;y++){var b=x[y];if(b.graphic.visible)switch(u.getJsonType(b.geometry)){case"esriGeometryPoint":var T=this._getSymbol(b.graphic);if(!T)continue;var w=b.geometry,S=void 0;if("text"===T.type){var M=T;S=f.getTextSymbolBounds(w.x,w.y,M,b.size,this._resolution,r)}else S=f.getMarkerSymbolBounds(w.x,w.y,T,this._resolution,r);l.polygonContainsPoint(S,m)&&g.push(b);break;case"esriGeometryPolyline":var E=this._getSymbol(b.graphic);if(!E)continue;v=1.5*n*window.devicePixelRatio*o.pt2px(E.width),f.isPointOnPolyline(b.geometry,e,t,v)&&g.push(b);break;case"esriGeometryEnvelope":var C=b.geometry,I=s.fromValues(C.xmin,C.ymin,C.xmax,C.ymax);s.intersects(I,_)&&g.push(b);break;case"esriGeometryPolygon":l.polygonContainsPoint(b.geometry,m)&&g.push(b);break;case"esriGeometryMultipoint":var F=this._getSymbol(b.graphic);if(!F)continue;for(var A=b.geometry.points,O=void 0,P=0;P<A.length;P++){if("text"===F.type){M=F;O=f.getTextSymbolBounds(A[P][0],A[P][1],M,b.size,this._resolution,r)}else O=f.getMarkerSymbolBounds(A[P][0],A[P][1],F,this._resolution,r);if(l.polygonContainsPoint(O,m)){g.push(b);break}}}}return g.sort(function(e,t){var i=f.graphicGeometryToNumber(e.graphic),n=f.graphicGeometryToNumber(t.graphic);return i===n?t.zorder-e.zorder:i-n}),g.map(function(e){return e.graphic})},e.prototype.getGraphicsData=function(e,t){var n=p(this._index,e.bounds[0],e.bounds[1],e.bounds[2],e.bounds[3]);if(0===n.length||0===t.length)return[];n.sort(function(e,t){return e.zorder-t.zorder}),n[0].insertAfter=-1;for(var r=1;r<n.length;r++)n[r].insertAfter=n[r-1].graphic.uid;n.sort(function(e,t){return e.graphic.uid-t.graphic.uid}),t.sort(function(e,t){return e.uid-t.uid});for(var o,a=0,s=0,l=[],u={originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]},h=0,c=t;h<c.length;h++){var f=c[h];for(s=-2;a<n.length;)if(o=n[a],a++,f.uid===o.graphic.uid){s=o.insertAfter;break}if(o.geometry&&-2!==s){var v=o.getGeometryQuantized(u),_=i({},o.graphic.attributes);_[this._uidFieldName]=f.uid,l.push({centroid:d.default.getCentroidQuantized(o,u,this.renderer,this._scale),geometry:v,attributes:_,symbol:f.symbol,insertAfter:s})}}return l},e.prototype.getGraphicData=function(e,t){var n=this._itemByGraphic.get(t);if(!n)return null;var r=p(this._index,e.bounds[0],e.bounds[1],e.bounds[2],e.bounds[3]);r.sort(function(e,t){return e.zorder-t.zorder});var o=r.indexOf(n),a=0===o||-1===o?-1:r[o-1].graphic.uid,s={originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]},l=n.getGeometryQuantized(s),u=i({},n.graphic.attributes);return u[this._uidFieldName]=t.uid,{centroid:d.default.getCentroidQuantized(n,s,this.renderer,this._scale),geometry:l,attributes:u,symbol:t.symbol,insertAfter:a}},e.prototype.queryTileData=function(e){var t=50*e.resolution,i=s.pad(e.bounds,t,s.create()),n=p(this._index,i[0],i[1],i[2],i[3]),r=[];return this._createTileGraphics(r,n,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]}),r},e.prototype.has=function(e){return this._itemByGraphic.has(e)},e.prototype.getBounds=function(e){return this._itemByGraphic.has(e)?this._itemByGraphic.get(e).bounds:null},e.prototype.add=function(e,t,i){if(e){var n=d.default.acquire(e,i,t,this.renderer,this._resolution,this._scale,this._tileInfoView.spatialReference);return this._itemByGraphic.set(e,n),i&&this._index.insert(n),n.bounds}},e.prototype.remove=function(e){if(this._itemByGraphic.has(e)){var t=this._itemByGraphic.get(e);this._index.remove(t),this._itemByGraphic.delete(e)}},e.prototype.updateZ=function(){for(var e,t,i=this._graphics.items,n=0;n<i.length;n++)t=i[n],(e=this._itemByGraphic.get(t))&&(e.zorder=n)},e.prototype.update=function(e,t,i){var n=this._itemByGraphic.get(e),r=s.clone(n.bounds);return n.size[0]=n.size[1]=0,this._index.remove(n),n.set(e,i,t,this.renderer,this._resolution,this._scale,this._tileInfoView.spatialReference),i&&this._index.insert(n),{oldBounds:r,newBounds:n.bounds}},e.prototype.updateLevel=function(e){var t=this;if(this._currentLevel!==e){this._currentLevel=e;var i=this._tileInfoView.getTileResolution(e);this._resolution=i,this._scale=this._tileInfoView.getTileScale({level:e,row:0,col:0,world:0}),this._index.clear();var n=this._itemByGraphic.values();m.length=0,c.forEachIter(n,function(e){e.updateBounds(t.renderer,t._resolution,t._scale,t._tileInfoView.spatialReference),e.geometry&&m.push(e)}),this._index.load(m)}},e.prototype.clear=function(){this._itemByGraphic.clear(),this._index.clear()},e.prototype._createTileGraphics=function(e,t,n){var r=this._uidFieldName;t.sort(function(e,t){return e.zorder-t.zorder});for(var o,a,s,l,u=0;u<t.length;u++){o=(s=t[u]).graphic,a=s.getGeometryQuantized(n),l=0===u?-1:t[u-1].graphic.uid;var h=i({},s.graphic.attributes);h[r]=o.uid,e.push({centroid:d.default.getCentroidQuantized(s,n,this.renderer,this._scale),geometry:a,attributes:h,symbol:o.symbol,insertAfter:l})}},e.prototype._getSymbol=function(e){return e.symbol?e.symbol:this.renderer?this.renderer.getSymbol(e,{scale:this._scale}):null},e}();t.default=g}.apply(null,n))||(e.exports=r)},"6+ni":function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equals=function(e,t){return e===this.x&&t===this.y},e.prototype.isEqual=function(e){return e.x===this.x&&e.y===this.y},e.prototype.setCoords=function(e,t){this.x=e,this.y=t},e.prototype.normalize=function(){var e=this.x,t=this.y,i=Math.sqrt(e*e+t*t);this.x/=i,this.y/=i},e.prototype.rightPerpendicular=function(){var e=this.x;this.x=this.y,this.y=-e},e.prototype.move=function(e,t){this.x+=e,this.y+=t},e.prototype.assign=function(e){this.x=e.x,this.y=e.y},e.prototype.assignAdd=function(e,t){this.x=e.x+t.x,this.y=e.y+t.y},e.prototype.assignSub=function(e,t){this.x=e.x-t.x,this.y=e.y-t.y},e.prototype.rotate=function(e,t){var i=this.x,n=this.y;this.x=i*e-n*t,this.y=i*t+n*e},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},e.distance=function(e,t){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},e.add=function(t,i){return new e(t.x+i.x,t.y+i.y)},e.sub=function(t,i){return new e(t.x-i.x,t.y-i.y)},e}();t.Point=i}.apply(null,n))||(e.exports=r)},"66cO":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("j2SP"),i("tI6k"),i("VY6u"),i("3+7H"),i("TQvW"),i("bqoF"),i("QFi0"),i("U+8K"),i("Zp3t"),i("z2+Q")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d){Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){function t(){var t=e.call(this)||this;return t._initialized=!1,t._color=n.vec4f32.fromValues(1,0,0,1),t._maxWidth=0,t}return i(t,e),t.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null),this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null),this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null),this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null),this._canvas=null},t.prototype.draw=function(e,t){var i=e.context;if(t.isReady){this._initialized||this._initialize(i),i.bindVAO(this._outlineVertexArrayObject),i.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",t.dvsMat3),this._outlineProgram.setUniform1f("u_coord_range",r.TILE_SIZE),this._outlineProgram.setUniform1f("u_depth",0),this._outlineProgram.setUniform4fv("u_color",this._color),i.drawArrays(3,0,4),i.bindVAO();var n=this._getTexture(i,t);n&&(i.bindVAO(this._tileInfoVertexArrayObject),i.bindProgram(this._tileInfoProgram),i.bindTexture(n,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",t.dvsMat3),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",1),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",n.descriptor.width,n.descriptor.height),i.drawArrays(5,0,4),i.bindVAO())}},t.prototype._initialize=function(e){if(this._initialized)return!0;var t=h.createProgram(e,s.background),i=h.createProgram(e,l.tileInfo),n={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},r=new Int8Array([0,0,1,0,1,1,0,1]),o=u.createVertex(e,35044,r),a=new d(e,s.background.attributes,n,{geometry:o}),c=new Int8Array([0,0,1,0,0,1,1,1]),f=u.createVertex(e,35044,c),p=new d(e,l.tileInfo.attributes,n,{geometry:f});return this._outlineProgram=t,this._tileInfoProgram=i,this._outlineVertexArrayObject=a,this._tileInfoVertexArrayObject=p,this._initialized=!0},t.prototype._getTexture=function(e,t){if(t.texture)return t.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var i=t.key.id,n=this._canvas.getContext("2d");n.font="24px sans-serif",n.textAlign="left",n.textBaseline="middle";var r=n.measureText(i),a=Math.pow(2,Math.ceil(o.log2(r.width+2)));return a>this._maxWidth&&(this._maxWidth=a),n.clearRect(0,0,this._maxWidth,32),n.fillStyle="blue",n.fillText(i,0,16),t.texture=new c(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas),t.texture},t}(a.default);t.default=f}.apply(null,n))||(e.exports=r)},"6N7s":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("2JMt"),i("F3FF")],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,i,n){return e.call(this,t,i,n)||this}return i(t,e),t.prototype.value=function(t){var i=e.prototype.value.call(this,t);return Math.exp(i)},t.prototype.valueDelta=function(t,i){var n=e.prototype.value.call(this,t),r=e.prototype.value.call(this,t+i)-n;return Math.exp(r)},t}(n.Momentum);t.ZoomMomentum=o;var a=function(e){function t(t,i,n,r){return void 0===t&&(t=2.5),void 0===i&&(i=.01),void 0===n&&(n=.95),void 0===r&&(r=12),e.call(this,t,i,n,r)||this}return i(t,e),t.prototype.add=function(t,i){e.prototype.add.call(this,Math.log(t),i)},t.prototype.createMomentum=function(e,t,i){return new o(e,t,i)},t}(r.MomentumEstimator);t.ZoomMomentumEstimator=a}.apply(null,n))||(e.exports=r)},"6cAc":function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(e,t,i,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=e,this.y=t,this.width=i,this.height=n}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!0,configurable:!0}),e}()}.apply(null,n))||(e.exports=r)},"6kSU":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("qKT0"),i("PND3"),i("BcWh"),i("H1tY"),i("jEml"),i("fUL3"),i("f3JK")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u){Object.defineProperty(t,"__esModule",{value:!0});var h={added:[],removed:[]},c=new r.default,d=new u(0,0,0,0),f=function(e){function t(t){var i=e.call(this)||this;return i._tiles=new Map,i._index=s(9,a("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),i.tiles=[],i.tileScheme=t,i}return i(t,e),t.prototype.destroy=function(){this._tiles.clear()},t.prototype.has=function(e){return this._tiles.has(e)},t.prototype.get=function(e){return this._tiles.get(e)},t.prototype.findByKey=function(e){return this._tiles.get(e.id)},t.prototype.intersections=function(e,t){var i="string"==typeof e?this.get(e):e;if(!i)return[];for(var n=t*i.resolution,r=i.bounds[0]-n,o=i.bounds[1]-n,a=i.bounds[2]+n,s=i.bounds[3]+n,l=[],u=0,h=this._index.search({minX:r,minY:o,maxX:a,maxY:s});u<h.length;u++){var c=h[u],d=c.bounds.slice();d[0]=Math.max(d[0],r),d[1]=Math.max(d[1],o),d[2]=Math.min(d[2],a),d[3]=Math.min(d[3],s),d[2]-d[0]>0&&d[3]-d[1]>0&&l.push({bounds:d,tile:c})}return l},t.prototype.boundsIntersections=function(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})},t.prototype.setViewState=function(e){var t=this.tileScheme.getTileCoverage(e,0);if(t){var i=t.spans,n=t.lodInfo,r=n.level;if(i.length>0)for(var o=0,a=i;o<a.length;o++)for(var s=a[o],u=s.row,f=s.colFrom,p=s.colTo,v=f;v<=p;v++){var _=d.set(r,u,n.normalizeCol(v),n.getWorldForColumn(v)).id;if(c.add(_),!this.has(_)){var m=new l.default(this.tileScheme,_);this._tiles.set(_,m),this._index.insert(m),this.tiles.push(m),h.added.push(m)}}for(var g=this.tiles.length-1;g>=0;g--){m=this.tiles[g];c.has(m.id)||(this._tiles.delete(m.id),this.tiles.splice(g,1),this._index.remove(m),h.removed.push(m))}(h.added.length||h.removed.length)&&this.emit("update",h),c.clear(),h.added.length=0,h.removed.length=0}},t}(o);t.default=f}.apply(null,n))||(e.exports=r)},"7laH":function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext}}.apply(null,n))||(e.exports=r)},"8fgo":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("2Atf"),i("4w2c"),i("tI6k"),i("JNkf"),i("apbF"),i("PDSL"),i("m87x"),i("Zp3t")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h){Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dotTextureSize=0,t._dotTextures=null,t._dotSamplers=new Int32Array([o.TEXTURE_BINDING_RENDERER_0,o.TEXTURE_BINDING_RENDERER_1]),t}return i(t,e),t.prototype.dispose=function(){this._disposeTextures()},t.prototype.getGeometryType=function(){return a.WGLGeometryType.FILL},t.prototype.drawGeometry=function(e,t,i,n){var r,a=e.context,l=e.painter,h=e.rendererInfo,c=e.requiredLevel,d=e.drawPhase,f=i.indexCount,p=i.indexFrom,v=i.materialKey,_=u.FillMaterialKey.load(v),m=(r=_,s.createProgramDescriptor(r.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121,normalized:!0}].concat(r.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121,normalized:!1},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],r.hasVV()?[{location:7,name:"a_vv",count:2,type:5126}]:[],r.dotDensity?[{location:2,name:"a_dd1",count:4,type:5126},{location:3,name:"a_dd2",count:4,type:5126}]:[]),visibility:[{location:8,name:"a_visible",count:1,type:5121}]})),g=l.materialManager.getProgram(_,d,h,"fill",m.attributes);a.bindProgram(g);var y=this._getVAO(a,m.bufferLayouts,m.attributes,n);if(a.bindVAO(y),this._setSharedUniforms(g,e,t),_.textureBinding){l.textureManager.bindTextures(a,g,_);var x=1/Math.pow(2,c-t.key.level)/e.pixelRatio;g.setUniform1f("u_zoomFactor",x)}if(_.vvColor&&(g.setUniform1fv("u_vvColorValues",h.vvColorValues),g.setUniform4fv("u_vvColors",h.vvColors)),_.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",h.vvOpacityValues),g.setUniform1fv("u_vvOpacities",h.vvOpacities)),_.dotDensity){var b=o.TILE_SIZE/h.ddDotSize,T=b*window.devicePixelRatio*b*window.devicePixelRatio,w=1/(x=1/Math.pow(2,c-t.key.level))*(1/x),S=h.ddDotScale?e.state.scale/h.ddDotScale:1;g.setUniform1f("u_tileZoomFactor",x),g.setUniform1f("u_tileDotsOverArea",T/(o.TILE_SIZE*window.devicePixelRatio*o.TILE_SIZE*window.devicePixelRatio)),g.setUniformMatrix4fv("u_dotColors",h.ddColors),g.setUniform4fv("u_dotBackgroundColor",h.ddBackgroundColor),g.setUniform1f("u_dotValue",Math.max(1,h.ddDotValue*S*w)),this._bindDotDensityTextures(a,g,h,b)}a.drawElements(4,f,5125,4*p),a.bindVAO(null)},t.prototype._disposeTextures=function(){if(this._dotTextures){for(var e=0;e<this._dotTextures.length;e++)this._dotTextures[e].dispose();this._dotTextures=null}},t.prototype._bindDotDensityTextures=function(e,t,i,n){var r=this._createDotDensityTextures(e,n,i.ddSeed);t.setUniform1iv("u_dotTextures",this._dotSamplers);for(var o=0;o<r.length;o++)e.bindTexture(r[o],this._dotSamplers[o])},t.prototype._createDotDensityTextures=function(e,t,i){return this._dotTextureSize!==t&&(this._disposeTextures(),this._dotTextureSize=t),null===this._dotTextures&&(this._dotTextures=[this._allocDotDensityTexture(e,t,i),this._allocDotDensityTexture(e,t,i)]),this._dotTextures},t.prototype._allocDotDensityTexture=function(e,t,i){for(var n=new r(i),o=new Float32Array(t*t*4),a=0;a<o.length;a++)o[a]=n.getFloat();return new h(e,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:t,height:t},o)},t}(l.default);t.default=c}.apply(null,n))||(e.exports=r)},"9gM4":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("lRq4"),i("0FS0"),i("Lzvl"),i("u90+"),i("wjMf")],void 0===(r=function(e,t,i,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){this.bounds=i.create(),this.graphic=null,this.size=[0,0,0,0]}return e.acquire=function(t,i,n,r,o,a,s){var l;return void 0===t&&(t=null),0===e._pool.length?l=new e:(l=e._pool.pop(),this._set.delete(l)),l.acquire(t,i,n,r,o,a,s),l},e.release=function(e){e&&!this._set.has(e)&&(e.release(),this._pool.push(e),this._set.add(e))},e.getCentroidQuantized=function(e,t,i,s){if(r.isPolygon(e.geometry)){var l=e.graphic.symbol;if(!l&&i&&(l=i.getSymbol(e.graphic,{scale:s})),!l)return null;if(a.isMarkerSymbol(l.type)){var u=n.polygonCentroid(e.geometry);return o.quantizePoint(t,{},{x:u[0],y:u[1]},!1,!1)}}return null},e.prototype.acquire=function(e,t,i,n,r,o,a){void 0===e&&(e=null),e&&this.set(e,t,i,n,r,o,a)},e.prototype.release=function(){this.graphic=null,this.geometry=null},e.prototype.set=function(e,t,i,n,r,o,s){this.graphic=e,this.geometry=t,a.getBounds(this.bounds,this.size,e,t,i,n,r,o,s)},e.prototype.updateBounds=function(e,t,i,n){a.getBounds(this.bounds,this.size,this.graphic,this.geometry,null,e,t,i,n)},e.prototype.getGeometryQuantized=function(e){if(r.isPolygon(this.geometry)){var t=this.geometry.rings;if(1===t.length&&2===t[0].length)return o.quantizeGeometry(e,{paths:[[t[0][0],t[0][1]]]})}return o.quantizeGeometry(e,this.geometry)},e._pool=[],e._set=new Set,e}();t.default=s}.apply(null,n))||(e.exports=r)},"AP+j":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("aMdW"),i("Zx0K"),i("YX1r"),i("lgZd"),i("W9tT"),i("ab6c"),i("Brhx"),i("tI6k"),i("SkDs"),i("Sq9p"),i("JNkf"),i("qe2g"),i("Dos2"),i("apbF"),i("xxo4"),i("Dikz"),i("f3JK")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d,f,p,v,_,m,g,y){function x(e,t){return e.sortKey-t.sortKey}var b=new Set;return function(e){function t(t,i,n){void 0===n&&(n=!1);var o=e.call(this)||this;return o._data=null,o.hlDisplayList=null,o._displayList=null,o._wglBuffers=null,o._dirtyMap=new c.default,o.coords=[0,0],o.bounds=[0,0,0,0],o.dvsMat3=a.mat3f32.create(),o.tileMat3=a.mat3f32.create(),o.labelMat2d=r.mat2df32.create(),o._labelIndex=null,o._dirty=!0,o.fader=new p.default,o.key=y.pool.acquire(t),o.coords[0]=i[0],o.coords[1]=i[3],o.bounds=i,o._ensureCorrectZOrder=n,o}return i(t,e),Object.defineProperty(t.prototype,"displayObjects",{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._dirty},set:function(e){(this._dirty=e)||this.isReady||this.ready(),this.requestRender()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0}),t.prototype.getGeometry=function(e){return this._wglBuffers&&this._wglBuffers.has(e)?this._wglBuffers.get(e):null},t.prototype.getDisplayList=function(e){switch(e){case f.WGLDrawPhase.HIGHLIGHT:return this.hlDisplayList;default:return this._data&&this._displayList}},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.setData=function(e,t,i){var n=e.addOrUpdate,r=e.remove;if(this.fader.reset(),(e.clear||!this.hasData)&&!e.addOrUpdate)return this.clear(),void this.ready();!e.clear&&this.hasData||!e.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:n,remove:r},t,i):(n.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new c.default,this._dispRecStore=d.default.fromTileData(n,this._dirtyMap),this._data=n,this._readyTileIfNoLabels(t,i),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=n.tileDisplayData.displayList.clone()))},t.prototype.commitChanges=function(e){this.isDirty&&this._wglBuffers||(this._wglBuffers||(this._wglBuffers=new m.default(this.stage.context)),this._displayList=this._data.tileDisplayData.displayList.clone(),this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._dirtyMap.markAllClean())},t.prototype.resetVisibility=function(e){var t=this,i=new Array(0),n=new Array(1);e.forEach(function(e){n[0]=e,t.setFilterFlag(0,i,n)})},t.prototype.setFilterFlag=function(e,t,i){if(this.hasData){for(var n=1<<e,r=this._data.tileBufferData.geometries.map(_.geometryToMappedGeometry),o=0,a=t;o<a.length;o++){var s=a[o];if(v=this._data.tileDisplayData.displayObjectRegistry.get(s)){v.setFilterFlag(e,!0);for(var l=0,u=v.displayRecords;l<u.length;l++)if(b=(S=r[(x=u[l]).geometryType]).geometry.vertexBuffer[_.C_VBO_VISIBILITY]){S.vertexFrom=null==S.vertexFrom?x.vertexFrom:Math.min(S.vertexFrom,x.vertexFrom),S.vertexTo=null==S.vertexTo?x.vertexFrom+x.vertexCount:Math.max(S.vertexTo,x.vertexFrom+x.vertexCount);for(var h=x.vertexFrom,c=x.vertexCount,d=0;d<c;++d)b.data[h+d]|=n}}}for(var f=0,p=i;f<p.length;f++){var v,m=p[f];if(v=this._data.tileDisplayData.displayObjectRegistry.get(m)){v.setFilterFlag(e,!1);for(var g=0,y=v.displayRecords;g<y.length;g++){var x,b;if(b=(S=r[(x=y[g]).geometryType]).geometry.vertexBuffer[_.C_VBO_VISIBILITY])for(S.vertexFrom=null==S.vertexFrom?x.vertexFrom:Math.min(S.vertexFrom,x.vertexFrom),S.vertexTo=null==S.vertexTo?x.vertexFrom+x.vertexCount:Math.max(S.vertexTo,x.vertexFrom+x.vertexCount),h=x.vertexFrom,c=x.vertexCount,d=0;d<c;++d)b.data[h+d]&=~n}}}for(var T=!1,w=0;w<r.length;++w){var S;if(null!=(S=r[w]).vertexFrom&&null!=S.vertexTo){var M=S.vertexTo?S.vertexTo-S.vertexFrom:0;this._dirtyMap.markDirtyVertices(w,_.C_VBO_VISIBILITY,S.vertexFrom,M),T=!0}}T&&this.requestRender()}},t.prototype.setVisibilityRange=function(e,t,i,n){for(var r=this._data.tileDisplayData.displayObjectRegistry.get(e),o=this._data.tileBufferData.geometries[f.WGLGeometryType.LABEL].vertexBuffer[_.C_VBO_VISIBILITY_RANGE],a=1/0,s=0,l=t;l<t+i;++l){for(var u=r.displayRecords[l],h=Math.max(u.minZoom,n),c=u.maxZoom,d=v.i8888to32(h,c,h,c),p=u.vertexFrom*o.stride/4,m=u.vertexCount*o.stride/4,g=p;g<p+m;++g)o.data[g]=d;a=Math.min(a,u.vertexFrom),s=Math.max(s,u.vertexFrom+u.vertexCount)}var y=s-a;this._dirtyMap.markDirtyVertices(f.WGLGeometryType.LABEL,_.C_VBO_VISIBILITY_RANGE,a,y)},t.prototype.setTransform=function(e,t){var i=this.tileMat3,n=e.toScreenNoRotation([0,0],this.coords),r=n[0],a=n[1],s=t;o.mat3.set(this.tileMat3,s,0,0,0,s,0,r,a,1),o.mat3.multiply(this.dvsMat3,e.displayViewMat3,i)},t.prototype.setLabelTransform=function(e,t){var i=this.labelMat2d,r=e.getScreenTransform(i,t),o=l.vec2f32.create();s.vec2.transformMat2d(o,this.coords,r),n.mat2d.identity(i),n.mat2d.translate(i,i,o),n.mat2d.multiply(i,e.viewMat2d,i)},t.prototype.clear=function(){this._data=null,this._displayList=null,this._dispRecStore=null,this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null),this.hlDisplayList&&(this.hlDisplayList=null)},t.prototype.attach=function(){return!0},t.prototype.dispose=function(){this.clear()},t.prototype.doRender=function(e){if(this.isReady&&this.hasData){if(this.commitChanges(e),this.stage.context.setStencilFunction(514,this.stencilRef,255),e.drawPhase===f.WGLDrawPhase.MAP||e.drawPhase===f.WGLDrawPhase.LABEL||e.drawPhase===f.WGLDrawPhase.LABEL_ALPHA)this._displayList.replay(e,this);else for(var t=0,i=this.stage.painter.getBrushes(e.drawPhase);t<i.length;t++)i[t].draw(e,this);this.fader.step()||this.requestRender()}},t.prototype.buildHLList=function(e){var t=this;this.hlDisplayList=new g,e.forEach(function(e){t._addToHLDisplayList(t.hlDisplayList,e)})},t.prototype._addToHLDisplayList=function(e,t){if(this._data){var i=this._data.tileDisplayData.displayObjectRegistry.get(t);if(i){for(var n=[],r=0,o=i.displayRecords;r<o.length;r++){var a=o[r].copy();a.meshData=null,a.symbolLevel=0,a.zOrder=0,n.push(a)}n.sort(x),e.addToList(n)}}},t.prototype._readyTileIfNoLabels=function(e,t){this.isDirty=!(!e||!t||(this._rebuildLabelIndex(),0))},t.prototype._doPatchData=function(e,t,i){this._patchData(e)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=d.default.fromTileData(this._data,this._dirtyMap)),this._readyTileIfNoLabels(t,i),this.requestRender()},t.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var e=0,t=this.displayObjects;e<t.length;e++)for(var i=0,n=t[e].metrics;i<n.length;i++){var r=n[i];this._insertIntoLabelIndex(r)}},t.prototype._insertIntoLabelIndex=function(e){-1!==e.xBucket&&this.labelIndex[e.yBucket][e.xBucket].push(e)},t.prototype._initLabelIndex=function(){for(var e=[],t=0;t<h.TILE_SIZE/h.COLLISION_BUCKET_SIZE;t++){e.push([]);for(var i=0;i<h.TILE_SIZE/h.COLLISION_BUCKET_SIZE;i++)e[t].push([])}return e},t.prototype._patchData=function(e){for(var t=!0,i=e.addOrUpdate&&e.addOrUpdate.tileDisplayData&&e.addOrUpdate.tileDisplayData.displayObjects||[],n=(e.remove||[]).slice(),r=0,o=i;r<o.length;r++)null!=(_=o[r]).insertAfter&&n.push(_.id);for(var a=0,s=n;a<s.length;a++){var l=s[a];if(v=this._data.tileDisplayData.displayObjectRegistry.get(l)){this._data.tileDisplayData.displayList.removeFromList(v.displayRecords);for(var u=0,h=v.displayRecords;u<h.length;u++){var c=h[u];this._dispRecStore.delete(c)}this._data.tileDisplayData.displayObjectRegistry.delete(l);var d=this._data.tileDisplayData.displayObjects.indexOf(v);this._data.tileDisplayData.displayObjects.splice(d,1)}}for(var f=0,p=i;f<p.length;f++){var v,_=p[f],m=void 0;if(v=this._data.tileDisplayData.displayObjectRegistry.get(_.id)){var g=v.displayRecords;v.set(_),v.displayRecords=g;for(var y=v.displayRecords.length,x=0;x<y;++x){var T=v.displayRecords[x],w=_.displayRecords[x];(x>=_.displayRecords.length||T.geometryType!==w.geometryType||T.symbolLevel!==w.symbolLevel||T.zOrder!==w.zOrder||T.materialKey!==w.materialKey)&&(this._dispRecStore.delete(v.displayRecords[x]),x<_.displayRecords.length&&(v.displayRecords[x]=void 0))}v.displayRecords.length=_.displayRecords.length,v.metrics=_.metrics}else{(v=_.copy()).displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(_.id,v);var S=void 0,M=this._data.tileDisplayData.displayObjects;if(null!=v.insertAfter)if(m={},0<=v.insertAfter){var E=this._data.tileDisplayData.displayObjectRegistry.get(v.insertAfter);E&&(S=M.indexOf(E)+1)<M.length?M.splice(S,0,v):(M.push(v),S=M.length)}else M.unshift(v),S=0;else M.push(v),S=M.length;if(m){var C=void 0;if(this._data.tileDisplayData.displayList.unified)C=0<_.displayRecords.length?1:0;else{b.clear();for(var I=0,F=_.displayRecords;I<F.length;I++){var A=F[I],O=this._data.tileDisplayData.displayList.getDPInfoType(A.geometryType);b.add(O)}C=b.size}var P=0;for(x=S-1;0<=x&&P<C;--x)for(var R=M[x].displayRecords.length-1;0<=R&&P<C;--R){var D=M[x].displayRecords[R];m[O=this._data.tileDisplayData.displayList.getDPInfoType(D.geometryType)]||(m[O]=D,++P)}}}var L=_.displayRecords.length;for(x=0;x<L;++x){w=_.displayRecords[x],(T=v.displayRecords[x])?(T.meshData=w.meshData,T.materialKey=w.materialKey):((T=w.copy()).vertexFrom=void 0,T.indexFrom=void 0,v.displayRecords[x]=T);var B=w.geometryType,V=(O=this._data.tileDisplayData.displayList.getDPInfoType(B),e.addOrUpdate.tileBufferData.geometries[B]),z=V.vertexBuffer,G=V.indexBuffer,N=void 0;m&&(N=m[O]?this._data.tileDisplayData.displayList.splitAfter(m[O]):-1),t=this._dispRecStore.setMeshData(T,w,z,G,N)&&t,m&&null!=T.indexFrom&&null!=T.indexFrom&&(m[O]=T)}}return t},t}(u.DisplayObject)}.apply(null,n))||(e.exports=r)},AwqN:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._byGeometryType=null}return Object.defineProperty(e.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._byGeometryType=null},e.prototype.verticesFor=function(e){return this._byGeometryType?this._byGeometryType[e].vertices:0},e.prototype.indicesFor=function(e){return this._byGeometryType?this._byGeometryType[e].indices:0},e.prototype.needMore=function(e,t,i){if(t||i){this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]);var n=this._byGeometryType[e];n.vertices+=t,n.indices+=i}},e}();t.default=i}.apply(null,n))||(e.exports=r)},BEeJ:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){function i(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var n=1/Math.LN2;t.positiveMod=i,t.radToByte=function(e){return i(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return i(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*n},t.sqr=function(e){return e*e},t.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},t.interpolate=function(e,t,i){return e*(1-i)+t*i},t.between=function(e,t,i){return e>=t&&e<=i||e>=i&&e<=t}}.apply(null,n))||(e.exports=r)},Bbit:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forEachIter=function(e,t){for(;;){var i=e.next(),n=i.value;if(i.done)return;t(n)}}}.apply(null,n))||(e.exports=r)},Brhx:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("BcWh")],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderRequestedCalled=!1,t._attached=!1,t._isReady=!1,t._opacity=1,t.renderRequested=!1,t._visible=!0,t}return i(t,e),Object.defineProperty(t.prototype,"attached",{get:function(){return this._attached},set:function(e){this._attached!==e&&(this._attached=e,e?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity!==e&&(this._opacity=e,this.requestRender())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this.requestRender())},enumerable:!0,configurable:!0}),t.prototype.attach=function(){return this.ready(),!0},t.prototype.detach=function(){},t.prototype.processRender=function(e){this.visible&&this.attached&&(this._renderRequestedCalled=!1,this.doRender(e),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))},t.prototype.requestRender=function(){var e=this.renderRequested;this._renderRequestedCalled=!0,this.renderRequested=!0,this.parent&&this.parent.requestChildRender(this),e!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")},t.prototype.dispose=function(){},t.prototype.ready=function(){this._isReady=!0,this.emit("isReady")},t}(n);t.DisplayObject=r}.apply(null,n))||(e.exports=r)},CIy2:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("FXVB"),i("W9tT"),i("DIqE"),i("Rdxj"),i("2fXB"),i("O7NG"),i("AzkI")],void 0===(r=function(e,t,i,n,r,o,a,s,l){function u(e,t){if(!e)throw new Error(t||"assert").stack,new v(t)}function h(e){for(var t in e)return t}function c(e,t){e[12]=t[0],e[13]=t[1],e[14]=t[2]}function d(e,t){void 0===t&&(t=0);for(var i=0,n=0;n<4;n++)i+=e[t+n]*m[n];return i}function f(e){return e-Math.floor(e)}Object.defineProperty(t,"__esModule",{value:!0});var p=s.vec4f64.create(),v=function(){function e(e){this.message=e}return e.prototype.toString=function(){return"AssertException: "+this.message},e}();t.AssertException=v,t.VertexAttrConstants={POSITION:"position",NORMAL:"normal",NORMALCOMPRESSED:"normalCompressed",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",REGION:"region",COMPONENTINDEX:"componentIndex",TANGENT:"aTangent"},t.assert=u,t.verify=function(e,t){e||(t=t||"")},t.encodeInt16=function(e){return l.clamp(Math.round(32767*e),-32767,32767)},t.encodeNormal=function(e,t){var i=Math.abs(e[0]),n=Math.abs(e[1]),r=1/(i+n+Math.abs(e[2])),o=i*r,a=n*r,s=Math.min(e[2]*r,0);t[0]=(e[0]<0?-1:1)*(o-s),t[1]=(e[1]<0?-1:1)*(a-s)},t.fallbackIfUndefined=function(e,t){return void 0===e?t:e},t.hex2rgb=function(e){return[((e=Math.floor(e))>>16&255)/255,(e>>8&255)/255,(255&e)/255]},t.rgb2hex=function(e){return"0x"+((l.clamp(Math.round(255*e[0]),0,255)<<16)+(l.clamp(Math.round(255*e[1]),0,255)<<8)+l.clamp(Math.round(255*e[2]),0,255)).toString(16)},t.dec2hex=function(e){var t=e.toString(16);return"00000000".substr(0,8-t.length)+t},t.rayTriangle3D=function(e,t,i,n,r,a,s,l,u){void 0===u&&(u=o.vec3f64.create());var h=n[s]-i[a],c=n[s+1]-i[a+1],d=n[s+2]-i[a+2],f=r[l]-i[a],p=r[l+1]-i[a+1],v=r[l+2]-i[a+2],_=t[1]*v-p*t[2],m=t[2]*f-v*t[0],g=t[0]*p-f*t[1],y=h*_+c*m+d*g;if(y>-1e-5&&y<1e-5)return!1;var x=1/y,b=e[0]-i[a],T=e[1]-i[a+1],w=e[2]-i[a+2];if(u[1]=x*(b*_+T*m+w*g),u[1]<0||u[1]>1)return!1;var S=T*d-c*w,M=w*h-d*b,E=b*c-h*T;return u[2]=x*(t[0]*S+t[1]*M+t[2]*E),!(u[2]<0||u[1]+u[2]>1||(u[0]=x*(f*S+p*M+v*E),0))},t.rayBoxTest=function(e,t,i,n){var r,o=(i[0]-e[0])/t[0],a=(n[0]-e[0])/t[0];o>a&&(r=o,o=a,a=r);var s=(i[1]-e[1])/t[1],l=(n[1]-e[1])/t[1];if(s>l&&(r=s,s=l,l=r),o>l||s>a)return!1;s>o&&(o=s),l<a&&(a=l);var u=(i[2]-e[2])/t[2],h=(n[2]-e[2])/t[2];return u>h&&(r=u,u=h,h=r),!(o>h||u>a||(h<a&&(a=h),a<0))},t.rayRay2D=function(e,t,i,n,o,a){void 0===a&&(a=r.vec2f64.create());var s=(n[o]-i[o])*(t[0]-e[0])-(n[0]-i[0])*(t[o]-e[o]),l=(n[0]-i[0])*(e[o]-i[o])-(n[o]-i[o])*(e[0]-i[0]);if(0===s)return!1;var u=l/s;return a[0]=e[0]+u*(t[0]-e[0]),a[1]=e[o]+u*(t[o]-e[o]),!0},t.project=function(e,t,i,n,r){r||(r=e),p[0]=e[0],p[1]=e[1],p[2]=e[2],p[3]=1,a.vec4.transformMat4(p,p,t),r.length>2&&(r[2]=-p[2]),a.vec4.transformMat4(p,p,i),u(0!==p[3]),r[0]=p[0]/p[3],r[1]=p[1]/p[3],r[2]=p[2]/p[3],r[0]=(.5*r[0]+.5)*n[2]+n[0],r[1]=(.5*r[1]+.5)*n[3]+n[1]},t.getFirstObjectKey=h,t.getFirstObjectValue=function(e){return e[h(e)]},t.objectEmpty=function(e){for(var t in e)return!1;return!0},t.logWithBase=function(e,t){return Math.log(e)/Math.log(t)},t.setMatrixTranslation=c,t.setMatrixTranslation3=function(e,t,i,n){e[12]=t,e[13]=i,e[14]=n},t.getMatrixTranslation=function(e,t){return void 0===t&&(t=o.vec3f64.create()),t[0]=e[12],t[1]=e[13],t[2]=e[14],t},t.createTranslationMatrix=function(e,t){return c(e=i.mat4.identity(e),t),e},t.isTranslationMatrix=function(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]},t.fovx2fovy=function(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/t)},t.fovy2fovx=function(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/i)},t.fovx2fovd=function(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/t)},t.fovy2fovd=function(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/i)},t.fovd2fovx=function(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+i*i))},t.fovd2fovy=function(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/Math.sqrt(t*t+i*i))},t.packFloatRGBA=function(e,t,i){void 0===i&&(i=0);for(var n=l.clamp(e,0,g),r=0;r<4;r++)t[i+r]=Math.floor(256*f(n*_[r]))},t.unpackFloatRGBA=d;var _=[1,256,65536,16777216],m=[1/256,1/65536,1/16777216,1/4294967296],g=d(new Uint8ClampedArray([255,255,255,255]));t.inverseProjectionInfo=function(e,t,i,r,o){var a=e;0===e[11]?(r[0]=2/(t*a[0]),r[1]=2/(i*a[5]),r[2]=(1+a[12])/a[0],r[3]=(1+a[13])/a[5],n.vec2.set(o,0,1)):(r[0]=-2/(t*a[0]),r[1]=-2/(i*a[5]),r[2]=(1-a[8])/a[0],r[3]=(1-a[9])/a[5],n.vec2.set(o,1,0))}}.apply(null,n))||(e.exports=r)},CIzB:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},t.clone=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},t.fromValues=function(e,t,i,n,r,o,a,s,l,u,h,c,d,f,p,v){return[e,t,i,n,r,o,a,s,l,u,h,c,d,f,p,v]},t.createView=function(e,t){return new Float64Array(e,t,16)}}.apply(null,n))||(e.exports=r)},DAnI:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("LN/d"),i("kUhT"),i("0i+W"),i("PDtg"),i("viuU")],void 0===(r=function(e,t,i,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=i.Stage,t.LabelManager=n.default,t.GraphicsView2D=r.default,t.MapViewNavigation=o.default,t.MagnifierView2D=a.default}.apply(null,n))||(e.exports=r)},Dikz:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("Q2wQ"),i("qsST"),i("JNkf")],void 0===(r=function(e,t,i,n,r){var o=n.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");function a(e,t,i){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];t<e.length?e.splice.apply(e,[t,i].concat(n)):e.push.apply(e,n)}var s=new Map;s.set(r.WGLDrawPhase.MAP,[r.WGLGeometryType.FILL,r.WGLGeometryType.LINE,r.WGLGeometryType.MARKER,r.WGLGeometryType.TEXT]),s.set(r.WGLDrawPhase.LABEL,[r.WGLGeometryType.LABEL]),s.set(r.WGLDrawPhase.LABEL_ALPHA,[r.WGLGeometryType.LABEL]);var l=function(){function e(e){void 0===e&&(e=!1),this.symbolLevels=[],this.unified=e}return e.prototype.replay=function(e,t){if(this.unified)for(var i=0,n=this.symbolLevels;i<n.length;i++)for(var r=0,o=n[i].zLevels;r<o.length;r++){var a=o[r].geometryDPInfo;for(var l in a)if(a[l])for(var u=0,h=a[l];u<h.length;u++){var c=h[u],d=e.painter.getGeometryBrush(c.geometryType),f=t.getGeometry(c.geometryType);d.drawGeometry(e,t,c,f)}}else for(var p=function(i){var n=e.painter.getGeometryBrush(i),r=t.getGeometry(i);v.byType(i,function(i){n.drawGeometry(e,t,i,r)})},v=this,_=0,m=s.get(e.drawPhase);_<m.length;_++)p(m[_])},Object.defineProperty(e.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.symbolLevels.length=0},e.prototype.addToList=function(e,t){if(Array.isArray(e))for(var i=0,n=e;i<n.length;i++){var r=n[i];this._addToList(r,t)}else this._addToList(e,t)},e.prototype.removeFromList=function(e){Array.isArray(e)||(e=[e]);for(var t=null,i=0,n=e;i<n.length;i++){var r=n[i];t=this._removeFromList(r)}return t},e.prototype.byType=function(e,t){for(var i=0,n=this.symbolLevels;i<n.length;i++)for(var r=0,o=n[i].zLevels;r<o.length;r++){var a=o[r].geometryDPInfo,s=this.getDPInfoType(e);if(a[s])for(var l=0,u=a[s];l<u.length;l++)t(u[l])}},e.prototype.clone=function(){for(var t=new e(this.unified),i=0,n=this.symbolLevels;i<n.length;i++){var r=n[i];t.symbolLevels.push(r.clone())}return t},e.prototype.splitAfter=function(e){for(var t=this._getDisplayList(e.symbolLevel,e.zOrder,e.geometryType),i=t.length,n=e.indexFrom+e.indexCount,r=0;r<i;++r){var o=t[r];if(o.geometryType===e.geometryType&&n>o.indexFrom&&n<=o.indexFrom+o.indexCount){if(n<o.indexFrom+o.indexCount){var a=new u;a.geometryType=o.geometryType,a.materialKey=o.materialKey,a.indexFrom=n,a.indexCount=o.indexFrom+o.indexCount-n,t.splice(r+1,0,a),o.indexCount=n-o.indexFrom}return r}}},e.prototype._addToList=function(e,t){var i=e.symbolLevel,n=e.zOrder,r=this._getDisplayList(i,n,e.geometryType),o=null!=t?t:r.length-1,s=0<=o&&o<r.length?r[o]:null;if(null===s||s.materialKey!==e.materialKey||s.indexFrom+s.indexCount!==e.indexFrom||this.unified&&s.geometryType!==e.geometryType){var l=new u;l.indexFrom=e.indexFrom,l.indexCount=e.indexCount,l.materialKey=e.materialKey,l.geometryType=e.geometryType,a(r,o+1,0,l)}else s.indexCount+=e.indexCount},e.prototype._removeFromList=function(e){for(var t=e.symbolLevel,i=e.zOrder,n=this._getDisplayList(t,i,e.geometryType),r=n.length,o=void 0,s=0;s<r;++s){var l=n[s];if(e.indexFrom+e.indexCount>l.indexFrom&&e.indexFrom<l.indexFrom+l.indexCount&&(!this.unified||l.geometryType===e.geometryType)){o=s;break}}if(void 0===o)return null;if(l=n[o],e.indexFrom===l.indexFrom)return l.indexCount-=e.indexCount,l.indexFrom+=e.indexCount,0===l.indexCount&&a(n,o,1),o-1;if(e.indexFrom+e.indexCount===l.indexFrom+l.indexCount)return l.indexCount-=e.indexCount,0===l.indexCount?(a(n,o,1),o-1):o;var h=l.indexFrom,c=e.indexFrom-l.indexFrom,d=e.indexCount,f=l.indexFrom+l.indexCount-(e.indexFrom+e.indexCount);l.indexCount=c;var p=new u;return p.geometryType=l.geometryType,p.materialKey=l.materialKey,p.indexFrom=h+c+d,p.indexCount=f,a(n,o+1,0,p),o},e.prototype._getDisplayList=function(e,t,i){for(var n,o,a=this.symbolLevels.length,s=0;s<a;s++)if(this.symbolLevels[s].symbolLevel===e){n=this.symbolLevels[s];break}n||((n=new d).symbolLevel=e,this.symbolLevels.push(n));for(var l,u=n.zLevels.length,f=0;f<u;f++)if(n.zLevels[f].zLevel===t){o=n.zLevels[f];break}if(o||((o=new c).geometryDPInfo=new h,o.zLevel=t,n.zLevels.push(o)),this.unified)o.geometryDPInfo.unified||(o.geometryDPInfo.unified=[]),l=o.geometryDPInfo.unified;else switch(i){case r.WGLGeometryType.FILL:o.geometryDPInfo.fill||(o.geometryDPInfo.fill=[]),l=o.geometryDPInfo.fill;break;case r.WGLGeometryType.LINE:o.geometryDPInfo.line||(o.geometryDPInfo.line=[]),l=o.geometryDPInfo.line;break;case r.WGLGeometryType.MARKER:o.geometryDPInfo.marker||(o.geometryDPInfo.marker=[]),l=o.geometryDPInfo.marker;break;case r.WGLGeometryType.TEXT:o.geometryDPInfo.text||(o.geometryDPInfo.text=[]),l=o.geometryDPInfo.text;break;case r.WGLGeometryType.LABEL:o.geometryDPInfo.label||(o.geometryDPInfo.label=[]),l=o.geometryDPInfo.label}return l},e.prototype.getDPInfoType=function(e){if(this.unified)return"unified";switch(e){case r.WGLGeometryType.FILL:return"fill";case r.WGLGeometryType.LINE:return"line";case r.WGLGeometryType.MARKER:return"marker";case r.WGLGeometryType.TEXT:return"text";case r.WGLGeometryType.LABEL:return"label";default:o.error("DisplayList: Tried to convert unknown geometryType: "+e)}},e}(),u=function(){function e(){this.materialKey=null,this.indexFrom=0,this.indexCount=0}return e.prototype.clone=function(){var t=new e;return t.geometryType=this.geometryType,t.materialKey=this.materialKey,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t},e}(),h=function(){function e(){this.fill=null,this.line=null,this.marker=null,this.text=null,this.label=null,this.unified=null}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill&&this.fill.map(function(e){return e.clone()}),t.line=this.line&&this.line.map(function(e){return e.clone()}),t.marker=this.marker&&this.marker.map(function(e){return e.clone()}),t.text=this.text&&this.text.map(function(e){return e.clone()}),t.label=this.label&&this.label.map(function(e){return e.clone()}),t.unified=this.unified&&this.unified.map(function(e){return e.clone()}),t},e}(),c=function(){function e(){this.geometryDPInfo=new h}return e.prototype.clone=function(){var t=new e;return t.zLevel=this.zLevel,t.geometryDPInfo=this.geometryDPInfo.clone(),t},e}(),d=function(){function e(){this.zLevels=[]}return e.prototype.clone=function(){var t=new e;t.symbolLevel=this.symbolLevel;for(var i=0,n=this.zLevels;i<n.length;i++){var r=n[i];t.zLevels.push(r.clone())}return t},e}();return l}.apply(null,n))||(e.exports=r)},DlJW:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("7laH")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.load=function(e){if(i.default(e))return{drawArraysInstanced:e.drawArraysInstanced.bind(e),drawElementsInstanced:e.drawElementsInstanced.bind(e),vertexAttribDivisor:e.vertexAttribDivisor.bind(e)};var t=e.getExtension("ANGLE_instanced_arrays");return t?{drawArraysInstanced:t.drawArraysInstancedANGLE.bind(t),drawElementsInstanced:t.drawElementsInstancedANGLE.bind(t),vertexAttribDivisor:t.vertexAttribDivisorANGLE.bind(t)}:null}}.apply(null,n))||(e.exports=r)},E9c0:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.gain=e}return e.prototype.update=function(e){if(this.hasLastValue){var t=this.computeDelta(e);this.updateDelta(t)}this.lastValue=e},e.prototype.reset=function(){this.lastValue=void 0,this.filteredDelta=void 0},Object.defineProperty(e.prototype,"hasLastValue",{get:function(){return void 0!==this.lastValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasFilteredDelta",{get:function(){return void 0!==this.filteredDelta},enumerable:!0,configurable:!0}),e.prototype.computeDelta=function(e){return e-this.lastValue},e.prototype.updateDelta=function(e){this.hasFilteredDelta?this.filteredDelta=(1-this.gain)*this.filteredDelta+this.gain*e:this.filteredDelta=e},e}();t.FilteredFiniteDifference=i}.apply(null,n))||(e.exports=r)},"Ed/z":function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._pos=0,this._buffer=e,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer)}return e.prototype.readInt32=function(){return this._i32View[this._pos++]},e.prototype.readF32=function(){return this._f32View[this._pos++]},e}();t.default=i}.apply(null,n))||(e.exports=r)},F3FF:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("AzkI"),i("E9c0"),i("2JMt")],void 0===(r=function(e,t,i,n,r,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t,i,n){void 0===e&&(e=2.5),void 0===t&&(t=.01),void 0===i&&(i=.95),void 0===n&&(n=12),this.minimumInitialVelocity=e,this.stopVelocity=t,this.friction=i,this.maxVelocity=n,this.value=new r.FilteredFiniteDifference(.8),this.time=new r.FilteredFiniteDifference(.3)}return e.prototype.add=function(e,t){if(this.time.hasLastValue){if(this.time.computeDelta(t)<.01)return;if(this.value.hasFilteredDelta){var i=this.value.computeDelta(e);this.value.filteredDelta*i<0&&this.value.reset()}}this.time.update(t),this.value.update(e)},e.prototype.reset=function(){this.value.reset(),this.time.reset()},e.prototype.evaluateMomentum=function(){if(!this.value.hasFilteredDelta)return null;var e=this.value.filteredDelta/this.time.filteredDelta;return e=n.clamp(e,-this.maxVelocity,this.maxVelocity),Math.abs(e)<this.minimumInitialVelocity?null:this.createMomentum(e,this.stopVelocity,this.friction)},e.prototype.createMomentum=function(e,t,i){return new o.Momentum(e,t,i)},e}();t.MomentumEstimator=a}.apply(null,n))||(e.exports=r)},FXVB:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("Jl7l")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.mat4=i}.apply(null,n))||(e.exports=r)},"G+IK":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("qKT0"),i("TMur"),i("Ebn8"),i("Gtr7"),i("jBNx"),i("Vx27"),i("0LE5"),i("Rdxj"),i("xI7m"),i("kLlh")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d){return function(e){function t(t){var i=e.call(this)||this;return i.animationTime=0,i.momentumEstimator=new d.PanPlanarMomentumEstimator(500,6,.92),i.momentum=null,i.tmpMomentum=h.vec3f64.create(),i.momentumFinished=!1,i.viewpoint=new o({targetGeometry:new r.Point,scale:0,rotation:0}),i.watch("momentumFinished",function(e){e&&i.navigation.stop()}),i}return i(t,e),t.prototype.begin=function(e,t){this.navigation.begin(),this.momentumEstimator.reset(),this.addToEstimator(t),this.previousDrag=t},t.prototype.update=function(e,t){this.addToEstimator(t);var i=t.center.x,n=t.center.y,r=this.previousDrag;i=r?r.center.x-i:-i,n=r?n-r.center.y:n,e.viewpoint=c.translateBy(this.viewpoint,e.viewpoint,[i||0,n||0]),this.previousDrag=t},t.prototype.end=function(e,t){this.addToEstimator(t),this.momentum=this.momentumEstimator.evaluateMomentum(),this.animationTime=0,this.momentum&&this.onAnimationUpdate(e),this.previousDrag=null,this.navigation.end()},t.prototype.addToEstimator=function(e){var t=e.center.x,i=e.center.y,n=s.createScreenPointArray(-t,i),r=h.vec3f64.fromValues(-t,i,0);this.momentumEstimator.add(n,r,.001*e.timestamp)},t.prototype.onAnimationUpdate=function(e){var t=this;this.navigation.animationManager.animateContinous(e.viewpoint,function(i,n){t.momentumFinished=!t.momentum||t.momentum.isFinished(t.animationTime);var r=.001*n;if(!t.momentumFinished){var o=t.momentum.valueDelta(t.animationTime,r);u.vec3.scale(t.tmpMomentum,t.momentum.direction,o),e.viewpoint=c.translateBy(i,i,t.tmpMomentum)}t.animationTime+=r})},t.prototype.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())},n([l.property()],t.prototype,"momentumFinished",void 0),n([l.property()],t.prototype,"viewpoint",void 0),n([l.property()],t.prototype,"navigation",void 0),n([l.subclass("esri.views.2d.navigation.actions.Pan")],t)}(l.declared(a))}.apply(null,n))||(e.exports=r)},GDRe:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("tI6k"),i("6+ni"),i("VY6u")],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,i){this.ratio=e,this.x=t,this.y=i},a=function(){function e(e,t,n,r,o){void 0===r&&(r=8),void 0===o&&(o=8),this.lines=[],this.starts=[],this.pixelRatio=r,this.pixelMargin=o,this.tileSize=i.TILE_SIZE*r,this.dz=e,this.yPos=t,this.xPos=n}return e.prototype.setExtent=function(e){this.finalRatio=this.tileSize/e*(1<<this.dz);var t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;var i=e>>this.dz;i<t&&(t=i),this.margin=t,this.xmin=i*this.xPos-t,this.ymin=i*this.yPos-t,this.xmax=this.xmin+i+2*t,this.ymax=this.ymin+i+2*t},e.prototype.reset=function(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0},e.prototype.moveTo=function(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new n.Point(e,t),this._firstPt=new n.Point(e,t),this._dist=0},e.prototype.lineTo=function(e,t){var i,r,a,s,l,u,h,c,d=this._isIn(e,t),f=new n.Point(e,t),p=n.Point.distance(this._prevPt,f);if(d)this._prevIsIn?this._lineTo(e,t,!0):(i=this._prevPt,r=f,a=this._intersect(r,i),this.start=this._dist+p*(1-this._r),this._lineTo(a.x,a.y,!0),this._lineTo(r.x,r.y,!0));else if(this._prevIsIn)r=this._prevPt,i=f,a=this._intersect(r,i),this._lineTo(a.x,a.y,!0),this._lineTo(i.x,i.y,!1);else{var v=this._prevPt,_=f;if(v.x<=this.xmin&&_.x<=this.xmin||v.x>=this.xmax&&_.x>=this.xmax||v.y<=this.ymin&&_.y<=this.ymin||v.y>=this.ymax&&_.y>=this.ymax)this._lineTo(_.x,_.y,!1);else{var m=[];if((v.x<this.xmin&&_.x>this.xmin||v.x>this.xmin&&_.x<this.xmin)&&(s=(this.xmin-v.x)/(_.x-v.x),(c=v.y+s*(_.y-v.y))<=this.ymin?u=!1:c>=this.ymax?u=!0:m.push(new o(s,this.xmin,c))),(v.x<this.xmax&&_.x>this.xmax||v.x>this.xmax&&_.x<this.xmax)&&(s=(this.xmax-v.x)/(_.x-v.x),(c=v.y+s*(_.y-v.y))<=this.ymin?u=!1:c>=this.ymax?u=!0:m.push(new o(s,this.xmax,c))),(v.y<this.ymin&&_.y>this.ymin||v.y>this.ymin&&_.y<this.ymin)&&(s=(this.ymin-v.y)/(_.y-v.y),(h=v.x+s*(_.x-v.x))<=this.xmin?l=!1:h>=this.xmax?l=!0:m.push(new o(s,h,this.ymin))),(v.y<this.ymax&&_.y>this.ymax||v.y>this.ymax&&_.y<this.ymax)&&(s=(this.ymax-v.y)/(_.y-v.y),(h=v.x+s*(_.x-v.x))<=this.xmin?l=!1:h>=this.xmax?l=!0:m.push(new o(s,h,this.ymax))),0===m.length)l?u?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):u?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<m.length&&m[0].ratio>m[1].ratio)this.start=this._dist+p*m[1].ratio,this._lineTo(m[1].x,m[1].y,!0),this._lineTo(m[0].x,m[0].y,!0);else{this.start=this._dist+p*m[0].ratio;for(var g=0;g<m.length;g++)this._lineTo(m[g].x,m[g].y,!0)}this._lineTo(_.x,_.y,!1)}}this._dist+=p,this._prevIsIn=d,this._prevPt=f},e.prototype.close=function(){if(2<this.line.length){var e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);for(var i=this.line,n=i.length;4<=n&&(i[0].x===i[1].x&&i[0].x===i[n-2].x||i[0].y===i[1].y&&i[0].y===i[n-2].y);)i.pop(),i[0].x=i[n-2].x,i[0].y=i[n-2].y,--n}},e.prototype.result=function(e){return void 0===e&&(e=!0),this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&l.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)},e.prototype.resultWithStarts=function(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();var e=this.lines,t=e.length;if(0===t)return null;for(var i=[],n=0;n<t;n++)i.push({line:e[n],start:this.starts[n]||0});return i},e.prototype._isIn=function(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax},e.prototype._intersect=function(e,t){var i,r,o;if(t.x>=this.xmin&&t.x<=this.xmax)o=((r=t.y<=this.ymin?this.ymin:this.ymax)-e.y)/(t.y-e.y),i=e.x+o*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)o=((i=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),r=e.y+o*(t.y-e.y);else{r=t.y<=this.ymin?this.ymin:this.ymax;var a=((i=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),s=(r-e.y)/(t.y-e.y);a<s?(o=a,r=e.y+a*(t.y-e.y)):(o=s,i=e.x+s*(t.x-e.x))}return this._r=o,new n.Point(i,r)},e.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0},e.prototype._moveTo=function(e,t,i){3!==this.type?i&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new n.Point(e,t))):(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new n.Point(e,t)),this._is_h=!1,this._is_v=!1)},e.prototype._lineTo=function(e,t,i){var r,o;if(3!==this.type)if(i){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),0<this.line.length&&(r=this.line[this.line.length-1]).equals(e,t))return;this.line.push(new n.Point(e,t))}else this.line&&0<this.line.length&&this._pushLine();else if(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){var a=(r=this.line[this.line.length-1]).x===e,s=r.y===t;if(a&&s)return;this._is_h&&a?(r.x=e,r.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):this._is_v&&s?(r.x=e,r.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):(this.line.push(new n.Point(e,t)),this._is_h=a,this._is_v=s)}else this.line.push(new n.Point(e,t))},e}();t.TileClipper=a;var s=function(){function e(){}return e.prototype.setExtent=function(e){this._ratio=4096===e?1:4096/e},e.prototype.reset=function(e){this.type=e,this.lines=[],this.line=null},e.prototype.moveTo=function(e,t){this.line&&this.lines.push(this.line),this.line=[];var i=this._ratio;this.line.push(new n.Point(Math.round(e*i),Math.round(t*i)))},e.prototype.lineTo=function(e,t){var i=this._ratio;this.line.push(new n.Point(Math.round(e*i),Math.round(t*i)))},e.prototype.close=function(){var e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])},e.prototype.result=function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:(3===this.type&&1!==this._ratio&&l.simplify(4096,64,this.lines),this.lines)},e}();t.SimpleBuilder=s;var l=function(){function e(){}return e.simplify=function(t,i,n){if(n){for(var r=-i,o=t+i,a=-i,s=t+i,l=[],u=[],h=n.length,c=0;c<h;++c){var d=n[c];if(d&&!(d.length<2))for(var f=d[0],p=void 0,v=d.length,_=1;_<v;++_)p=d[_],f.x===p.x&&(f.x<=r&&(f.y>p.y?(l.push(c),l.push(_),l.push(0),l.push(-1)):(u.push(c),u.push(_),u.push(0),u.push(-1))),f.x>=o&&(f.y<p.y?(l.push(c),l.push(_),l.push(1),l.push(-1)):(u.push(c),u.push(_),u.push(1),u.push(-1)))),f.y===p.y&&(f.y<=a&&(f.x<p.x?(l.push(c),l.push(_),l.push(2),l.push(-1)):(u.push(c),u.push(_),u.push(2),u.push(-1))),f.y>=s&&(f.x>p.x?(l.push(c),l.push(_),l.push(3),l.push(-1)):(u.push(c),u.push(_),u.push(3),u.push(-1)))),f=p}if(0!==l.length&&0!==u.length){e.fillParent(n,u,l),e.fillParent(n,l,u);var m=[];e.calcDeltas(m,u,l),e.calcDeltas(m,l,u),e.addDeltas(m,n)}}},e.fillParent=function(e,t,i){for(var n=i.length,o=t.length,a=0;a<o;a+=4){for(var s=t[a],l=t[a+1],u=t[a+2],h=e[s][l-1],c=e[s][l],d=8092,f=-1,p=0;p<n;p+=4)if(i[p+2]===u){var v=i[p],_=i[p+1],m=e[v][_-1],g=e[v][_];switch(u){case 0:case 1:r.between(h.y,m.y,g.y)&&r.between(c.y,m.y,g.y)&&(y=Math.abs(g.y-m.y))<d&&(d=y,f=p);break;case 2:case 3:var y;r.between(h.x,m.x,g.x)&&r.between(c.x,m.x,g.x)&&(y=Math.abs(g.x-m.x))<d&&(d=y,f=p)}}t[a+3]=f}},e.calcDeltas=function(t,i,n){for(var r=i.length,o=0;o<r;o+=4){var a=e.calcDelta(o,i,n,[]);t.push(i[o]),t.push(i[o+1]),t.push(i[o+2]),t.push(a)}},e.calcDelta=function(t,i,n,r){var o=i[t+3];if(-1===o)return 0;var a=r.length;return 1<a&&r[a-2]===o?0:(r.push(o),e.calcDelta(o,n,i,r)+1)},e.addDeltas=function(e,t){for(var i=e.length,n=0,r=0;r<i;r+=4)n<(s=e[r+3])&&(n=s);for(r=0;r<i;r+=4){var o=t[e[r]],a=e[r+1],s=n-e[r+3];switch(e[r+2]){case 0:o[a-1].x-=s,o[a].x-=s,1===a&&(o[o.length-1].x-=s),a===o.length-1&&(o[0].x-=s);break;case 1:o[a-1].x+=s,o[a].x+=s,1===a&&(o[o.length-1].x+=s),a===o.length-1&&(o[0].x+=s);break;case 2:o[a-1].y-=s,o[a].y-=s,1===a&&(o[o.length-1].y-=s),a===o.length-1&&(o[0].y-=s);break;case 3:o[a-1].y+=s,o[a].y+=s,1===a&&(o[o.length-1].y+=s),a===o.length-1&&(o[0].y+=s)}}},e}(),u=function(){function e(){this.linesIn=[],this.linesOut=[]}return e.prototype.cut=function(e,t){var i;if(this.xCut=t,e.rings)this.closed=!0,i=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,i=e.paths,this.minPts=2}for(var n=0,r=i;n<r.length;n++)if((p=r[n])&&!(p.length<this.minPts)){for(var o=!0,a=0,s=p;a<s.length;a++){var l=s[a];o?(this.moveTo(l),o=!1):this.lineTo(l)}this.closed&&this.close()}this._pushLineIn(),this._pushLineOut(),i=[];for(var u=0,h=this.linesIn;u<h.length;u++)(p=h[u])&&p.length>=this.minPts&&i.push(p);for(var c=-2*this.xCut,d=0,f=this.linesOut;d<f.length;d++){var p;if((p=f[d])&&p.length>=this.minPts){for(var v=0,_=p;v<_.length;v++)(l=_[v])[0]+=c;i.push(p)}}return this.closed?e.rings=i:e.paths=i,e},e.prototype.moveTo=function(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e},e.prototype.lineTo=function(e){var t=this._side(e[0]);if(t*this._prevSide==-1){var i=this._intersect(this._prevPt,e);this._lineTo(this.xCut,i,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e},e.prototype.close=function(){var e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this.lineIn),this._checkClosingPt(this.lineOut)},e.prototype._moveTo=function(e,t,i){this.closed?(this.lineIn.push([i<=0?e:this.xCut,t]),this.lineOut.push([0<=i?e:this.xCut,t])):(i<=0&&this.lineIn.push([e,t]),0<=i&&this.lineOut.push([e,t]))},e.prototype._lineTo=function(e,t,i){this.closed?(this._addPolyVertex(this.lineIn,i<=0?e:this.xCut,t),this._addPolyVertex(this.lineOut,0<=i?e:this.xCut,t)):i<0?(0===this._prevSide&&this._pushLineOut(),this.lineIn.push([e,t])):0<i?(0===this._prevSide&&this._pushLineIn(),this.lineOut.push([e,t])):this._prevSide<0?(this.lineIn.push([e,t]),this.lineOut.push([e,t])):0<this._prevSide&&(this.lineOut.push([e,t]),this.lineIn.push([e,t]))},e.prototype._addPolyVertex=function(e,t,i){var n=e.length;1<n&&e[n-1][0]===t&&e[n-2][0]===t?e[n-1][1]=i:e.push([t,i])},e.prototype._checkClosingPt=function(e){var t=e.length;3<t&&e[0][0]===this.xCut&&e[t-2][0]===this.xCut&&e[1][0]===this.xCut&&(e[0][1]=e[t-2][1],e.pop())},e.prototype._side=function(e){return e<this.xCut?-1:e>this.xCut?1:0},e.prototype._intersect=function(e,t){var i=(this.xCut-e[0])/(t[0]-e[0]);return e[1]+i*(t[1]-e[1])},e.prototype._pushLineIn=function(){this.lineIn&&this.lineIn.length>=this.minPts&&this.linesIn.push(this.lineIn),this.lineIn=[]},e.prototype._pushLineOut=function(){this.lineOut&&this.lineOut.length>=this.minPts&&this.linesOut.push(this.lineOut),this.lineOut=[]},e}();t.CutVertical=u}.apply(null,n))||(e.exports=r)},H2OT:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("H1tY"),i("UJGa"),i("oF5M"),i("KU+h")],void 0===(r=function(e,t,i,n,r,o){Object.defineProperty(t,"__esModule",{value:!0});var a=.75,s=function(){function e(){this._hlRenderer=new r.default,this._hlSurfaces=new o.default,this._hlGradient=new n.default,this._width=void 0,this._height=void 0,this._adjustedWidth=void 0,this._adjustedHeight=void 0}return e.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose(),this._hlRenderer&&this._hlRenderer.dispose(),this._hlGradient&&this._hlGradient.destroy(),this._boundFBO=null},e.prototype.setup=function(e,t,i){var n=(this._width=t)%4,r=(this._height=i)%4;t+=n<2?-n:4-n,i+=r<2?-r:4-r,this._adjustedWidth=t,this._adjustedHeight=i,this._boundFBO=e.getBoundFramebufferObject();var o=Math.round(t*a),s=Math.round(i*a);this._hlRenderer.setup(e,o,s),this._hlSurfaces.setup(e,o,s)},e.prototype.startMaskDraw=function(e){e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),e.setClearColor(0,0,0,0),e.setClearStencil(0),e.clear(e.gl.COLOR_BUFFER_BIT|e.gl.STENCIL_BUFFER_BIT),e.setViewport(0,0,this._adjustedWidth*a,this._adjustedHeight*a)},e.prototype.draw=function(e){e.setStencilTestEnabled(!1),e.setBlendingEnabled(!1),e.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.preBlur(e,this._hlSurfaces.sharedBlur1Tex),i("esri-feature-highlight-debug")?(e.bindFramebuffer(null),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex)):(e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex),e.bindFramebuffer(this._boundFBO),e.setBlendingEnabled(!0),e.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(e,this._hlSurfaces.sharedBlur1Tex,this._hlGradient),this._boundFBO=null)},e.prototype.setHighlightOptions=function(e){this._hlGradient.setHighlightOptions(e)},e}();t.default=s}.apply(null,n))||(e.exports=r)},"Hoc/":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("zp6E"),i("v7zm"),i("qMld")],void 0===(r=function(e,t,i,n,r){var o=function(){function e(e){for(this._metrics=[],this._bitmaps=[];e.next();)switch(e.tag()){case 1:for(var t=e.getMessage();t.next();)switch(t.tag()){case 3:for(var i=t.getMessage(),n=void 0,r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=void 0;i.next();)switch(i.tag()){case 1:n=i.getUInt32();break;case 2:r=i.getBytes();break;case 3:o=i.getUInt32();break;case 4:a=i.getUInt32();break;case 5:s=i.getSInt32();break;case 6:l=i.getSInt32();break;case 7:u=i.getUInt32();break;default:i.skip()}n&&(this._metrics[n]={width:o,height:a,left:s,top:l,advance:u},this._bitmaps[n]=r);break;default:t.skip()}break;default:e.skip()}}return e.prototype.getMetrics=function(e){return this._metrics[e]},e.prototype.getBitmap=function(e){return this._bitmaps[e]},e}(),a=function(){function e(){this._ranges=[]}return e.prototype.getRange=function(e){return this._ranges[e]},e.prototype.addRange=function(e,t){this._ranges[e]=t},e}();return function(){function e(e){this._glyphInfo={},this._baseURL=e}return e.prototype.getRange=function(e,t){var a=this._getFontStack(e);if(a.getRange(t))return r.resolve();var s=256*t,l=s+255,u=this._baseURL.replace("{fontstack}",e).replace("{range}",s+"-"+l);return i(u,{responseType:"array-buffer"}).then(function(e){a.addRange(t,new o(new n(new Uint8Array(e.data),new DataView(e.data))))})},e.prototype.getGlyph=function(e,t){var i=this._getFontStack(e);if(i){var n=Math.floor(t/256);if(!(256<n)){var r=i.getRange(n);if(r)return{metrics:r.getMetrics(t),bitmap:r.getBitmap(t)}}}},e.prototype._getFontStack=function(e){var t=this._glyphInfo[e];return t||(t=this._glyphInfo[e]=new a),t},e}()}.apply(null,n))||(e.exports=r)},Id87:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("6cAc")],void 0===(r=function(e,t,i){return function(){function e(e,t,i,n,r,o,a,s){this._glyphItems=e,this._maxWidth=t,this._lineHeight=i,this._letterSpacing=n,this._offset=r,this._hAnchor=o,this._vAnchor=a,this._justify=s}return e.prototype.getShaping=function(e,t){for(var i=this._letterSpacing,n=this._lineHeight,r=this._justify,o=this._maxWidth,a=[],s=0,l=0,u=0,h=0,c=-1,d=0,f=-1,p=e.length,v=0;v<p;v++){var _=e.charCodeAt(v);if(10!==_){for(var m=void 0,g=0,y=this._glyphItems;g<y.length&&!(m=y[g][_]);g++);if(m){if(a.push({codePoint:_,x:s,y:l,glyphMosaicItem:m}),s+=m.metrics.advance+i,0<o&&o<s&&0<=f){var x=f+1;T=a[x].x,d=Math.max(T,d);for(var b=x;b<a.length;b++)t?a[b].y-=n:a[b].y+=n,a[b].x-=T;r&&this._applyJustification(a,h,f),t?l-=n:l+=n,s-=T,++u,h=x,f=-1}++c,32===_&&(f=a.length-1)}}else{if(v===p-1)continue;if(h<=c){var T=(w=a[c]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(T,d),r&&this._applyJustification(a,h,c),h=a.length}t?l-=n:l+=n,s=0,++u}}if(h<=c){var w,S=(w=a[c]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(d,S),r&&this._applyJustification(a,h,c)}if(0<a.length){var M=(r-this._hAnchor)*d,E=(-this._vAnchor*(u+1)+.5)*n;t&&u&&(E+=u*n),M+=this._offset[0],E+=this._offset[1];for(var C=0,I=a;C<I.length;C++){var F=I[C];F.x+=M,F.y+=E}}return a},e.getBox=function(e){if(!e.length)return null;for(var t=1/0,i=1/0,n=0,r=0,o=0,a=e;o<a.length;o++){var s=a[o],l=s.glyphMosaicItem.metrics,u=l.height,h=l.left,c=l.top,d=l.width,f=s.x,p=s.y-(u-Math.abs(c)),v=f+d+h,_=p+u;t=Math.min(t,f),n=Math.max(n,v),i=Math.min(i,p),r=Math.max(r,_)}return{x:t,y:i,width:n-t,height:r-i}},e.addDecoration=function(e,t){var n=e.length;if(0!==n){for(var r=e[0].x+e[0].glyphMosaicItem.metrics.left,o=e[0].y,a=1;a<n;a++){var s=e[a];if(s.y!==o){var l=e[a-1].x+e[a-1].glyphMosaicItem.metrics.left+e[a-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:r,y:o+t-3,glyphMosaicItem:{sdf:!0,rect:new i(4,0,4,8),metrics:{width:l-r,height:8,left:0,top:0,advance:0},page:0}}),o=s.y,r=s.x+s.glyphMosaicItem.metrics.left}}var u=e[n-1].x+e[n-1].glyphMosaicItem.metrics.left+e[n-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:r,y:o+t-3,glyphMosaicItem:{sdf:!0,rect:new i(4,0,4,8),metrics:{width:u-r,height:8,left:0,top:0,advance:0},page:0}})}},e.prototype._applyJustification=function(e,t,i){for(var n=e[i],r=n.glyphMosaicItem.metrics.advance,o=(n.x+r)*this._justify,a=t;a<=i;a++)e[a].x-=o},e}()}.apply(null,n))||(e.exports=r)},Jl7l:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("jaBu"),i("qysZ")],void 0===(r=function(e,t,i,n){function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function o(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],h=t[7],c=t[8],d=t[9],f=t[10],p=t[11],v=t[12],_=t[13],m=t[14],g=t[15],y=i[0],x=i[1],b=i[2],T=i[3];return e[0]=y*n+x*s+b*c+T*v,e[1]=y*r+x*l+b*d+T*_,e[2]=y*o+x*u+b*f+T*m,e[3]=y*a+x*h+b*p+T*g,y=i[4],x=i[5],b=i[6],T=i[7],e[4]=y*n+x*s+b*c+T*v,e[5]=y*r+x*l+b*d+T*_,e[6]=y*o+x*u+b*f+T*m,e[7]=y*a+x*h+b*p+T*g,y=i[8],x=i[9],b=i[10],T=i[11],e[8]=y*n+x*s+b*c+T*v,e[9]=y*r+x*l+b*d+T*_,e[10]=y*o+x*u+b*f+T*m,e[11]=y*a+x*h+b*p+T*g,y=i[12],x=i[13],b=i[14],T=i[15],e[12]=y*n+x*s+b*c+T*v,e[13]=y*r+x*l+b*d+T*_,e[14]=y*o+x*u+b*f+T*m,e[15]=y*a+x*h+b*p+T*g,e}function a(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=n+n,l=r+r,u=o+o,h=n*s,c=n*l,d=n*u,f=r*l,p=r*u,v=o*u,_=a*s,m=a*l,g=a*u;return e[0]=1-(f+v),e[1]=c+g,e[2]=d-m,e[3]=0,e[4]=c-g,e[5]=1-(h+v),e[6]=p+_,e[7]=0,e[8]=d+m,e[9]=p-_,e[10]=1-(h+f),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function s(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.set=function(e,t,i,n,r,o,a,s,l,u,h,c,d,f,p,v,_){return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e[8]=u,e[9]=h,e[10]=c,e[11]=d,e[12]=f,e[13]=p,e[14]=v,e[15]=_,e},t.identity=r,t.transpose=function(e,t){if(e===t){var i=t[1],n=t[2],r=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=r,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],h=t[8],c=t[9],d=t[10],f=t[11],p=t[12],v=t[13],_=t[14],m=t[15],g=i*s-n*a,y=i*l-r*a,x=i*u-o*a,b=n*l-r*s,T=n*u-o*s,w=r*u-o*l,S=h*v-c*p,M=h*_-d*p,E=h*m-f*p,C=c*_-d*v,I=c*m-f*v,F=d*m-f*_,A=g*F-y*I+x*C+b*E-T*M+w*S;return A?(A=1/A,e[0]=(s*F-l*I+u*C)*A,e[1]=(r*I-n*F-o*C)*A,e[2]=(v*w-_*T+m*b)*A,e[3]=(d*T-c*w-f*b)*A,e[4]=(l*E-a*F-u*M)*A,e[5]=(i*F-r*E+o*M)*A,e[6]=(_*x-p*w-m*y)*A,e[7]=(h*w-d*x+f*y)*A,e[8]=(a*I-s*E+u*S)*A,e[9]=(n*E-i*I-o*S)*A,e[10]=(p*T-v*x+m*g)*A,e[11]=(c*x-h*T-f*g)*A,e[12]=(s*M-a*C-l*S)*A,e[13]=(i*C-n*M+r*S)*A,e[14]=(v*y-p*b-_*g)*A,e[15]=(h*b-c*y+d*g)*A,e):null},t.adjoint=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],h=t[8],c=t[9],d=t[10],f=t[11],p=t[12],v=t[13],_=t[14],m=t[15];return e[0]=s*(d*m-f*_)-c*(l*m-u*_)+v*(l*f-u*d),e[1]=-(n*(d*m-f*_)-c*(r*m-o*_)+v*(r*f-o*d)),e[2]=n*(l*m-u*_)-s*(r*m-o*_)+v*(r*u-o*l),e[3]=-(n*(l*f-u*d)-s*(r*f-o*d)+c*(r*u-o*l)),e[4]=-(a*(d*m-f*_)-h*(l*m-u*_)+p*(l*f-u*d)),e[5]=i*(d*m-f*_)-h*(r*m-o*_)+p*(r*f-o*d),e[6]=-(i*(l*m-u*_)-a*(r*m-o*_)+p*(r*u-o*l)),e[7]=i*(l*f-u*d)-a*(r*f-o*d)+h*(r*u-o*l),e[8]=a*(c*m-f*v)-h*(s*m-u*v)+p*(s*f-u*c),e[9]=-(i*(c*m-f*v)-h*(n*m-o*v)+p*(n*f-o*c)),e[10]=i*(s*m-u*v)-a*(n*m-o*v)+p*(n*u-o*s),e[11]=-(i*(s*f-u*c)-a*(n*f-o*c)+h*(n*u-o*s)),e[12]=-(a*(c*_-d*v)-h*(s*_-l*v)+p*(s*d-l*c)),e[13]=i*(c*_-d*v)-h*(n*_-r*v)+p*(n*d-r*c),e[14]=-(i*(s*_-l*v)-a*(n*_-r*v)+p*(n*l-r*s)),e[15]=i*(s*d-l*c)-a*(n*d-r*c)+h*(n*l-r*s),e},t.determinant=function(e){var t=e[0],i=e[1],n=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],h=e[9],c=e[10],d=e[11],f=e[12],p=e[13],v=e[14],_=e[15];return(t*a-i*o)*(c*_-d*v)-(t*s-n*o)*(h*_-d*p)+(t*l-r*o)*(h*v-c*p)+(i*s-n*a)*(u*_-d*f)-(i*l-r*a)*(u*v-c*f)+(n*l-r*s)*(u*p-h*f)},t.multiply=o,t.translate=function(e,t,i){var n=i[0],r=i[1],o=i[2],a=void 0,s=void 0,l=void 0,u=void 0,h=void 0,c=void 0,d=void 0,f=void 0,p=void 0,v=void 0,_=void 0,m=void 0;return t===e?(e[12]=t[0]*n+t[4]*r+t[8]*o+t[12],e[13]=t[1]*n+t[5]*r+t[9]*o+t[13],e[14]=t[2]*n+t[6]*r+t[10]*o+t[14],e[15]=t[3]*n+t[7]*r+t[11]*o+t[15]):(a=t[0],s=t[1],l=t[2],u=t[3],h=t[4],c=t[5],d=t[6],f=t[7],p=t[8],v=t[9],_=t[10],m=t[11],e[0]=a,e[1]=s,e[2]=l,e[3]=u,e[4]=h,e[5]=c,e[6]=d,e[7]=f,e[8]=p,e[9]=v,e[10]=_,e[11]=m,e[12]=a*n+h*r+p*o+t[12],e[13]=s*n+c*r+v*o+t[13],e[14]=l*n+d*r+_*o+t[14],e[15]=u*n+f*r+m*o+t[15]),e},t.scale=function(e,t,i){var n=i[0],r=i[1],o=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,i,r){var o=r[0],a=r[1],s=r[2],l=Math.sqrt(o*o+a*a+s*s),u=void 0,h=void 0,c=void 0,d=void 0,f=void 0,p=void 0,v=void 0,_=void 0,m=void 0,g=void 0,y=void 0,x=void 0,b=void 0,T=void 0,w=void 0,S=void 0,M=void 0,E=void 0,C=void 0,I=void 0,F=void 0,A=void 0,O=void 0,P=void 0;return l<n.EPSILON?null:(o*=l=1/l,a*=l,s*=l,u=Math.sin(i),c=1-(h=Math.cos(i)),d=t[0],f=t[1],p=t[2],v=t[3],_=t[4],m=t[5],g=t[6],y=t[7],x=t[8],b=t[9],T=t[10],w=t[11],S=o*o*c+h,M=a*o*c+s*u,E=s*o*c-a*u,C=o*a*c-s*u,I=a*a*c+h,F=s*a*c+o*u,A=o*s*c+a*u,O=a*s*c-o*u,P=s*s*c+h,e[0]=d*S+_*M+x*E,e[1]=f*S+m*M+b*E,e[2]=p*S+g*M+T*E,e[3]=v*S+y*M+w*E,e[4]=d*C+_*I+x*F,e[5]=f*C+m*I+b*F,e[6]=p*C+g*I+T*F,e[7]=v*C+y*I+w*F,e[8]=d*A+_*O+x*P,e[9]=f*A+m*O+b*P,e[10]=p*A+g*O+T*P,e[11]=v*A+y*O+w*P,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],h=t[9],c=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*r+u*n,e[5]=a*r+h*n,e[6]=s*r+c*n,e[7]=l*r+d*n,e[8]=u*r-o*n,e[9]=h*r-a*n,e[10]=c*r-s*n,e[11]=d*r-l*n,e},t.rotateY=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),o=t[0],a=t[1],s=t[2],l=t[3],u=t[8],h=t[9],c=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r-u*n,e[1]=a*r-h*n,e[2]=s*r-c*n,e[3]=l*r-d*n,e[8]=o*n+u*r,e[9]=a*n+h*r,e[10]=s*n+c*r,e[11]=l*n+d*r,e},t.rotateZ=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],h=t[5],c=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r+u*n,e[1]=a*r+h*n,e[2]=s*r+c*n,e[3]=l*r+d*n,e[4]=u*r-o*n,e[5]=h*r-a*n,e[6]=c*r-s*n,e[7]=d*r-l*n,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,i){var r=i[0],o=i[1],a=i[2],s=Math.sqrt(r*r+o*o+a*a),l=void 0,u=void 0,h=void 0;return s<n.EPSILON?null:(r*=s=1/s,o*=s,a*=s,l=Math.sin(t),h=1-(u=Math.cos(t)),e[0]=r*r*h+u,e[1]=o*r*h+a*l,e[2]=a*r*h-o*l,e[3]=0,e[4]=r*o*h-a*l,e[5]=o*o*h+u,e[6]=a*o*h+r*l,e[7]=0,e[8]=r*a*h+o*l,e[9]=o*a*h-r*l,e[10]=a*a*h+u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=a,t.fromQuat2=function(e,t){var i=l,n=-t[0],r=-t[1],o=-t[2],s=t[3],u=t[4],h=t[5],c=t[6],d=t[7],f=n*n+r*r+o*o+s*s;return f>0?(i[0]=2*(u*s+d*n+h*o-c*r)/f,i[1]=2*(h*s+d*r+c*n-u*o)/f,i[2]=2*(c*s+d*o+u*r-h*n)/f):(i[0]=2*(u*s+d*n+h*o-c*r),i[1]=2*(h*s+d*r+c*n-u*o),i[2]=2*(c*s+d*o+u*r-h*n)),a(e,t,i),e};var l=i.create();t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[4],a=t[5],s=t[6],l=t[8],u=t[9],h=t[10];return e[0]=Math.sqrt(i*i+n*n+r*r),e[1]=Math.sqrt(o*o+a*a+s*s),e[2]=Math.sqrt(l*l+u*u+h*h),e},t.getRotation=function(e,t){var i=t[0]+t[5]+t[10],n=0;return i>0?(n=2*Math.sqrt(i+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,i,n){var r=t[0],o=t[1],a=t[2],s=t[3],l=r+r,u=o+o,h=a+a,c=r*l,d=r*u,f=r*h,p=o*u,v=o*h,_=a*h,m=s*l,g=s*u,y=s*h,x=n[0],b=n[1],T=n[2];return e[0]=(1-(p+_))*x,e[1]=(d+y)*x,e[2]=(f-g)*x,e[3]=0,e[4]=(d-y)*b,e[5]=(1-(c+_))*b,e[6]=(v+m)*b,e[7]=0,e[8]=(f+g)*T,e[9]=(v-m)*T,e[10]=(1-(c+p))*T,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,i,n,r){var o=t[0],a=t[1],s=t[2],l=t[3],u=o+o,h=a+a,c=s+s,d=o*u,f=o*h,p=o*c,v=a*h,_=a*c,m=s*c,g=l*u,y=l*h,x=l*c,b=n[0],T=n[1],w=n[2],S=r[0],M=r[1],E=r[2],C=(1-(v+m))*b,I=(f+x)*b,F=(p-y)*b,A=(f-x)*T,O=(1-(d+m))*T,P=(_+g)*T,R=(p+y)*w,D=(_-g)*w,L=(1-(d+v))*w;return e[0]=C,e[1]=I,e[2]=F,e[3]=0,e[4]=A,e[5]=O,e[6]=P,e[7]=0,e[8]=R,e[9]=D,e[10]=L,e[11]=0,e[12]=i[0]+S-(C*S+A*M+R*E),e[13]=i[1]+M-(I*S+O*M+D*E),e[14]=i[2]+E-(F*S+P*M+L*E),e[15]=1,e},t.fromQuat=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=i+i,s=n+n,l=r+r,u=i*a,h=n*a,c=n*s,d=r*a,f=r*s,p=r*l,v=o*a,_=o*s,m=o*l;return e[0]=1-c-p,e[1]=h+m,e[2]=d-_,e[3]=0,e[4]=h-m,e[5]=1-u-p,e[6]=f+v,e[7]=0,e[8]=d+_,e[9]=f-v,e[10]=1-u-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,i,n,r,o,a){var s=1/(i-t),l=1/(r-n),u=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(i+t)*s,e[9]=(r+n)*l,e[10]=(a+o)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*u,e[15]=0,e},t.perspective=function(e,t,i,n,r){var o=1/Math.tan(t/2),a=void 0;return e[0]=o/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(a=1/(n-r),e[10]=(r+n)*a,e[14]=2*r*n*a):(e[10]=-1,e[14]=-2*n),e},t.perspectiveFromFieldOfView=function(e,t,i,n){var r=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+s),u=2/(r+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(a-s)*l*.5,e[9]=(r-o)*u*.5,e[10]=n/(i-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*i/(i-n),e[15]=0,e},t.ortho=function(e,t,i,n,r,o,a){var s=1/(t-i),l=1/(n-r),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+i)*s,e[13]=(r+n)*l,e[14]=(a+o)*u,e[15]=1,e},t.lookAt=function(e,t,i,o){var a=void 0,s=void 0,l=void 0,u=void 0,h=void 0,c=void 0,d=void 0,f=void 0,p=void 0,v=void 0,_=t[0],m=t[1],g=t[2],y=o[0],x=o[1],b=o[2],T=i[0],w=i[1],S=i[2];return Math.abs(_-T)<n.EPSILON&&Math.abs(m-w)<n.EPSILON&&Math.abs(g-S)<n.EPSILON?r(e):(d=_-T,f=m-w,p=g-S,a=x*(p*=v=1/Math.sqrt(d*d+f*f+p*p))-b*(f*=v),s=b*(d*=v)-y*p,l=y*f-x*d,(v=Math.sqrt(a*a+s*s+l*l))?(a*=v=1/v,s*=v,l*=v):(a=0,s=0,l=0),u=f*l-p*s,h=p*a-d*l,c=d*s-f*a,(v=Math.sqrt(u*u+h*h+c*c))?(u*=v=1/v,h*=v,c*=v):(u=0,h=0,c=0),e[0]=a,e[1]=u,e[2]=d,e[3]=0,e[4]=s,e[5]=h,e[6]=f,e[7]=0,e[8]=l,e[9]=c,e[10]=p,e[11]=0,e[12]=-(a*_+s*m+l*g),e[13]=-(u*_+h*m+c*g),e[14]=-(d*_+f*m+p*g),e[15]=1,e)},t.targetTo=function(e,t,i,n){var r=t[0],o=t[1],a=t[2],s=n[0],l=n[1],u=n[2],h=r-i[0],c=o-i[1],d=a-i[2],f=h*h+c*c+d*d;f>0&&(h*=f=1/Math.sqrt(f),c*=f,d*=f);var p=l*d-u*c,v=u*h-s*d,_=s*c-l*h;return(f=p*p+v*v+_*_)>0&&(p*=f=1/Math.sqrt(f),v*=f,_*=f),e[0]=p,e[1]=v,e[2]=_,e[3]=0,e[4]=c*_-d*v,e[5]=d*p-h*_,e[6]=h*v-c*p,e[7]=0,e[8]=h,e[9]=c,e[10]=d,e[11]=0,e[12]=r,e[13]=o,e[14]=a,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e},t.subtract=s,t.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e},t.multiplyScalarAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e[3]=t[3]+i[3]*n,e[4]=t[4]+i[4]*n,e[5]=t[5]+i[5]*n,e[6]=t[6]+i[6]*n,e[7]=t[7]+i[7]*n,e[8]=t[8]+i[8]*n,e[9]=t[9]+i[9]*n,e[10]=t[10]+i[10]*n,e[11]=t[11]+i[11]*n,e[12]=t[12]+i[12]*n,e[13]=t[13]+i[13]*n,e[14]=t[14]+i[14]*n,e[15]=t[15]+i[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],h=e[7],c=e[8],d=e[9],f=e[10],p=e[11],v=e[12],_=e[13],m=e[14],g=e[15],y=t[0],x=t[1],b=t[2],T=t[3],w=t[4],S=t[5],M=t[6],E=t[7],C=t[8],I=t[9],F=t[10],A=t[11],O=t[12],P=t[13],R=t[14],D=t[15];return Math.abs(i-y)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(r-x)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(o-b)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-T)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(s-w)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(l-S)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(u-M)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(h-E)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(c-C)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(d-I)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-F)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(p-A)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(v-O)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(_-P)<=n.EPSILON*Math.max(1,Math.abs(_),Math.abs(P))&&Math.abs(m-R)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(g-D)<=n.EPSILON*Math.max(1,Math.abs(g),Math.abs(D))},t.mul=o,t.sub=s}.apply(null,n))||(e.exports=r)},"KU+h":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("/f24"),i("Zp3t")],void 0===(r=function(e,t,i,n){function r(e,t,r){var o=new n(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:t,height:r,samplingMode:9729});return[o,i.createWithAttachments(e,o,{colorTarget:0,depthStencilTarget:2})]}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this._width=void 0,this._height=void 0,this._resources=null}return e.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)},e.prototype._initialize=function(e,t,i){var n=r(e,this._width=t,this._height=i),o=n[0],a=n[1],s=r(e,t,i),l=s[0],u=s[1];this._resources={sharedBlur1Tex:o,sharedBlur1Fbo:a,sharedBlur2Tex:l,sharedBlur2Fbo:u}},e.prototype.setup=function(e,t,i){!this._resources||this._width===t&&this._height===i||this.dispose(),this._resources||this._initialize(e,t,i)},Object.defineProperty(e.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0}),e}();t.default=o}.apply(null,n))||(e.exports=r)},"LN/d":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("2Atf"),i("qMld"),i("afW+"),i("KJwU"),i("aMdW"),i("N5UP"),i("W9tT"),i("DIqE"),i("1Mg+"),i("+P5t"),i("JNkf"),i("OO/B"),i("5MKl"),i("dlMz"),i("QFi0"),i("qLgY"),i("/f24"),i("U+8K"),i("3KT0"),i("z2+Q")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d,f,p,v,_,m,g,y,x,b,T){Object.defineProperty(t,"__esModule",{value:!0});var w=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this)||this;n._renderParameters={drawPhase:0,state:n.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1},n._renderRequested=!1,n._clipData=new Float32Array(8),n._upperLeft=h.vec2f64.create(),n._upperRight=h.vec2f64.create(),n._lowerLeft=h.vec2f64.create(),n._lowerRight=h.vec2f64.create(),n._mat2=l.mat2df64.create(),n._clipRendererInitialized=!1,n._supersampleScreenshots=!0,n.stage=n,n._stationary=!0,n.attached=!0;var r=i.canvas,a=void 0===r?document.createElement("canvas"):r,s=i.alpha,u=void 0===s||s,c=i.stencil,d=void 0===c||c,f=i.renderContext,v=void 0===f?"webgl":f,_=i.supersampleScreenshots,m=void 0===_||_;n._canvas=a,a.setAttribute("style","width: 100%; height:100%; display:block;"),t.appendChild(a);var y={alpha:u,antialias:!1,depth:!0,stencil:d},x=g.createContextOrErrorHTML(a,y,v);return n.context=new b(x),n.painter=new p.default(n.context),n._taskHandle=o.addFrameTask({render:function(){return n.renderFrame()}}),n._taskHandle.pause(),n._supersampleScreenshots=m,n}return i(t,e),t.prototype.destroy=function(){this.removeAllChildren(),this.renderFrame(),this._taskHandle.remove(),this._taskHandle=null,this._boundFBO=null,this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null),this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO1=null),this._labelsFBO2&&(this._labelsFBO2.dispose(),this._labelsFBO2=null),this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null),this._clipVAO&&(this._clipVAO.dispose(),this._clipVAO=null,this._clipVBO=null),this._clipStencilProgram&&(this._clipStencilProgram.dispose(),this._clipStencilProgram=null),this.painter.dispose(),this.context.dispose(),this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas),this._canvas=null},Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background=e,this.requestRender()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e,this.requestRender()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stationary",{get:function(){return this._stationary},set:function(e){this._stationary!==e&&(this._stationary=e,this.requestRender())},enumerable:!0,configurable:!0}),t.prototype.requestRender=function(){this._renderRequested=!0,this._taskHandle&&this._taskHandle.resume()},t.prototype.renderFrame=function(){this._renderRequested&&(this._renderRequested=!1,this._renderParameters.state=this._state,this._renderParameters.stationary=this.stationary,this._renderParameters.pixelRatio=window.devicePixelRatio,this._renderParameters.globalOpacity=1,this.processRender(this._renderParameters)),this._renderRequested||this._taskHandle.pause()},t.prototype.setHighlightOptions=function(e){this.painter.setHighlightOptions(e)},t.prototype.renderChildren=function(e){var t=this.context,i=this.children;this.beforeRenderChildren(e),e.drawPhase=f.WGLDrawPhase.MAP;for(var n=e.children?e.children:i,r=n.length,o=0;o<r;o++){(l=n[o]).attached&&l.processRender(e)}var a=t.getBoundFramebufferObject();t.bindFramebuffer(this._labelsFBO2);var s=e.stationary;if(t.setClearColor(0,0,0,s?0:1),t.clear(t.gl.COLOR_BUFFER_BIT),s){e.drawPhase=f.WGLDrawPhase.LABEL_ALPHA,e.labelFBO=this._labelsFBO1;for(o=0;o<r;o++){(l=n[o]).attached&&l.processRender(e)}}t.bindFramebuffer(a),e.labelFBO=this._labelsFBO2,e.drawPhase=f.WGLDrawPhase.LABEL;for(o=0;o<r;o++){var l;(l=n[o]).attached&&l.processRender(e)}var u=this._labelsFBO2;this._labelsFBO2=this._labelsFBO1,this._labelsFBO1=u,this.afterRenderChildren()},t.prototype.beforeRenderChildren=function(e){var t=this.context,i=this.painter,n=e.state,r=e.pixelRatio;if(i){t.enforceState();var o=n.size,l=n.rotation,h=Math.round(o[0]*r),c=Math.round(o[1]*r);if(this._boundFBO=t.getBoundFramebufferObject(),this._labelsFBO1&&this._labelsFBO1.width===h&&this._labelsFBO1.height===c||(this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO2.dispose()),this._labelsFBO1=y.createWithAttachments(t,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:h,height:c},{colorTarget:0,depthStencilTarget:0}),t.bindFramebuffer(this._labelsFBO1),t.setDepthWriteEnabled(!0),t.setStencilWriteMask(255),t.setClearColor(0,0,0,0),t.setClearDepth(1),t.setClearStencil(0),t.clear(t.gl.COLOR_BUFFER_BIT|t.gl.DEPTH_BUFFER_BIT|t.gl.STENCIL_BUFFER_BIT),t.setDepthWriteEnabled(!1),t.bindFramebuffer(this._boundFBO),this._labelsFBO2=y.createWithAttachments(t,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:h,height:c},{colorTarget:0,depthStencilTarget:0})),!(n.spatialReference&&(n.spatialReference._isWrappable?n.spatialReference._isWrappable():n.spatialReference.isWrappable)))return void(this._clipFrame=!1);var d=a.common.toRadian(l),f=Math.abs(Math.cos(d)),p=Math.abs(Math.sin(d)),v=Math.round(h*f+c*p),_=Math.round(n.worldScreenWidth);if(v<=_)return void(this._clipFrame=!1);this._clipFBO&&this._clipFBO.width===h&&this._clipFBO.height===c||(this._clipFBO=new y(t,{colorTarget:0,depthStencilTarget:3,width:h,height:c}));var m=.5*h,g=.5*c,x=1/h,b=1/c,T=.5*_*r,w=.5*(h*p+c*f),S=this._upperLeft,M=this._upperRight,E=this._lowerLeft,C=this._lowerRight;u.vec2.set(S,-T,-w),u.vec2.set(M,T,-w),u.vec2.set(E,-T,w),u.vec2.set(C,T,w),s.mat2d.identity(this._mat2),s.mat2d.translate(this._mat2,this._mat2,[m,g]),0!==l&&s.mat2d.rotate(this._mat2,this._mat2,d),u.vec2.transformMat2d(S,S,this._mat2),u.vec2.transformMat2d(M,M,this._mat2),u.vec2.transformMat2d(E,E,this._mat2),u.vec2.transformMat2d(C,C,this._mat2);var I=this._clipData;I.set([2*E[0]*x-1,2*(c-E[1])*b-1,2*C[0]*x-1,2*(c-C[1])*b-1,2*S[0]*x-1,2*(c-S[1])*b-1,2*M[0]*x-1,2*(c-M[1])*b-1]),this._clipRendererInitialized||this._initializeClipRenderer(t),this._clipVBO.setData(I),this._boundFBO=t.getBoundFramebufferObject(),t.bindFramebuffer(this._clipFBO),t.setDepthWriteEnabled(!0),t.setStencilWriteMask(255),t.setClearColor(0,0,0,0),t.setClearDepth(1),t.setClearStencil(0),t.clear(t.gl.COLOR_BUFFER_BIT|t.gl.DEPTH_BUFFER_BIT|t.gl.STENCIL_BUFFER_BIT),t.setDepthWriteEnabled(!1),this._clipFrame=!0}},t.prototype.afterRenderChildren=function(){var e=this.context;e.logIno(),this._clipFrame&&this._clipRendererInitialized&&(e.bindFramebuffer(this._boundFBO),this._boundFBO=null,e.bindVAO(this._clipVAO),e.bindProgram(this._clipStencilProgram),e.setDepthWriteEnabled(!1),e.setDepthTestEnabled(!1),e.setStencilTestEnabled(!0),e.setBlendingEnabled(!1),e.setColorMask(!1,!1,!1,!1),e.setStencilOp(7680,7680,7681),e.setStencilWriteMask(255),e.setStencilFunction(519,1,255),e.drawElements(4,6,5123,0),e.bindVAO(),e.setColorMask(!0,!0,!0,!0),e.setBlendingEnabled(!0),e.setStencilFunction(514,1,255),this._blitRenderer.render(e,this._clipFBO.colorTexture,9728,1),e.setStencilTestEnabled(!1))},t.prototype.doRender=function(t){var i=this.context,n=t.state,r=t.pixelRatio;if(this._resizeCanvas(t),this.context.enforceState(),i.setViewport(0,0,r*n.size[0],r*n.size[1]),i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),this.background&&this.background.color){var o=this.background.color,a=o.r,s=o.g,l=o.b,u=o.a;i.setClearColor(a/255,s/255,l/255,u)}else i.setClearColor(0,0,0,0);i.setClearDepth(1),i.setClearStencil(0),i.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT|i.gl.STENCIL_BUFFER_BIT),i.setDepthWriteEnabled(!1),e.prototype.doRender.call(this,t)},t.prototype.takeScreenshot=function(e,t){var i=_.screenshotSuperSampleSettings(e,this._supersampleScreenshots),n=i.framebufferWidth,o=i.framebufferHeight,a=this.context,s=e.layers,l={drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),pixelRatio:i.pixelRatio};if(null!=e.rotation){var u=l.state.viewpoint;u.rotation=e.rotation,l.state.viewpoint=u}s.length>0&&(l.children=[],s.forEach(function(e){var i=t.find(function(t){return t.layer.id===e.id});i&&i.container&&i.attached&&l.children.push(i.container)}));var h=y.create(a,{colorTarget:0,depthStencilTarget:3,width:n,height:o}),c=a.getBoundFramebufferObject(),d=a.getViewport();a.bindFramebuffer(h),a.setViewport(0,0,n,o);var f=a.gl;a.setClearColor(0,0,0,0),a.setClearDepth(1),a.setClearStencil(0),a.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT|f.STENCIL_BUFFER_BIT),this.renderChildren(l);var p=this._readbackScreenshot(i);a.bindFramebuffer(c),a.setViewport(d.x,d.y,d.width,d.height),this.requestRender();var v=this._ensureScreenshotEncodeCanvas(),m=_.encodeResult(p,e,v,{flipY:!0,premultipliedAlpha:!0});return r.resolve(m)},t.prototype._ensureScreenshotEncodeCanvas=function(){return this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas")),this._screenshotEncodeCanvas},t.prototype._readbackScreenshot=function(e){var t=e.framebufferWidth,i=e.framebufferHeight,n=e.region,r=e.resample,o=this.context.gl;if(r){var a=_.createEmptyImageData(t,i,this._ensureScreenshotEncodeCanvas());o.readPixels(0,0,t,i,6408,5121,new Uint8Array(a.data.buffer));var s=_.createEmptyImageData(n.width,n.height,this._ensureScreenshotEncodeCanvas());return _.resampleHermite(a,s,!0,r.region.x,i-(r.region.y+r.region.height),r.region.width,r.region.height)}a=_.createEmptyImageData(n.width,n.height,this._ensureScreenshotEncodeCanvas());return o.readPixels(n.x,i-(n.y+n.height),n.width,n.height,6408,5121,new Uint8Array(a.data.buffer)),a},t.prototype._resizeCanvas=function(e){var t=this._canvas,i=t.style,n=e.state.size,r=e.pixelRatio,o=n[0],a=n[1],s=Math.round(o*r),l=Math.round(a*r);t.width===s&&t.height===l||(t.width=s,t.height=l),i.width=o+"px",i.height=a+"px"},t.prototype._initializeClipRenderer=function(e){if(this._clipRendererInitialized)return!0;this._blitRenderer=new d;var t=v.stencil.attributes,i=x.createProgram(e,v.stencil);if(!i)return!1;var n=m.createVertex(e,35040,32),r=new Uint16Array([0,1,2,2,1,3]),o=m.createIndex(e,35044,r),a=new T(e,t,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:n},o);return this._clipStencilProgram=i,this._clipVBO=n,this._clipVAO=a,this._clipRendererInitialized=!0,!0},t}(c.Container);t.Stage=w}.apply(null,n))||(e.exports=r)},Nh3O:function(e,t,i){var n,r;n=[i("G/ag"),i("ajsq"),i("kDn6")],void 0===(r=function(e,t,i){e.getObject("string",!0,dojox);var n=t("dojox.string.BidiEngine",i,{inputFormat:"ILYNN",outputFormat:"VLNNN",sourceToTarget:[],targetToSource:[],levels:[],bidiTransform:function(e,t,i){if(this.sourceToTarget=[],this.targetToSource=[],!e)return"";if(A(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(t,i))return e;t=this.inputFormat,i=this.outputFormat;var n=e,o=B,s=C(t.charAt(1)),l=C(i.charAt(1)),u=("I"===t.charAt(0)?"L":t.charAt(0))+s,c=("I"===i.charAt(0)?"L":i.charAt(0))+l,d=t.charAt(2)+i.charAt(2);o.defInFormat=u,o.defOutFormat=c,o.defSwap=d;var f=r(e,u,c,d,o),p=!1;return"R"===i.charAt(1)?p=!0:"C"!==i.charAt(1)&&"D"!==i.charAt(1)||(p=this.checkContextual(f)),this.sourceToTarget=R,this.targetToSource=O(this.sourceToTarget),D=this.targetToSource,n=t.charAt(3)===i.charAt(3)?f:"S"===i.charAt(3)?a(p,f,!0):h(f,p,!0),this.sourceToTarget=R,this.targetToSource=D,this.levels=L,n},_inputFormatSetter:function(e){if(!U.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=e},_outputFormatSetter:function(e){if(!U.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=e},checkParameters:function(e,t){return e?this.set("inputFormat",e):e=this.inputFormat,t?this.set("outputFormat",t):t=this.outputFormat,e!==t},checkContextual:function(e){var t=l(e);if("ltr"!==t&&"rtl"!==t){try{t=document.dir.toLowerCase()}catch(e){}"ltr"!==t&&"rtl"!==t&&(t="ltr")}return t},hasBidiChar:function(e){return k.test(e)}});function r(e,t,i,n,a){var s=o(e,{inFormat:t,outFormat:i,swap:n},a);if(s.inFormat===s.outFormat)return e;t=s.inFormat,i=s.outFormat,n=s.swap;var l=t.substring(0,1),u=t.substring(1,4),h=i.substring(0,1),d=i.substring(1,4);if(a.inFormat=t,a.outFormat=i,a.swap=n,"L"===l&&"VLTR"===i){if("LTR"===u)return a.dir=G,c(e,a);if("RTL"===u)return a.dir=N,c(e,a)}if("V"===l&&"V"===h)return a.dir="RTL"===u?N:G,v(e,a);if("L"===l&&"VRTL"===i)return"LTR"===u?(a.dir=G,e=c(e,a)):(a.dir=N,e=c(e,a)),v(e);if("VLTR"===t&&"LLTR"===i)return a.dir=G,c(e,a);if("V"===l&&"L"===h&&u!==d)return e=v(e),"RTL"===u?r(e,"LLTR","VLTR",n,a):r(e,"LRTL","VRTL",n,a);if("VRTL"===t&&"LRTL"===i)return r(e,"LRTL","VRTL",n,a);if("L"===l&&"L"===h){var f=a.swap;return a.swap=f.substr(0,1)+"N","RTL"===u?(a.dir=N,e=c(e,a),a.swap="N"+f.substr(1,2),a.dir=G,e=c(e,a)):(a.dir=G,e=c(e,a),a.swap="N"+f.substr(1,2),e=r(e,"VLTR","LRTL",a.swap,a)),e}}function o(e,t,i){if(void 0===t.inFormat&&(t.inFormat=i.defInFormat),void 0===t.outFormat&&(t.outFormat=i.defOutFormat),void 0===t.swap&&(t.swap=i.defSwap),t.inFormat===t.outFormat)return t;var n,r=t.inFormat.substring(0,1),o=t.inFormat.substring(1,4),a=t.outFormat.substring(0,1),s=t.outFormat.substring(1,4);return"C"===o.charAt(0)&&(o="ltr"===(n=l(e))||"rtl"===n?n.toUpperCase():"L"===t.inFormat.charAt(2)?"LTR":"RTL",t.inFormat=r+o),"C"===s.charAt(0)&&(s="rtl"===(n=l(e))?"RTL":"ltr"===n?(n=u(e)).toUpperCase():"L"===t.outFormat.charAt(2)?"LTR":"RTL",t.outFormat=a+s),t}function a(e,t,i){if(0!==t.length){void 0===e&&(e=!0),void 0===i&&(i=!0);var n=(t=String(t)).split(""),r=0,o=1,a=n.length;e||(r=n.length-1,o=-1,a=1);for(var l=s(n,r,o,a,i),u="",h=0;h<n.length;h++)i&&_(l,l.length,h)>-1?(P(D,h,!e,-1),R.splice(h,1)):u+=n[h];return u}}function s(e,t,i,n,r){for(var o=0,a=[],s=0,l=t;l*i<n;l+=i)if(m(e[l])||E(e[l])){if(""===e[l]&&y(e,l+i,i,n)){e[l]=F(e[l+i],0===o?W:q),I(e,l+=i,i,n),r&&(a[s]=l,s++),o=0;continue}var u=e[l];1===o?e[l]=g(e,l+i,i,n)?S(e[l]):M(e[l],Y):!0===g(e,l+i,i,n)?e[l]=M(e[l],Q):e[l]=M(e[l],Z),E(u)||(o=1),!0===w(u)&&(o=0)}else o=0;return a}function l(e){var t=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e);return t?t[0]<="z"?"ltr":"rtl":""}function u(e){var t=e.split("");return t.reverse(),l(t.join(""))}function h(e,t,i){if(0!==e.length){void 0===i&&(i=!0),void 0===t&&(t=!0);var n,r="";n=(e=String(e)).split("");for(var o=0;o<e.length;o++){var a=!1;if(n[o]>=""&&n[o]<"\ufeff"){var s=e.charCodeAt(o);n[o]>=""&&n[o]<=""?(t?(o>0&&i&&" "===n[o-1]?r=r.substring(0,r.length-1)+"":(r+="",a=!0),r+=j[(s-65269)/2]):(r+=j[(s-65269)/2],r+="",o+1<e.length&&i&&" "===n[o+1]?o++:a=!0),a&&(P(D,o,!0,1),R.splice(o,0,R[o]))):r+=$[s-65136]}else r+=n[o]}return r}}function c(e,t){var i=e.split(""),n=[];return d(i,n,t),p(i,n,t),x(2,i,n,t),x(1,i,n,t),L=n,i.join("")}function d(e,t,i){var n,r,o,a=e.length,s=i.dir?ne:ie,l=null,u=null,h=null,c=0,d=null,p=-1,v=null,_=null,m=[],g=[];for(i.hiLevel=i.dir,i.lastArabic=!1,i.hasUbatAl=!1,i.hasUbatB=!1,i.hasUbatS=!1,v=0;v<a;v++)m[v]=(n=e[v],r=void 0,o=void 0,r=n.charCodeAt(0),(o=me[r>>8])<_e?o:ge[o-_e][255&r]);for(_=0;_<a;_++){if(l=c,g[_]=u=b(e,m,g,_,i),d=240&(c=s[l][u]),c&=15,t[_]=h=s[c][V],d>0)if(16===d){for(v=p;v<_;v++)t[v]=1;p=-1}else p=-1;if(s[c][z])-1===p&&(p=_);else if(p>-1){for(v=p;v<_;v++)t[v]=h;p=-1}m[_]===ue&&(t[_]=0),i.hiLevel|=h}i.hasUbatS&&f(m,t,a,i)}function f(e,t,i,n){for(var r=0;r<i;r++)if(e[r]===he){t[r]=n.dir;for(var o=r-1;o>=0&&e[o]===de;o--)t[o]=n.dir}}function p(e,t,i){if(0!==i.hiLevel&&i.swap.substr(0,1)!==i.swap.substr(1,2))for(var n=0;n<e.length;n++)1===t[n]&&(e[n]=T(e[n]))}function v(e,t){var i=e.split("");if(t){var n=[];d(i,n,t),L=n}return i.reverse(),R.reverse(),i.join("")}function _(e,t,i){for(var n=0;n<t;n++)if(e[n]===i)return n;return-1}function m(e){for(var t=0;t<ee.length;t++)if(e>=ee[t]&&e<=te[t])return!0;return!1}function g(e,t,i,n){for(;t*i<n&&E(e[t]);)t+=i;return!!(t*i<n&&m(e[t]))}function y(e,t,i,n){for(;t*i<n&&E(e[t]);)t+=i;var r=" ";if(!(t*i<n))return!1;r=e[t];for(var o=0;o<j.length;o++)if(j[o]===r)return!0;return!1}function x(e,t,i,n){if(!(n.hiLevel<e)){if(1===e&&n.dir===N&&!n.hasUbatB)return t.reverse(),void R.reverse();for(var r,o,a,s,l=t.length,u=0;u<l;){if(i[u]>=e){for(r=u+1;r<l&&i[r]>=e;)r++;for(o=u,a=r-1;o<a;o++,a--)s=t[o],t[o]=t[a],t[a]=s,s=R[o],R[o]=R[a],R[a]=s;u=r}u++}}}function b(e,t,i,n,r){var o=t[n];return{UBAT_L:function(){return r.lastArabic=!1,re},UBAT_R:function(){return r.lastArabic=!1,oe},UBAT_ON:function(){return le},UBAT_AN:function(){return se},UBAT_EN:function(){return r.lastArabic?se:ae},UBAT_AL:function(){return r.lastArabic=!0,r.hasUbatAl=!0,oe},UBAT_WS:function(){return le},UBAT_CS:function(){var e,o;return n<1||n+1>=t.length||(e=i[n-1])!==ae&&e!==se||(o=t[n+1])!==ae&&o!==se?le:(r.lastArabic&&(o=se),o===e?o:le)},UBAT_ES:function(){return(n>0?i[n-1]:ue)===ae&&n+1<t.length&&t[n+1]===ae?ae:le},UBAT_ET:function(){if(n>0&&i[n-1]===ae)return ae;if(r.lastArabic)return le;for(var e=n+1,o=t.length;e<o&&t[e]===fe;)e++;return e<o&&t[e]===ae?ae:le},UBAT_NSM:function(){if("VLTR"===r.inFormat){for(var o=t.length,a=n+1;a<o&&t[a]===pe;)a++;if(a<o){var s=e[n],l=s>=1425&&s<=2303||64286===s,u=t[a];if(l&&(u===oe||u===ce))return oe}}return n<1||t[n-1]===ue?le:i[n-1]},UBAT_B:function(){return r.lastArabic=!0,r.hasUbatB=!0,r.dir},UBAT_S:function(){return r.hasUbatS=!0,le},UBAT_LRE:function(){return r.lastArabic=!1,le},UBAT_RLE:function(){return r.lastArabic=!1,le},UBAT_LRO:function(){return r.lastArabic=!1,le},UBAT_RLO:function(){return r.lastArabic=!1,le},UBAT_PDF:function(){return r.lastArabic=!1,le},UBAT_BN:function(){return le}}[ve[o]]()}function T(e){for(var t,i=0,n=H.length-1;i<=n;)if(t=Math.floor((i+n)/2),e<H[t][0])n=t-1;else{if(!(e>H[t][0]))return H[t][1];i=t+1}return e}function w(e){for(var t=0;t<J.length;t++)if(J[t]===e)return!0;return!1}function S(e){for(var t=0;t<X.length;t++)if(e===X[t])return K[t];return e}function M(e,t){for(var i=0;i<X.length;i++)if(e===X[i])return t[i];return e}function E(e){return e>=""&&e<=""}function C(e){return"L"===e?"LTR":"R"===e?"RTL":"C"===e?"CLR":"D"===e?"CRL":void 0}function I(e,t,i,n){for(;t*i<n&&E(e[t]);)t+=i;return t*i<n&&(e[t]=" ",!0)}function F(e,t){for(var i=0;i<j.length;i++)if(e===j[i])return t[i];return e}function A(e,t,i){R=[],L=[];for(var n=0;n<i;n++)e[n]=n,t[n]=n,R[n]=n}function O(e){for(var t=new Array(e.length),i=0;i<e.length;i++)t[e[i]]=i;return t}function P(e,t,i,n){for(var r=0;r<e.length;r++)(e[r]>t||!i&&e[r]===t)&&(e[r]+=n)}var R=[],D=[],L=[],B={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1},V=5,z=6,G=0,N=1,U=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,k=/[\u0591-\u06ff\ufb1d-\ufefc]/,H=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],j=["","","",""],W=["","","",""],q=["","","",""],X=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Z=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Y=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],K=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Q=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],J=["","","","","","","","","","","","",""],$=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],ee=["",""],te=["",""],ie=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ne=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],re=0,oe=1,ae=2,se=3,le=4,ue=5,he=6,ce=7,de=8,fe=11,pe=12,ve=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],_e=100,me=[_e+0,re,re,re,re,_e+1,_e+2,_e+3,oe,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,_e+4,le,le,le,re,le,re,le,re,le,le,le,re,re,le,le,re,re,re,re,re,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,re,re,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,re,re,le,le,re,re,le,le,re,re,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,re,re,re,_e+5,ce,ce,_e+6,_e+7],ge=[[18,18,18,18,18,18,18,18,18,he,ue,he,de,ue,18,18,18,18,18,18,18,18,18,18,18,18,18,18,ue,ue,ue,he,de,le,le,fe,fe,fe,le,le,le,le,le,10,9,10,9,9,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,9,le,le,le,le,le,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,le,le,le,le,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,le,le,le,18,18,18,18,18,18,ue,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,le,fe,fe,fe,fe,le,le,le,le,re,le,le,18,le,le,fe,fe,ae,ae,le,re,le,le,le,ae,re,le,le,le,le,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,le,le,le,le,le,le,le,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,le,re,re,re,re,re,re,re,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,re,le,le,le,le,le,le,le,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,oe,pe,oe,pe,pe,oe,pe,pe,oe,pe,le,le,le,le,le,le,le,le,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,le,le,le,le,le,oe,oe,oe,oe,oe,le,le,le,le,le,le,le,le,le,le,le],[se,se,se,se,le,le,le,le,ce,fe,fe,ce,9,ce,le,le,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,ce,le,le,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,se,se,se,se,se,se,se,se,se,se,fe,se,se,ce,ce,ce,pe,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,pe,pe,pe,pe,pe,pe,pe,se,le,pe,pe,pe,pe,pe,pe,ce,ce,pe,pe,le,pe,pe,pe,pe,ce,ce,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ce,ce,ce,ce,ce,ce],[ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,le,ce,ce,pe,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,le,le,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,ce,le,le,le,le,le,le,le,le,le,le,le,le,le,le,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,pe,pe,pe,pe,pe,pe,pe,pe,pe,oe,oe,le,le,le,le,oe,le,le,le,le,le],[de,de,de,de,de,de,de,de,de,de,de,18,18,18,re,oe,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,de,ue,13,14,15,16,17,9,fe,fe,fe,fe,fe,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,9,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,de,18,18,18,18,18,le,le,le,le,le,18,18,18,18,18,18,ae,re,le,le,ae,ae,ae,ae,ae,ae,10,10,le,le,le,re,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,10,10,le,le,le,le,re,re,re,re,re,re,re,re,re,re,re,re,re,le,le,le,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le],[re,re,re,re,re,re,re,le,le,le,le,le,le,le,le,le,le,le,le,re,re,re,re,re,le,le,le,le,le,oe,pe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,10,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,le,oe,oe,oe,oe,oe,le,oe,le,oe,oe,le,oe,oe,le,oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce],[pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,pe,pe,pe,pe,pe,pe,pe,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,9,le,9,le,le,9,le,le,le,le,le,le,le,le,le,fe,le,le,10,10,le,le,le,le,le,fe,fe,le,le,le,le,le,ce,ce,ce,ce,ce,le,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,le,le,18],[le,le,le,fe,fe,fe,le,le,le,le,le,10,9,10,9,9,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,9,le,le,le,le,le,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,le,le,le,le,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,le,le,le,le,le,le,le,le,le,le,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,le,le,le,re,re,re,re,re,re,le,le,re,re,re,re,re,re,le,le,re,re,re,re,re,re,le,le,re,re,re,le,le,le,fe,fe,le,le,le,fe,fe,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le,le]];return n}.apply(null,n))||(e.exports=r)},Nwkb:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("QFi0"),i("z2+Q")],void 0===(r=function(e,t,i,n,r){return function(){function e(e,t){this.rctx=e,this._vertexBuffer=n.createVertex(e,35044,new Uint16Array(t)),this._vao=new r(e,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}return e.prototype.bind=function(){this._vao.bind()},e.prototype.unbind=function(){this._vao.unbind()},e.prototype.dispose=function(){this._vao.dispose(!1),this._vertexBuffer.dispose()},e.prototype.draw=function(){this.rctx.drawArrays(5,0,4)},e}()}.apply(null,n))||(e.exports=r)},O7NG:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("TPlk")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.vec4f64=i}.apply(null,n))||(e.exports=r)},"OO/B":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("2Atf"),i("H1tY"),i("FXVB"),i("oZZu"),i("0LE5"),i("vlC2"),i("+P5t"),i("JNkf"),i("pvXx"),i("eprR"),i("apbF"),i("Nwkb"),i("66cO"),i("p2sx"),i("8fgo"),i("f93k"),i("gvME"),i("2pwJ"),i("3u8V"),i("H2OT"),i("nL6+"),i("/f24"),i("U+8K")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d,f,p,v,_,m,g,y,x,b,T,w,S){Object.defineProperty(t,"__esModule",{value:!0});var M=function(){function e(){this._initialized=!1}return e.prototype.registerPass=function(e,t){this._initialize();for(var i=0;i<u.WGLDrawPhase.NUM_DRAW_PHASES-2;i++){var n=1<<i;n&t&&this._passMap.set(n,e)}return this},e.prototype.getPaintPassTs=function(e){return this._initialize(),this._passMap.has(e)?[this._passMap.get(e)]:[]},e.prototype._initialize=function(){this._initialized||(this._passMap=new Map,this._initialized=!0)},e}();t.PainterOptions=M;var E=new Uint8Array(4*d.C_HITTEST_SEARCH_SIZE*d.C_HITTEST_SEARCH_SIZE),C=new Uint32Array(E.buffer),I=s.vec3f32.create(),F=[0,0],A=function(){function e(e){this.context=e,this._hlPainter=new b.default,this._blitRenderer=new l,this._globalOpacityFBO=null,this._boundFBO=null,this.textureManager=new c,this.stencilRef=-1,this.materialManager=new h(e),this._quadVertexStream=new f(e,[0,0,1,0,0,1,1,1]),this._transformTextureProgram=S.createProgram(e,T.transformTexture),this._transformSolidProgram=S.createProgram(e,T.transformSolid),this._transform=o.mat4f32.create()}return e.prototype.dispose=function(){this.materialManager.dispose(),this.textureManager.dispose(),this._hlPainter&&(this._hlPainter.dispose(),this._hlPainter=null),this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null),this._globalOpacityFBO&&(this._globalOpacityFBO.dispose(),this._globalOpacityFBO=null),this._boundFBO=null,this._hittestFBO&&(this._hittestFBO.dispose(),this._hittestFBO=null),this._passes&&(this._passes.forEach(function(e){return e.dispose()}),this._passes.clear()),this._brushes&&(this._brushes.forEach(function(e){return e.forEach(function(e){return e.dispose()})}),this._brushes.clear()),this._geometryBrushes&&(this._geometryBrushes.forEach(function(e){return e.dispose()}),this._geometryBrushes.clear()),this._quadVertexStream.dispose()},e.prototype.getBrushes=function(e){if(e===u.WGLDrawPhase.MAP)throw new Error("Painter: Tried to get brush for the MAP phase; use a specific geometry type and call getMapBrush() instead.");if(!this._brushes){var t=[this.getGeometryBrush(u.WGLGeometryType.FILL),this.getGeometryBrush(u.WGLGeometryType.LINE),this.getGeometryBrush(u.WGLGeometryType.MARKER),this.getGeometryBrush(u.WGLGeometryType.TEXT)],i=new m.default,n=new p.default,r=new v.default;this._brushes=new Map,this._brushes.set(u.WGLDrawPhase.LABEL,[i]),this._brushes.set(u.WGLDrawPhase.LABEL_ALPHA,[i]),this._brushes.set(u.WGLDrawPhase.HITTEST,t),this._brushes.set(u.WGLDrawPhase.HIGHLIGHT,t),this._brushes.set(u.WGLDrawPhase.CLIP,[r]),this._brushes.set(u.WGLDrawPhase.DEBUG,[n])}if(!this._brushes.has(e))throw new Error("Painter: Tried to get brush for unknown phase: "+e);return this._brushes.get(e)},e.prototype.getGeometryBrush=function(e){if(!this._geometryBrushes){var t=new _.default,i=new g.default,n=new y.default,r=new x.default,o=new m.default;this._geometryBrushes=new Map,this._geometryBrushes.set(u.WGLGeometryType.FILL,t),this._geometryBrushes.set(u.WGLGeometryType.LINE,i),this._geometryBrushes.set(u.WGLGeometryType.MARKER,n),this._geometryBrushes.set(u.WGLGeometryType.TEXT,r),this._geometryBrushes.set(u.WGLGeometryType.LABEL,o)}return this._geometryBrushes.get(e)},e.prototype.draw=function(e,t,i,n){this._setGlobalOpacity(e,i),0==(i&(u.WGLDrawPhase.LABEL_ALPHA|u.WGLDrawPhase.LABEL))&&this._drawClippingRects(e,t);var r=this.context;r.setBlendingEnabled(!0),r.setStencilWriteMask(0),r.setBlendFunctionSeparate(1,771,1,771),this._drawPhases(e,t,i,n),this._applyGlobalOpacity(e,i),this._debugTiles(e,t)},e.prototype.highlight=function(e,t){var i=this.context,n=i.getViewport();this._hlPainter.setup(i,n.width,n.height),this._hlPainter.startMaskDraw(i),this._drawClippingRects(e,t),i.setBlendingEnabled(!0),i.setStencilWriteMask(0),i.setBlendFunctionSeparate(1,771,1,771),this._drawPhases(e,t,u.WGLDrawPhase.HIGHLIGHT),this._hlPainter.draw(i)},e.prototype.setHighlightOptions=function(e){this._hlPainter.setHighlightOptions(e)},e.prototype.hitTest=function(e,t){var i=this.context,n=d.C_HITTEST_SEARCH_SIZE,r=[0,0],o=[0,0],a=e.state;if(a.toMap(r,[0,0]),a.toMap(o,[n,n]),0===t.filter(function(e){return!(r[0]>e.bounds[2]||o[0]<e.bounds[0]||r[1]<e.bounds[1]||o[1]>e.bounds[3])}).length)return[];this._hittestFBO||(this._hittestFBO=w.create(i,{colorTarget:0,depthStencilTarget:3,width:n,height:n}));var s=i.getViewport(),l=i.getBoundFramebufferObject();i.bindFramebuffer(this._hittestFBO),i.setViewport(0,0,n,n),this._drawClippingRects(e,t);var h=i.gl;i.setClearColor(1,1,1,1),i.clear(h.COLOR_BUFFER_BIT),i.setBlendingEnabled(!1),i.setStencilWriteMask(0),this._drawPhases(e,t,u.WGLDrawPhase.HITTEST),i.setBlendingEnabled(!0),this._hittestFBO.readPixels(0,0,n,n,6408,5121,E);for(var c=n*n,f=new Set,p=0;p<c;p++){var v=C[p];4294967295!==v&&f.add(v)}i.bindFramebuffer(l),i.setViewport(s.x,s.y,s.width,s.height);var _=[];return f.forEach(function(e){_.push(e)}),_},e.prototype.startStencilBurn=function(){this.context.setStencilTestEnabled(!0),this.context.setStencilWriteMask(255),this.context.setClearStencil(0),this.context.clear(this.context.gl.STENCIL_BUFFER_BIT),this.context.setStencilOp(7680,7680,7681),this.context.setColorMask(!1,!1,!1,!1),this.context.setBlendingEnabled(!1),this._quadVertexStream.bind(),this.context.bindProgram(this._transformSolidProgram)},e.prototype.startStencilDraw=function(){this.context.setStencilWriteMask(0),this.context.setStencilOp(7680,7680,7680),this.context.setColorMask(!0,!0,!0,!0),this.context.setBlendingEnabled(!0),this.context.setBlendFunction(1,771),this._quadVertexStream.bind(),this.context.bindProgram(this._transformTextureProgram)},e.prototype.endStencilDraw=function(){this.context.setStencilTestEnabled(!1),this._quadVertexStream.unbind(),this.context.bindProgram()},e.prototype.drawBitmap=function(e,t,i){var n=this.context,o=e.state,s=-Math.PI*o.rotation/180,l=-Math.PI*t.rotation/180;!(s+t.rotation)&&i<1.05&&.95<i?t.setSamplingMode(9728):t.setSamplingMode(9729);var h,c=o.toScreen(F,t.x,t.y),d=c[0],f=c[1],p=e.state.size[0],v=e.state.size[1],_=i*t.width,m=i*t.height,g=e.globalOpacity*t.opacity,y=this._transform,x=this._quadVertexStream,b=e.drawPhase;h=b===u.WGLDrawPhase.CLIP?(n.setStencilFunction(519,this.stencilRef,255),this._transformSolidProgram):(n.setStencilFunction(514,this.stencilRef,255),this._transformTextureProgram),r.mat4.identity(y),r.mat4.scale(y,y,a.vec3.set(I,2/p,2/v,1)),r.mat4.translate(y,y,a.vec3.set(I,d-p/2,v/2-f,0)),r.mat4.rotateZ(y,y,s),r.mat4.translate(y,y,a.vec3.set(I,_/2,-m/2,0)),r.mat4.rotateZ(y,y,-l),r.mat4.scale(y,y,a.vec3.set(I,_/2,m/2,1)),h.setUniformMatrix4fv("u_transform",y),b!==u.WGLDrawPhase.CLIP&&(t.bind(0),h.setUniform1i("u_texture",0)),h.setUniform1f("u_opacity",g),x.draw()},e.prototype._getPaintPass=function(e){if(this._passes||(this._passes=new Map),!this._passes.has(e))try{this._passes.set(e,new e)}catch(t){throw new Error("Tried to instantiate WGLPaintPass with unknown constructor: "+e+",\n"+t)}return this._passes.get(e)},e.prototype._getPaintPasses=function(e,t){var i=this;return t.getPaintPassTs(e).map(function(e){return i._getPaintPass(e)})},e.prototype._drawPhases=function(e,t,n,r){var o=this.context;o.setStencilTestEnabled(!0);for(var a=0;a<u.WGLDrawPhase.NUM_DRAW_PHASES-2;a++){var s=1<<a;if(s&n){var l=r?this._getPaintPasses(s,r):[],h=i({},e,{drawPhase:s});l.forEach(function(t){return t.preRender(e,e.rendererInfo)});for(var c=0,d=t;c<d.length;c++)d[c].doRender(h);l.reverse().forEach(function(t){return t.postRender(e,e.rendererInfo)})}}o.setStencilTestEnabled(!1)},e.prototype._debugTiles=function(e,t){n("esri-feature-tiles-debug")&&this._drawPhases(e,t,u.WGLDrawPhase.DEBUG)},e.prototype._drawClippingRects=function(e,t){if(0!==t.length){var i=this.context;i.setDepthWriteEnabled(!1),i.setDepthTestEnabled(!1),i.setStencilTestEnabled(!0),i.setBlendingEnabled(!1),i.setColorMask(!1,!1,!1,!1),i.setStencilOp(7680,7680,7681),i.setClearStencil(0),i.clear(i.gl.STENCIL_BUFFER_BIT),i.setStencilWriteMask(255);for(var n=0,r=t.length;n<t.length;n++,r--){var o=t[n];o.attached&&(o.stencilRef=r)}this._drawPhases(e,t,u.WGLDrawPhase.CLIP),i.setColorMask(!0,!0,!0,!0)}},e.prototype._setGlobalOpacity=function(e,t){if(t===u.WGLDrawPhase.MAP&&1!==e.globalOpacity){var i=e.context,n=e.pixelRatio,r=e.state.size,o=r[0],a=r[1],s=Math.round(o*n),l=Math.round(a*n);null!==this._globalOpacityFBO&&this._globalOpacityFBO.width===s&&this._globalOpacityFBO.height===l||(null!==this._globalOpacityFBO&&this._globalOpacityFBO.dispose(),this._globalOpacityFBO=w.create(i,{colorTarget:0,depthStencilTarget:3,width:s,height:l})),this._boundFBO=i.getBoundFramebufferObject(),i.bindFramebuffer(this._globalOpacityFBO),i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT|i.gl.STENCIL_BUFFER_BIT),i.setDepthWriteEnabled(!1)}},e.prototype._applyGlobalOpacity=function(e,t){if(t===u.WGLDrawPhase.MAP&&1!==e.globalOpacity){var i=e.context;i.bindFramebuffer(this._boundFBO);var n=this._globalOpacityFBO.colorTexture;this._blitRenderer.render(i,n,9728,e.globalOpacity),this._boundFBO=null}},e}();t.default=A}.apply(null,n))||(e.exports=r)},PDSL:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("3+7H"),i("z2+Q")],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.draw=function(e,t){var i=this;if(t.canDisplay){var n=this.getGeometryType(),r=t.getDisplayList(e.drawPhase),o=t.getGeometry(n);o&&r.byType(n,function(n){i.drawGeometry(e,t,n,o)})}},t.prototype._getVAO=function(e,t,i,n){return n.vao||(n.vao=new r(e,i,t,n.vertexBufferMap,n.indexBuffer)),n.vao},t.prototype._setSharedUniforms=function(e,t,i){e.setUniform1f("u_pixelRatio",t.pixelRatio),e.setUniformMatrix3fv("u_dvsMat3",i.dvsMat3),e.setUniformMatrix3fv("u_displayViewMat3",t.state.displayViewMat3),e.setUniformMatrix4fv("u_insideEffectMat4",t.rendererInfo.insideEffect),e.setUniformMatrix4fv("u_outsideEffectMat4",t.rendererInfo.outsideEffect)},t}(n.default);t.default=o}.apply(null,n))||(e.exports=r)},PDtg:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("qKT0"),i("Ebn8"),i("Gtr7"),i("Vx27"),i("oxlp"),i("xI7m"),i("q4Xm"),i("G+IK"),i("Y6jg"),i("UrSa")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d){Object.defineProperty(t,"__esModule",{value:!0});var f=new r({targetGeometry:new s}),p=[0,0],v=function(e){function t(t){var i=e.call(this)||this;return i._endTimer=null,i.animationManager=null,i}return i(t,e),t.prototype.initialize=function(){this.pan=new h({navigation:this}),this.rotate=new d({navigation:this}),this.pinch=new c({navigation:this}),this.zoomBox=new u({view:this.view,navigation:this})},t.prototype.destroy=function(){this.zoomBox.destroy(),this.zoomBox=null,this.animationManager=null},t.prototype.begin=function(){this._set("interacting",!0)},t.prototype.end=function(){var e=this;this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=0),this._endTimer=setTimeout(function(){e._set("interacting",!1)},0)},t.prototype.zoom=function(e,t){if(void 0===t&&(t=this._getDefaultAnchor()),this.stop(),this.begin(),this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return e<1?this.zoomIn(t):this.zoomOut(t);this.setViewpoint(t,e,0,[0,0])},t.prototype.zoomIn=function(e){void 0===e&&(e=this._getDefaultAnchor());var t=this.view,i=t.scale,n=t.constraints.snapToNextScale(i);return t.goTo(this._scaleAndRotateViewpoint(f,e,n/i,0))},t.prototype.zoomOut=function(e){void 0===e&&(e=this._getDefaultAnchor());var t=this.view,i=t.scale,n=t.constraints.snapToPreviousScale(i);return t.goTo(this._scaleAndRotateViewpoint(f,e,n/i,0))},t.prototype.setViewpoint=function(e,t,i,n){this.begin(),this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,e,t,i,n),this.end()},t.prototype.animateViewpoint=function(e,t,i){return this.view.goTo(this._scaleAndRotateViewpoint(f,e,t,i))},t.prototype.continousRotateClockwise=function(){var e=this.get("view.viewpoint");this.animationManager.animateContinous(e,function(e){l.rotateBy(e,e,-1)})},t.prototype.continousRotateCounterclockwise=function(){var e=this.get("view.viewpoint");this.animationManager.animateContinous(e,function(e){l.rotateBy(e,e,1)})},t.prototype.resetRotation=function(){this.view.rotation=0},t.prototype.continousPanLeft=function(){var e=this.get("view.viewpoint");this.animationManager.animateContinous(e,function(e){l.translateBy(e,e,[-10,0])})},t.prototype.continousPanRight=function(){var e=this.get("view.viewpoint");this.animationManager.animateContinous(e,function(e){l.translateBy(e,e,[10,0])})},t.prototype.continousPanUp=function(){var e=this.get("view.viewpoint");this.animationManager.animateContinous(e,function(e){l.translateBy(e,e,[0,10])})},t.prototype.continousPanDown=function(){var e=this.get("view.viewpoint");this.animationManager.animateContinous(e,function(e){l.translateBy(e,e,[0,-10])})},t.prototype.stop=function(){this.pan.stopMomentumNavigation(),this.animationManager.stop(),this.end(),this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=0)},t.prototype._getDefaultAnchor=function(){var e=this.view.size;return p[0]=.5*e[0],p[1]=.5*e[1],p},t.prototype._scaleAndRotateViewpoint=function(e,t,i,n){var r=this.view,o=r.size,a=r.padding,s=r.constraints,u=r.scale,h=r.viewpoint,c=u*i,d=s.canZoomInTo(c),f=s.canZoomOutTo(c);return i<1&&!d||i>1&&!f?h:l.padAndScaleAndRotateBy(e,h,i,n,t,o,a)},t.prototype._scaleRotateTranslateViewpoint=function(e,t,i,n,r){var o=this.view,a=o.size,s=o.padding,u=o.constraints,h=o.scale,c=o.viewpoint,d=h*i,f=u.canZoomInTo(d),p=u.canZoomOutTo(d);return(i<1&&!f||i>1&&!p)&&(i=1),l.translateBy(c,c,r),l.padAndScaleAndRotateBy(e,c,i,n,t,a,s)},n([a.property()],t.prototype,"animationManager",void 0),n([a.property({type:Boolean,readOnly:!0})],t.prototype,"interacting",void 0),n([a.property()],t.prototype,"pan",void 0),n([a.property()],t.prototype,"pinch",void 0),n([a.property()],t.prototype,"rotate",void 0),n([a.property()],t.prototype,"view",void 0),n([a.property()],t.prototype,"zoomBox",void 0),n([a.subclass("esri.views.2d.navigation.MapViewNavigation")],t)}(a.declared(o));t.default=v}.apply(null,n))||(e.exports=r)},PhOF:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("6cAc")],void 0===(r=function(e,t,i){return function(){function e(e,t){this._width=0,this._height=0,this._free=[],this._width=e,this._height=t,this._free.push(new i(0,0,e,t))}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.allocate=function(e,t){if(e>this._width||t>this._height)return new i;for(var n=null,r=-1,o=0;o<this._free.length;++o){var a=this._free[o];e<=a.width&&t<=a.height&&(null===n||a.y<=n.y&&a.x<=n.x)&&(n=a,r=o)}return null===n?new i:(this._free.splice(r,1),n.width<n.height?(n.width>e&&this._free.push(new i(n.x+e,n.y,n.width-e,t)),n.height>t&&this._free.push(new i(n.x,n.y+t,n.width,n.height-t))):(n.width>e&&this._free.push(new i(n.x+e,n.y,n.width-e,n.height)),n.height>t&&this._free.push(new i(n.x,n.y+t,e,n.height-t))),new i(n.x,n.y,e,t))},e.prototype.release=function(e){for(var t=0;t<this._free.length;++t){var i=this._free[t];if(i.y===e.y&&i.height===e.height&&i.x+i.width===e.x)i.width+=e.width;else if(i.x===e.x&&i.width===e.width&&i.y+i.height===e.y)i.height+=e.height;else if(e.y===i.y&&e.height===i.height&&e.x+e.width===i.x)i.x=e.x,i.width+=e.width;else{if(e.x!==i.x||e.width!==i.width||e.y+e.height!==i.y)continue;i.y=e.y,i.height+=e.height}this._free.splice(t,1),this.release(e)}this._free.push(e)},e}()}.apply(null,n))||(e.exports=r)},PwbG:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("apbF")],void 0===(r=function(e,t,i){return function(){function e(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}return e.prototype.clone=function(){for(var t=new e,i=0;i<this.geometries.length;i++){var n=this.geometries[i],r=t.geometries[i];for(var o in r.indexBuffer=n.indexBuffer.slice(),r.vertexBuffer={},n.vertexBuffer){var a=n.vertexBuffer[o],s=a.data,l=a.stride;r.vertexBuffer[o]={data:s.slice(),stride:l}}}return t},e.deserialize=function(t){for(var n=new e,r=0;r<5;++r)for(var o in n.geometries[r].indexBuffer=new Uint32Array(t.geometries[r].indexBuffer),n.geometries[r].vertexBuffer={},t.geometries[r].vertexBuffer)n.geometries[r].vertexBuffer[o]={data:i.allocateTypedArrayBufferwithData(t.geometries[r].vertexBuffer[o].data,t.geometries[r].vertexBuffer[o].stride),stride:t.geometries[r].vertexBuffer[o].stride};return n},e.prototype.serialize=function(){for(var e={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},t=0;t<5;++t)for(var i in this.geometries[t].vertexBuffer)e.geometries[t].vertexBuffer[i]={data:this.geometries[t].vertexBuffer[i].data.buffer,stride:this.geometries[t].vertexBuffer[i].stride};return e},e.prototype.getBuffers=function(){for(var e=[],t=0;t<5;++t)for(var i in e.push(this.geometries[t].indexBuffer.buffer),this.geometries[t].vertexBuffer)e.push(this.geometries[t].vertexBuffer[i].data.buffer);return e},e}()}.apply(null,n))||(e.exports=r)},Rrc3:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("H1tY")],void 0===(r=function(e,t,i){return function(){function e(t,n){this._context=t,this._desc=n,this._glName=null,this._id=-1;var r=this._context.gl;i("esri-webgl-debug")&&this._context.instanceCounter.incrementCount(5),this._id=++e._nextId,this._glName=r.createRenderbuffer(),this._context.bindRenderbuffer(this),r.renderbufferStorage(r.RENDERBUFFER,n.internalFormat,n.width,n.height)}return Object.defineProperty(e.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,t){var i=this._context.gl,n=this._desc;n.width===e&&n.height===t||(n.width=e,n.height=t,this._context.bindRenderbuffer(this),i.renderbufferStorage(i.RENDERBUFFER,n.internalFormat,n.width,n.height))},e.prototype.dispose=function(){this._glName&&(this._context.gl.deleteRenderbuffer(this._glName),this._glName=null),i("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(5),this._context=null},e._nextId=0,e}()}.apply(null,n))||(e.exports=r)},ST29:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("W9tT")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._reference=null}return Object.defineProperty(e.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(e){this.reference&&this.reference.hasData&&(this.reference.isDirty=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reference",{get:function(){return this._reference},set:function(e){this._reference=e},enumerable:!0,configurable:!0}),e.prototype.reset=function(e,t,n){var r=this.reference;if(!r||!r.hasData)return!1;t&&(r.isDirty=!0);for(var o=r.labelMat2d,a=r.labelMat2d[4],s=r.labelMat2d[5],l=0,u=r.displayObjects;l<u.length;l++)for(var h=0,c=u[l].metrics;h<c.length;h++){var d=c[h];n.hasVV()&&d.computeOffset(n.vvEval);var f=d.bounds.center,p=d.bounds.centerT;r.isDirty&&(d.minZoom=-1);var v=i.vec2.copy(p,d.anchor);if(e.rotation?i.vec2.transformMat2d(v,v,o):(p[0]=v[0]+a,p[1]=v[1]+s),i.vec2.add(p,v,f),p[0]+=d.offsetX,p[1]+=d.offsetY,d.boxes)for(var _=0,m=d.boxes;_<m.length;_++){var g=m[_],y=g.center,x=d.anchor,b=g.centerT;i.vec2.add(b,x,y),e.rotation?i.vec2.transformMat2d(b,b,o):(b[0]=b[0]+a,b[1]=b[1]+s)}}return!0},e}();t.default=n}.apply(null,n))||(e.exports=r)},SkDs:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("apbF")],void 0===(r=function(e,t,i){function n(e,t,i){if(!e.allDirty)if(null!=e.from&&null!=e.count){var n=Math.min(e.from,t),r=Math.max(e.from+e.count,t+i)-n;e.from=n,e.count=r}else e.from=t,e.count=i}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._dirties=i.createGeometryData(function(e){return{indices:{from:null,count:null,allDirty:!1}}},function(e,t){return{vertices:{from:null,count:null,allDirty:!1}}})}return e.prototype.markAllClean=function(){for(var e=0,t=this._dirties;e<t.length;e++){var i=t[e];for(var n in i.data.indices.from=null,i.data.indices.count=null,i.data.indices.allDirty=!1,i.buffers)i.buffers[n].data.vertices.from=null,i.buffers[n].data.vertices.count=null,i.buffers[n].data.vertices.allDirty=!1}},e.prototype.markAllDirty=function(){for(var e=0,t=this._dirties;e<t.length;e++){var i=t[e];for(var n in i.data.indices.allDirty=!0,i.buffers)i.buffers[n].data.vertices.allDirty=!0}},e.prototype.forEach=function(e){for(var t=0;t<this._dirties.length;++t){var i=this._dirties[t],n={};for(var r in i.buffers){var o=i.buffers[r].data.vertices;(o.allDirty||null!=o.from&&null!=o.count&&0<o.count)&&(n[r]=o)}var a,s=i.data.indices;((a=s.allDirty||null!=s.from&&null!=s.count&&0<s.count?{indices:s,vertices:n}:{indices:null,vertices:n}).indices||0<Object.keys(a).length)&&e(a,t)}},e.prototype.markDirtyIndices=function(e,t,i){n(this._dirties[e].data.indices,t,i)},e.prototype.markDirtyVertices=function(e,t,i,r){n(this._dirties[e].buffers[t].data.vertices,i,r)},e}();t.default=r}.apply(null,n))||(e.exports=r)},Sq9p:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("H1tY"),i("Zry2"),i("apbF")],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0});var o=["FILL","LINE","MARKER","TEXT","LABEL"],a=function(){function e(e,t,i,o){for(var a in this._strides=e,this._displayList=t,this._freeListsAndStorage={},this._dirtyMap=null,this._dirtyMap=i,e)for(var s in this._freeListsAndStorage[a]={vtxFreeList:o?new n.FreeList(o):null,idxFreeList:o?new n.FreeList(o):null,vertexBuffers:{},indexBuffer:o?new Uint32Array(o):null},e[a])this._freeListsAndStorage[a].vertexBuffers[s]={data:o?r.allocateTypedArrayBuffer(o,e[a][s]):null,stride:e[a][s]}}return e.fromTileData=function(t,i){var a=function(e){var t=e.getStrides(),i={};for(var n in t)i[o[n]]=t[n];return i}(t),s=[0,0,0,0,0],l=[0,0,0,0,0],u=[];t.tileDisplayData.displayObjectRegistry.forEach(function(e){u.push(e)});for(var h=0,c=u;h<c.length;h++)for(var d=0,f=c[h].displayRecords;d<f.length;d++){var p=f[d];s[p.geometryType]=Math.max(s[p.geometryType],p.vertexFrom+p.vertexCount),l[p.geometryType]=Math.max(l[p.geometryType],p.indexFrom+p.indexCount)}for(var v=new e(a,t.tileDisplayData.displayList,i,null),_=0;_<t.tileBufferData.geometries.length;++_){var m=s[_],g=l[_],y=t.tileBufferData.geometries[_],x=o[_],b=v._storageFor(x),T=t.tileBufferData.geometries[_].indexBuffer;b.indexBuffer=T,b.idxFreeList=new n.FreeList(T.length),b.idxFreeList.allocate(g);var w=void 0;for(var S in y.vertexBuffer){var M=t.tileBufferData.geometries[_].vertexBuffer[S];b.vertexBuffers[S].data=M.data,b.vertexBuffers[S].stride=M.stride;var E=r.strideToPackingFactor(M.stride),C=M.data.length*E/M.stride;w||(w=C)}b.vtxFreeList=new n.FreeList(w),b.vtxFreeList.allocate(m)}return v},e.prototype.delete=function(e){var t=o[e.geometryType];this._freeVertices(t,e.vertexFrom,e.vertexCount),this._freeIndices(t,e.indexFrom,e.indexCount),this._displayList.removeFromList(e),e.vertexFrom=void 0,e.indexFrom=void 0},e.prototype.setMeshData=function(e,t,i,n,a){var s=o[e.geometryType];e.meshData=null;var l=void 0,u=void 0;void 0===e.vertexFrom?(u=t.vertexCount,l=this._allocateVertices(s,u)):t.vertexCount>e.vertexCount?(this._freeVertices(s,e.vertexFrom,e.vertexCount),u=t.vertexCount,l=this._allocateVertices(s,u)):u=t.vertexCount===e.vertexCount?(l=e.vertexFrom,e.vertexCount):(this._freeVertices(s,e.vertexFrom+t.vertexCount,e.vertexCount-t.vertexCount),l=e.vertexFrom,t.vertexCount);var h=!0,c=void 0,d=void 0,f=void 0;if(void 0===e.indexFrom?(c=a,f=t.indexCount,d=this._allocateIndices(s,f)):t.indexCount>e.indexCount?(c=this._displayList.removeFromList(e),this._freeIndices(s,e.indexFrom,e.indexCount),f=t.indexCount,d=this._allocateIndices(s,f)):f=t.indexCount===e.indexCount?(h=!1,d=e.indexFrom,e.indexCount):(c=this._displayList.removeFromList(e),this._freeIndices(s,e.indexFrom+t.indexCount,e.indexCount-t.indexCount),d=e.indexFrom,t.indexCount),-1===l||-1===d)return-1!==l&&this._freeVertices(s,l,u),-1!==d&&this._freeIndices(s,d,f),e.setMeshDataFromBuffers(t,i,n),e.vertexFrom=void 0,e.vertexCount=0,e.indexFrom=void 0,e.indexCount=0,!1;var p=this._storageFor(s);if(r.copyMeshData(l,d,p.vertexBuffers,p.indexBuffer,t,i,n),e.vertexFrom=l,e.indexFrom=d,e.vertexCount=t.vertexCount,e.indexCount=t.indexCount,this._dirtyMap)for(var v in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),i)this._dirtyMap.markDirtyVertices(e.geometryType,v,e.vertexFrom,e.vertexCount);return h&&this._displayList.addToList(e,c),!0},e.prototype._allocateVertices=function(e,t){var i=this._storageFor(e),n=i.vtxFreeList.allocate(t);return-1===n?-1:.5<i.vtxFreeList.fragmentation?-1:n},e.prototype._freeVertices=function(e,t,n){var o=this._storageFor(e);if(o.vtxFreeList.free(t,n),i("esri-feature-tiles-debug"))for(var a in o.vertexBuffers)for(var s=o.vertexBuffers[a].data,l=this._stridesFor(e,a),u=r.strideToPackingFactor(l),h=t*l/u,c=n*l/u,d=h;d<h+c;++d)s[d]=0},e.prototype._freeIndices=function(e,t,n){var r=this._storageFor(e);if(r.idxFreeList.free(t,n),i("esri-feature-tiles-debug"))for(var o=r.indexBuffer,a=t;a<t+n;++a)o[a]=0},e.prototype._allocateIndices=function(e,t){var i=this._storageFor(e),n=i.idxFreeList.allocate(t);return-1===n?-1:.5<i.idxFreeList.fragmentation?-1:n},e.prototype._storageFor=function(e){return this._freeListsAndStorage[e]},e.prototype._stridesFor=function(e,t){return this._strides[e][t]},e}();t.default=a}.apply(null,n))||(e.exports=r)},TCFx:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(){this._instanceCount={textureCount:0,bufferCount:0,vaoCount:0,programCount:0,framebufferCount:0,renderBufferCount:0}}return e.prototype.incrementCount=function(e){switch(e){case 0:this._instanceCount.textureCount++;break;case 1:this._instanceCount.bufferCount++;break;case 2:this._instanceCount.vaoCount++;break;case 3:this._instanceCount.programCount++;break;case 4:this._instanceCount.framebufferCount++;break;case 5:this._instanceCount.renderBufferCount++}},e.prototype.decrementCount=function(e){switch(e){case 0:this._instanceCount.textureCount--;break;case 1:this._instanceCount.bufferCount--;break;case 2:this._instanceCount.vaoCount--;break;case 3:this._instanceCount.programCount--;break;case 4:this._instanceCount.framebufferCount--;break;case 5:this._instanceCount.renderBufferCount--}},e.prototype.printResourceCount=function(){},e}()}.apply(null,n))||(e.exports=r)},TEGq:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("hPTP")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.highlight={name:"highlight",shaders:{vertexShader:i.resolveIncludes("highlight/textured.vert"),fragmentShader:i.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,a_texcoord:1}},t.blur={name:"blur",shaders:{vertexShader:i.resolveIncludes("highlight/textured.vert"),fragmentShader:i.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}}.apply(null,n))||(e.exports=r)},TF9k:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("ked+"),i("ST29")],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.neighbors=new Array(9),this._tiles=new Array(t);for(var i=0;i<t;i++)this._tiles[i]=new n.default;this.key=e}return Object.defineProperty(e.prototype,"isDirty",{get:function(){for(var e=0,t=this._tiles;e<t.length;e++)if(t[e].dirty)return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0}),e.prototype.getTile=function(e){return this._tiles[e]},e.prototype.getReference=function(e){var t=this._tiles[e];return t&&t.reference},e.prototype.onRegisterLayer=function(e){this.invalidateRange(e),this._add(e)},e.prototype.onUnregisterLayer=function(e){this.invalidateRange(e),this._remove(e)},e.prototype.onLabelsRendered=function(){},e.prototype.invalidateRange=function(e){for(var t=e;t<this._tiles.length;t++)this._tiles[t].dirty=!0},e.prototype.add=function(e){this._add(e)},e.prototype.remove=function(e){this._remove(e)},e.prototype.canDelete=function(){return 0===this._tiles.length},e.prototype.ready=function(){for(var e=0,t=this._tiles;e<t.length;e++)t[e].dirty=!1},e.prototype.computeNeighbors=function(e){this.neighbors[0]=this._getNeighbor(e,-1,-1),this.neighbors[1]=this._getNeighbor(e,0,-1),this.neighbors[2]=this._getNeighbor(e,1,-1),this.neighbors[3]=this._getNeighbor(e,-1,0),(this.neighbors[4]=this).neighbors[5]=this._getNeighbor(e,1,0),this.neighbors[6]=this._getNeighbor(e,-1,1),this.neighbors[7]=this._getNeighbor(e,0,1),this.neighbors[8]=this._getNeighbor(e,1,1)},e.prototype.reset=function(e,t,i){for(var n=0,r=this._tiles;n<r.length;n++){var o=r[n];o&&o.reset(e,t,i)}},e.prototype._add=function(e){var t=[];if(e>=this._tiles.length)this._tiles.push(new n.default);else{for(var i=0;i<this._tiles.length;i++)i===e&&t.push(new n.default),t.push(this._tiles[i]);this._tiles=t}},e.prototype._remove=function(e){for(var t=[],i=0;i<this._tiles.length;i++)i!==e&&t.push(this._tiles[i]);this._tiles=t},e.prototype._getNeighbor=function(e,t,n){var r=this.key,o=r.col+t,a=r.row+n,s=r.level,l=r.world,u=i.TileKey.getId(s,a,o,l);return e.has(u)?e.get(u):null},e}();t.default=r}.apply(null,n))||(e.exports=r)},TPlk:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){function i(){return[0,0,0,0]}Object.defineProperty(t,"__esModule",{value:!0}),t.create=i,t.clone=function(e){return[e[0],e[1],e[2],e[3]]},t.fromValues=function(e,t,i,n){return[e,t,i,n]},t.fromArray=function(e){for(var t=[0,0,0,0],i=Math.min(4,e.length),n=0;n<i;++n)t[n]=e[n];return t},t.createView=function(e,t){return new Float64Array(e,t,4)}}.apply(null,n))||(e.exports=r)},TQvW:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("hPTP")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.background={name:"background",shaders:{vertexShader:i.resolveIncludes("background/background.vert"),fragmentShader:i.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},U6iw:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("7laH")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.load=function(e,t){if(t.disjointTimerQuery)return null;var n=e.getExtension("EXT_disjoint_timer_query")||e.getExtension("EXT_disjoint_timer_query_webgl2");return n?i.default(e)?{createQuery:function(){return e.createQuery()},resultAvailable:function(t){return e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE)},getResult:function(t){return e.getQueryParameter(t,e.QUERY_RESULT)},disjoint:function(){return e.getParameter(n.GPU_DISJOINT_EXT)},beginTimeElapsed:function(t){return e.beginQuery(n.TIME_ELAPSED_EXT,t)},endTimeElapsed:function(){return e.endQuery(n.TIME_ELAPSED_EXT)},createTimestamp:function(e){return n.queryCounterEXT(e,n.TIMESTAMP_EXT)},timestampBits:function(){return e.getQuery(n.TIMESTAMP_EXT,n.QUERY_COUNTER_BITS_EXT)}}:{createQuery:function(){return n.createQueryEXT()},resultAvailable:function(e){return n.getQueryObjectEXT(e,n.QUERY_RESULT_AVAILABLE_EXT)},getResult:function(e){return n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)},disjoint:function(){return e.getParameter(n.GPU_DISJOINT_EXT)},beginTimeElapsed:function(e){return n.beginQueryEXT(n.TIME_ELAPSED_EXT,e)},endTimeElapsed:function(){return n.endQueryEXT(n.TIME_ELAPSED_EXT)},createTimestamp:function(e){return n.queryCounterEXT(e,n.TIMESTAMP_EXT)},timestampBits:function(){return n.getQueryEXT(n.TIMESTAMP_EXT,n.QUERY_COUNTER_BITS_EXT)}}:null}}.apply(null,n))||(e.exports=r)},UJGa:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("qsST"),i("tI6k"),i("dtEy"),i("Zp3t")],void 0===(r=function(e,t,i,n,r,o){Object.defineProperty(t,"__esModule",{value:!0});var a=i.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),s=[0,0,0,0],l=function(){function e(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:r.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:r.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:r.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:r.HIGHLIGHT_SIZING.outerHaloWidth},this.shadeTexChanged=!0,this.texelData=new Uint8Array(4*r.SHADE_TEXTURE_SIZE),this.minMaxDistance=[0,0]}return e.prototype.setHighlightOptions=function(e){var t,i,n,o;n=e,(o=this._convertedHighlightOptions).outlineColor[0]=o.fillColor[0]=n.color.r/255,o.outlineColor[1]=o.fillColor[1]=n.color.g/255,o.outlineColor[2]=o.fillColor[2]=n.color.b/255,o.outlineColor[3]=o.fillColor[3]=n.color.a,o.fillColor[3]*=n.fillOpacity,o.outlineColor[3]*=n.haloOpacity,o.fillColor[0]*=o.fillColor[3],o.fillColor[1]*=o.fillColor[3],o.fillColor[2]*=o.fillColor[3],o.outlineColor[0]*=o.outlineColor[3],o.outlineColor[1]*=o.outlineColor[3],o.outlineColor[2]*=o.outlineColor[3],o.outlineWidth=r.HIGHLIGHT_SIZING.outlineWidth,o.outerHaloWidth=r.HIGHLIGHT_SIZING.outerHaloWidth,o.innerHaloWidth=r.HIGHLIGHT_SIZING.innerHaloWidth,o.outlinePosition=r.HIGHLIGHT_SIZING.outlinePosition;var l,u=this._convertedHighlightOptions.outlinePosition-this._convertedHighlightOptions.outlineWidth/2-this._convertedHighlightOptions.outerHaloWidth,h=this._convertedHighlightOptions.outlinePosition-this._convertedHighlightOptions.outlineWidth/2,c=this._convertedHighlightOptions.outlinePosition+this._convertedHighlightOptions.outlineWidth/2,d=this._convertedHighlightOptions.outlinePosition+this._convertedHighlightOptions.outlineWidth/2+this._convertedHighlightOptions.innerHaloWidth,f=Math.sqrt(Math.PI/2)*r.SIGMAS[3],p=Math.abs(u)>f?Math.round(10*(Math.abs(u)-f))/10:0,v=Math.abs(d)>f?Math.round(10*(Math.abs(d)-f))/10:0;p&&!v?a.error("The outer rim of the highlight is "+p+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!p&&v?a.error("The inner rim of the highlight is "+v+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):p&&v&&a.error("The highlight is "+Math.max(p,v)+"px away from the edge of the feature; consider reducing some width values.");var _=[void 0,void 0,void 0,void 0];function m(e,t,i){_[0]=(1-i)*e[0]+i*t[0],_[1]=(1-i)*e[1]+i*t[1],_[2]=(1-i)*e[2]+i*t[2],_[3]=(1-i)*e[3]+i*t[3]}for(var g=this.texelData,y=0;y<r.SHADE_TEXTURE_SIZE;++y)(l=u+y/(r.SHADE_TEXTURE_SIZE-1)*(d-u))<u?(_[4*y+0]=0,_[4*y+1]=0,_[4*y+2]=0,_[4*y+3]=0):l<h?m(s,this._convertedHighlightOptions.outlineColor,(l-u)/(h-u)):l<c?(t=this._convertedHighlightOptions.outlineColor,_[0]=t[0],_[1]=t[1],_[2]=t[2],_[3]=t[3]):l<d?m(this._convertedHighlightOptions.outlineColor,this._convertedHighlightOptions.fillColor,(l-c)/(d-c)):(i=this._convertedHighlightOptions.fillColor,_[4*y+0]=i[0],_[4*y+1]=i[1],_[4*y+2]=i[2],_[4*y+3]=i[3]),g[4*y+0]=255*_[0],g[4*y+1]=255*_[1],g[4*y+2]=255*_[2],g[4*y+3]=255*_[3];this.minMaxDistance[0]=u,this.minMaxDistance[1]=d,this.shadeTexChanged=!0},e.prototype.applyHighlightOptions=function(e,t){this.shadeTex||(this.shadeTex=new o(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:r.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729})),this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,r.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1),e.bindTexture(this.shadeTex,n.TEXTURE_BINDING_HIGHLIGHT_1),t.setUniform2fv("u_minMaxDistance",this.minMaxDistance)},e.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)},e}();t.default=l}.apply(null,n))||(e.exports=r)},UrSa:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("qKT0"),i("TMur"),i("Ebn8"),i("Gtr7"),i("Vx27"),i("W9tT"),i("DIqE"),i("xI7m")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h){var c=u.vec2f64.create(),d=u.vec2f64.create();return function(e){function t(t){var i=e.call(this,t)||this;return i._previousCenter=u.vec2f64.create(),i.viewpoint=new o({targetGeometry:new r.Point,scale:0,rotation:0}),i}return i(t,e),t.prototype.begin=function(e,t){this.navigation.begin(),l.vec2.set(this._previousCenter,t.center.x,t.center.y)},t.prototype.update=function(e,t){var i=e.state,n=i.size,r=i.padding;l.vec2.set(c,t.center.x,t.center.y),h.getAnchor(d,n,r),e.viewpoint=h.rotateBy(this.viewpoint,e.content.viewpoint,h.angleBetween(d,this._previousCenter,c)),l.vec2.copy(this._previousCenter,c)},t.prototype.end=function(e,t){this.navigation.end()},n([s.property()],t.prototype,"viewpoint",void 0),n([s.property()],t.prototype,"navigation",void 0),n([s.subclass("esri.views.2d.actions.Rotate")],t)}(s.declared(a))}.apply(null,n))||(e.exports=r)},Uu9s:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor = u_color;\n}\n","background.vert":"attribute vec2 a_pos;\n\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n\nvoid main() {\n  vec3 v_pos = u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position = vec4(v_pos.xy, 0.0, 1.0);\n}\n"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\n\nvarying mediump vec2 v_uv;\n\nvoid main() {\n  lowp vec4 color = texture2D(u_tex, v_uv);\n\n  // Note: output in pre-multiplied alpha for correct alpha compositing\n  gl_FragColor = color *  u_opacity;\n}\n","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\n\nvarying mediump vec2 v_uv;\n\nvoid main(void) {\n  gl_Position = vec4(a_pos, 0.0, 1.0);\n  v_uv = a_tex;\n}\n"},highlight:{"blur.frag":"// A gaussian blur shader. It blurs the alpha channel of its input\n// according to 4 different sigma and stores the results into the\n// four channel of the target framebuffer.\n\n// It is intended to be called twice; the first time to perform an\n// horizontal blur, and a second time to perform a vertical blur.\n\n// This shader is used to turn the highlight mask into a highlight\n// map. The highlight map is an approximation of the signed distance\n// field of the mask.\n\n\n// Interpolated texture coordinates.\nvarying mediump vec2 v_texcoord;\n\n// Blur direction information. There are two possible\n// configurations that the host code can use.\n//  - [1, 0, 1/WIDTH, 0] Used when blurring horizontally. In this\n//    case u_direction[0] = 1 is expressed in pixel and is fed to\n//    the gauss function to produce the value of the gaussian weight\n//    for that pixel, while u_direction[2] = 1/WIDTH is in texel units\n//    and is used to sample the right texel from the texture map.\n//  - [0, 1, 0, 1/HEIGHT] Used when blurring vertically. In this\n//    case u_direction[1] = 1 is expressed in pixel and is fed to\n//    the gauss function to produce the value of the gaussian weight\n//    for that pixel, while u_direction[3] = 1/HEIGHT is in texel units\n//    and is used to sample the right texel from the texture map.\nuniform mediump vec4 u_direction;\n\n// Source to destination channel selection matrix.\nuniform mediump mat4 u_channelSelector;\n\n// The highlight map is obtained by blurring the alpha channel of the highlight\n// mask accroding to these 4 values of the gaussian's sigma parameter.\nuniform mediump vec4 u_sigmas;\n\n// This is the highlight mask if we have not blurred horizontally yet, otherwise\n// it is the horizontally blurred highlight map and blurring it one more time\n// vertically will complete the process.\nuniform sampler2D u_texture;\n\n// The gaussian kernel. Note that it lacks the normalization constant, because\n// we want to store it unnormalized in the highlight map (i.e. having a peak\n// value of 1). Note also that we are using the SIMD (single instruction, multiple\n// data) capabilities of the GPU to compute four different gaussian kernels, one\n// for each sigma.\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\n\n// Same as above but uses only channel 3, aka `w`, aka `q`, aka `a`.\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\n\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\n\n// Sample the input texture and accumulated its gaussian weighted value and the\n// total weight; operates on all four channels.\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  // Computes the gaussian weights, one for each sigma.\n  // Note that u_direction.xy is [1, 0] when blurring horizontally and [0, 1] when blurring vertically.\n  mediump vec4 w = gauss4(i * u_direction.xy);\n\n  // Accumumates the values.\n  // Note that u_direction.xy is [1/WIDTH, 0] when blurring horizontally and [0, 1/HEIGHT] when blurring vertically.\n  tot += selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n\n  // Accumulates the weights.\n  weight += w;\n}\n\n// Sample the input texture and accumulated its gaussian weighted value and the\n// total weight; operates on a single channel.\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  // Computes the gaussian weights, using only the last sigma.\n  // Note that u_direction.xy is [1, 0] when blurring horizontally and [0, 1] when blurring vertically.\n  mediump float w = gauss1(i * u_direction.xy);\n\n  // Accumumates the values.\n  // Note that u_direction.xy is [1/WIDTH, 0] when blurring horizontally and [0, 1/HEIGHT] when blurring vertically.\n  tot += selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n\n  // Accumulates the weights.\n  weight += w;\n}\n\nvoid main(void) {\n  // Initialize accumulated values and weights to zero.\n  mediump float tot = 0.0;\n  mediump float weight = 0.0;\n\n  // Accumulates enough samples. These will be taken\n  // horizontally or vertically depending on the value\n  // of u_direction.\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n\n  // Originally we were performing 4 blurs in parallel;\n  // Now we store the only result in the alpha component.\n  // dari8942: In theory we could disable writing to rgb\n  // using a color mask but I don't really feel like messing\n  // with that now.\n  gl_FragColor = vec4(0.0, 0.0, 0.0, tot / weight);\n}\n","highlight.frag":"// Takes as input the highlight map, estimated the signed distance field,\n// and shades the fragments according to their estimated distance from the\n// edge of the highlighted feature.\n\n// A shade texture is used to turn distance values into colors; the shade\n// texture is basically a color gradient and is recomputed on the host\n// every time that the user alters the highlight options.\n\n// Interpolated texture coordinates.\nvarying mediump vec2 v_texcoord;\n\n// The highlight map. Each channel is a blurred\n// version of the alpha channel of the highlight mask.\n//  - Channel 0 (red) corresponds to a gaussian blur with sigma = u_sigmas[0];\n//  - Channel 1 (green) corresponds to a gaussian blur with sigma = u_sigmas[1];\n//  - Channel 2 (blue) corresponds to a gaussian blur with sigma = u_sigmas[2];\n//  - Channel 3 (alpha) corresponds to a gaussian blur with sigma = u_sigmas[3];\n// As of today, only channel 3 is used for distance estimation.\n// But the availability of different amounts of blur leaves the\n// door open to multi-scale approaches.\nuniform sampler2D u_texture;\n\n// The highlight map was obtained by blurring the alpha channel of the highlight\n// mask accroding to these 4 values of the gaussian's sigma parameter.\nuniform mediump vec4 u_sigmas;\n\n// A 1-D texture used to shade the highlight.\nuniform sampler2D u_shade;\n\n// The 1-D shade texture is spreaded between u_minMaxDistance[0] and u_minMaxDistance[1].\nuniform mediump vec2 u_minMaxDistance;\n\n// Signed distance estimation.\nmediump float estimateDistance() {\n  // Use the largest sigma and the corresponding distance value stored in the\n  // last channel of the highlight map.\n  mediump float sigma = u_sigmas[3];\n  mediump float y = texture2D(u_texture, v_texcoord)[3];\n\n  // Estimates the distance by linearization and local inversion around\n  // the inflection point. The inflection point is in x = 0.\n  const mediump float y0 = 0.5;                           // Value of the convolution at the inflection point.\n  mediump float m0 = 1.0 / (sqrt(2.0 * 3.1415) * sigma);  // Slope of the convolution at the inflection point.\n  mediump float d = (y - y0) / m0;                        // Inversion of a local linearization.\n\n  // Return the estimated distance.\n  return d;\n}\n\n// Shading based on estimated distance.\nmediump vec4 shade(mediump float d) {\n  // Maps the sampled distance from the [A, D] range (see HighlightRenderer::setHighlightOptions) to [0, 1].\n  mediump float mappedDistance = (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n\n  // Force to [0, 1]; it should not be necessary because the shade texture uses the CLAMP address mode, so\n  // this should happen anyway internally to the sampler, but in practice it is needed to avoid weird\n  // banding artifacts.\n  // We don't really know if we need this or not.\n  mappedDistance = clamp(mappedDistance, 0.0, 1.0);\n\n  // Sample the 1-D shade texture on its center line (i.e. on t=0.5).\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\n\nvoid main(void) {\n  // Estimate the distance.\n  mediump float d = estimateDistance();\n\n  // Shade the distance.\n  gl_FragColor = shade(d);\n}\n","textured.vert":"// Identity vertex shader that outputs an untransformed 2-D vertex\n// and passes its texture coordinates unchanged to the interpolator.\n\n// Vertex position.\nattribute mediump vec2 a_position;\n\n// Texture coordinates.\nattribute mediump vec2 a_texcoord;\n\n// Texture coordinates to be interpolated.\nvarying mediump vec2 v_texcoord;\n\nvoid main(void) {\n  // Pass the position unchanged.\n  gl_Position = vec4(a_position, 0.0, 1.0);\n\n  // Pass the texture coordinates unchanged.\n  v_texcoord = a_texcoord;\n}\n"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\n\nvarying mediump vec2 v_texCoord;\n\nvoid main(void)\n{\n  lowp vec4 color = texture2D(u_readbackTexture, v_texCoord);\n  color = color + (1.0 - color.a) * u_background;\n\n  // calculate the grayscale value of the mask:\n  lowp vec4 mask_color = texture2D(u_maskTexture, v_texCoord);\n  lowp float gray = 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  // make all the map color outside the mask black\n  color *= gray;\n\n  lowp vec4 overley_color = texture2D(u_overlyTexture, v_texCoord);\n\n  // premultiply the overlay color\n  overley_color.rgb *= overley_color.a;\n  gl_FragColor = overley_color + (1.0 - overley_color.a) * color;\n}\n","magnifier.vert":"precision mediump float;\n\nattribute mediump vec2 a_pos; // encoded values are 0 and 1\n\nuniform mediump vec2 u_drawPos; // the center position of the magnifier\nuniform mediump float u_width; // the width of the magnifier in normalized display coords\nuniform mediump float u_height; // the height of the magnifier in normalized display coords\n\nvarying mediump vec2 v_texCoord;\n\n\nvoid main(void)\n{\n  v_texCoord = a_pos;\n  vec2 coord = u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position = vec4(coord, 0.0, 1.0);\n}\n"},materials:{"constants.glsl":"const float C_DEG_TO_RAD = 3.14159265359 / 180.0;\nconst float SIGNED_BYTE_TO_UNSIGNED = 128.0;\n\n// markers\nconst float SOFT_EDGE_RATIO = 1.0; // use blur here if needed\n\n// lines\nconst float THIN_LINE_WIDTH_FACTOR = 1.1;\n\n// meaning that a 2 pixels line width is considered a thin line\nconst float THIN_LINE_HALF_WIDTH = 1.0;\n\n// labels \nconst float OFFSET_PRECISION = 1.0 / 8.0;\nconst float OUTLINE_SCALE = 1.0 / 5.0;\nconst float SDF_FONT_SIZE = 24.0;\n\n// maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the\n// geometry to 6 on the outside. 6 is actually the maximum distance outside the glyph, therefore\n// it is the limitation of the halo which is 1/4 of the geometry size.\nconst float MAX_SDF_DISTANCE = 8.0;\n\nconst float PLACEMENT_PADDING = 8.0;\n\n\nconst float EPSILON = 0.0000001; \n\nconst int MAX_FILTER_COUNT = 2;\n","effects.glsl":"\nuniform mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\n\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 outColor = vec4(color);\n\n  // default visibility filter is index 0, index 1+ are effects\n  for (int i = 1; i < EFFECT_COUNT + 1; i++) {\n    float bit = getBit(filterFlags, i);\n    \n    outColor = u_insideEffectMat4[ i ] * (bit  * outColor) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * outColor);\n  }\n  \n  return outColor; \n}\n\nvoid applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n\n  // default visibility filter is index 0, index 1+ are effects\n  for (int i = 0; i < EFFECT_COUNT + 1; i++) {\n    float bit = getBit(filterFlags, i); \n\n    color = u_insideEffectMat4[ i ] * (bit  * color) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * color);\n  }\n\n  // If we are not visible, clip the vertex if we are doing a hit-test\n  pos.z += 2.0 * (1.0 - getBit(filterFlags, 0)); \n}\n\nvoid applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit = getBit(filterFlags, 0); \n\n  pos.z += 2.0 * (1.0 - bit);\n\n  // When outsideLabelsVisible is false, we also clip labels if they fail any effect filter\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i = 1; i < EFFECT_COUNT + 1; i++) {\n    float bit = getBit(filterFlags, i); \n\n    pos.z += 2.0 * (1.0 - bit);\n  }\n#endif\n}\n",fill:{"fill.frag":"precision highp float;\n\n#include <materials/constants.glsl>\n\n#ifdef ID\n\nvarying highp vec4 v_id;\n\n#endif // ID\n\n#ifdef PATTERN\n\nuniform lowp sampler2D u_texture;\n\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n\n#endif // PATTERN\n\n#ifdef DOT_DENSITY\n\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n\nvarying highp vec4 v_dotThresholds[ 2 ];\nvarying vec2 v_dotTextureCoords;\n\n#endif\n\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\n\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}\n\nvoid main() {\n\n#ifdef ID\n\n  gl_FragColor = v_id;\n\n#elif defined(PATTERN)\n\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n  mediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n  // we need to only sample from area that has our sprite in the mosaic.\n  mediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  // sample the sprite mosaic\n  lowp vec4 color = texture2D(u_texture, samplePos);\n  gl_FragColor = v_opacity * v_color * color;\n\n#elif defined(DOT_DENSITY) && !defined(HIGHLIGHT)\n\n  vec4 textureThresholds0 = texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 = texture2D(u_dotTextures[1], v_dotTextureCoords);\n\n  vec4 difference0 = v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 = v_dotThresholds[1] - textureThresholds1;\n\n#ifdef DD_DOT_BLENDING\n\n  vec4 isPositive0 = step(0.0, difference0);\n  vec4 isPositive1 = step(0.0, difference1);\n\n  float weightSum = dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero = step(weightSum, 0.0);\n  float greaterThanZero = 1.0 - lessThanEqZero ;\n  float divisor = (weightSum + lessThanEqZero); // Guard against divide by zero\n\n  vec4 weights0 = difference0 * isPositive0 / divisor;\n  vec4 weights1 = difference1 * isPositive1 / divisor;\n\n  vec4 dotColor = u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n\n  gl_FragColor = greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n\n#else\n\n  float diffMax = max(max4(difference0), max4(difference1));\n  float lessThanZero = step(diffMax, 0.0);\n  float greaterOrEqZero = 1.0 - lessThanZero;\n\n  vec4 isMax0 = step(diffMax, difference0);\n  vec4 isMax1 = step(diffMax, difference1);\n\n  vec4 dotColor = u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n\n  gl_FragColor = greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n\n#endif\n\n#else\n\n  gl_FragColor = v_opacity * v_color;\n\n#endif // PATTERN\n\n#ifdef HIGHLIGHT\n\n  gl_FragColor.a = 1.0;\n\n#endif // HIGHLIGHT\n}\n","fill.vert":"precision mediump float;\n\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/vv.glsl>\n#include <materials/effects.glsl>\n\nattribute vec2 a_pos;\nattribute vec4 a_id;                // objectId in RGBA components\nattribute float  a_visible;         // one byte controlling the visibility of the vertex (separate buffer),\n\n#ifndef DOT_DENSITY\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;              // encodes a bitset (CIM) detailing vv locking\n#endif\n\n#if defined(VV_COLOR) || defined(VV_OPACITY)\nattribute highp vec4 a_vv;\n#endif\n\nuniform highp mat3 u_dvsMat3;      // premultiplies DisplayMat3 * ViewMat3 * ScreenMat3\nuniform highp float u_pixelRatio;\n\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif\n\n#ifdef PATTERN\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_mosaicSize;\n\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n\n#ifdef DOT_DENSITY\nattribute highp vec4 a_dd1;\nattribute highp vec4 a_dd2;\n\nuniform float u_dotValue;\nuniform float u_tileDotsOverArea; \n\nuniform float u_dotTextureDotCount;\nuniform float u_tileZoomFactor; \n\nvarying vec4 v_dotThresholds[ 2 ]; \nvarying vec2 v_dotTextureCoords;\n\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n\nvoid main()\n{\n// Arguably DotDensity should be extracted to its own shader. This gets a bit\n// fungly because DD uses a signifcantly different stride\n#ifndef DOT_DENSITY \n  float a_bitset = a_aux3.w; \n  float isColorLocked = getBit(a_bitset, 0);\n  \n  v_color = a_color;\n#else\n  v_color = vec4(0.0, 0.0, 0.0, 1.0);    // for highlight\n#endif\n  v_opacity = 1.0;\n  \n#ifdef ID\n  v_id = a_id;\n#endif\n  \n#ifdef VV_OPACITY\n  v_opacity = getVVOpacity(a_vv.y);\n#endif\n  \n#ifdef VV_COLOR\n  v_color = getVVColor(a_vv.x, v_color, isColorLocked);\n#endif\n  \n#ifdef PATTERN\n  vec2 aux2 = (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  vec2 symbolOffset = u_zoomFactor * (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED);\n  mat3 patternMatrix = mat3(1.0);\n\n  // calculate the pattern matrix\n  patternMatrix[0][0] = 1.0 / (u_zoomFactor * a_aux1.x * aux2.x);\n  patternMatrix[1][1] = 1.0 / (u_zoomFactor * a_aux1.y * aux2.y);\n\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from\n  // tile coordinates to texture coordinates.\n  v_tileTextureCoord = (patternMatrix * vec3(a_pos + symbolOffset, 1.0)).xy;\n  v_tlbr = a_tlbr / u_mosaicSize.xyxy;\n\n#elif defined(DOT_DENSITY)\n  float size = u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n\n  v_dotThresholds[0] = dotThreshold(a_dd1, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] = dotThreshold(a_dd2, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords = (a_pos + 0.5) / size;\n\n#endif\n  vec3 v_pos = u_dvsMat3 * vec3(a_pos, 1.);\n\n  applyFilter(v_color, v_pos, a_visible);\n  \n  gl_Position = vec4(v_pos, 1.0);\n}\n"},icon:{"icon.frag":"precision mediump float;\n\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <util/encoding.glsl>\n#include <materials/effects.glsl>\n#include <materials/constants.glsl>\n\nuniform lowp sampler2D u_texture;\n\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\nvarying float v_visible;\n\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying float v_overridingOutlineColor;\n#endif // SDF\n\n#ifdef HIGHLIGHT\nvarying float v_isThinGeometry;\n#endif // HIGHLIGHT\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor = v_color;\n\n  // calculate the distance from the edge [-0.5, 0.5]\n  float d = 0.5 - rgba2float(texture2D(u_texture, v_tex));\n\n  // the soft edge ratio is about 1.5 pixels allocated for the soft edge.\n  float size = max(v_size.x, v_size.y);\n  float dist = d * size * SOFT_EDGE_RATIO;\n\n  // set the fragment's transparency according to the distance from the edge\n  fillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\n\n  float outlineWidth = v_outlineWidth;\n\n  #ifdef HIGHLIGHT\n    outlineWidth = max(outlineWidth, 4.0 * v_isThinGeometry);\n  #endif\n\n  // count for the outline\n  // therefore tint the entire icon area.\n  if (outlineWidth > 0.25) {\n    lowp vec4 outlinePixelColor = v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n\n    // outlines can't be larger than the size of the symbol\n    float clampedOutlineSize = min(outlineWidth, size);\n\n    outlinePixelColor *= clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n\n    // finally combine the outline and the fill colors (outline draws on top of fill)\n    gl_FragColor = v_transparency * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor = v_transparency * fillPixelColor;\n  }\n#else // not an SDF\n   lowp vec4 texColor = texture2D(u_texture, v_tex);\n   gl_FragColor = v_transparency * getEffectColor(texColor, v_visible);\n#endif // SDF\n\n#ifdef HIGHLIGHT\n  gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","icon.vert":"precision mediump float;\n\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/vv.glsl>\n#include <materials/effects.glsl>\n\nattribute vec2 a_pos;\nattribute vec4 a_vertexOffsetAndTex;\nattribute vec4 a_id;                   // objectId in RGBA components\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute float a_visible;             // one byte controlling the vertex visibility (separate buffer)\n\n#ifdef VV\nattribute highp vec4 a_vv;\n#endif\n\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform vec2 u_mosaicSize;            // mosaic size in pixels\n\nvarying lowp vec4 v_color;\nvarying mediump vec2 v_tex;           // texture coordinates used to sample the sprite atlas\nvarying lowp float v_transparency;    // the calculated transparency to be applied by the fragment shader.\nvarying mediump vec2 v_size;          // icon size in px\nvarying float v_visible;\n\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying float v_overridingOutlineColor;\n#endif\n\n#ifdef HIGHLIGHT\nvarying float v_isThinGeometry;\n#endif // HIGHLIGHT\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif\n\nvec2 getMarkerSize(inout vec2 offset, in vec2 baseSize, in float vvSize) {\n  float f = getVVSize(baseSize.y, vvSize);\n  vec2 size = vec2(f * baseSize.x / baseSize.y, f);\n\n  offset *= (size / baseSize);\n  return size;\n}\n\nvoid main()\n{\n  vec2 offset = a_vertexOffsetAndTex.xy;\n  vec2 a_tex = a_vertexOffsetAndTex.zw + SIGNED_BYTE_TO_UNSIGNED;\n  vec2 a_size = a_sizeAndOutlineWidth.xy;\n  float a_bitset = a_sizeAndOutlineWidth.w;\n\n  float isMapAligned = getBit(a_bitset, 0);\n  float isColorLocked = getBit(a_bitset, 1);\n  float isThinGeometry = getBit(a_bitset, 2);\n  mat3 offsetMat3 = isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n\n  v_transparency = 1.0;\n  v_color = a_color;\n  v_size = a_size;\n  v_tex = a_tex / u_mosaicSize; // texture coords and transparency\n  v_visible = a_visible;\n\n#ifdef ID\n  v_id = a_id;\n#endif\n\n#ifdef VV_OPACITY\n  v_transparency = getVVOpacity(a_vv.z);\n#endif\n\n#ifdef VV_COLOR\n  v_color = getVVColor(a_vv.y, a_color, isColorLocked);\n#endif // VV_COLOR\n\n#ifdef VV_SIZE\n  v_size = getMarkerSize(offset, a_size, a_vv.x);\n#endif\n\n#ifdef VV_ROTATION\n  offset = (getVVRotationMat3(a_vv.w) * vec3(offset, 0.0)).xy;\n#endif\n\n#ifdef SDF\n  #ifdef VV_COLOR\n    // this is true only if we have SDF and color VV\n    v_overridingOutlineColor = isThinGeometry;\n  #else\n    v_overridingOutlineColor = 0.0;\n  #endif\n\n  offset *= 2.0;\n  v_outlineColor = getEffectColor(a_outlineColor, a_visible);\n  // YF: in practice v_size.x and v_size.y are identical since we're mostly dealing with sms\n  v_outlineWidth = min(a_sizeAndOutlineWidth.z, max(v_size.x - 0.99, 0.0));\n#endif\n\n#ifdef HIGHLIGHT\n  v_isThinGeometry = isThinGeometry;\n#endif\n\n  vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + offsetMat3 * vec3(offset, 0.0);\n\n  applyFilter(v_color, pos, a_visible);\n\n  gl_Position = vec4(pos, 1.0);\n}\n"},label:{"label.frag":"precision lowp float;\n\nuniform mediump sampler2D u_referenceTex;\nuniform mediump vec2 u_screenSize;\nuniform mediump float u_pixelRatio;\n\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\n\n#ifdef ID\nvarying mediump float v_fadeStep;\n#else\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_color;\n#endif // ID\n\nconst vec3 epsilon = vec3(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n\nvoid main()\n{\n  mediump vec2 refTextPos = gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n  mediump vec4 referenceFragment = texture2D(u_referenceTex, refTextPos);\n#ifdef ID\n  mediump float alpha = clamp(referenceFragment.a + v_fadeStep, 0.0, 1.0);\n  // fill the whole quad\n  gl_FragColor = vec4(alpha);\n#else\n  // read the fade alpha\n  lowp float fadeAlpha = referenceFragment.a;\n\n  // read the distance from the SDF texture\n  lowp float dist = texture2D(u_texture, v_tex).a;\n\n  // the edge distance if a factor of the outline width\n  // We cap this to 0.25 to prevent this from becomming negative / running into the glyph boundaries\n  float glyphEdgeDistance = max(0.75 - v_edgeDistanceOffset, 0.25);\n\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n  lowp float sdfAlpha = smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist);\n\n  gl_FragColor = fadeAlpha * sdfAlpha * v_color;\n#endif\n}\n","label.vert":"precision mediump float;\n\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/vv.glsl>\n#include <materials/effects.glsl>\n\nattribute vec2 a_pos;                         // (2 x i16)\nattribute vec4 a_color;                       // (4 x u8)\nattribute vec2 a_vertexOffset;                // (2 x i16) offset from the anchor point of the string\nattribute vec4 a_texAndSize;                  // (4 x u8) texture coordinatesm and font size. w is for the halo size\nattribute vec4 a_refSymbolAndPlacementOffset; // (4 x u8) reference symbol offset (px) and the placement offset (px)\nattribute float a_vvSize;                     // size visual variable\nattribute lowp float  a_visible;              // a one byte controlling the visibility of the vertex (separate buffer)\nattribute mediump vec2 a_visibilityRange;     // (2 x u8);\n\nuniform mediump float u_zoomLevel;            // the current zoom level X 10\nuniform highp mat3 u_dvsMat3;                 // premultiplies displayMat3 * viewMat3 * screenMat3\nuniform highp mat3 u_displayMat3;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nuniform vec2 u_mosaicSize;\nuniform float u_pixelRatio;\n\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;                   // texture coordinates used to sample the glyph atlas\nvarying mediump vec4 v_color;\n\n#ifdef ID                                     // somewhat of a misnomer - id is used here for the label alpha phase\nuniform mediump float u_fadeStep; \nvarying mediump float v_fadeStep;\n#endif\n\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle = angle * 360.0 / 254.0;\n  float mapAngle = u_mapRotation * 360.0 / 254.0;\n  float diffAngle = min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z = 0.0;\n\n  // make sure range is inclusive\n  z += 2.0 * (1.0 - step(minZoom, u_zoomLevel));\n  z += 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  z += 2.0 * u_mapAligned * step(90.0, diffAngle);\n  return z;\n}\n\nvoid main()\n{\n  float isHalo = mod(a_pos, 2.0).x; // lsb of a_pos denotes whether a vertex is part of the halo or not\n  vec3 pos = vec3(floor(a_pos * 0.5), 1.0);\n  vec2 placementDir = a_refSymbolAndPlacementOffset.zw - 1.0;  // encoded as dir + 1.0\n  vec2 vertexOffset = a_vertexOffset * OFFSET_PRECISION;\n  float refSymbolSize = a_refSymbolAndPlacementOffset.y;\n  float fontSize = a_texAndSize.z;\n  float z = getZ(a_visibilityRange.x, a_visibilityRange.y, a_refSymbolAndPlacementOffset.x);\n\n  float fontScale = fontSize / SDF_FONT_SIZE;\n  float halfSize = refSymbolSize / 2.0;\n\n  v_color = a_color;\n  v_tex = a_texAndSize.xy / u_mosaicSize;\n\n#ifdef ID\n  v_fadeStep = u_fadeStep;\n#endif\n  \n#ifdef VV_SIZE // unlike with text, this is the VV_SIZE of the reference symbol, not the label itself\n  halfSize = getVVSize(refSymbolSize, a_vvSize) / 2.0;\n#endif\n  // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\n  v_edgeDistanceOffset = isHalo * OUTLINE_SCALE * a_texAndSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth = 0.106 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n\n  vec2 placementOffset = placementDir * (halfSize + PLACEMENT_PADDING);\n  vec3 glyphOffset = u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos = u_dvsMat3 * pos + glyphOffset;\n  \n  applyFilterLabels(v_color, v_pos, a_visible);\n\n#ifdef DEBUG\n  v_color = vec4(a_color.rgb, z == 0.0 ? 1.0 : 0.645);  // visualize hidden glyphs\n#endif\n  \n  gl_Position = vec4(v_pos.xy, v_pos.z + z, 1.0);\n}\n"},line:{"line.frag":"precision lowp float;\n\n#include <util/encoding.glsl>\n#include <materials/constants.glsl>\n\nuniform lowp float u_blur;\nuniform mediump float u_antialiasing;\n\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying lowp float v_transparency;\n\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform mediump float u_zoomFactor;\n\nvarying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\nvarying mediump vec2 v_patternSize;\nvarying highp float v_accumulatedDistance;\n#endif // PATTERN SDF\n\n#ifdef SDF\nconst float sdfPatternHalfWidth = 15.5; // YF: assumed that the width will be set to 31\nconst float widthFactor = 2.0;\n#endif // SDF\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n\nvoid main()\n{\n  // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides of the centerline)\n  mediump float thinLineFactor = max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n  mediump float fragDist = length(v_normal) * v_lineHalfWidth;\n\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n  // when it is a thin line then use a slightly shallower slope in order to add more feathering\n  lowp float alpha = clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n\n#if defined(SDF) && !defined(HIGHLIGHT) // When we render the highlight, we want to treat the line as if it was solid\n  mediump float lineHalfWidth = widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio = lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX = mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY = 0.5 + 0.5 * v_normal.y;\n\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n  mediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n  // calculate the distance from the edge [-0.5, 0.5]\n  mediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n\n  // the distance is a proportional to the line width\n  float dist = d * lineHalfWidth;\n\n  lowp vec4 fillPixelColor = v_transparency * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor = fillPixelColor;\n#elif defined(PATTERN) && !defined(HIGHLIGHT)  // When we render the highlight, we want to treat the line as if it was solid\n  // we need to calculate the relative portion of the line texture along the line given the accumulated distance along the line\n  // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\n  mediump float relativeTexX = mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n\n  // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\n  // which range from -1.0 to 1.0. On the line's centerline, the value of the interpolated normal is 0.0, however the relative\n  // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\n  // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\n  //              | -> line-width / 2\n  //      - - - - - - - - - - - - - -\n  //              | -> line-width / 2\n  //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\n\n  mediump float relativeTexY = 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n  mediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n  // get the color from the texture\n  lowp vec4 color = texture2D(u_texture, texCoord);\n\n  gl_FragColor = v_transparency * alpha * v_color * color;\n#else // solid line (no texture, no pattern)\n  // output the fragment color\n  gl_FragColor = v_transparency * alpha * v_color;\n#endif // SDF\n\n#ifdef HIGHLIGHT\n  gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","line.vert":"precision mediump float;\n\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/vv.glsl>\n#include <materials/effects.glsl>\n\nattribute vec2 a_pos;\nattribute vec4 a_id;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute float  a_visible;                // a one byte controlling the visibility of the vertex (separate buffer)\n\n#ifdef VV\nattribute highp vec3 a_vv;\n#endif\n\nuniform highp mat3 u_dvsMat3;              // premultiplies DisplayMat3 * ViewMat3 * ScreenMat3\nuniform highp mat3 u_displayViewMat3;     // premultiplies DisplayMat3 * ViewMat3\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\n\nvarying mediump vec2 v_normal;             // interpolated normal to the line. packed into the two LSBs of the vertex coordinate\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying lowp float v_transparency;\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif\n\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n\nvarying mediump vec4 v_tlbr;               // normalized pattern coordinates [0, 1]\nvarying mediump vec2 v_patternSize;\n#endif\n\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance; // we need to accumulated distance only if it is a pattern or an SDF line\n#endif\n\n#if defined(SDF) && !defined(HIGHLIGHT) // When we render the highlight, we want to treat the line as if it was solid\nconst float widthFactor = 2.0;\n#else\nconst float widthFactor = 1.0;\n#endif\n\nconst float scale = 1.0 / 31.0;\n\nvoid main()\n{\n  float a_bitset = a_segmentDirection.w;\n\n  float isColorLocked = getBit(a_bitset, 0);\n  float lineHalfWidth = a_accumulatedDistanceAndHalfWidth.y * scale;\n\n  v_transparency = 1.0;\n  v_color = a_color;\n  v_normal = a_offsetAndNormal.zw * scale;\n\n#ifdef ID\n  v_id = a_id;\n#endif\n\n#ifdef VV_OPACITY\n  v_transparency = getVVOpacity(a_vv.z);\n#endif\n\n#ifdef VV_COLOR\n  v_color = getVVColor(a_vv.y, v_color, isColorLocked);\n#endif\n\n#ifdef VV_SIZE\n  lineHalfWidth = 0.5 * getVVSize(2.0 * lineHalfWidth, a_vv.x);\n#endif\n\n#ifdef PATTERN\n  v_tlbr = a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize = vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n\n  // make sure to clip the vertices in case that the width of the line is 0 (or negative)\n  float z = 2.0 * step(lineHalfWidth, 0.0);\n\n  // add an antialiasing distance. We use 0.2 rather than 0.5 in order to match the SVG renderer\n  // also limit the total line width to 1.3 pixels. Below this value lines don't look good compared\n  // to the SVG renderer\n  v_lineHalfWidth = max(lineHalfWidth, 0.45) + 0.2 * u_antialiasing;\n\n\n#ifdef HIGHLIGHT\n  v_lineHalfWidth = max(v_lineHalfWidth, 2.0);\n#endif\n\n  // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides\n  // of the centerline) in practice, a thin line is a line who's half width vary from 0.45px to\n  // the value of thinLineHalfWidth, as the value is claped in line 221 above\n  mediump float thinLineFactor = max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is\n  // given in integers (for the sake of using less attribute memory, we need to scale it back to\n  // the original range of ~ [0, 1]) in a case of a thin line we move each vertex twice as far\n  mediump vec2 dist = thinLineFactor * widthFactor * v_lineHalfWidth * a_offsetAndNormal.xy * scale;\n\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance = a_accumulatedDistanceAndHalfWidth.x + dot(scale * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n\n  vec3 offset = u_displayViewMat3 * vec3(dist, 0.0);\n  vec3 v_pos = u_dvsMat3 * vec3(a_pos.xy, 1.0) + offset;\n  vec3 pos = vec3(v_pos.xy, z);\n\n  applyFilter(v_color, pos, a_visible);\n\n  gl_Position = vec4(pos, 1.0);\n}\n"},text:{"text.frag":"precision lowp float;\n\nuniform lowp sampler2D u_texture;\n\nvarying mediump vec4 v_color;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n  // read the distance from the SDF texture\n  lowp float dist = texture2D(u_texture, v_tex).a;\n\n  // the edge distance if a factor of the outline width\n  // We cap this to 0.25 to prevent this from becomming negative / running into the glyph boundaries\n  float glyphEdgeDistance = max(0.75 - v_edgeDistanceOffset, 0.25);\n\n  #ifdef HIGHLIGHT\n    glyphEdgeDistance /= 2.0;\n  #endif\n\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n  lowp float alpha = smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\n\n  gl_FragColor = alpha * v_color;\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","text.vert":"precision mediump float;\n\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/vv.glsl>\n#include <materials/effects.glsl>\n\nattribute vec2 a_pos;          // 2 * 2 (2 x signed 16)\nattribute vec4 a_id;           // 4 (4 x unsigned byte)\nattribute vec4 a_color;        // 4 (4 x unsigned byte)\nattribute vec2 a_vertexOffset; // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\nattribute vec4 a_texFontSize;  // 4 (4 x unsigned byte) texture coordinatesm and font size\nattribute vec4 a_aux;          // hold onto additional information such as a bitset on the last byte (a_aux.w)\nattribute float a_visible;     // a one byte controlling the visibility of the vertex (a separate visibility buffer)\n\n#ifdef VV\nattribute highp vec4 a_vv;\n#endif\n\nuniform vec2 u_mosaicSize;\nuniform float u_pixelRatio;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3; // Premultiplies DisplayMat3 * ViewMat3 * ScreenMat3\n\nvarying mediump vec4 v_color;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;        // texture coordinates used to sample the glyph atlas\nvarying lowp float v_transparency; // the calculated transparency to be applied by the fragment shader. \n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n  float a_bitset = a_aux.w;\n\n  float isColorLocked = getBit(a_bitset, 0);\n  float isHalo = getBit(a_pos.x, 0);   // The lsb of pos denotes whether a vertex is part of the halo or not\n  float fontSize = a_texFontSize.z;\n  vec3 pos = vec3(floor(a_pos * 0.5), 1.0);\n  vec3 offset = vec3(a_vertexOffset * OFFSET_PRECISION, 0.0);\n  float scale = 1.0;\n\n  v_transparency = 1.0;\n  v_color = a_color;\n  v_tex = a_texFontSize.xy / u_mosaicSize;\n\n#ifdef ID\n  v_id = a_id;\n#endif\n\n#ifdef VV_OPACITY\n  v_transparency = getVVOpacity(a_vv.z);\n#endif\n\n#ifdef VV_COLOR\n  // we don't want to override the halo color\n  v_color = isHalo * a_color + (1.0 - isHalo) * getVVColor(a_vv.y, a_color, isColorLocked);\n#endif\n\n#ifdef VV_SIZE\n  float f = getVVSize(a_texFontSize.z, a_vv.x);\n  scale = f / fontSize; \n  fontSize = f;\n  offset.xy *= scale; \n#endif\n  \n#ifdef VV_ROTATION\n  offset = getVVRotationMat3(a_vv.w) * offset;\n#endif\n\n  vec3 v_pos = u_dvsMat3 * pos + u_displayMat3 * offset;\n  float fontScale = fontSize / SDF_FONT_SIZE;\n\n  // if isHalo is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\n  v_edgeDistanceOffset = isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth = 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n\n  applyFilter(v_color, v_pos, a_visible);\n  \n  gl_Position = vec4(v_pos, 1.0);\n}\n"},"utils.glsl":"\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset = pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n","vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif // VV_COLOR\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif // VV_ROTATION\n\nconst highp float nanValue = 1e-30;\n\nbool isNan(float val) {\n  return (val == nanValue);\n  //return !( val < 0.0 || 0.0 < val || val == 0.0 );\n}\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  // we need to multiply by 8 in order to translate to tile coordinates\n  float interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio = clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n\n  for (int i = 1; i < VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n      float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n\n  if (opacityValue <= u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n\n  for (int i = 1; i < VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] >= opacityValue) {\n      float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  // YF TODO: if the symbol has rotation we need to combine the symbo's rotation with the VV one\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n\n  float rotation = rotationValue;\n  if (u_vvRotationType == 1.0) {\n    rotation = 90.0 - rotation;\n  }\n\n  float angle = C_DEG_TO_RAD * rotation;\n\n  float sinA = sin(angle);\n  float cosA = cos(angle);\n\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\n\nmat3 getVVRotationMat3(float rotationValue) {\n  // YF TODO: if the symbol has rotation we need to combine the symbo's rotation with the VV one\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n\n  float rotation = rotationValue;\n  if (u_vvRotationType == 1.0) {\n    rotation = 90.0 - rotation;\n  }\n\n  float angle = C_DEG_TO_RAD * -rotation;\n\n  float sinA = sin(angle);\n  float cosA = cos(angle);\n\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif // VV_ROTATION\n\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\n\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked == 1.0) {\n    return fallback;\n  }\n\n  if (colorValue <= u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n\n  for (int i = 1; i < VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] >= colorValue) {\n      float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif // VV_COLOR\n\nfloat getVVSize(in float size, in float vvSize)  {\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n\n#elif defined(VV_SIZE_FIELD_STOPS)\n  return getVVStopsSize(vvSize, size);\n\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n\n#else\n  return size;\n\n#endif\n}\n"},raster:{"solid.frag":"precision mediump float;\n\nvoid main(void) {\n  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n}\n","texture.frag":"precision mediump float;\n\n// Texture coordinates.\nvarying vec2 v_texcoord;\n\n// Texture sampler.\nuniform sampler2D u_texture;\n\n// Opacity.\nuniform float u_opacity;\n\nvoid main(void) {\n  vec4 color = texture2D(u_texture, v_texcoord);\n  color.a *= u_opacity;\n  gl_FragColor = vec4(color.rgb * color.a, color.a);\n}\n","transform.vert":"precision mediump float;\n\n// Vertex position. Assumed normalized in the [0, 1] range.\nattribute vec2 a_position;\n\n// Transform matrix.\nuniform mat4 u_transform;\n\n// Output texture coordinates, for interpolation.\nvarying vec2 v_texcoord;\n\nvoid main(void) {\n  gl_Position = u_transform * vec4((2.0 * a_position - 1.0), 0.0, 1.0);\n  v_texcoord = a_position;\n}\n"},stencil:{"stencil.frag":"void main() {\n  gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n}\n","stencil.vert":"attribute vec2 a_pos;\n\nvoid main() {\n  gl_Position = vec4(a_pos, 0.0, 1.0);\n}\n"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\n\nvoid main(void) {\n  lowp vec4 color = texture2D(u_texture, v_tex);\n  gl_FragColor = 0.75 * color;\n}\n","tileInfo.vert":"attribute vec2 a_pos;\n\nuniform highp mat3 u_dvsMat3;\n\nuniform mediump float u_depth;\nuniform mediump float u_coord_ratio;\nuniform mediump vec2 u_delta; // in tile coordinates\nuniform mediump vec2 u_dimensions; // in tile coordinates\n\nvarying mediump vec2 v_tex;\n\nvoid main() {\n  mediump vec2 offset = u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos = u_dvsMat3 * vec3(offset, 1.0);\n  \n  gl_Position = vec4(v_pos.xy, 0.0, 1.0);\n\n  v_tex = a_pos;\n}\n"},util:{"encoding.glsl":"// Factors to convert rgba back to float\nconst vec4 rgba2float_factors = vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\n\nfloat rgba2float(vec4 rgba) {\n  // Convert components from 0->1 back to 0->255 and then\n  // add the components together with their corresponding\n  // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n  return dot(rgba, rgba2float_factors);\n}\n"}}}.apply(null,n))||(e.exports=r)},VY6u:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var i=1/Math.LN2;function n(e,t){return 0<=(e%=t)?e:e+t}t.positiveMod=n,t.radToByte=function(e){return n(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return n(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*i},t.sqr=function(e){return e*e},t.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},t.interpolate=function(e,t,i){return e*(1-i)+t*i},t.between=function(e,t,i){return t<=e&&e<=i||i<=e&&e<=t}}.apply(null,n))||(e.exports=r)},XCks:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("qMld"),i("qDit")],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=1e20,o=function(){function e(e){this.size=e,this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=e,this.context=this.canvas.getContext("2d"),this._gridOuter=new Float64Array(e*e),this._gridInner=new Float64Array(e*e),this._f=new Float64Array(e),this._d=new Float64Array(e),this._z=new Float64Array(e+1),this._v=new Int16Array(e);var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("style","position: absolute;"),t.setAttribute("width","0"),t.setAttribute("height","0"),document.body.appendChild(t),this._svg=t}return e.prototype.draw=function(e,t){var o=this;void 0===t&&(t=31);var a=this._createSVGString(e);return i.create(function(e){var i=new Image;i.src="data:image/svg+xml; charset=utf8, "+encodeURIComponent(a),i.onload=function(){o.context.clearRect(0,0,o.size,o.size),o.context.drawImage(i,0,0,o.size,o.size);for(var a=o.context.getImageData(0,0,o.size,o.size),s=new Uint8Array(o.size*o.size*4),l=0;l<o.size*o.size;l++){var u=a.data[4*l+3]/255;o._gridOuter[l]=1===u?0:0===u?r:Math.pow(Math.max(0,.5-u),2),o._gridInner[l]=1===u?r:0===u?0:Math.pow(Math.max(0,u-.5),2)}for(o._edt(o._gridOuter,o.size,o.size),o._edt(o._gridInner,o.size,o.size),l=0;l<o.size*o.size;l++){var h=.5-(o._gridOuter[l]-o._gridInner[l])/(2*t);n.packFloat(h,s,4*l)}e(s)}})},e.prototype._createSVGString=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",e),this._svg.appendChild(t);var i,n,r,o,a=t.getBBox(),s=a.width/a.height,l=this.size/2;if(1<s){n=i=l/a.width;var u=l*(1/s);r=this.size/4,o=l-u/2}else i=n=l/a.height,r=l-l*s/2,o=this.size/4;var h=-a.x*i+r,c=-a.y*n+o;t.setAttribute("style","transform: matrix("+i+", 0, 0, "+n+", "+h+", "+c+")");var d='<svg style="fill:red;" height="'+this.size+'" width="'+this.size+'" xmlns="http://www.w3.org/2000/svg">'+this._svg.innerHTML+"</svg>";return this._svg.removeChild(t),d},e.prototype._edt=function(e,t,i){for(var n=this._f,r=this._d,o=this._v,a=this._z,s=0;s<t;s++){for(var l=0;l<i;l++)n[l]=e[l*t+s];for(this._edt1d(n,r,o,a,i),l=0;l<i;l++)e[l*t+s]=r[l]}for(l=0;l<i;l++){for(s=0;s<t;s++)n[s]=e[l*t+s];for(this._edt1d(n,r,o,a,t),s=0;s<t;s++)e[l*t+s]=Math.sqrt(r[s])}},e.prototype._edt1d=function(e,t,i,n,o){n[i[0]=0]=-r,n[1]=+r;for(var a=1,s=0;a<o;a++){for(var l=(e[a]+a*a-(e[i[s]]+i[s]*i[s]))/(2*a-2*i[s]);l<=n[s];)s--,l=(e[a]+a*a-(e[i[s]]+i[s]*i[s]))/(2*a-2*i[s]);i[++s]=a,n[s]=l,n[s+1]=+r}for(a=0,s=0;a<o;a++){for(;n[s+1]<a;)s++;t[a]=(a-i[s])*(a-i[s])+e[i[s]]}},e}();t.default=o}.apply(null,n))||(e.exports=r)},Y080:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("2Atf"),i("xhoE"),i("qMld"),i("1Mg+"),i("JNkf"),i("oDRR")],void 0===(r=function(e,t,i,n,r,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var i=e.call(this)||this;return i._displayHeight=0,i._displayWidth=0,i._rendererInfo=new s,i.tileInfoView=t.tileInfoView,i.highlightIDs=t.highlightIDs,i.getMaterialItems=i.getMaterialItems.bind(i),i}return n(t,e),t.prototype.dispose=function(){this.removeAllChildren();for(var e=0,t=this.children;e<t.length;e++)t[e].dispose()},t.prototype.disposeWebGLResources=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].clear()},t.prototype.displayWidth=function(){return this._displayWidth},Object.defineProperty(t.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0}),t.prototype.setVisibility=function(e,t){},t.prototype.getMaterialItems=function(e){var t=e;if(t&&0!==t.length){for(var i=[],n=this.stage.painter.textureManager,o=0,a=t;o<a.length;o++){var s=a[o];i.push(n.rasterizeItem(s.symbol,s.glyphIds))}return r.all(i).then(function(e){return e.map(function(e,i){return{id:t[i].id,mosaicItem:e}})})}},t.prototype.renderChildren=function(e){var t=this.stage.painter;if(this._updateTilesTransform(e.state,this.tileInfoView.getClosestInfoForScale(e.state.scale).level),e.drawPhase===a.WGLDrawPhase.MAP){var n=this.tileInfoView.getClosestInfoForScale(e.state.scale).level,r=this.tileInfoView.tileInfo.scaleToZoom(e.state.scale),o=this._rendererInfo,s=i({},e,{rendererInfo:o,requiredLevel:n,displayLevel:r,context:this.stage.context,painter:t});this.sortChildren(function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col});var l=s.drawPhase;t.draw(s,this.children,l,null),0<this.highlightIDs.size&&t.highlight(s,this.children)}},t.prototype._updateTilesTransform=function(e,t){for(var i=0,n=this.children;i<n.length;i++){var r=n[i],o=this.tileInfoView.tileInfo.lods[r.key.level].resolution/(e.resolution*e.pixelRatio);r.setTransform(e,o)}},t}(o.Container);t.default=l}.apply(null,n))||(e.exports=r)},Y6jg:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("qKT0"),i("TMur"),i("Ebn8"),i("Gtr7"),i("Vx27"),i("W9tT"),i("DIqE"),i("xI7m"),i("f7cP"),i("6N7s")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d){return function(e){function t(t){var i=e.call(this,t)||this;return i._animationTime=0,i._momentumFinished=!1,i._rotationMomentumEstimator=new c.RotationMomentumEstimator(.6,.15,.95),i._rotationDirection=1,i._zoomDirection=1,i._zoomMomentumEstimator=new d.ZoomMomentumEstimator,i._zoomOnly=null,i.zoomMomentum=null,i.rotateMomentum=null,i.viewpoint=new o({targetGeometry:new r.Point,scale:0,rotation:0}),i.watch("_momentumFinished",function(e){e&&i.navigation.stop()}),i}return i(t,e),t.prototype.begin=function(e,t){this.navigation.begin(),this._rotationMomentumEstimator.reset(),this._zoomMomentumEstimator.reset(),this._zoomOnly=null,this._previousAngle=this._startAngle=t.angle,this._previousRadius=this._startRadius=t.radius,this._previousCenter=t.center,this._updateTimestamp=null,e.constraints.rotationEnabled&&this.addToRotateEstimator(0,t.timestamp),this.addToZoomEstimator(t,1)},t.prototype.update=function(e,t){null===this._updateTimestamp&&(this._updateTimestamp=t.timestamp);var i=t.angle,n=t.radius,r=t.center,o=Math.abs(180*(i-this._startAngle)/Math.PI),a=Math.abs(n-this._startRadius),s=this._startRadius/n;if(this._previousRadius){var l=n/this._previousRadius,u=180*(i-this._previousAngle)/Math.PI;this._rotationDirection=u>=0?1:-1,this._zoomDirection=l>=1?1:-1,e.constraints.rotationEnabled?(null===this._zoomOnly&&t.timestamp-this._updateTimestamp>200&&(this._zoomOnly=a-o>0),null===this._zoomOnly||this._zoomOnly?u=0:this.addToRotateEstimator(i-this._startAngle,t.timestamp)):u=0,this.addToZoomEstimator(t,s),this.navigation.setViewpoint([r.x,r.y],1/l,u,[this._previousCenter.x-r.x,r.y-this._previousCenter.y])}this._previousAngle=i,this._previousRadius=n,this._previousCenter=r},t.prototype.end=function(e,t){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum(),this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum(),this._animationTime=0,(this.rotateMomentum||this.zoomMomentum)&&this.onAnimationUpdate(e),this.navigation.end()},t.prototype.addToRotateEstimator=function(e,t){this._rotationMomentumEstimator.add(e,.001*t)},t.prototype.addToZoomEstimator=function(e,t){this._zoomMomentumEstimator.add(t,.001*e.timestamp)},t.prototype.canZoomIn=function(e){var t=e.scale,i=e.constraints.effectiveMaxScale;return 0===i||t>i},t.prototype.canZoomOut=function(e){var t=e.scale,i=e.constraints.effectiveMinScale;return 0===i||t<i},t.prototype.onAnimationUpdate=function(e){var t=this;this.navigation.animationManager.animateContinous(e.viewpoint,function(i,n){var r=!t.canZoomIn(e)&&t._zoomDirection>1||!t.canZoomOut(e)&&t._zoomDirection<1,o=!t.rotateMomentum||t.rotateMomentum.isFinished(t._animationTime),a=r||!t.zoomMomentum||t.zoomMomentum.isFinished(t._animationTime),s=.001*n;if(t._momentumFinished=o&&a,!t._momentumFinished){var c=t.rotateMomentum?Math.abs(t.rotateMomentum.valueDelta(t._animationTime,s))*t._rotationDirection*180/Math.PI:0,d=t.zoomMomentum?Math.abs(t.zoomMomentum.valueDelta(t._animationTime,s)):1,f=u.vec2f64.create(),p=u.vec2f64.create();if(t._previousCenter){l.vec2.set(f,t._previousCenter.x,t._previousCenter.y),h.getPaddingScreenTranslation(p,e.size,e.padding),l.vec2.add(f,f,p);var v=e.constraints,_=e.scale,m=_*d;d<1&&!v.canZoomInTo(m)?(d=_/v.effectiveMaxScale,t.zoomMomentum=null,t.rotateMomentum=null):d>1&&!v.canZoomOutTo(m)&&(d=_/v.effectiveMinScale,t.zoomMomentum=null,t.rotateMomentum=null),h.scaleAndRotateBy(i,e.viewpoint,d,c,f,e.size)}}t._animationTime+=s})},t.prototype.stopMomentumNavigation=function(){(this.rotateMomentum||this.zoomMomentum)&&(this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop())},n([s.property()],t.prototype,"_momentumFinished",void 0),n([s.property()],t.prototype,"viewpoint",void 0),n([s.property()],t.prototype,"navigation",void 0),n([s.subclass("esri.views.2d.navigation.actions.Pinch")],t)}(s.declared(a))}.apply(null,n))||(e.exports=r)},YIDE:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("hPTP")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.magnifier={name:"magnifier",shaders:{vertexShader:i.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:i.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},Zry2:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._largestRange=null,this._parent=e,this._updateLargestRange()}return Object.defineProperty(e.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0}),e.prototype.rangeCreated=function(e){(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.rangeResized=function(e,t,i){e===this._largestRange?e.count<i&&this._updateLargestRange():(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.findBestRange=function(e){for(var t=this._parent._freeHead,i=null;null!==t;)t.count>=e&&(!i||t.count-e<i.count-e)&&(i=t),t=t.next;return i},e.prototype.findAdjacentRanges=function(e,t){for(var i=!0,n=!1,r=null,o=this._parent._freeHead;i&&!n;){var a=null!==r?r.from+r.count:0,s=null!==o?o.from:this._parent._size;a<=e&&e+t<=s?n=!(i=!1):null!==o?o=(r=o).next:i=!1}return[r,o]},e.prototype._updateLargestRange=function(){for(var e=null,t=this._parent._freeHead;null!==t;)(!e||t.count>e.count)&&(e=t),t=t.next;this._largestRange=e},e}(),n=function(){function e(e,t){this._allocated=0,this._size=e,this._freeHead=0<e?{from:0,count:e,prev:null,next:null}:null,this._bookKeeper=t||new i(this),this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}return e.prototype.allocate=function(t){var i=this._bookKeeper.findBestRange(t);if(null===i)return-1;var n=i.from,r=i.count;if(i.from+=t,i.count-=t,this._bookKeeper.rangeResized(i,n,r),this._allocated+=t,0===i.count){var o=null!==i.prev?this._freeHead:i.next;e._removeRange(i),this._freeHead=o}return n},e.prototype.free=function(t,i){var n=this._bookKeeper.findAdjacentRanges(t,i),r=n[0],o=n[1],a={from:t,count:i,prev:r,next:o};if(null!==r&&(r.next=a),null!==o&&(o.prev=a),this._bookKeeper.rangeCreated(a),this._allocated-=i,null!==o&&a.from+a.count===o.from){var s=a.from,l=a.count;e._fuse(a,o),e._removeRange(o),this._bookKeeper.rangeResized(a,s,l),this._bookKeeper.rangeResized(o,void 0,0)}null!==r&&r.from+r.count===a.from&&(s=r.from,l=r.count,e._fuse(r,a),e._removeRange(a),this._bookKeeper.rangeResized(r,s,l),this._bookKeeper.rangeResized(a,void 0,0)),this._freeHead=null!==a.prev?this._freeHead:a},Object.defineProperty(e.prototype,"fragmentation",{get:function(){var e=this._size-this._allocated;return 0===e?0:1-this._bookKeeper.largestRange.count/e},enumerable:!0,configurable:!0}),e._removeRange=function(e){null!==e.prev?null!==e.next?(e.prev.next=e.next,e.next.prev=e.prev):e.prev.next=null:null!==e.next&&(e.next.prev=null)},e._fuse=function(e,t){e.count+=t.count,e.next=t.next,t.from+=t.count,t.count=0,null!==t.next&&(t.next.prev=e)},e}();t.FreeList=n}.apply(null,n))||(e.exports=r)},bH65:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("qysZ")],void 0===(r=function(e,t,i){function n(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}function r(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}function o(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e}function a(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(i*i+n*n+r*r+o*o)}function s(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return i*i+n*n+r*r+o*o}function l(e){var t=e[0],i=e[1],n=e[2],r=e[3];return Math.sqrt(t*t+i*i+n*n+r*r)}function u(e){var t=e[0],i=e[1],n=e[2],r=e[3];return t*t+i*i+n*n+r*r}Object.defineProperty(t,"__esModule",{value:!0}),t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,i,n,r){return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e},t.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},t.subtract=n,t.multiply=r,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e},t.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},t.scaleAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e[3]=t[3]+i[3]*n,e},t.distance=a,t.squaredDistance=s,t.length=l,t.squaredLength=u,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=i*i+n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=i*a,e[1]=n*a,e[2]=r*a,e[3]=o*a),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,i,n){var r=t[0],o=t[1],a=t[2],s=t[3];return e[0]=r+n*(i[0]-r),e[1]=o+n*(i[1]-o),e[2]=a+n*(i[2]-a),e[3]=s+n*(i[3]-s),e},t.random=function(e,t){var n,r,o,a,s,l;t=t||1;do{s=(n=2*i.RANDOM()-1)*n+(r=2*i.RANDOM()-1)*r}while(s>=1);do{l=(o=2*i.RANDOM()-1)*o+(a=2*i.RANDOM()-1)*a}while(l>=1);var u=Math.sqrt((1-s)/l);return e[0]=t*n,e[1]=t*r,e[2]=t*o*u,e[3]=t*a*u,e},t.transformMat4=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3];return e[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*a,e[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*a,e[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*a,e[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*a,e},t.transformQuat=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=i[0],s=i[1],l=i[2],u=i[3],h=u*n+s*o-l*r,c=u*r+l*n-a*o,d=u*o+a*r-s*n,f=-a*n-s*r-l*o;return e[0]=h*u+f*-a+c*-l-d*-s,e[1]=c*u+f*-s+d*-a-h*-l,e[2]=d*u+f*-l+h*-s-c*-a,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],s=t[0],l=t[1],u=t[2],h=t[3];return Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-l)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-u)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-h)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))},t.sub=n,t.mul=r,t.div=o,t.dist=a,t.sqrDist=s,t.len=l,t.sqrLen=u}.apply(null,n))||(e.exports=r)},bqoF:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("hPTP")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.tileInfo={name:"tileInfo",shaders:{vertexShader:i.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:i.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},dtEy:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SIGMAS=[void 0,void 0,void 0,1],t.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],t.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t.SHADE_TEXTURE_SIZE=256,t.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}}.apply(null,n))||(e.exports=r)},eFQu:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xdHJ")],void 0===(r=function(e,t,i){function n(e){return"esri.views.2d.layers.FeatureLayerView2D"===e.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===e.declaredClass}function r(e){switch(e.get("layer.renderer.type")){case"class-breaks":case"simple":case"unique-value":return!0;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this.registerLayer=e,this.unregisterLayer=t,this._layerViewState=new i.default}return e.prototype.findIndex=function(e){return e.view.allLayerViews.findIndex(function(t){return t.uid===e.uid})},e.prototype.update=function(e){for(var t=e.added,i=0,o=e.removed;i<o.length;i++)n(l=o[i])&&this._layerViewState.has(l)&&this._deleteState(l);for(var a=0,s=t;a<s.length;a++){var l;n(l=s[a])&&r(l)&&!this._layerViewState.has(l)&&this._createState(l)}this._recomputeOrder()},e.prototype.destroy=function(){var e=this;this._layerViewState.forEach(function(t,i){return e._deleteState(i)})},e.prototype._createState=function(e){var t={priority:-1,handle:null};return t.handle=e.watch("labelsVisible",this._recomputeOrder.bind(this)),this._layerViewState.set(e,t),t},e.prototype._deleteState=function(e){if(this._layerViewState.has(e)){var t=this._layerViewState.get(e);t.handle.remove(),-1!==t.priority&&this.unregisterLayer(e),this._layerViewState.delete(e)}},e.prototype._recomputeOrder=function(){var e=this;this._layerViewState.forEach(function(t,i){var n=i.view.map.allLayers.findIndex(function(e){return e.uid===i.layer.uid}),r=i.layer,o=r.visible&&r.labelsVisible&&r.labelingInfo?4294967295-n:-1;o!==t.priority&&(t.priority=o,e.unregisterLayer(i),-1!==o&&e.registerLayer(i,o))})},e}();t.default=o}.apply(null,n))||(e.exports=r)},eprR:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("HZ3d"),i("Q2wQ"),i("0J3i"),i("WYKK"),i("ma1f"),i("qsST"),i("qMld"),i("W9tT"),i("ab6c"),i("MYW0"),i("tI6k"),i("JNkf"),i("0XPR"),i("3pdx"),i("Hoc/"),i("XCks"),i("qDit"),i("1ZJt"),i("apbF"),i("PlK1"),i("weRx")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d,f,p,v,_,m,g,y,x,b,T){var w=h.vec2f32.create(),S="arial-unicode-ms-regular",M=s.getLogger("esri.views.2d.engine.webgl.TextureManager"),E=function(){function e(e,t,i){this.mosaicType=e,this.page=t,this.sdf=i}return e.fromMosaic=function(t,i){return new e(t,i.page,i.sdf)},e}();return function(){function e(){this._invalidFontsMap=new Map,this._sdfConverter=new m.default(126),this._bindingInfos=new Array,this._hashToBindingIndex=new Map,this._spriteMosaic=new y(1024,1024,300),this._glyphSource=new _(r.fontsUrl+"/{fontstack}/{range}.pbf"),this._glyphMosaic=new v(1024,1024,this._glyphSource)}return Object.defineProperty(e.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._spriteMosaic.dispose(),this._glyphMosaic.dispose(),this._spriteMosaic=null,this._glyphMosaic=null,this._rasterizationCanvas=null},e.prototype._hashMosaic=function(e,t){return 1|e<<1|(t.sdf?1:0)<<2|t.page<<3},e.prototype._setTextureBinding=function(e,t){var i=this._hashMosaic(e,t);if(!this._hashToBindingIndex.has(i)){var n=E.fromMosaic(e,t),r=this._bindingInfos.length+1;this._hashToBindingIndex.set(i,r),this._bindingInfos.push(n)}t.textureBinding=this._hashToBindingIndex.get(i)},e.prototype.rasterizeItem=function(e,t){var i=this;return void 0===t&&(t=null),e?e.type&&-1!==e.type.toLowerCase().indexOf("3d")?(M.error(new a("mapview-invalid-type","MapView does not support 3d symbol type: "+e.type,e)),l.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!e.type||"text"!==e.type&&"esriTS"!==e.type?o.safeCast(this._rasterizeSpriteSymbol(e)).then(function(e){return b.ok(e)&&e&&i._setTextureBinding(f.MosaicType.SPRITE,e),{spriteMosaicItem:e}}):this._rasterizeTextSymbol(e,t).then(function(e){return e.forEach(function(e){return i._setTextureBinding(f.MosaicType.GLYPH,e)}),{glyphMosaicItems:e}}):(M.error(new a("mapview-null-resource","Unable to rasterize null resource")),l.resolve(null))},e.prototype.bindTextures=function(e,t,i,n){if(void 0===n&&(n=1),0!==i.textureBinding){var r=this._bindingInfos[i.textureBinding-1],o=r.page;switch(r.mosaicType){case f.MosaicType.SPRITE:var a=this.sprites.getWidth(o)/n,s=this.sprites.getHeight(o)/n,l=u.vec2.set(w,a,s);return this._bindSpritePage(e,o,d.TEXTURE_BINDING_SPRITE_ATLAS,9729),t.setUniform1i("u_texture",d.TEXTURE_BINDING_SPRITE_ATLAS),void t.setUniform2fv("u_mosaicSize",l);case f.MosaicType.GLYPH:return a=this.glyphs.width/n,s=this.glyphs.height/n,l=u.vec2.set(w,a,s),this._bindGlyphsPage(e,o,d.TEXTURE_BINDING_GLYPH_ATLAS),t.setUniform1i("u_texture",d.TEXTURE_BINDING_GLYPH_ATLAS),void t.setUniform2fv("u_mosaicSize",l);default:M.error("mapview-texture-manager","Cannot handle unknown type "+r.mosaicType)}}},e.prototype._bindSpritePage=function(e,t,i,n){n||(n=9729),this._spriteMosaic.bind(e,n,t,i)},e.prototype._bindGlyphsPage=function(e,t,i){this._glyphMosaic.bind(e,9729,t,i)},e.prototype._rasterizeTextSymbol=function(e,t){var i=this,n=p.getFullyQualifiedFontName(e.font),r=this._invalidFontsMap.has(n);return this._glyphMosaic.getGlyphItems(r?S:n,t).catch(function(e){return M.error(new a("mapview-invalid-resource","Couldn't find font "+n+". Falling back to Arial Unicode MS Regular")),i._invalidFontsMap.set(n,!0),i._glyphMosaic.getGlyphItems(S,t)})},e.prototype._rasterizeSpriteSymbol=function(e){return i(this,void 0,void 0,function(){var t,i,r,o,a,s,l;return n(this,function(n){return(h=u=e)&&(x.isFillSymbol(u)||x.isLineSymbol(u))&&"style"in u&&("solid"===u.style||"esriSFSSolid"===h.style||"esriSLSSolid"===h.style||"none"===u.style||"esriSFSNull"===h.style||"esriSLSNull"===h.style)?[2,null]:(t=function(e){if(e.type){switch(x.normalizeSymbolType(e.type)){case"simple-marker":return e.path?"simple-marker"+e.style+e.path:"simple-marker"+e.style;case"simple-line":return"simple-line"+e.style+e.cap;case"simple-fill":return"simple-fill"+e.style}if(x.isPictureSymbol(e))return e.imageData?e.imageData:e.url+""+e.width+e.height}return JSON.stringify(e)}(e),this._spriteMosaic.has(t)?[2,this._spriteMosaic.getSpriteItem(t)]:"simple-marker"!==(c=e).type&&"esriSMS"!==c.type||!c.path?(d=e).url||d.imageData?[2,this._handleImage(e,t)]:(i=this._rasterizeResource(e),r=i.size,o=i.anchor,a=i.image,s=i.sdf,l=i.simplePattern,[2,this._addItemToMosaic(t,r,o,a,!x.isMarkerSymbol(e),s,l)]):[2,this._handleSVG(e,t)]);var u,h,c,d})})},e.prototype._handleSVG=function(e,t){return i(this,void 0,void 0,function(){var i,r;return n(this,function(n){switch(n.label){case 0:return i=[126,126],[4,this._sdfConverter.draw(e.path)];case 1:return r=n.sent(),[2,this._addItemToMosaic(t,i,[0,0],new Uint32Array(r.buffer),!1,!0,!0)]}})})},e.prototype._handleImage=function(e,t){return i(this,void 0,void 0,function(){var i,r,o,s,l,u,h;return n(this,function(n){switch(n.label){case 0:i=e.imageData?"data:"+e.contentType+";base64,"+e.imageData:e.url,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,T.requestImage(i)];case 2:return r=n.sent(),o=this._rasterizeResource(r),s=o.size,l=o.anchor,u=o.sdf,h=o.image,[2,this._addItemToMosaic(t,s,l,h,!x.isMarkerSymbol(e),u,!1)];case 3:return n.sent(),[2,new a("mapview-invalid-resoure","Could not fetch requested resource at "+i)];case 4:return[2]}})})},e.prototype._rasterizeResource=function(e){if(e instanceof HTMLImageElement){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));var t=e;this._rasterizationCanvas.width=t.width,this._rasterizationCanvas.height=t.height;var i=this._rasterizationCanvas.getContext("2d");i.drawImage(t,0,0,t.width,t.height);for(var n=i.getImageData(0,0,t.width,t.height),r=new Uint8Array(n.data),o=void 0,a=0;a<r.length;a+=4)o=r[a+3]/255,r[a]=r[a]*o,r[a+1]=r[a+1]*o,r[a+2]=r[a+2]*o;var s=t.width,l=t.height,u=r;if(256<=s||256<=l){var h=t.width/t.height;1<h?(s=256,l=Math.round(256/h)):(l=256,s=Math.round(256*h)),u=new Uint8Array(4*s*l),x.resampleHermite(r,t.width,t.height,new Uint8ClampedArray(u.buffer),s,l,!1)}return{size:[s,l],anchor:[0,0],image:new Uint32Array(u.buffer),sdf:!1,simplePattern:!1}}return this._rasterizeJSON(e)},e.prototype._addItemToMosaic=function(e,t,i,n,r,o,a){return this._spriteMosaic.addSpriteItem(e,t,i,n,r,o,a)},e.prototype._rasterizeJSON=function(e){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){var t=c.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,e.style),i=t[0];return{size:[t[1],t[2]],anchor:[0,0],image:new Uint32Array(i.buffer),sdf:!1,simplePattern:!0}}if("simple-line"===e.type||"esriSLS"===e.type){var n=c.SymbolHelper.rasterizeSimpleLine(this._rasterizationCanvas,e.style,e.cap),r=n[0];return{size:[n[1],n[2]],anchor:[0,0],image:new Uint32Array(r.buffer),sdf:!0,simplePattern:!0}}var o;if("simple-marker"===e.type||"esriSMS"===e.type?(o=c.CIMSymbolHelper.fromSimpleMarker(e),1):(o=e,g.checkSDF(o))){var a=g.buildSDF(o),s=a[0];return{size:[a[1],a[2]],anchor:[0,0],image:new Uint32Array(s.buffer),sdf:!0,simplePattern:!0}}var l=c.CIMSymbolHelper.rasterize(this._rasterizationCanvas,o),u=l[0];return{size:[l[1],l[2]],anchor:[l[3],l[4]],image:new Uint32Array(u.buffer),sdf:!1,simplePattern:!1}},e}()}.apply(null,n))||(e.exports=r)},f7cP:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("F3FF")],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n,r){return void 0===t&&(t=3),void 0===i&&(i=.01),void 0===n&&(n=.95),void 0===r&&(r=12),e.call(this,t,i,n,r)||this}return i(t,e),t.prototype.add=function(t,i){if(this.value.hasLastValue){for(var n=this.value.lastValue,r=t-n;r>Math.PI;)r-=2*Math.PI;for(;r<-Math.PI;)r+=2*Math.PI;t=n+r}e.prototype.add.call(this,t,i)},t}(n.MomentumEstimator);t.RotationMomentumEstimator=r}.apply(null,n))||(e.exports=r)},f93k:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("JNkf"),i("apbF"),i("PDSL"),i("m87x")],void 0===(r=function(e,t,i,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.LABEL},t.prototype.drawGeometry=function(e,t,i,o){var s=e.context,l=e.painter,u=e.drawPhase,h=e.state,c=e.rendererInfo,d=i.indexCount,f=i.indexFrom,p=i.materialKey,v=a.LabelMaterialKey.load(p),_=v.mapAligned?1:0;if(e.requiredLevel===t.key.level||_){var m,g=(m=v,r.createProgramDescriptor(m.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_color",count:4,type:5121,normalized:!0},{location:2,name:"a_vertexOffset",count:2,type:5122},{location:3,name:"a_texAndSize",count:4,type:5121},{location:4,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:5,name:"a_vvSize",count:1,type:5126}],visibility:[{location:6,name:"a_visible",count:1,type:5121}],visibilityRange:[{location:7,name:"a_visibilityRange",count:2,type:5121}]})),y=l.materialManager.getProgram(v,u,c,"label",g.attributes),x=this._getVAO(s,g.bufferLayouts,g.attributes,o);s.setStencilTestEnabled(!1),s.bindProgram(y),s.bindVAO(x),this._setSharedUniforms(y,e,t),u===n.WGLDrawPhase.LABEL_ALPHA?(s.setBlendingEnabled(!1),y.setUniform1f("u_fadeStep",t.fader.value)):l.textureManager.bindTextures(s,y,v,4);var b=1===_?h.displayViewMat3:h.displayMat3;v.vvSizeMinMaxValue&&y.setUniform4fv("u_vvSizeMinMaxValue",c.vvSizeMinMaxValue),v.vvSizeScaleStops&&y.setUniform1f("u_vvSizeScaleStopsValue",c.vvSizeScaleStopsValue),v.vvSizeFieldStops&&(y.setUniform1fv("u_vvSizeFieldStopsValues",c.vvSizeFieldStopsValues),y.setUniform1fv("u_vvSizeFieldStopsSizes",c.vvSizeFieldStopsSizes)),v.vvSizeUnitValue&&y.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",c.vvSizeUnitValueToPixelsRatio),s.bindTexture(e.labelFBO.colorTexture,3),y.setUniform1i("u_referenceTex",3),y.setUniform1f("u_mapRotation",Math.floor(h.rotation/360*254)),y.setUniform1f("u_mapAligned",_),y.setUniformMatrix3fv("u_displayMat3",b),y.setUniform1f("u_opacity",1),y.setUniform1f("u_zoomLevel",Math.round(10*e.displayLevel)),y.setUniform2fv("u_screenSize",e.state.size),s.drawElements(4,d,5125,4*f),s.bindVAO(null),s.setStencilTestEnabled(!0),s.setBlendingEnabled(!0)}},t}(o.default);t.default=s}.apply(null,n))||(e.exports=r)},fUL3:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("PND3"),i("QVms"),i("lRq4"),i("lAK8"),i("f3JK")],void 0===(r=function(e,t,i,n,r,o,a){function s(e,t){var i=e.bounds,n=t.bounds;return e.key.id!==t.key.id&&e.key.world===t.key.world&&i[0]<=n[0]&&i[1]<=n[1]&&i[2]>=n[2]&&i[3]>=n[3]}Object.defineProperty(t,"__esModule",{value:!0}),t.isParentOf=s,t.isChildOf=function(e,t){return s(t,e)};var l=function(){function e(e,t){this.bounds=r.create(),this.key=new a(0,0,0,0),this.objectIds=new i.default,this.key.set(t);var n=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=n.resolution,this.scale=n.scale,this.level=n.level,this.needsClear=!0}return Object.defineProperty(e.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.tileInfoView,this.id)},e.prototype.createChildTiles=function(){for(var t=this.key.getChildKeys(),i=n.acquire(),r=0;r<t.length;r++)i[r]=new e(this.tileInfoView,t[r]);return i},e.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},e}();t.Tile=l,t.default=l}.apply(null,n))||(e.exports=r)},fw2w:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("0J3i"),i("ma1f"),i("qsST"),i("qMld"),i("Vt+U"),i("aYWh"),i("Z4y+"),i("nrlZ"),i("vtMp"),i("xuSL")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c){function d(e){return"polygon"===e.type}function f(e){return"polygon"===e[0].type}function p(e){return"polyline"===e[0].type}function v(e){return d(e)?e.rings:e.paths}function _(e,t){return Math.ceil((e-t)/(2*t))}function m(e,t){for(var i=0,n=v(e);i<n.length;i++)for(var r=0,o=n[i];r<o.length;r++){o[r][0]+=t}return e}function g(e){for(var t=[],i=0,n=0,r=0;r<e.length;r++){for(var o=e[r],a=null,s=0;s<o.length;s++)a=o[s],t.push(a),0===s?n=i=a[0]:(i=Math.min(i,a[0]),n=Math.max(n,a[0]));a&&t.push([(i+n)/2,0])}return t}function y(e,t){if(!(e instanceof s||e instanceof a)){var i="straightLineDensify: the input geometry is neither polyline nor polygon";throw M.error(i),new n(i)}for(var r=[],o=0,l=v(e);o<l.length;o++){var u=l[o],h=[];r.push(h),h.push([u[0][0],u[0][1]]);for(var c=0;c<u.length-1;c++){var f=u[c][0],p=u[c][1],_=u[c+1][0],m=u[c+1][1],g=Math.sqrt((_-f)*(_-f)+(m-p)*(m-p)),y=(m-p)/g,x=(_-f)/g,b=g/t;if(b>1){for(var T=1;T<=b-1;T++){var w=T*t,S=x*w+f,E=y*w+p;h.push([S,E])}var C=(g+Math.floor(b-1)*t)/2,I=x*C+f,F=y*C+p;h.push([I,F])}h.push([_,m])}}return d(e)?new a({rings:r,spatialReference:e.spatialReference}):new s({paths:r,spatialReference:e.spatialReference})}function x(e,t,i){if(t){var n=y(e,1e6);e=h.webMercatorToGeographic(n,!0)}return i&&(e=m(e,i)),e}function b(e,t,i){var n;if(Array.isArray(e)){if((n=e[0])>t){var r=_(n,t);e[0]=n+r*(-2*t)}else if(n<i){r=_(n,i);e[0]=n+r*(-2*i)}}else if((n=e.x)>t){r=_(n,t);e=e.clone().offset(r*(-2*t),0)}else if(n<i){r=_(n,i);e=e.clone().offset(r*(-2*i),0)}return e}function T(e,t){for(var i=-1,n=0;n<t.cutIndexes.length;n++)!function(n){for(var r=t.cutIndexes[n],o=t.geometries[n],a=v(o),s=0;s<a.length;s++)!function(e){var t=a[e];t.some(function(i){if(i[0]<180)return!0;for(var n=0,r=0;r<t.length;r++){var a=t[r][0];n=a>n?a:n}for(var s=-360*_(n=Number(n.toFixed(9)),180),l=0;l<t.length;l++){var u=o.getPoint(e,l);o.setPoint(e,l,u.clone().offset(s,0))}return!0})}(s);if(r===i){if(f(e))for(var l=0,u=v(o);l<u.length;l++){var h=u[l];e[r]=e[r].addRing(h)}else if(p(e))for(var c=0,d=v(o);c<d.length;c++){var m=d[c];e[r]=e[r].addPath(m)}}else i=r,e[r]=o}(n);return e}function w(){return S||(S=new c({url:i.geometryServiceUrl})),S}Object.defineProperty(t,"__esModule",{value:!0});var S,M=r.getLogger("esri.geometry.support.normalizeUtils"),E={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new s({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:l.WebMercator}),minus180Line:new s({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:l.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new s({paths:[[[180,-180],[180,180]]],spatialReference:l.WebMercator}),minus180Line:new s({paths:[[[-180,-180],[-180,180]]],spatialReference:l.WebMercator})}};t.straightLineDensify=y,t.normalizeCentralMeridian=function e(t,i,n){if(!Array.isArray(t))return e([t],i);i||(i=w());for(var r,l,c,d,f,p,v,g,y=0,S=[],M=[],C=0,I=t;C<I.length;C++){var F=I[C];if(F)if(r||(r=F.spatialReference,l=u.getInfo(r),c=r.isWebMercator,d=E[p=c?102100:4326].maxX,f=E[p].minX,v=E[p].plus180Line,g=E[p].minus180Line),l)if("mesh"===F.type)M.push(F);else if("point"===F.type)M.push(b(F.clone(),d,f));else if("multipoint"===F.type){var A=F.clone();A.points=A.points.map(function(e){return b(e,d,f)}),M.push(A)}else if("extent"===F.type){var O=(P=F.clone())._normalize(!1,!1,l);M.push(O.rings?new a(O):O)}else if(F.extent){var P,R=_((P=F.extent).xmin,f)*(2*d),D=0===R?F.clone():m(F.clone(),R);P.offset(R,0),P.intersects(v)&&P.xmax!==d?(y=P.xmax>y?P.xmax:y,D=x(D,c),S.push(D),M.push("cut")):P.intersects(g)&&P.xmin!==f?(y=P.xmax*(2*d)>y?P.xmax*(2*d):y,D=x(D,c,360),S.push(D),M.push("cut")):M.push(D)}else M.push(F.clone());else M.push(F);else M.push(F)}for(var L=_(y,d),B=-90,V=L,z=new s;L>0;){var G=360*L-180;z.addPath([[G,B],[G,-1*B]]),B*=-1,L--}if(S.length>0&&V>0)return i.cut(S,z,n).then(function(e){return T(S,e)}).then(function(e){for(var r=[],o=[],a=0;a<M.length;a++){var s=M[a];if("cut"!==s)o.push(s);else{var l=e.shift(),u=t[a];"polygon"===u.type&&u.rings&&u.rings.length>1&&l.rings.length>=u.rings.length?(r.push(l),o.push("simplify")):o.push(c?h.geographicToWebMercator(l):l)}}return r.length?i.simplify(r,n).then(function(e){for(var t=[],i=0;i<o.length;i++){var n=o[i];"simplify"!==n?t.push(n):t.push(c?h.geographicToWebMercator(e.shift()):e.shift())}return t}):o});for(var N=[],U=0;U<M.length;U++){var k=M[U];if("cut"!==k)N.push(k);else{var H=S.shift();N.push(!0===c?h.geographicToWebMercator(H):H)}}return o.resolve(N)},t.getDenormalizedExtent=function(e){var t;if(!e)return null;var i=e.extent;if(!i)return null;var n=e.spatialReference&&u.getInfo(e.spatialReference);if(!n)return i;var r,o=n.valid,a=o[0],s=o[1],l=2*s,h=i.width,c=i.xmin,d=i.xmax;if(c=(t=[d,c])[0],d=t[1],"extent"===e.type||0===h||h<=s||h>l||c<a||d>s)return i;switch(e.type){case"polygon":if(!(e.rings.length>1))return i;r=g(e.rings);break;case"polyline":if(!(e.paths.length>1))return i;r=g(e.paths);break;case"multipoint":r=e.points}for(var f=i.clone(),p=0;p<r.length;p++){var v=r[p][0];v<0?(v+=s,d=Math.max(v,d)):(v-=s,c=Math.min(v,c))}return f.xmin=c,f.xmax=d,f.width<h?(f.xmin-=s,f.xmax-=s,f):i},t.normalizeMapX=function(e,t){var i=u.getInfo(t);if(i){var n=i.valid,r=n[0],o=n[1],a=o-r;if(e<r)for(;e<r;)e+=a;if(e>o)for(;e>o;)e-=a}return e}}.apply(null,n))||(e.exports=r)},gm1X:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("ll/V"),i("xdHJ"),i("tI6k"),i("TF9k"),i("S0eh"),i("Bbit"),i("AzkI")],void 0===(r=function(e,t,i,n,r,o,a,s,l){Object.defineProperty(t,"__esModule",{value:!0});var u=r.TILE_SIZE/r.COLLISION_BUCKET_SIZE,h=u,c=function(){function e(e){this._layers=new n.default,this._collisionBuckets=new n.default,this._tilingScheme=e}return Object.defineProperty(e.prototype,"collisionInfos",{get:function(){var e=[];return s.forEachIter(this._layers.values(),function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),e.prototype.registerLayer=function(e,t,i){if(e&&!this._layers.has(e.uid)){var n=a.default.create(e,t,i,this.collisionInfos,this._tilingScheme);this._layers.set(e.uid,n),this._collisionBuckets.forEach(function(e){return e.onRegisterLayer(n.index)})}},e.prototype.unregisterLayer=function(e){var t=this;if(e&&this._layers.has(e.uid)){var i=this._layers.get(e.uid);a.default.delete(i.index,this.collisionInfos),this._layers.delete(e.uid),this._collisionBuckets.forEach(function(e,n){var r=e.getTile(i.index);r&&(e.onUnregisterLayer(i.index),e.canDelete()&&t._collisionBuckets.delete(n),r.reference&&(r.reference.isDirty=!1))})}},e.prototype.addTile=function(e,t){var i=t.key.id;this._layers.has(e)&&(this._collisionBuckets.has(i)||this._collisionBuckets.set(i,new o.default(t.key,this._layers.size)),this._collisionBuckets.get(i).getTile(this._getIndex(e)).reference=t)},e.prototype.removeTile=function(e,t){if(this._layers.has(e)&&this._collisionBuckets.has(t)){var i=this._collisionBuckets.get(t).getTile(this._getIndex(e));i.dirty=!1,i.reference=null}},e.prototype.run=function(e,t){for(var n=i.from(this._collisionBuckets.values()).filter(function(e){return e.key.level===t}).sort(function(e,t){return e.key.compareRowMajor(t.key)}),r=this._checkRotation(e.rotation),o=0,s=n;o<s.length;o++){var l=s[o];r=r||l.isDirty;for(var u=0;u<this._layers.size;u++){var h=a.default.find(u,this.collisionInfos);l.computeNeighbors(this._collisionBuckets),l.reset(e,r,h)}}for(var c=0;c<this._layers.size;c++){h=a.default.find(c,this.collisionInfos);for(var d=0,f=n;d<f.length;d++)l=f[d],this._run(l,h,t)}for(var p=0,v=n;p<v.length;p++)(l=v[p]).ready()},e.prototype._run=function(e,t,i){var n=e.getReference(t.index);n&&n.isDirty&&n.hasData&&this._runVisibility(e,n,t,i)},e.prototype._runVisibility=function(e,t,i,n){for(var r=0,o=t.displayObjects;r<o.length;r++){for(var a=o[r],s=0,l=0;l<a.metrics.length;l++){var u=a.metrics[l],h=a.getLabelVisibility(i.layerView)?this._computeLabelVisibility(a,u,i.index,e,t,u.baseZoom,n):255;s=Math.max(h,s)}for(var c=0,d=a.metrics;c<d.length;c++)u=d[c],t.setVisibilityRange(a.id,u.range.from,u.range.count,s),u.minZoom=s}},e.prototype._computeLabelVisibility=function(e,t,i,n,r,o,a){for(var s=o,l=t.xBucket,c=t.yBucket,d=t.xOverflow,f=t.yOverflow,p=l-d,v=l+d+1,_=c+f+1,m=c-f;m<_;m++)for(var g=p;g<v;g++)if(!(g<-u||m<-h||u<g||h<m))for(var y=0;y<=i;y++){var x=this._getRelativeSubBucket(y,n,r,g,m);if(x)for(var b=0,T=x;b<T.length;b++){var w=T[b];if(w.id!==e.id){var S=this._compareLabels(t,w,s,a);s=Math.max(S,s)}}}return s},e.prototype._compareLabels=function(e,t,i,n){var o=10*(n+r.COLLISION_MAX_ZOOM_DELTA);if(-1===t.minZoom||t.minZoom>o||t.minZoom>Math.floor(10*n))return i;var a=e.findCollisionDelta(t),s=l.clamp(Math.floor(10*(a+n)),0,255);return t.minZoom>=s?i:Math.max(i,s)},e.prototype._getNeighboringTile=function(e,t,i,n,r){var o=3*(1+r)+(1+n),a=t.neighbors[o];return a&&a.getTile(e)},e.prototype._getRelativeSubBucket=function(e,t,i,n,r){var o=l.sign(Math.floor(n/4)),a=l.sign(Math.floor(r/4)),s=this._getNeighboringTile(e,t,i,o,a);return s&&s.reference&&s.index&&s.reference.hasData?s.index[r-4*a][n-4*o]:null},e.prototype._checkRotation=function(e){if(!this._lastRotation)return this._lastRotation=e,!1;var t=e!==this._lastRotation;return this._lastRotation=e,t},e.prototype._getIndex=function(e){return this._layers.get(e).index},e}();t.default=c}.apply(null,n))||(e.exports=r)},gvME:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("JNkf"),i("apbF"),i("PDSL"),i("m87x")],void 0===(r=function(e,t,i,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.LINE},t.prototype.drawGeometry=function(e,t,i,n){var o,s=e.context,l=e.painter,u=e.rendererInfo,h=e.requiredLevel,c=e.drawPhase,d=i.indexFrom,f=i.indexCount,p=i.materialKey,v=a.LineMaterialKey.load(p),_=(o=v,r.createProgramDescriptor(o.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121,normalized:!0},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120}].concat(o.hasVV()?[{location:7,name:"a_vv",count:3,type:5126}]:[]),visibility:[{location:8,name:"a_visible",count:1,type:5121}]})),m=l.materialManager.getProgram(v,c,u,"line",_.attributes),g=this._getVAO(s,_.bufferLayouts,_.attributes,n),y=1/e.pixelRatio;s.bindProgram(m),s.bindVAO(g),this._setSharedUniforms(m,e,t),v.textureBinding&&l.textureManager.bindTextures(s,m,v);var x=Math.pow(2,h-t.key.level)/e.pixelRatio;m.setUniform1f("u_zoomFactor",x),m.setUniform1f("u_blur",0+y),m.setUniform1f("u_antialiasing",y),v.vvSizeMinMaxValue&&m.setUniform4fv("u_vvSizeMinMaxValue",u.vvSizeMinMaxValue),v.vvSizeScaleStops&&m.setUniform1f("u_vvSizeScaleStopsValue",u.vvSizeScaleStopsValue),v.vvSizeFieldStops&&(m.setUniform1fv("u_vvSizeFieldStopsValues",u.vvSizeFieldStopsValues),m.setUniform1fv("u_vvSizeFieldStopsSizes",u.vvSizeFieldStopsSizes)),v.vvSizeUnitValue&&m.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",u.vvSizeUnitValueToPixelsRatio),v.vvColor&&(m.setUniform1fv("u_vvColorValues",u.vvColorValues),m.setUniform4fv("u_vvColors",u.vvColors)),v.vvOpacity&&(m.setUniform1fv("u_vvOpacityValues",u.vvOpacityValues),m.setUniform1fv("u_vvOpacities",u.vvOpacities)),s.setFaceCullingEnabled(!0),s.setFrontFace(2305),s.setCullFace(1029),s.drawElements(4,f,5125,4*d),s.setFaceCullingEnabled(!1),s.bindVAO(null)},t}(o.default);t.default=s}.apply(null,n))||(e.exports=r)},hPTP:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("Uu9s"),i("IROT")],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=new n(function(e){var t=i;return e.split("/").forEach(function(e){t&&(t=t[e])}),t});t.resolveIncludes=function(e){return r.resolveIncludes(e)}}.apply(null,n))||(e.exports=r)},j2SP:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("3gjc")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.vec4f32=i}.apply(null,n))||(e.exports=r)},kDn6:function(e,t,i){var n,r;n=[i("ajsq"),i("G/ag"),i("Ksvq"),i("ZcSO")],void 0===(r=function(e,t,i,n){return e("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(e){var t=this._attrPairNames;return t[e]?t[e]:t[e]={s:"_"+e+"Setter",g:"_"+e+"Getter"}},postscript:function(e){e&&this.set(e)},_get:function(e,t){return"function"==typeof this[t.g]?this[t.g]():this[e]},get:function(e){return this._get(e,this._getAttrNames(e))},set:function(e,t){if("object"==typeof e){for(var i in e)e.hasOwnProperty(i)&&"_watchCallbacks"!=i&&this.set(i,e[i]);return this}var r,o=this._getAttrNames(e),a=this._get(e,o),s=this[o.s];if("function"==typeof s?r=s.apply(this,Array.prototype.slice.call(arguments,1)):this[e]=t,this._watchCallbacks){var l=this;n(r,function(){l._watchCallbacks(e,a,t)})}return this},_changeAttrValue:function(e,t){var i=this.get(e);return this[e]=t,this._watchCallbacks&&this._watchCallbacks(e,i,t),this},watch:function(e,t){var n=this._watchCallbacks;if(!n){var r=this;n=this._watchCallbacks=function(e,t,i,o){var a=function(n){if(n)for(var o=0,a=(n=n.slice()).length;o<a;o++)n[o].call(r,e,t,i)};a(n["_"+e]),o||a(n["*"])}}t||"function"!=typeof e?e="_"+e:(t=e,e="*");var o=n[e];"object"!=typeof o&&(o=n[e]=[]),o.push(t);var a={};return a.unwatch=a.remove=function(){var e=i.indexOf(o,t);e>-1&&o.splice(e,1)},a}})}.apply(null,n))||(e.exports=r)},kLlh:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("0LE5"),i("Rdxj"),i("E9c0"),i("2JMt")],void 0===(r=function(e,t,i,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,i,n,r,o){var a=e.call(this,t,i,n)||this;return a.sceneVelocity=r,a.direction=o,a}return i(t,e),t.prototype.value=function(t){return e.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,t)},t}(a.Momentum);t.PanPlanarMomentum=s;var l=function(){function e(e,t,i){void 0===e&&(e=300),void 0===t&&(t=12),void 0===i&&(i=.84),this.minimumInitialVelocity=e,this.stopVelocity=t,this.friction=i,this.time=new o.FilteredFiniteDifference(.6),this.screen=[new o.FilteredFiniteDifference(.4),new o.FilteredFiniteDifference(.4)],this.scene=[new o.FilteredFiniteDifference(.6),new o.FilteredFiniteDifference(.6),new o.FilteredFiniteDifference(.6)],this.tmpDirection=r.vec3f64.create()}return e.prototype.add=function(e,t,i){this.time.hasLastValue&&this.time.computeDelta(i)<.015||(this.screen[0].update(e[0]),this.screen[1].update(e[1]),this.scene[0].update(t[0]),this.scene[1].update(t[1]),this.scene[2].update(t[2]),this.time.update(i))},e.prototype.reset=function(){this.screen[0].reset(),this.screen[1].reset(),this.scene[0].reset(),this.scene[1].reset(),this.scene[2].reset(),this.time.reset()},e.prototype.evaluateMomentum=function(){if(!this.screen[0].hasFilteredDelta)return null;var e=this.screen[0].filteredDelta,t=this.screen[1].filteredDelta,i=Math.sqrt(e*e+t*t)/this.time.filteredDelta;return Math.abs(i)<this.minimumInitialVelocity?null:this.createMomentum(i,this.stopVelocity,this.friction)},e.prototype.createMomentum=function(e,t,i){n.vec3.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);var r=n.vec3.length(this.tmpDirection);r>0&&n.vec3.scale(this.tmpDirection,this.tmpDirection,1/r);var o=r/this.time.filteredDelta;return new s(e,t,i,o,this.tmpDirection)},e}();t.PanPlanarMomentumEstimator=l}.apply(null,n))||(e.exports=r)},kUhT:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("qKT0"),i("Gtr7"),i("7MDj"),i("rMND"),i("Vx27"),i("gm1X"),i("eFQu")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u){Object.defineProperty(t,"__esModule",{value:!0});var h=64,c=function(e){function t(t){var i=e.call(this)||this;return i._applyVisivilityPassThrottled=a.throttle(i._applyVisivilityPass,h,i),i._previousResolution=Number.POSITIVE_INFINITY,i.lastUpdateId=-1,i.updateRequested=!1,i.view=null,i}return i(t,e),t.prototype.initialize=function(){var e=this;this.collisionEngine=new l.default(this.view.featuresTilingScheme),this._layerViewSorter=new u.default(function(t,i){e.collisionEngine.registerLayer(t.layer,t,i);var n=t.tileRenderer;n&&n.forEachTile(function(i){i.isDirty=!0,e.addTile(t.layer.uid,i)}),e.requestUpdate()},function(t){e.collisionEngine.unregisterLayer(t.layer),e.requestUpdate()}),this.handles.add(this.view.allLayerViews.on("change",function(t){e._layerViewSorter.update(t)}))},t.prototype.destroy=function(){this._layerViewSorter.destroy(),this._layerViewSorter=null,this.collisionEngine=null,this._applyVisivilityPassThrottled.remove()},Object.defineProperty(t.prototype,"updating",{get:function(){return this.updateRequested},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this._previousResolution,i=e.state.resolution;this._previousResolution=i,i===t&&this._applyVisivilityPassThrottled(e)},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate(this))},t.prototype.processUpdate=function(e){this._set("updateParameters",e),this.updateRequested&&(this.update(e),this.updateRequested=!1)},t.prototype.addTile=function(e,t){this.collisionEngine.addTile(e,t)},t.prototype.removeTile=function(e,t){this.collisionEngine.removeTile(e,t)},t.prototype._applyVisivilityPass=function(e){var t=this.view.featuresTilingScheme.getClosestInfoForScale(e.state.scale).level;this.collisionEngine.run(e.state,t)},n([s.property()],t.prototype,"updateRequested",void 0),n([s.property({readOnly:!0})],t.prototype,"updateParameters",void 0),n([s.property({dependsOn:["updateRequested"]})],t.prototype,"updating",null),n([s.property()],t.prototype,"view",void 0),n([s.subclass("esri.views.2d.layers.labels.LabelManager")],t)}(s.declared(r,o));t.default=c}.apply(null,n))||(e.exports=r)},"nL6+":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("hPTP")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.transformTexture={name:"transform-texture",shaders:{vertexShader:i.resolveIncludes("raster/transform.vert"),fragmentShader:i.resolveIncludes("raster/texture.frag")},attributes:{a_position:0,a_texcoord:1}},t.transformSolid={name:"transform-solid",shaders:{vertexShader:i.resolveIncludes("raster/transform.vert"),fragmentShader:i.resolveIncludes("raster/solid.frag")},attributes:{a_position:0}}}.apply(null,n))||(e.exports=r)},oDRR:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("LxLY"),i("jBNx"),i("8uEs"),i("oZZu"),i("4oaH"),i("tI6k"),i("apbF")],void 0===(r=function(e,t,i,n,r,o,a,s,l){function u(e,t){var i=t.length;if(e<t[0].value||1===i)return t[0].size;for(var n=1;n<i;n++)if(e<t[n].value){var r=(e-t[n-1].value)/(t[n].value-t[n-1].value);return t[n-1].size+r*(t[n].size-t[n-1].size)}return t[i-1].size}function h(e,t,i){void 0===i&&(i=0);var n=t.r,r=t.g,o=t.b,a=t.a;e[i+0]=n*a/255,e[i+1]=r*a/255,e[i+2]=o*a/255,e[i+3]=a}var c=function(e,t,i){for(var n=16*i,r=n,o=0;r<Math.min(n+16,e.length);r++,o++)e[r]=t[o]},d=o.mat4f32.create(),f=o.mat4f32.fromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return function(){function e(){this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.vvSizeFieldStopsValues=new Float32Array(6),this.vvSizeFieldStopsSizes=new Float32Array(6),this.ddColors=new Float32Array(32),this.ddBackgroundColor=new Float32Array(4),this.insideEffect=new Float32Array(16*s.MAX_FILTERS),this.outsideEffect=new Float32Array(16*s.MAX_FILTERS),this.effectCount=0,this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1},this.symbolLevels.push(0),c(this.insideEffect,d,0),c(this.outsideEffect,f,0);for(var e=1;e<s.MAX_FILTERS;e++)c(this.insideEffect,d,e),c(this.outsideEffect,d,e)}return Object.defineProperty(e.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0}),e.prototype.update=function(e,t,n,r){var o=this;switch(i.isSome(r)?(r.forEach(function(e,t){return o._updateEffects(t,e)}),this.effectCount=r.length):this.effectCount=0,n&&this._updateVisualVariables(n,e),t.type){case"dot-density":this._updateDotDensityInfo(t.attributes),this.ddDotValue=t.referenceDotValue,this.ddDotScale=t.referenceScale,this.ddDotSize=t.dotSize,this.ddDotBlending=t.blendDots,this.ddSeed=t.seed,h(this.ddBackgroundColor,t.backgroundColor)}},e.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount}},e.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2},e.prototype._updateEffects=function(e,t){var n=e+1;if(i.isSome(t)&&t.filter&&t.filter.enabled){this.outsideLabelsVisible=t.excludedLabelsVisible;var r=t.parsedIncludedEffect,o=t.parsedExcludedEffect;i.isSome(r)?c(this.insideEffect,r.getColorMatrix(),n):c(this.insideEffect,d,n),i.isSome(o)?c(this.outsideEffect,o.getColorMatrix(),n):c(this.outsideEffect,d,n)}else c(this.insideEffect,d,n),c(this.outsideEffect,d,n)},e.prototype._updateVisualVariables=function(e,t){var i=this._vvMaterialParameters;if(i.vvOpacityEnabled=!1,i.vvSizeEnabled=!1,i.vvColorEnabled=!1,i.vvRotationEnabled=!1,e){var o=e.size;if(o){if(i.vvSizeEnabled=!0,o.minMaxValue){var s=o.minMaxValue,h=void 0,c=void 0;if(l.isDefined(s.minSize)&&l.isDefined(s.maxSize))if(l.isNumber(s.minSize)&&l.isNumber(s.maxSize))h=n.pt2px(s.minSize),c=n.pt2px(s.maxSize);else{var d=t.scale;h=n.pt2px(u(d,s.minSize.stops)),c=n.pt2px(u(d,s.maxSize.stops))}this.vvSizeMinMaxValue.set([s.minDataValue,s.maxDataValue,h,c])}if(o.scaleStops&&(this.vvSizeScaleStopsValue=n.pt2px(u(t.scale,o.scaleStops.stops))),o.unitValue){var f=r.getMetersPerUnitForSR(t.spatialReference)/a.meterIn[o.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=f/t.resolution}o.fieldStops&&(this.vvSizeFieldStopsValues.set(o.fieldStops.values),this.vvSizeFieldStopsSizes.set(o.fieldStops.sizes))}var p=e.color;p&&(i.vvColorEnabled=!0,this.vvColorValues.set(p.values),this.vvColors.set(p.colors));var v=e.opacity;v&&(i.vvOpacityEnabled=!0,this.vvOpacityValues.set(v.values),this.vvOpacities.set(v.opacities));var _=e.rotation;_&&(i.vvRotationEnabled=!0,i.vvRotationType=_.type)}},e.prototype._updateDotDensityInfo=function(e){for(var t=this.ddColors,i=0;i<Math.min(s.DOT_DENSITY_MAX_FIELDS,e.length);i++)h(t,e[i].color,4*i)},e}()}.apply(null,n))||(e.exports=r)},oF5M:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("tI6k"),i("dtEy"),i("TEGq"),i("QFi0"),i("U+8K"),i("z2+Q")],void 0===(r=function(e,t,i,n,r,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){this._width=void 0,this._height=void 0,this._resources=null}return e.prototype.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)},e.prototype.preBlur=function(e,t){e.bindTexture(t,i.TEXTURE_BINDING_HIGHLIGHT_0),e.bindProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",n.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype.finalBlur=function(e,t){e.bindTexture(t,i.TEXTURE_BINDING_HIGHLIGHT_0),e.bindProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",n.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype.renderHighlight=function(e,t,n){e.bindTexture(t,i.TEXTURE_BINDING_HIGHLIGHT_0),e.bindProgram(this._resources.highlightProgram),n.applyHighlightOptions(e,this._resources.highlightProgram),e.bindVAO(this._resources.quadVAO),e.setBlendingEnabled(!0),e.setBlendFunction(1,771),e.drawArrays(5,0,4),e.bindVAO()},e.prototype._initialize=function(e,t,l){this._width=t,this._height=l;var u=new o(e,34962,35044,new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]).buffer),h=new s(e,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:u}),c=a.createProgram(e,r.highlight),d=a.createProgram(e,r.blur);c.setUniform1i("u_texture",i.TEXTURE_BINDING_HIGHLIGHT_0),c.setUniform1i("u_shade",i.TEXTURE_BINDING_HIGHLIGHT_1),c.setUniform4fv("u_sigmas",n.SIGMAS),d.setUniform1i("u_texture",i.TEXTURE_BINDING_HIGHLIGHT_0),d.setUniform4fv("u_sigmas",n.SIGMAS),this._resources={quadGeometry:u,quadVAO:h,highlightProgram:c,blurProgram:d}},e.prototype.setup=function(e,t,i){this._resources?(this._width=t,this._height=i):this._initialize(e,t,i)},e}();t.default=l}.apply(null,n))||(e.exports=r)},p2sx:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("j2SP"),i("tI6k"),i("3+7H"),i("TQvW"),i("QFi0"),i("U+8K"),i("z2+Q")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u){Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){function t(){var t=e.call(this)||this;return t._color=n.vec4f32.fromValues(1,0,0,1),t._initialized=!1,t}return i(t,e),t.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null),this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)},t.prototype.draw=function(e,t){var i=e.context;this._initialized||this._initialize(i),i.setStencilFunctionSeparate(1032,519,t.stencilRef,255),i.bindVAO(this._solidVertexArrayObject),i.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix3fv("u_dvsMat3",t.dvsMat3),this._solidProgram.setUniform1f("u_coord_range",r.TILE_SIZE),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),i.drawArrays(5,0,4),i.bindVAO()},t.prototype._initialize=function(e){if(this._initialized)return!0;var t=l.createProgram(e,a.background);if(!t)return!1;var i=new Int8Array([0,0,1,0,0,1,1,1]),n=s.createVertex(e,35044,i),r=new u(e,a.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:n});return this._solidProgram=t,this._solidVertexArrayObject=r,this._initialized=!0},t}(o.default);t.default=h}.apply(null,n))||(e.exports=r)},pvXx:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("2Atf"),i("xdHJ"),i("JNkf"),i("wdp+"),i("U+8K")],void 0===(r=function(e,t,i,n,r,o,a){var s=function(e){return e===r.WGLDrawPhase.HITTEST||e===r.WGLDrawPhase.LABEL_ALPHA},l=function(e,t,i){return i.getVariationHash()+"-"+((s(n=e)?1:0)|(n===r.WGLDrawPhase.HIGHLIGHT?2:0))+"-"+t.getVariationHash();var n};return function(){function e(e){this._programByKey=new n.default,this._programCache=new a.ProgramCache(e)}return e.prototype.dispose=function(){this._programCache&&this._programCache.dispose()},e.prototype.getProgram=function(e,t,n,a,u){var h=l(t,n,e);if(this._programByKey.has(h))return this._programByKey.get(h);var c,d,f=(c=t,d=n,i({},e.getVariation(),d.getVariation(),{highlight:c===r.WGLDrawPhase.HIGHLIGHT,id:s(c)})),p=this._programCache.getProgram(o.createProgramTemplate(a,u),f);if(!p)throw new Error("Unable to get program for key: ${key}");return this._programByKey.set(h,p),p},e}()}.apply(null,n))||(e.exports=r)},q4Xm:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("qKT0"),i("Gtr7"),i("jBNx"),i("Vx27")],void 0===(r=function(e,t,i,n,r,o,a){var s="esri-zoom-box__container",l="esri-zoom-box__overlay",u="esri-zoom-box__overlay-background",h="esri-zoom-box__outline",c="Shift",d="Ctrl";return function(e){function t(t){var i=e.call(this,t)||this;return i._container=null,i._overlay=null,i._backgroundShape=null,i._boxShape=null,i._box={x:0,y:0,width:0,height:0},i._redraw=i._redraw.bind(i),i}return i(t,e),t.prototype.destroy=function(){this.view=null},Object.defineProperty(t.prototype,"view",{set:function(e){var t=this;this._handles&&this._handles.forEach(function(e){e.remove()}),this._handles=null,this._destroyOverlay(),this._set("view",e),e&&(e.on("drag",[c],function(e){return t._handleDrag(e,1)}),e.on("drag",[c,d],function(e){return t._handleDrag(e,-1)}))},enumerable:!0,configurable:!0}),t.prototype._start=function(e,t,i,n){this._createContainer(),this._createOverlay(),this.navigation.begin()},t.prototype._update=function(e,t,i,n){this._box.x=e,this._box.y=t,this._box.width=i,this._box.height=n,this._rafId||(this._rafId=requestAnimationFrame(this._redraw))},t.prototype._end=function(e,t,i,n,r){var a=this.view,s=a.toMap(o.createScreenPoint(e+.5*i,t+.5*n)),l=Math.max(i/a.width,n/a.height);-1===r&&(l=1/l),this._destroyOverlay(),this.navigation.end(),a.goTo({center:s,scale:a.scale*l})},t.prototype._updateBox=function(e,t,i,n){var r=this._boxShape;r.setAttributeNS(null,"x",""+e),r.setAttributeNS(null,"y",""+t),r.setAttributeNS(null,"width",""+i),r.setAttributeNS(null,"height",""+n),r.setAttributeNS(null,"class",h)},t.prototype._updateBackground=function(e,t,i,n){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(e,t,i,n,this.view.width,this.view.height))},t.prototype._createContainer=function(){var e=document.createElement("div");e.className=s,this.view.root.appendChild(e),this._container=e},t.prototype._createOverlay=function(){var e=this.view.width,t=this.view.height,i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttributeNS(null,"d","M 0 0 L "+e+" 0 L "+e+" "+t+" L 0 "+t+" Z"),i.setAttributeNS(null,"class",u);var n=document.createElementNS("http://www.w3.org/2000/svg","rect"),r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),r.setAttributeNS(null,"class",l),r.appendChild(i),r.appendChild(n),this._container.appendChild(r),this._backgroundShape=i,this._boxShape=n,this._overlay=r},t.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=this._backgroundShape=this._boxShape=this._overlay=null},t.prototype._toSVGPath=function(e,t,i,n,r,o){var a=e+i,s=t+n;return"M 0 0 L "+r+" 0 L "+r+" "+o+" L 0 "+o+" ZM "+e+" "+t+" L "+e+" "+s+" L "+a+" "+s+" L "+a+" "+t+" Z"},t.prototype._handleDrag=function(e,t){var i,n,r,o,a=e.x,s=e.y,l=e.origin.x,u=e.origin.y;switch(a>l?(i=l,r=a-l):(i=a,r=l-a),s>u?(n=u,o=s-u):(n=s,o=u-s),e.action){case"start":this._start(i,n,r,o);break;case"update":this._update(i,n,r,o);break;case"end":this._end(i,n,r,o,t)}e.stopPropagation()},t.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var e=this._box,t=e.x,i=e.y,n=e.width,r=e.height;this._updateBox(t,i,n,r),this._updateBackground(t,i,n,r),this._rafId=requestAnimationFrame(this._redraw)}},n([a.property()],t.prototype,"navigation",void 0),n([a.property()],t.prototype,"view",null),n([a.subclass("esri.views.2d.navigation.ZoomBox")],t)}(a.declared(r))}.apply(null,n))||(e.exports=r)},qbr3:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("2Atf")],void 0===(r=function(e,t,i){function n(e){return b.intern(e)}function r(e){return T.intern(e)}function o(e){return w.intern(e)}function a(e){return S.intern(e)}function s(e){return M.intern(e)}function l(e){return E.intern(e)}function u(e){return C.intern(e)}function h(e){return I.intern(e)}function c(e){return"["+e.join(",")+"]"}function d(e){return e?c([e.srcRgb,e.srcAlpha,e.dstRgb,e.dstAlpha,e.opRgb,e.opAlpha,e.color.r,e.color.g,e.color.b,e.color.a]):null}function f(e){return e?c([e.face,e.mode]):null}function p(e){return e?c([e.factor,e.units]):null}function v(e){return e?c([e.func]):null}function _(e){return e?c([e.function.func,e.function.ref,e.function.mask,e.operation.fail,e.operation.zFail,e.operation.zPass]):null}function m(e){return e?c([e.zNear,e.zFar]):null}function g(e){return e?c([e.r,e.g,e.b,e.a]):null}function y(e){return e?c([e.mask]):null}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleBlendingParams=function(e,t,i,n){return void 0===i&&(i=32774),void 0===n&&(n=[0,0,0,0]),{srcRgb:e,srcAlpha:e,dstRgb:t,dstAlpha:t,opRgb:i,opAlpha:i,color:{r:n[0],g:n[1],b:n[2],a:n[3]}}},t.separateBlendingParams=function(e,t,i,n,r,o,a){return void 0===r&&(r=32774),void 0===o&&(o=32774),void 0===a&&(a=[0,0,0,0]),{srcRgb:e,srcAlpha:t,dstRgb:i,dstAlpha:n,opRgb:r,opAlpha:o,color:{r:a[0],g:a[1],b:a[2],a:a[3]}}},t.backFaceCullingParams={face:1029,mode:2305},t.defaultDepthWriteParams={zNear:0,zFar:1},t.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0},t.makeBlending=n,t.makeCulling=r,t.makePolygonOffset=o,t.makeDepthTest=a,t.makeStencilTest=s,t.makeDepthWrite=l,t.makeColorWrite=u,t.makeStencilWrite=h,t.makePipelineState=function(e){return F.intern(e)};var x=function(){function e(e,t){this.makeKey=e,this.makeRef=t,this.interns=new Map}return e.prototype.intern=function(e){if(!e)return null;var t=this.makeKey(e),i=this.interns;return i.has(t)||i.set(t,this.makeRef(e)),i.get(t)},e}(),b=new x(d,function(e){return i({__tag:"Blending"},e)}),T=new x(f,function(e){return i({__tag:"Culling"},e)}),w=new x(p,function(e){return i({__tag:"PolygonOffset"},e)}),S=new x(v,function(e){return i({__tag:"DepthTest"},e)}),M=new x(_,function(e){return i({__tag:"StencilTest"},e)}),E=new x(m,function(e){return i({__tag:"DepthWrite"},e)}),C=new x(g,function(e){return i({__tag:"ColorWrite"},e)}),I=new x(y,function(e){return i({__tag:"StencilWrite"},e)}),F=new x(function(e){return e?c([d(e.blending),f(e.culling),p(e.polygonOffset),v(e.depthTest),_(e.stencilTest),m(e.depthWrite),g(e.colorWrite),y(e.stencilWrite)]):null},function(e){return{blending:n(e.blending),culling:r(e.culling),polygonOffset:o(e.polygonOffset),depthTest:a(e.depthTest),stencilTest:s(e.stencilTest),depthWrite:l(e.depthWrite),colorWrite:u(e.colorWrite),stencilWrite:h(e.stencilWrite)}}),A=function(){function e(e){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=e}return e.prototype.setPipeline=function(e){(this._pipelineInvalid||e!==this._pipeline)&&(this.setBlending(e.blending),this.setCulling(e.culling),this.setPolygonOffset(e.polygonOffset),this.setDepthTest(e.depthTest),this.setStencilTest(e.stencilTest),this.setDepthWrite(e.depthWrite),this.setColorWrite(e.colorWrite),this.setStencilWrite(e.stencilWrite),this._pipeline=e),this._pipelineInvalid=!1},e.prototype.invalidateBlending=function(){this._blendingInvalid=!0,this._pipelineInvalid=!0},e.prototype.invalidateCulling=function(){this._cullingInvalid=!0,this._pipelineInvalid=!0},e.prototype.invalidatePolygonOffset=function(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0},e.prototype.invalidateDepthTest=function(){this._depthTestInvalid=!0,this._pipelineInvalid=!0},e.prototype.invalidateStencilTest=function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0},e.prototype.invalidateDepthWrite=function(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0},e.prototype.invalidateColorWrite=function(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0},e.prototype.invalidateStencilWrite=function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0},e.prototype.setBlending=function(e){this._blending=this.setSubState(e,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1},e.prototype.setCulling=function(e){this._culling=this.setSubState(e,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1},e.prototype.setPolygonOffset=function(e){this._polygonOffset=this.setSubState(e,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1},e.prototype.setDepthTest=function(e){this._depthTest=this.setSubState(e,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1},e.prototype.setStencilTest=function(e){this._stencilTest=this.setSubState(e,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1},e.prototype.setDepthWrite=function(e){this._depthWrite=this.setSubState(e,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1},e.prototype.setColorWrite=function(e){this._colorWrite=this.setSubState(e,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1},e.prototype.setStencilWrite=function(e){this._stencilWrite=this.setSubState(e,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1},e.prototype.setSubState=function(e,t,i,n){return(i||e!==t)&&(n(e),this._pipelineInvalid=!0),e},e}();t.StateTracker=A}.apply(null,n))||(e.exports=r)},qe2g:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){void 0===e&&(e=400),this.duration=e,this._lastTime=0,this._elapsed=0,this._value=0,this._finished=!1}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._lastTime=0,this._elapsed=0,this._value=0},e.prototype.step=function(){var e=performance.now();if(0===this._lastTime)return this._lastTime=e,!(this._value=0);if(this._elapsed>=this.duration)return!0;var t=e-this._lastTime;return this._elapsed+=t,this._lastTime=e,this._value=Math.min(this._elapsed/this.duration,1),!1},e}();t.default=i}.apply(null,n))||(e.exports=r)},rMND:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){function i(e,t,i,n){var r=null,o=1e3;"number"==typeof t?(o=t,n=i):(r=t,o=i);var a,s=0,l=function(){s=0,e.apply(n,a)},u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r&&r.apply(n,e),a=e,o?s||(s=setTimeout(l,o)):l()};return u.remove=function(){s&&(clearTimeout(s),s=0)},u.forceUpdate=function(){s&&(clearTimeout(s),l())},u.hasPendingUpdates=function(){return!!s},u}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=i,t.default=i}.apply(null,n))||(e.exports=r)},rYkQ:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("AwqN"),i("PwbG"),i("tTR7"),i("apbF"),i("apbF"),i("azm3"),i("hNI9"),i("ph8t"),i("Ed/z"),i("flWe"),i("3vQA")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d){var f=new i.default,p=new i.default;function v(e,t){var i={};for(var n in e){var r={data:a.allocateTypedArrayBuffer(t,e[n]),stride:e[n]};i[n]=r}return i}return function(){function e(){this.tileDisplayData=null,this.tileBufferData=null}return e.prototype.reshuffle=function(){f.reset();for(var t=r.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),i=0,s=t;i<s.length;i++)for(var l=0,u=T=s[i];l<u.length;l++)(M=u[l])&&f.needMore(M.geometryType,M.meshData?M.meshData.vertexCount:M.vertexCount,M.meshData?M.meshData.indexData.length:M.indexCount);for(var h=t.length,c=new n,d=0;d<h;++d){c.geometries[d].indexBuffer=new Uint32Array(Math.round(1.15*f.indicesFor(d)));var v=[];for(var _ in this.tileBufferData.geometries[d].vertexBuffer)v.push(this.tileBufferData.geometries[d].vertexBuffer[_].stride);var m=e._computeVertexAlignment(v),g=Math.round(1.15*f.verticesFor(d)),y=e._align(g,m);for(var x in this.tileBufferData.geometries[d].vertexBuffer){var b=this.tileBufferData.geometries[d].vertexBuffer[x].stride;c.geometries[d].vertexBuffer[x]={stride:b,data:a.allocateTypedArrayBuffer(y,b)}}}for(p.reset(),this.tileDisplayData.displayList.clear(),d=0;d<h;++d){for(var T,w=0,S=T=t[d];w<S.length;w++){var M;if((M=S[w]).meshData)M.writeMeshDataToBuffers(p.verticesFor(d),c.geometries[d].vertexBuffer,p.indicesFor(d),c.geometries[d].indexBuffer),M.meshData=null;else{var E=this.tileBufferData.geometries[d].vertexBuffer,C=this.tileBufferData.geometries[d].indexBuffer,I=c.geometries[d].vertexBuffer,F=c.geometries[d].indexBuffer,A=p.verticesFor(d),O=p.indicesFor(d);o.copyMeshData(A,O,I,F,M,E,C),M.vertexFrom=A,M.indexFrom=O}p.needMore(d,M.vertexCount,M.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(T)}if(this.tileDisplayData.displayList.unified)for(var P=0,R=this.tileDisplayData.displayObjects;P<R.length;P++){var D=R[P];this.tileDisplayData.displayList.addToList(D.displayRecords)}this.tileBufferData=c},e.prototype.getStrides=function(){for(var e=[],t=0;t<this.tileBufferData.geometries.length;++t){var i=this.tileBufferData.geometries[t];for(var n in e[t]={},i.vertexBuffer)e[t][n]=i.vertexBuffer[n].stride}return e},e.prototype.clone=function(){var t=new e;return t.tileBufferData=this.tileBufferData.clone(),t.tileDisplayData=this.tileDisplayData.clone(),t},e.prototype._guessSize=function(){for(var e=this.tileDisplayData.displayObjects,t=Math.min(e.length,4),i=0,n=0;n<t;n++)i=Math.max(i,e[n].displayRecords.length);return 2*(12*e.length+e.length*i*40)},e.prototype.serialize=function(){var e=this.tileBufferData.serialize(),t=this.tileBufferData.getBuffers(),i=this.tileDisplayData.serialize(new d.default(Int32Array,this._guessSize())).buffer();return t.push(i),{result:{displayData:i,bufferData:e},transferList:t}},e.decode=function(t){var i=c.deserializeList(new h.default(t.displayObjects),s),n={};for(var r in t.vertexBuffersMap)n[r]=u.VertexBuffers.decode(t.vertexBuffersMap[r]);return e.fromMeshData({displayObjects:i,vertexBuffersMap:n})},e.fromMeshData=function(t){var i=new e,o=new r.default,a=new n;for(var s in o.displayObjects=t.displayObjects,t.vertexBuffersMap){var l=t.vertexBuffersMap[s];a.geometries[s].indexBuffer=l.indexBuffer,a.geometries[s].vertexBuffer=l.namedBuffers}return i.tileDisplayData=o,i.tileBufferData=a,i},e.bind=function(t,i){var n=new e;return n.tileDisplayData=t,n.tileBufferData=i,n},e.create=function(t,i){var o=new e;o.tileDisplayData=new r.default;for(var a=[0,0,0,0,0],s=[0,0,0,0,0],u=[[],[],[],[],[]],h=0,c=o.tileDisplayData.displayObjects=t;h<c.length;h++)for(var d=0,f=c[h].displayRecords;d<f.length;d++){var p=f[d];u[p.geometryType].push(p),a[p.geometryType]+=p.meshData.vertexCount,s[p.geometryType]+=p.meshData.indexData.length}for(var _,m=new n,g=[(_=i).fill||{},_.line||{},_.icon||{},_.text||{},_.label||{}],y=0;y<5;y++){var x=new Uint32Array(s[y]),b=v(g[y],a[y]);l.writeAllMeshDataToBuffers(u[y],b,x),m.geometries[y]={indexBuffer:x,vertexBuffer:b}}return o.tileBufferData=m,o},e._align=function(e,t){var i=e%t;return 0===i?e:e+(t-i)},e._computeVertexAlignment=function(e){for(var t=!1,i=!1,n=0,r=e;n<r.length;n++){var o=r[n];o%4==2?t=!0:o%4!=0&&(i=!0)}return i?4:t?2:1},e}()}.apply(null,n))||(e.exports=r)},tI6k:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EXTRUDE_SCALE=64,t.PICTURE_FILL_COLOR=4294967295,t.TILE_SIZE=512,t.ANGLE_FACTOR_256=256/360,t.DEBUG_LABELS=!1,t.COLLISION_BUCKET_SIZE=128,t.DOT_DENSITY_MAX_FIELDS=8,t.COLLISION_MAX_ZOOM_DELTA=3,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=16,t.COLLISION_BOX_PADDING=8,t.COLLISION_TILE_BOX_SIZE=t.TILE_SIZE/t.COLLISION_BUCKET_SIZE,t.COLLISION_PLACEMENT_PADDING=8,t.HEURISTIC_GLYPHS_PER_LINE=50,t.HEURISTIC_GLYPHS_PER_FEATURE=10,t.GLYPH_SIZE=24,t.TEXT_LINE_HEIGHT=1.2*t.GLYPH_SIZE,t.TEXT_MAX_WIDTH=10*t.GLYPH_SIZE,t.TEXT_SPACING=0,t.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}},t.TEXTURE_BINDING_SPRITE_ATLAS=0,t.TEXTURE_BINDING_GLYPH_ATLAS=1,t.TEXTURE_BINDING_HIGHLIGHT_0=2,t.TEXTURE_BINDING_HIGHLIGHT_1=3,t.TEXTURE_BINDING_RENDERER_0=4,t.TEXTURE_BINDING_RENDERER_1=5,t.MAX_FILTERS=2,t.FILTER_FLAG_0=1,t.EFFECT_FLAG_0=2}.apply(null,n))||(e.exports=r)},tTR7:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("Dikz"),i("azm3"),i("flWe")],void 0===(r=function(e,t,i,n,r){function o(e){for(var t=[[],[],[],[],[]],i=0,n=e;i<n.length;i++)for(var r=0,o=n[i].displayRecords;r<o.length;r++){var a=o[r];t[a.geometryType].push(a)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.groupRecordsByGeometryType=o;var a=function(){function e(){}return Object.defineProperty(e.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var e=0,t=this.displayObjects;e<t.length;e++){var i=t[e];this._displayObjectRegistry.set(i.id,i)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0}),e.prototype.computeDisplayList=function(e){if(this._displayList=new i(e),e)for(var t=0,n=this.displayObjects;t<n.length;t++)for(var r=0,a=n[t].displayRecords;r<a.length;r++){var s=a[r];this._displayList.addToList(s)}else for(var l=o(this.displayObjects),u=l.length,h=0;h<u;++h){var c=l[h];this._displayList.addToList(c)}},e.prototype.clone=function(){var t=new e;return this.displayObjects&&(t.displayObjects=this.displayObjects.map(function(e){return e.clone()})),t},e.prototype.serialize=function(e){return r.serializeList(e,this.displayObjects),e},e.prototype._deserializeObjects=function(e){for(var t=e.readInt32(),i=new Array(t),r=new Map,o=0;o<i.length;++o){var a=n.deserialize(e);i[o]=a,r.set(a.id,a)}this.displayObjects=i,this._displayList=null,this._displayObjectRegistry=r},e.deserialize=function(t){var i=new e;return i._deserializeObjects(t),i},e}();t.default=a}.apply(null,n))||(e.exports=r)},"u90+":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("Lzvl")],void 0===(r=function(e,t,i){function n(e){return e&&"upperLeft"===e.originPosition}function r(e,t){var i=e.scale,n=e.translate;return Math.round((t-n[0])/i[0])}function o(e,t){var i=e.scale,n=e.translate;return Math.round((n[1]-t)/i[1])}function a(e,t,i){for(var n,a,s,l,u=[],h=0;h<i.length;h++){var c=i[h];h>0?(s=r(e,c[0]),l=o(e,c[1]),s===n&&l===a||(u.push(t(c,s-n,l-a)),n=s,a=l)):(n=r(e,c[0]),a=o(e,c[1]),u.push(t(c,n,a)))}return u.length>0?u:null}function s(e,t,i,n){return a(e,i?n?E:M:n?M:S,t)}function l(e,t,i,n){for(var r=[],o=i?n?E:M:n?M:S,s=0;s<t.length;s++){var l=a(e,o,t[s]);l&&l.length>=3&&r.push(l)}return r.length?r:null}function u(e,t,i,n){for(var r=[],o=i?n?E:M:n?M:S,s=0;s<t.length;s++){var l=a(e,o,t[s]);l&&l.length>=2&&r.push(l)}return r.length?r:null}function h(e,t){var i=e.scale,n=e.translate;return t*i[0]+n[0]}function c(e,t){var i=e.scale;return e.translate[1]-t*i[1]}function d(e,t,i){var n=new Array(i.length);if(!i.length)return n;var r=e.scale,o=r[0],a=r[1],s=h(e,i[0][0]),l=c(e,i[0][1]);n[0]=t(i[0],s,l);for(var u=1;u<i.length;u++){var d=i[u];s+=d[0]*o,l-=d[1]*a,n[u]=t(d,s,l)}return n}function f(e,t,i){for(var n=new Array(i.length),r=0;r<i.length;r++)n[r]=d(e,t,i[r]);return n}function p(e,t,i,n){return d(e,i?n?E:M:n?M:S,t)}function v(e,t,i,n){return f(e,i?n?E:M:n?M:S,t)}function _(e,t,i,n){return f(e,i?n?E:M:n?M:S,t)}function m(e,t,i){for(var n=i[0],r=n[0],o=n[1],a=Math.min(r,t[0]),s=Math.min(o,t[1]),l=Math.max(r,t[2]),u=Math.max(o,t[3]),h=1;h<i.length;h++){var c=i[h],d=c[0],f=c[1];r+=d,o+=f,d<0&&(a=Math.min(a,r)),d>0&&(l=Math.max(l,r)),f<0?s=Math.min(s,o):f>0&&(u=Math.max(u,o))}return e[0]=a,e[1]=s,e[2]=l,e[3]=u,e}function g(e,t){if(!t.length)return null;e[0]=e[1]=Number.POSITIVE_INFINITY,e[2]=e[3]=Number.NEGATIVE_INFINITY;for(var i=0;i<t.length;i++)m(e,e,t[i]);return e}function y(e,t,i,n,a){return t.xmin=r(e,i.xmin),t.ymin=o(e,i.ymin),t.xmax=r(e,i.xmax),t.ymax=o(e,i.ymax),t!==i&&(n&&(t.zmin=i.zmin,t.zmax=i.zmax),a&&(t.mmin=i.mmin,t.mmax=i.mmax)),t}function x(e,t,i,n,r){return t.points=s(e,i.points,n,r),t}function b(e,t,i,n,a){return t.x=r(e,i.x),t.y=o(e,i.y),t!==i&&(n&&(t.z=i.z),a&&(t.m=i.m)),t}function T(e,t,i,n,r){var o=l(e,i.rings,n,r);return o?(t.rings=o,t):null}function w(e,t,i,n,r){var o=u(e,i.paths,n,r);return o?(t.paths=o,t):null}Object.defineProperty(t,"__esModule",{value:!0});var S=function(e,t,i){return[t,i]},M=function(e,t,i){return[t,i,e[2]]},E=function(e,t,i){return[t,i,e[2],e[3]]};t.toQuantizationTransform=function(e){return e?{originPosition:"upperLeft",scale:[e.tolerance,e.tolerance],translate:[e.extent.xmin,e.extent.ymax]}:null},t.equals=function(e,t){return e===t||null==e&&null==t||null!=e&&null!=t&&(n(e)?(i=e.translate[0],r=e.translate[1],o=e.scale[0]):(i=e.extent.xmin,r=e.extent.ymax,o=e.tolerance),n(t)?(a=t.translate[0],s=t.translate[1],l=t.scale[0]):(a=t.extent.xmin,s=t.extent.ymax,l=t.tolerance),i===a&&r===s&&o===l);var i,r,o,a,s,l},t.quantizeX=r,t.quantizeY=o,t.quantizeBounds=function(e,t,i){return t[0]=r(e,i[0]),t[3]=o(e,i[1]),t[2]=r(e,i[2]),t[1]=o(e,i[3]),t},t.quantizePoints=s,t.quantizeRings=l,t.quantizePaths=u,t.hydrateX=h,t.hydrateY=c,t.hydrateCoordsArray=d,t.hydrateCoordsArrayArray=f,t.hydrateBounds=function(e,t,i){return i?(t[0]=h(e,i[0]),t[1]=c(e,i[3]),t[2]=h(e,i[2]),t[3]=c(e,i[1]),t):[h(e,t[0]),c(e,t[3]),h(e,t[2]),c(e,t[1])]},t.hydratePoints=p,t.hydratePaths=v,t.hydrateRings=_,t.getQuantizedBoundsCoordsArray=m,t.getQuantizedBoundsCoordsArrayArray=g,t.getQuantizedBoundsPoints=function(e){var t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return m(t,t,e)},t.getQuantizedBoundsPaths=function(e){return g([0,0,0,0],e)},t.getQuantizedBoundsRings=function(e){return g([0,0,0,0],e)},t.quantizeExtent=y,t.quantizeMultipoint=x,t.quantizePoint=b,t.quantizePolygon=T,t.quantizePolyline=w,t.quantizeGeometry=function(e,t){return e&&t?i.isPoint(t)?b(e,{},t,!1,!1):i.isPolyline(t)?w(e,{},t,!1,!1):i.isPolygon(t)?T(e,{},t,!1,!1):i.isMultipoint(t)?x(e,{},t,!1,!1):i.isExtent(t)?y(e,{},t,!1,!1):null:null},t.hydrateExtent=function(e,t,i,n,r){return t.xmin=h(e,i.xmin),t.ymin=c(e,i.ymin),t.xmax=h(e,i.xmax),t.ymax=c(e,i.ymax),t!==i&&(n&&(t.zmin=i.zmin,t.zmax=i.zmax),r&&(t.mmin=i.mmin,t.mmax=i.mmax)),t},t.hydrateMultipoint=function(e,t,i,n,r){return t.points=p(e,i.points,n,r),t},t.hydratePoint=function(e,t,i,n,r){return t.x=h(e,i.x),t.y=c(e,i.y),t!==i&&(n&&(t.z=i.z),r&&(t.m=i.m)),t},t.hydratePolygon=function(e,t,i,n,r){return t.rings=_(e,i.rings,n,r),t},t.hydratePolyline=function(e,t,i,n,r){return t.paths=v(e,i.paths,n,r),t}}.apply(null,n))||(e.exports=r)},uwSd:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BASE_TEXTURE_UNIT=33984}.apply(null,n))||(e.exports=r)},v7zm:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(e,t,i,n){this._tag=0,this._dataType=99,this._data=e,this._dataView=t,this._pos=i||0,this._end=n||e.byteLength}return e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),i},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),i},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,i=this._toString(this._data,t,t+e);return this._skip(e),i},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,i=this._toBytes(this._data,t,t+e);return this._skip(e),i},e.prototype.getMessage=function(){var t=this._getLength(),i=this._pos,n=new e(this._data,this._dataView,i,i+t);return this._skip(t),n},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,i=this._pos,n=0;if(this._end-i>=10)do{if(n|=127&(e=t[i++]),0==(128&e))break;if(n|=(127&(e=t[i++]))<<7,0==(128&e))break;if(n|=(127&(e=t[i++]))<<14,0==(128&e))break;if(n|=(127&(e=t[i++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[i++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[i++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[i++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[i++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[i++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[i++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var r=1;i!==this._end&&0!=(128&(e=t[i]));)++i,n+=(127&e)*r,r*=128;if(i===this._end)throw new Error("Varint overrun!");++i,n+=e*r}return this._pos=i,n},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,i){var n="",r="";i=Math.min(this._end,i);for(var o=t;o<i;++o){var a=e[o];128&a?r+="%"+a.toString(16):(n+=decodeURIComponent(r)+String.fromCharCode(a),r="")}return r.length&&(n+=decodeURIComponent(r)),n},e.prototype._toBytes=function(e,t,i){return i=Math.min(this._end,i),new Uint8Array(e.buffer,t,i-t)},e}()}.apply(null,n))||(e.exports=r)},veTl:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("7laH")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.load=function(e,t){if(i.default(e))return{createVertexArray:e.createVertexArray.bind(e),deleteVertexArray:e.deleteVertexArray.bind(e),bindVertexArray:e.bindVertexArray.bind(e)};if(t.vao)return null;var n=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object");return n?{createVertexArray:n.createVertexArrayOES.bind(n),deleteVertexArray:n.deleteVertexArrayOES.bind(n),bindVertexArray:n.bindVertexArrayOES.bind(n)}:null}}.apply(null,n))||(e.exports=r)},vhZU:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("qKT0"),i("Gtr7"),i("afW+"),i("Vx27")],void 0===(r=function(e,t,i,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var i=e.call(this,t)||this;return i._queue=new Map,i._queueArray=[],i._onGoingGraphic=null,i._onGoingPromise=null,i._scheduledNextHandle=null,i._timestamp=Date.now(),i._next=i._next.bind(i),i._finalize=i._finalize.bind(i),i}return i(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._queueArray.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._queueArray.length>0||null!==this._onGoingPromise},enumerable:!0,configurable:!0}),t.prototype.cancel=function(e){if(this._onGoingGraphic&&this._onGoingGraphic.graphic===e&&(this._onGoingPromise.cancel(),this._onGoingGraphic=this._onGoingPromise=null),this._queue.has(e)){var t=this._queue.get(e);this._queue.delete(e);var i=this._queueArray.indexOf(t);this._queueArray.slice(i,1)}this._scheduleNext(),this.notifyChange("updating")},t.prototype.clear=function(){this._queue.clear(),this._queueArray.length=0,this._onGoingPromise&&(this._onGoingPromise.cancel(),this._onGoingGraphic=this._onGoingPromise=null),this._cancelNext(),this.notifyChange("updating")},t.prototype.has=function(e){return this._queue.has(e)},t.prototype.isOngoing=function(e){return this._onGoingGraphic&&this._onGoingGraphic.graphic===e},t.prototype.push=function(e,t,i){if(!this._queue.has(e)){var n={graphic:e,addOrUpdate:t,timestamp:i||this._timestamp};this._queueArray.push(n),this._queue.set(e,n),this._scheduleNext(),this.notifyChange("updating")}},t.prototype.refresh=function(){this._timestamp=Date.now(),this.reset()},t.prototype.reset=function(){var e=this._onGoingGraphic;if(e){var t=e.graphic,i=e.addOrUpdate;this.push(t,i,this._timestamp)}},t.prototype._finalize=function(){this._onGoingGraphic=null,this._onGoingPromise=null,this.notifyChange("updating"),this._scheduleNext()},t.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},t.prototype._scheduleNext=function(){this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingGraphic||(this._scheduledNextHandle=o.schedule(this._next))},t.prototype._next=function(){if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingGraphic)this._scheduledNextHandle=null;else{this._scheduledNextHandle=null;var e=this._peek(),t=e.graphic,i=e.addOrUpdate;this._queue.delete(t),this._onGoingGraphic=e,this._onGoingPromise=this.process(t,i,this._timestamp),this._onGoingPromise.then(this._finalize,this._finalize),this.notifyChange("updating")}},t.prototype._peek=function(){return 0===this._queueArray.length?null:this._queueArray.pop()},n([a.property({readOnly:!0})],t.prototype,"length",null),n([a.property({readOnly:!0})],t.prototype,"updating",null),n([a.property({constructOnly:!0})],t.prototype,"process",void 0),n([a.subclass()],t)}(a.declared(r));t.default=s}.apply(null,n))||(e.exports=r)},viuU:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("xhoE"),i("qsST"),i("qMld"),i("jBNx"),i("Brhx"),i("JNkf"),i("YIDE"),i("weRx"),i("QFi0"),i("U+8K"),i("Zp3t"),i("z2+Q")],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,h,c,d,f){Object.defineProperty(t,"__esModule",{value:!0});var p=n.getLogger("esri.views.2d.engine.webgl.magnifier.Magnifier"),v=function(t){function n(){var i=null!==t&&t.apply(this,arguments)||this;return i._maskPath=e.toUrl("../../../../images/magnifier/mask.png"),i._overlayPath=e.toUrl("../../../../images/magnifier/overlay.png"),i.visible=!1,i}return i(n,t),n.prototype.destroy=function(){this._readbackTexture&&(this._readbackTexture.dispose(),this._readbackTexture=null,this._maskTexture.dispose(),this._maskTexture=null,this._overlayTexture.dispose(),this._overlayTexture=null,this._vertexArrayObject.dispose(),this._vertexArrayObject=null,this._program.dispose(),this._program=null)},Object.defineProperty(n.prototype,"magnifier",{get:function(){return this._magnifier},set:function(e){var t=this;this._magnifier=e,this._handle&&this._handle.remove(),this._handle=e.watch("version",function(){t.visible=e.visible,t.requestRender()}),this.visible=e.visible,this.requestRender()},enumerable:!0,configurable:!0}),n.prototype.doRender=function(e){var t=this.stage.context;if(e.drawPhase===s.WGLDrawPhase.MAP&&this._updateRessources(t)){var i=this._magnifier,n=1/i.factor,r=Math.ceil(n*this.overlay.width),a=Math.ceil(n*this.overlay.height),l=e.state.size,u=e.pixelRatio,h=u*l[0],c=u*l[1],d=i.position||{x:.5*l[0],y:.5*l[1]},f=u*d.x,p=c-u*d.y,v=.5*r,_=.5*a;v>f?f=v:f>=h-v&&(f=h-v-1),_>p?p=_:p>=c-_&&(p=c-_-1);var m=f-v,g=p-_,y=this._readbackTexture;t.bindTexture(y,0),t.gl.copyTexImage2D(y.descriptor.target,0,y.descriptor.pixelFormat,m,g,r,a,0);var x=this.stage.background&&this.stage.background.color,b=x?[x.a*x.r/255,x.a*x.g/255,x.a*x.b/255,x.a]:[1,1,1,1],T=(f+o.pt2px(i.offsetX))/h*2-1,w=(p-o.pt2px(i.offsetY))/c*2-1,S=this.overlay.width/h*2,M=this.overlay.height/c*2,E=this._program;t.bindVAO(this._vertexArrayObject),t.bindTexture(this._overlayTexture,6),t.bindTexture(this._maskTexture,7),t.bindProgram(E),E.setUniform4fv("u_background",b),E.setUniform1i("u_readbackTexture",0),E.setUniform1i("u_overlyTexture",6),E.setUniform1i("u_maskTexture",7),E.setUniform2f("u_drawPos",T,w),E.setUniform1f("u_width",S),E.setUniform1f("u_height",M),t.drawArrays(5,0,4),t.bindVAO()}},n.prototype._updateRessources=function(e){var t=this;if(!this._resourcePromise){var i;i=this.mask?r.resolve():u.requestImage(this._maskPath).then(function(e){return t.mask=e});var n;return n=this.overlay?r.resolve():u.requestImage(this._overlayPath).then(function(e){return t.overlay=e}),this._resourcePromise=r.all([i,n]).then(function(){t.requestRender()}),this.requestRender(),!1}if(!this._resourcePromise.isResolved())return this.requestRender(),!1;var o=1/this._magnifier.factor,a=Math.ceil(o*this.overlay.width),s=Math.ceil(o*this.overlay.height);if(this._readbackTexture&&this._readbackTexture.descriptor.width===a&&this._readbackTexture.descriptor.height===s)return!0;if(this.overlay.width!==this.mask.width||this.overlay.height!==this.mask.height)return p.error("Overlay and mask images must have the same size"),!1;if(!this._program){var v=c.createProgram(e,l.magnifier);if(!v)return!1;this._program=v}if(!this._vertexArrayObject){var _=new Uint16Array([0,1,0,0,1,1,1,0]),m=l.magnifier.attributes,g=new f(e,m,{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:h.createVertex(e,35044,_)});this._vertexArrayObject=g}if(!this._overlayTexture){var y=new d(e,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.overlay);this._overlayTexture=y}if(!this._maskTexture){var x=new d(e,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.mask);this._maskTexture=x}var b=new d(e,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:a,height:s});return this._readbackTexture=b,!0},n}(a.DisplayObject);t.default=v}.apply(null,n))||(e.exports=r)},wURW:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){var i,n,r,o;Object.defineProperty(t,"__esModule",{value:!0}),(n=i=t.VectorRole||(t.VectorRole={}))[n.ENTRY=1]="ENTRY",n[n.EXIT=2]="EXIT",n[n.CAP=3]="CAP",(o=r=t.CapPosition||(t.CapPosition={}))[o.START=1]="START",o[o.END=2]="END",t.SYSTEM_MAG_LIMIT=3.8,t.MITER_SAFE_RADS=2*Math.acos(1/t.SYSTEM_MAG_LIMIT);var a=t.SYSTEM_MAG_LIMIT*t.SYSTEM_MAG_LIMIT,s=-1,l=8/(2*Math.PI);function u(e){var t,i={items:new Array,count:0};for(t=0;t<e;++t)i.items.push(void 0);return i}t.allocTriangles=function(e){var t,i={items:new Array,count:0};for(t=0;t<e;++t)i.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return i},t.allocExtrudeVectors=function(){var e=function(e){var t,i={items:new Array,count:0};for(t=0;t<30;++t)i.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});return i}(),t={};return t[i.ENTRY]=u(20),t[i.EXIT]=u(20),t[i.CAP]=u(20),{vectors:e,lists:t}},t.copyExtrudeVectors=function(e,t){var n;for(n=0;n<t.vectors.count;++n)e.vectors.items[n].vector[0]=t.vectors.items[n].vector[0],e.vectors.items[n].vector[1]=t.vectors.items[n].vector[1],e.vectors.items[n].texCoords[0]=t.vectors.items[n].texCoords[0],e.vectors.items[n].texCoords[1]=t.vectors.items[n].texCoords[1],e.vectors.items[n].direction[0]=t.vectors.items[n].direction[0],e.vectors.items[n].direction[1]=t.vectors.items[n].direction[1],e.vectors.items[n].base=t.vectors.items[n].base;e.vectors.count=t.vectors.count;var r=t.lists[i.ENTRY],o=e.lists[i.ENTRY],a=t.lists[i.EXIT],s=e.lists[i.EXIT],l=t.lists[i.CAP],u=e.lists[i.CAP];for(n=0;n<r.count;++n)o.items[n]=r.items[n];for(o.count=r.count,n=0;n<a.count;++n)s.items[n]=a.items[n];for(s.count=a.count,n=0;n<l.count;++n)u.items[n]=l.items[n];u.count=l.count,e.capCenter=t.capCenter};var h={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};function c(e,t){h.vector[0]=e.vector[0],h.vector[1]=e.vector[1],h.texCoords[0]=e.texCoords[0],h.texCoords[1]=e.texCoords[1],h.direction[0]=e.direction[0],h.direction[1]=e.direction[1],h.base=e.base,e.vector[0]=t.vector[0],e.vector[1]=t.vector[1],e.texCoords[0]=t.texCoords[0],e.texCoords[1]=t.texCoords[1],e.direction[0]=t.direction[0],e.direction[1]=t.direction[1],e.base=t.base,t.vector[0]=h.vector[0],t.vector[1]=h.vector[1],t.texCoords[0]=h.texCoords[0],t.texCoords[1]=h.texCoords[1],t.direction[0]=h.direction[0],t.direction[1]=h.direction[1],t.base=h.base}t.swapExtrudeVectors=c;var d,f=[];for(d=0;d<32;++d)f.push([void 0,void 0]);var p=function(e){var t,i={items:new Array,count:0};for(t=0;t<8;++t)i.items.push([void 0,void 0]);return i}();function v(e,t){return e[0]*t[0]+e[1]*t[1]}function _(e){return Math.sqrt(v(e,e))}function m(e,t){var i=_(t);return e[0]=t[0]/i,e[1]=t[1]/i,e}function g(e,t){return e[0]=-t[1],e[1]=t[0],e}function y(e,t){return e[0]*t[1]-e[1]*t[0]}function x(e,t){return e[0]=-t[0],e[1]=-t[1],e}function b(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function T(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function w(e,t,i){return n=e,o=i,((r=t)[0]-n[0])*(o[1]-n[1])-(o[0]-n[0])*(r[1]-n[1])<0;var n,r,o}function S(e,t){var i=v(e,t);return.999<i?0:i<-.999?Math.PI:Math.acos(i)}function M(e,t,i,n,r){if(0!==n){var o,a=_(t),s=(r?-1:1)*S(b(f[0],t,1/a),b(f[1],i,1/a))/n,l=Math.cos(s),u=Math.sin(s),h=t[0],c=t[1];for(o=0;o<n-1;++o){var d=h;h=l*d-u*c,c=u*d+l*c,e.items[o][0]=h,e.items[o][1]=c}e.count=n-1}else e.count=0}function E(e){var t,i=e.count,n=Math.floor(i/2);for(t=0;t<n;++t){var r=e.items[t];e.items[t]=e.items[i-t-1],e.items[i-t-1]=r}}t.length=_,t.normalize=m,t.getNumberOfSlices=function(e){return Math.max(Math.round(e*l),1)},t.getRads=S,t.reverse=E;var C=[void 0,void 0],I=[void 0,void 0],F=[0,0],A=[0,0],O=[0,0],P=[0,0],R=Math.cos(Math.PI/4),D=Math.sin(Math.PI/4),L=Math.sqrt(2),B=function(){function e(e){this._distanceAlongCorrection=e.distanceAlongCorrection}return e.prototype.bridge=function(e,t,n){var r,o,a,s,l=t.vectors,u=t.lists[i.EXIT],h=n.vectors,d=n.lists[i.ENTRY];if(u.count===d.count+1)r=u.items,o=l.items,a=d.items,s=h.items;else if(d.count===u.count+1)r=d.items,o=h.items,a=u.items,s=l.items;else{if(u.count!==d.count)return void(e.count=0);r=d.items,o=h.items,a=u.items,s=l.items}var f,p=u.count+d.count-2;for(e.count=p,C[0]=r,C[1]=a,I[0]=o,I[1]=s,f=0;f<p;++f){var v=e.items[f],_=(f+0)%2,m=Math.floor((f+0)/2),g=I[_][C[_][m]];v.v1.vector[0]=g.vector[0],v.v1.vector[1]=g.vector[1],v.v1.texCoords[0]=g.texCoords[0],v.v1.texCoords[1]=g.texCoords[1],v.v1.direction[0]=g.direction[0],v.v1.direction[1]=g.direction[1],v.v1.base=g.base;var y=(f+1)%2,x=Math.floor((f+1)/2),b=I[y][C[y][x]];v.v2.vector[0]=b.vector[0],v.v2.vector[1]=b.vector[1],v.v2.texCoords[0]=b.texCoords[0],v.v2.texCoords[1]=b.texCoords[1],v.v2.direction[0]=b.direction[0],v.v2.direction[1]=b.direction[1],v.v2.base=b.base;var T=(f+2)%2,S=Math.floor((f+2)/2),M=I[T][C[T][S]];v.v3.vector[0]=M.vector[0],v.v3.vector[1]=M.vector[1],v.v3.texCoords[0]=M.texCoords[0],v.v3.texCoords[1]=M.texCoords[1],v.v3.direction[0]=M.direction[0],v.v3.direction[1]=M.direction[1],v.v3.base=M.base;var E=v.v1.base&&v.v1.base.point||F,R=v.v2.base&&v.v2.base.point||F,D=v.v3.base&&v.v3.base.point||F;A[0]=E[0]+v.v1.vector[0],A[1]=E[1]+v.v1.vector[1],O[0]=R[0]+v.v2.vector[0],O[1]=R[1]+v.v2.vector[1],P[0]=D[0]+v.v3.vector[0],P[1]=D[1]+v.v3.vector[1],w(A,O,P)||c(v.v2,v.v3)}},e.prototype.pie=function(e,t){if(0!==t.lists[i.CAP].count){if(1===t.lists[i.CAP].count)return void(e.count=0);var n;for(e.count=t.lists[i.CAP].count-1,n=0;n<e.count;++n){var r=e.items[n],o=t.lists[i.CAP].items[n],a=t.vectors.items[o];r.v1.vector[0]=a.vector[0],r.v1.vector[1]=a.vector[1],r.v1.texCoords[0]=a.texCoords[0],r.v1.texCoords[1]=a.texCoords[1],r.v1.direction[0]=a.direction[0],r.v1.direction[1]=a.direction[1],r.v1.base=a.base;var s=t.lists[i.CAP].items[n+1],l=t.vectors.items[s];r.v2.vector[0]=l.vector[0],r.v2.vector[1]=l.vector[1],r.v2.texCoords[0]=l.texCoords[0],r.v2.texCoords[1]=l.texCoords[1],r.v2.direction[0]=l.direction[0],r.v2.direction[1]=l.direction[1],r.v2.base=l.base;var u=t.capCenter,h=t.vectors.items[u];r.v3.vector[0]=h.vector[0],r.v3.vector[1]=h.vector[1],r.v3.texCoords[0]=h.texCoords[0],r.v3.texCoords[1]=h.texCoords[1],r.v3.direction[0]=h.direction[0],r.v3.direction[1]=h.direction[1],r.v3.base=h.base;var d=r.v1.base&&r.v1.base.point||F,f=r.v2.base&&r.v2.base.point||F,p=r.v3.base&&r.v3.base.point||F;A[0]=d[0]+r.v1.vector[0],A[1]=d[1]+r.v1.vector[1],O[0]=f[0]+r.v2.vector[0],O[1]=f[1]+r.v2.vector[1],P[0]=p[0]+r.v3.vector[0],P[1]=p[1]+r.v3.vector[1],w(A,O,P)||c(r.v2,r.v3)}}else e.count=0},e.prototype.buttCap=function(e,t,i){this.fastMiterJoin(e,t,i)},e.prototype.roundCap=function(e,t,n,o,a,s){void 0===s&&(s=0),this.fastMiterJoin(e,t,n);var l=o===r.START?0:1,u=o===r.START?1:0;e.capCenter=e.vectors.count;var h=e.vectors.items[e.capCenter];h.vector[0]=0,h.vector[1]=0,h.texCoords[0]=0,h.texCoords[1]=0,h.direction[0]=0,h.direction[1]=0,++e.vectors.count,M(p,e.vectors.items[l].vector,e.vectors.items[u].vector,a,!1);var c=e.vectors.count,d=e.lists[i.CAP];d.items[0]=l;var f,v=e.vectors.items[l].texCoords[1],_=e.vectors.items[u].texCoords[1];for(f=0;f<p.count;++f){var m=s*(1-Math.abs(p.count/2-f)/(p.count/2)),g=v+f/(p.count-1)*(_-v),y=p.items[f],x=e.vectors.items[c+f];x.vector[0]=y[0],x.vector[1]=y[1],x.texCoords[0]=m,x.texCoords[1]=g,x.direction[0]=0,x.direction[1]=0,d.items[f+1]=c+f}d.items[p.count+1]=u,d.count=p.count+2,e.vectors.count=c+p.count},e.prototype.squareCap=function(e,t,i,n){this.fastMiterJoin(e,t,i);var o=n===r.START?0:1,a=n===r.START?1:0,s=f[0],l=f[1],u=f[2],h=f[3],c=f[4],d=e.vectors.items[o].vector;s[0]=R*d[0]-D*d[1],s[1]=D*d[0]+R*d[1],b(h,s,L),l[0]=R*s[0]-D*s[1],l[1]=D*s[0]+R*s[1],u[0]=R*l[0]-D*l[1],u[1]=D*l[0]+R*l[1],b(c,u,L);var p=e.vectors.items[o];p.vector[0]=h[0],p.vector[1]=h[1];var v=e.vectors.items[a];v.vector[0]=c[0],v.vector[1]=c[1]},e.prototype.squareCapForDashedLines=function(e,t,n,o){if(o===r.START){var a=g(f[0],n),s=x(f[4],a),l=f[1],u=f[2],h=f[3];l[0]=R*a[0]-D*a[1],l[1]=D*a[0]+R*a[1],u[0]=R*l[0]-D*l[1],u[1]=D*l[0]+R*l[1],h[0]=R*u[0]-D*u[1],h[1]=D*u[0]+R*u[1],(c=f[5])[0]=0,c[1]=0,e.capCenter=0,(d=e.vectors.items)[0].vector[0]=c[0],d[0].vector[1]=c[1],d[0].direction[0]=0,d[0].direction[1]=0,d[0].texCoords[0]=0,d[0].texCoords[1]=0,d[1].vector[0]=a[0],d[1].vector[1]=a[1],d[1].direction[0]=0,d[1].direction[1]=0,d[1].texCoords[0]=0,d[1].texCoords[1]=-1,d[2].vector[0]=l[0]*L,d[2].vector[1]=l[1]*L,d[2].direction[0]=0,d[2].direction[1]=0,d[2].texCoords[0]=-1,d[2].texCoords[1]=-1,d[3].vector[0]=h[0]*L,d[3].vector[1]=h[1]*L,d[3].direction[0]=0,d[3].direction[1]=0,d[3].texCoords[0]=-1,d[3].texCoords[1]=1,d[4].vector[0]=s[0],d[4].vector[1]=s[1],d[4].direction[0]=0,d[4].direction[1]=0,d[4].texCoords[0]=0,d[4].texCoords[1]=1,e.vectors.count=5,e.lists[i.CAP].count=4,e.lists[i.CAP].items[0]=1,e.lists[i.CAP].items[1]=2,e.lists[i.CAP].items[2]=3,e.lists[i.CAP].items[3]=4,e.lists[i.ENTRY].count=0,e.lists[i.EXIT].count=3,e.lists[i.EXIT].items[0]=1,e.lists[i.EXIT].items[1]=0,e.lists[i.EXIT].items[2]=4}else{var c,d;a=g(f[0],n),s=x(f[4],a),l=f[1],u=f[2],h=f[3],l[0]=R*s[0]-D*s[1],l[1]=D*s[0]+R*s[1],u[0]=R*l[0]-D*l[1],u[1]=D*l[0]+R*l[1],h[0]=R*u[0]-D*u[1],h[1]=D*u[0]+R*u[1],(c=f[5])[0]=0,c[1]=0,e.capCenter=0,(d=e.vectors.items)[0].vector[0]=c[0],d[0].vector[1]=c[1],d[0].direction[0]=0,d[0].direction[1]=0,d[0].texCoords[0]=0,d[0].texCoords[1]=0,d[1].vector[0]=s[0],d[1].vector[1]=s[1],d[1].direction[0]=0,d[1].direction[1]=0,d[1].texCoords[0]=0,d[1].texCoords[1]=1,d[2].vector[0]=l[0]*L,d[2].vector[1]=l[1]*L,d[2].direction[0]=0,d[2].direction[1]=0,d[2].texCoords[0]=1,d[2].texCoords[1]=1,d[3].vector[0]=h[0]*L,d[3].vector[1]=h[1]*L,d[3].direction[0]=0,d[3].direction[1]=0,d[3].texCoords[0]=1,d[3].texCoords[1]=-1,d[4].vector[0]=a[0],d[4].vector[1]=a[1],d[4].direction[0]=0,d[4].direction[1]=0,d[4].texCoords[0]=0,d[4].texCoords[1]=-1,e.vectors.count=5,e.lists[i.CAP].count=4,e.lists[i.CAP].items[0]=1,e.lists[i.CAP].items[1]=2,e.lists[i.CAP].items[2]=3,e.lists[i.CAP].items[3]=4,e.lists[i.ENTRY].count=3,e.lists[i.ENTRY].items[0]=4,e.lists[i.ENTRY].items[1]=0,e.lists[i.ENTRY].items[2]=1,e.lists[i.EXIT].count=0}},e.prototype.fastMiterJoin=function(e,t,n){var r=g(f[0],n),o=r,a=x(f[1],r),l=e.vectors.items[0];l.vector[0]=o[0],l.vector[1]=o[1],l.texCoords[0]=0,l.texCoords[1]=s,l.direction[0]=0,l.direction[1]=0;var u=e.vectors.items[1];u.vector[0]=a[0],u.vector[1]=a[1],u.texCoords[0]=0,u.texCoords[1]=1,u.direction[0]=0,u.direction[1]=0,e.vectors.count=2;var h=e.lists[i.ENTRY];h.items[0]=0,h.items[1]=1,h.count=2;var c=e.lists[i.EXIT];c.items[0]=0,c.items[1]=1,c.count=2,e.lists[i.CAP].count=0,e.capCenter=void 0},e.prototype.miterJoin=function(e,t,n){var r=g(f[0],t),o=g(f[1],n),a=f[2];a[0]=r[0]+o[0],a[1]=r[1]+o[1];var l=m(f[3],a),u=v(l,r);l=b(f[4],l,1/u);var h=x(f[5],l);if(this._distanceAlongCorrection){(p=e.vectors.items[0]).vector[0]=l[0],p.vector[1]=l[1],p.texCoords[0]=0,p.texCoords[1]=s,p.direction[0]=t[0],p.direction[1]=t[1],(_=e.vectors.items[1]).vector[0]=h[0],_.vector[1]=h[1],_.texCoords[0]=0,_.texCoords[1]=1,_.direction[0]=t[0],_.direction[1]=t[1];var c=e.vectors.items[2];c.vector[0]=l[0],c.vector[1]=l[1],c.texCoords[0]=0,c.texCoords[1]=s,c.direction[0]=n[0],c.direction[1]=n[1];var d=e.vectors.items[3];d.vector[0]=h[0],d.vector[1]=h[1],d.texCoords[0]=0,d.texCoords[1]=1,d.direction[0]=n[0],d.direction[1]=n[1],e.vectors.count=4,(y=e.lists[i.ENTRY]).items[0]=0,y.items[1]=1,y.count=2,(T=e.lists[i.EXIT]).items[0]=2,T.items[1]=3,T.count=2}else{var p,_,y,T;(p=e.vectors.items[0]).vector[0]=l[0],p.vector[1]=l[1],p.texCoords[0]=0,p.texCoords[1]=s,p.direction[0]=0,p.direction[1]=0,(_=e.vectors.items[1]).vector[0]=h[0],_.vector[1]=h[1],_.texCoords[0]=0,_.texCoords[1]=1,_.direction[0]=0,_.direction[1]=0,e.vectors.count=2,(y=e.lists[i.ENTRY]).items[0]=0,y.items[1]=1,y.count=2,(T=e.lists[i.EXIT]).items[0]=0,T.items[1]=1,T.count=2}e.lists[i.CAP].count=0,e.capCenter=void 0},e.prototype.bevelJoin=function(e,t,n,r){var o=r*r,l=y(t,n),u=0<l?[s,1]:[1,s],h=u[0],c=u[1],d=0<l?x(f[0],g(f[1],t)):g(f[2],t),p=0<l?x(f[3],g(f[4],n)):g(f[5],n),_=f[6];_[0]=d[0]+p[0],_[1]=d[1]+p[1];var w=m(f[7],_),S=x(f[8],w),M=v(w,d),C=y(w,d),I=Math.abs(C/M),F=1+I*I,A=F<a?[I,this._distanceAlongCorrection]:[Math.sqrt(a-1),!0],O=A[0],P=A[1],R=F<o?[I,this._distanceAlongCorrection]:[Math.sqrt(o-1),!0],D=R[0],L=R[1];if(L&&P){T((N=e.vectors.items[0]).vector,x(f[9],d),b(f[10],x(f[11],t),O)),N.texCoords[0]=0,N.texCoords[1]=h,N.direction[0]=this._distanceAlongCorrection?t[0]:0,N.direction[1]=this._distanceAlongCorrection?t[1]:0,T((U=e.vectors.items[1]).vector,x(f[12],p),b(f[13],n,O)),U.texCoords[0]=0,U.texCoords[1]=h,U.direction[0]=this._distanceAlongCorrection?n[0]:0,U.direction[1]=this._distanceAlongCorrection?n[1]:0,(V=e.vectors.items[2]).vector[0]=0,V.vector[1]=0,V.texCoords[0]=0,V.texCoords[1]=0,V.direction[0]=0,V.direction[1]=0,T((z=e.vectors.items[3]).vector,d,b(f[14],t,D)),z.texCoords[0]=0,z.texCoords[1]=c,z.direction[0]=this._distanceAlongCorrection?t[0]:0,z.direction[1]=this._distanceAlongCorrection?t[1]:0;var B=e.vectors.items[4];T(B.vector,p,b(f[15],x(f[16],n),D)),B.texCoords[0]=0,B.texCoords[1]=c,B.direction[0]=this._distanceAlongCorrection?n[0]:0,B.direction[1]=this._distanceAlongCorrection?n[1]:0,e.vectors.count=5,(k=e.lists[i.ENTRY]).items[0]=0,k.items[1]=2,k.items[2]=3,k.count=3,(H=e.lists[i.EXIT]).items[0]=1,H.items[1]=2,H.items[2]=4,H.count=3,F<o?((G=e.lists[i.CAP]).count=0,e.capCenter=void 0):((G=e.lists[i.CAP]).items[0]=3,G.items[1]=4,G.count=2,e.capCenter=2)}else if(!L&&P)T((N=e.vectors.items[0]).vector,x(f[9],d),b(f[10],x(f[11],t),O)),N.texCoords[0]=0,N.texCoords[1]=h,N.direction[0]=this._distanceAlongCorrection?t[0]:0,N.direction[1]=this._distanceAlongCorrection?t[1]:0,T((U=e.vectors.items[1]).vector,x(f[12],p),b(f[13],n,O)),U.texCoords[0]=0,U.texCoords[1]=h,U.direction[0]=this._distanceAlongCorrection?n[0]:0,U.direction[1]=this._distanceAlongCorrection?n[1]:0,(V=e.vectors.items[2]).vector[0]=0,V.vector[1]=0,V.texCoords[0]=0,V.texCoords[1]=0,V.direction[0]=0,V.direction[1]=0,b((z=e.vectors.items[3]).vector,w,1/M),z.texCoords[0]=0,z.texCoords[1]=c,z.direction[0]=0,z.direction[1]=0,e.vectors.count=4,(k=e.lists[i.ENTRY]).items[0]=0,k.items[1]=2,k.items[2]=3,k.count=3,(H=e.lists[i.EXIT]).items[0]=1,H.items[1]=2,H.items[2]=3,H.count=3,e.lists[i.CAP].count=0,e.capCenter=void 0;else if(L&&!P){var V,z,G;b((N=e.vectors.items[0]).vector,S,1/M),N.texCoords[0]=0,N.texCoords[1]=h,N.direction[0]=0,N.direction[1]=0,(U=e.vectors.items[1]).vector[0]=0,U.vector[1]=0,U.texCoords[0]=0,U.texCoords[1]=0,U.direction[0]=0,U.direction[1]=0,T((V=e.vectors.items[2]).vector,d,b(f[9],t,D)),V.texCoords[0]=0,V.texCoords[1]=c,V.direction[0]=this._distanceAlongCorrection?t[0]:0,V.direction[1]=this._distanceAlongCorrection?t[1]:0,T((z=e.vectors.items[3]).vector,p,b(f[10],x(f[11],n),D)),z.texCoords[0]=0,z.texCoords[1]=c,z.direction[0]=this._distanceAlongCorrection?n[0]:0,z.direction[1]=this._distanceAlongCorrection?n[1]:0,e.vectors.count=4,(k=e.lists[i.ENTRY]).items[0]=0,k.items[1]=1,k.items[2]=2,k.count=3,(H=e.lists[i.EXIT]).items[0]=0,H.items[1]=1,H.items[2]=3,H.count=3,F<o?((G=e.lists[i.CAP]).count=0,e.capCenter=void 0):((G=e.lists[i.CAP]).items[0]=2,G.items[1]=3,G.count=2,e.capCenter=1)}else if(!L&&!P){var N,U,k,H;b((N=e.vectors.items[0]).vector,S,1/M),N.texCoords[0]=0,N.texCoords[1]=h,N.direction[0]=0,N.direction[1]=0,b((U=e.vectors.items[1]).vector,w,1/M),U.texCoords[0]=0,U.texCoords[1]=c,U.direction[0]=0,U.direction[1]=0,e.vectors.count=2,(k=e.lists[i.ENTRY]).items[0]=0,k.items[1]=1,k.count=2,(H=e.lists[i.EXIT]).items[0]=0,H.items[1]=1,H.count=2,e.lists[i.CAP].count=0,e.capCenter=void 0}l<0&&(E(e.lists[i.ENTRY]),E(e.lists[i.EXIT]))},e.prototype.roundJoin=function(e,t,n,r){var o=y(t,n),l=0<o?[s,1]:[1,s],u=l[0],h=l[1],c=0<o?x(f[0],g(f[1],t)):g(f[2],t),d=0<o?x(f[3],g(f[4],n)):g(f[5],n),_=f[6];_[0]=c[0]+d[0],_[1]=c[1]+d[1];var w=m(f[7],_),S=x(f[8],w),C=v(w,c),I=y(w,c),F=Math.abs(I/C),A=1+F*F<a?[F,this._distanceAlongCorrection]:[Math.sqrt(a-1),!0],O=A[0];if(A[1]){(R=e.vectors.items[0]).vector[0]=c[0],R.vector[1]=c[1],R.texCoords[0]=0,R.texCoords[1]=h,R.direction[0]=0,R.direction[1]=0,(D=e.vectors.items[1]).vector[0]=d[0],D.vector[1]=d[1],D.texCoords[0]=0,D.texCoords[1]=h,D.direction[0]=0,D.direction[1]=0,T((L=e.vectors.items[2]).vector,x(f[9],c),b(f[10],x(f[11],t),O)),L.texCoords[0]=0,L.texCoords[1]=u,L.direction[0]=this._distanceAlongCorrection?t[0]:0,L.direction[1]=this._distanceAlongCorrection?t[1]:0,T((B=e.vectors.items[3]).vector,x(f[12],d),b(f[13],n,O)),B.texCoords[0]=0,B.texCoords[1]=u,B.direction[0]=this._distanceAlongCorrection?n[0]:0,B.direction[1]=this._distanceAlongCorrection?n[1]:0;var P=e.vectors.items[4];P.vector[0]=0,P.vector[1]=0,P.texCoords[0]=0,P.texCoords[1]=0,P.direction[0]=0,P.direction[1]=0,e.vectors.count=5,(V=e.lists[i.ENTRY]).items[0]=2,V.items[1]=4,V.items[2]=0,V.count=3,(z=e.lists[i.EXIT]).items[0]=3,z.items[1]=4,z.items[2]=1,z.count=3,e.capCenter=4}else{var R,D,L,B,V,z;(R=e.vectors.items[0]).vector[0]=c[0],R.vector[1]=c[1],R.texCoords[0]=0,R.texCoords[1]=h,R.direction[0]=0,R.direction[1]=0,(D=e.vectors.items[1]).vector[0]=d[0],D.vector[1]=d[1],D.texCoords[0]=0,D.texCoords[1]=h,D.direction[0]=0,D.direction[1]=0,b((L=e.vectors.items[2]).vector,S,1/C),L.texCoords[0]=0,L.texCoords[1]=u,L.direction[0]=0,L.direction[1]=0,(B=e.vectors.items[3]).vector[0]=0,B.vector[1]=0,B.texCoords[0]=0,B.texCoords[1]=0,B.direction[0]=0,B.direction[1]=0,e.vectors.count=4,(V=e.lists[i.ENTRY]).items[0]=2,V.items[1]=3,V.items[2]=0,V.count=3,(z=e.lists[i.EXIT]).items[0]=2,z.items[1]=3,z.items[2]=1,z.count=3,e.capCenter=3}M(p,c,d,r,o<0);var G,N=e.vectors.count,U=e.lists[i.CAP];for(G=U.items[0]=0;G<p.count;++G){var k=p.items[G],H=e.vectors.items[N+G];H.vector[0]=k[0],H.vector[1]=k[1],H.texCoords[0]=0,H.texCoords[1]=h,H.direction[0]=0,H.direction[1]=0,U.items[G+1]=N+G}U.items[p.count+1]=1,U.count=p.count+2,e.vectors.count=N+p.count,o<0&&(E(e.lists[i.ENTRY]),E(e.lists[i.EXIT]))},e.prototype.unitRoundJoin=function(e,t,n,r){var o=y(t,n),a=0<o?[s,1]:[1,s],l=a[0],u=a[1],h=0<o?x(f[0],g(f[1],t)):g(f[2],t),c=0<o?x(f[3],g(f[4],n)):g(f[5],n),d=e.vectors.items[0];d.vector[0]=h[0],d.vector[1]=h[1],d.texCoords[0]=0,d.texCoords[1]=u,d.direction[0]=0,d.direction[1]=0;var v=e.vectors.items[1];v.vector[0]=c[0],v.vector[1]=c[1],v.texCoords[0]=0,v.texCoords[1]=u,v.direction[0]=0,v.direction[1]=0;var _=e.vectors.items[2];x(_.vector,h),_.texCoords[0]=0,_.texCoords[1]=l,_.direction[0]=0,_.direction[1]=0;var m=e.vectors.items[3];x(m.vector,c),m.texCoords[0]=0,m.texCoords[1]=l,m.direction[0]=0,m.direction[1]=0;var b=e.vectors.items[4];b.vector[0]=0,b.vector[1]=0,b.texCoords[0]=0,b.texCoords[1]=0,b.direction[0]=0,b.direction[1]=0,e.vectors.count=5;var T=e.lists[i.ENTRY];T.items[0]=2,T.items[1]=0,T.count=2;var w=e.lists[i.EXIT];w.items[0]=3,w.items[1]=1,w.count=2,e.capCenter=4,M(p,h,c,r,o<0);var S,C=e.vectors.count,I=e.lists[i.CAP];for(S=I.items[0]=0;S<p.count;++S){var F=p.items[S],A=e.vectors.items[C+S];A.vector[0]=F[0],A.vector[1]=F[1],A.texCoords[0]=0,A.texCoords[1]=u,A.direction[0]=0,A.direction[1]=0,I.items[S+1]=C+S}I.items[p.count+1]=1,I.count=p.count+2,e.vectors.count=C+p.count,o<0&&(E(e.lists[i.ENTRY]),E(e.lists[i.EXIT]))},e.prototype.rectJoin=function(e,t,n){var r=g(f[0],t),o=g(f[1],n),a=e.vectors.items[0];a.vector[0]=r[0],a.vector[1]=r[1],a.texCoords[0]=0,a.texCoords[1]=s,a.direction[0]=0,a.direction[1]=0;var l=e.vectors.items[1];l.vector[0]=o[0],l.vector[1]=o[1],l.texCoords[0]=0,l.texCoords[1]=s,l.direction[0]=0,l.direction[1]=0;var u=e.vectors.items[2];x(u.vector,r),u.texCoords[0]=0,u.texCoords[1]=1,u.direction[0]=0,u.direction[1]=0;var h=e.vectors.items[3];x(h.vector,o),h.texCoords[0]=0,h.texCoords[1]=1,h.direction[0]=0,h.direction[1]=0,e.vectors.count=4;var c=e.lists[i.ENTRY];c.items[0]=0,c.items[1]=2,c.count=2;var d=e.lists[i.EXIT];d.items[0]=1,d.items[1]=3,d.count=2,e.capCenter=void 0},e}();t.Tessellator=B}.apply(null,n))||(e.exports=r)},"wdp+":function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("hPTP"),i("U+8K")],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t="";t+=e[0].toUpperCase();for(var i=1;i<e.length;i++){var n=e[i];n===n.toUpperCase()?(t+="_",t+=n):t+=n.toUpperCase()}return t},o=function(e){var t={};for(var i in e)t[r(i)]=e[i];return n.glslifyDefineMap(t)};t.createProgramTemplate=function(e,t){return{name:e,attributes:t,shaders:function(t){return{vertexShader:o(t)+i.resolveIncludes("materials/"+e+"/"+e+".vert"),fragmentShader:o(t)+i.resolveIncludes("materials/"+e+"/"+e+".frag")}}}}}.apply(null,n))||(e.exports=r)},weRx:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("zp6E")],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.dataURItoBlob=function(e){for(var t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),r=new Uint8Array(n),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return new Blob([n],{type:i})},t.requestImage=function(e){return i(e,{responseType:"image"}).then(function(e){return e.data})}}.apply(null,n))||(e.exports=r)},xf8T:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){return[1,0,0,0,1,0,0,0,1]},t.clone=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},t.fromValues=function(e,t,i,n,r,o,a,s,l){return[e,t,i,n,r,o,a,s,l]},t.createView=function(e,t){return new Float64Array(e,t,9)}}.apply(null,n))||(e.exports=r)},xxo4:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("apbF"),i("QFi0")],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.geometryMap=i.createGeometryData(function(t){return{indexBuffer:n.createIndex(e,35044),vao:null}},function(t,r){return{vertexBuffer:n.createVertex(e,i.C_VBO_INFO[r])}})}return e.prototype.dispose=function(){for(var e in this.geometryMap){var t=this.geometryMap[e];for(var i in t.data.vao&&t.data.vao.dispose(!1),t.data.indexBuffer&&t.data.indexBuffer.dispose(),t.buffers)t.buffers[i]&&t.buffers[i].data.vertexBuffer.dispose()}},e.prototype.get=function(e){var t=this.geometryMap[e],i={};for(var n in t.buffers)i[n]=t.buffers[n].data.vertexBuffer;return{indexBuffer:t.data.indexBuffer,get vao(){return t.data.vao},set vao(e){t.data.vao=e},vertexBufferMap:i}},e.prototype.has=function(e){return null!=this.geometryMap[e]},e.prototype.upload=function(e,t){var i=this;t.forEach(function(t,n){i._upload(t,n,e)})},e.prototype._upload=function(e,t,i){if(e.indices&&(e.indices.allDirty?this._uploadIndices(i,t):null!=e.indices.from&&null!=e.indices.count&&this._uploadIndices(i,t,e.indices.from,e.indices.count)),e.vertices){var n=e.vertices;for(var r in n){var o=n[r];o.allDirty?this._uploadVertices(i,t,r):null!=o.from&&null!=o.count&&this._uploadVertices(i,t,r,o.from,o.count)}}},e.prototype._uploadVertices=function(e,t,i,n,r){var o=this.geometryMap[t];if(o){var a=e.geometries[t].vertexBuffer[i];if(a){var s=a.stride,l=a.data.buffer;o.buffers[i]&&0<l.byteLength&&(null!=n&&null!=r?o.buffers[i].data.vertexBuffer.setSubData(l,n*s,n*s,(n+r)*s):o.buffers[i].data.vertexBuffer.setData(l))}}},e.prototype._uploadIndices=function(e,t,i,n){var r=this.geometryMap[t];if(r){var o=e.geometries[t].indexBuffer.buffer;r.data.indexBuffer&&0<o.byteLength&&(null!=i&&null!=n?r.data.indexBuffer.setSubData(o,4*i,4*i,4*(i+n)):r.data.indexBuffer.setData(o))}},e}();t.default=r}.apply(null,n))||(e.exports=r)},zRH3:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i("9opi"),i("qKT0"),i("Gtr7"),i("Vx27")],void 0===(r=function(e,t,i,n,r,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.graphics=null,t.renderer=null,t.view=null,t}return i(t,e),n([o.property()],t.prototype,"graphics",void 0),n([o.property()],t.prototype,"renderer",void 0),n([o.property()],t.prototype,"view",void 0),n([o.subclass("esri.views.layers.GraphicsView")],t)}(o.declared(r))}.apply(null,n))||(e.exports=r)}}]);