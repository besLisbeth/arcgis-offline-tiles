(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/support/rasterFormats/Raw":"0fRT","esri/tasks/support/RelationshipQuery":"531e","esri/layers/support/DimensionalDefinition":"7Rj3","esri/tasks/ImageServiceIdentifyTask":"7ia+","esri/layers/support/Raster":"8Gw6","esri/layers/support/RasterFunction":"97bx","esri/core/requireUtils":"ADZV","esri/layers/support/rasterFormats/Png":"D34G","esri/layers/support/rasterFormats/JpgPlus":"EZfi","esri/layers/ImageryLayer":"G5N4","esri/core/colorUtils":"KtQ6","esri/layers/mixins/ArcGISImageService":"Odfd","esri/layers/support/rasterFormats/LercCodec":"Rc7o","esri/tasks/support/AttachmentQuery":"TsGx","esri/renderers/support/colorRampUtils":"UVEp","esri/layers/support/imageryRendererUtils":"YM6P","esri/support/popupUtils":"begh","esri/tasks/support/ImageServiceIdentifyResult":"bllj","esri/layers/support/PixelBlock":"dXLH","esri/geometry/support/normalizeUtils":"fw2w","esri/tasks/support/ImageServiceIdentifyParameters":"nakx","esri/layers/support/MosaicRule":"ouPT","esri/layers/support/rasterFormats/Zlib":"r5V0","esri/tasks/support/FeatureSet":"w1v0","esri/layers/support/rasterFormats/Jpg":"xIS7"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[22,89,91],{"0fRT":function(e,t,r){var i;void 0===(i=function(){"use strict";return{decodeBIP:function(e,t){var r=t.pixelType,i=t.bandCount,o=[],n=t.width*t.height,a=this.getBandCount(e,t);i=i||a;var s,l,u,p,f=e.byteLength-e.byteLength%(n*this._getPixelLength(r)),c=new r(e,0,n*a);for(s=0;s<i;s++){for(p=new r(n),l=0;l<n;l++)p[l]=c[l*a+s];o.push(p)}return f<e.byteLength-1&&(u=this._decodeMask(e.slice(f),t)),{pixels:o,mask:u}},decodeBSQ:function(e,t){var r=t.pixelType,i=t.bandCount;null!=i||(i=this.getBandCount(e,t));var o,n,a=[],s=t.width*t.height,l=s*i,u=e.byteLength-e.byteLength%(s*this._getPixelLength(r)),p=new r(e,0,l);for(o=0;o<i;o++)a.push(p.subarray(o*s,(o+1)*s));return u<e.byteLength-1&&(n=this._decodeMask(e.slice(u),t)),{pixels:a,mask:n}},getBandCount:function(e,t){var r=t.width*t.height,i=t.pixelType;return Math.floor(e.byteLength/(r*this._getPixelLength(i)))},_getPixelLength:function(e){var t=1;switch(e){case Uint8Array:case Int8Array:case Uint8ClampedArray:t=1;break;case Uint16Array:case Int16Array:t=2;break;case Uint32Array:case Int32Array:case Float32Array:t=4;break;case Float64Array:t=8}return t},_decodeMask:function(e,t){var r=t.width*t.height;if(8*e.byteLength<r)return null;var i=new Uint8Array(e,0,Math.ceil(r/8)),o=new Uint8Array(t.width*t.height),n=0,a=0,s=0,l=0;for(s=0;s<i.length-1;s++)for(a=i[s],l=7;l>=0;l--)o[n++]=a>>l&1;for(l=7;n<r-1;)a=i[i.length-1],o[n++]=a>>l&1,l--;return o}}}.apply(null,[]))||(e.exports=i)},"531e":function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("9opi"),r("qKT0"),r("TMur"),r("ycL1"),r("rg9i"),r("Vx27")],void 0===(o=function(e,t,r,i,o,n,a,s){return function(e){function t(t){var r=e.call(this,t)||this;return r.gdbVersion=null,r.geometryPrecision=void 0,r.historicMoment=null,r.maxAllowableOffset=void 0,r.objectIds=null,r.outFields=null,r.outSpatialReference=null,r.relationshipId=void 0,r.returnGeometry=!1,r.source=null,r.where=null,r}var n;return r(t,e),n=t,t.prototype._writeHistoricMoment=function(e,t){t.historicMoment=e&&e.getTime()},t.prototype.clone=function(){return new n(a.clone({gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&this.historicMoment.getTime(),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,source:this.source,where:this.where}))},i([s.property({type:String,json:{write:!0}})],t.prototype,"gdbVersion",void 0),i([s.property({type:Number,json:{write:!0}})],t.prototype,"geometryPrecision",void 0),i([s.property({type:Date})],t.prototype,"historicMoment",void 0),i([s.writer("historicMoment")],t.prototype,"_writeHistoricMoment",null),i([s.property({type:Number,json:{write:!0}})],t.prototype,"maxAllowableOffset",void 0),i([s.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),i([s.property({type:[String],json:{write:!0}})],t.prototype,"outFields",void 0),i([s.property({type:o.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],t.prototype,"outSpatialReference",void 0),i([s.property({json:{write:!0}})],t.prototype,"relationshipId",void 0),i([s.property({json:{write:!0}})],t.prototype,"returnGeometry",void 0),i([s.property({json:{write:!0}})],t.prototype,"source",void 0),i([s.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],t.prototype,"where",void 0),n=i([s.subclass("esri.tasks.support.RelationshipQuery")],t)}(s.declared(n))}.apply(null,i))||(e.exports=o)},"7Rj3":function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("9opi"),r("qKT0"),r("ycL1"),r("rg9i"),r("Vx27")],void 0===(o=function(e,t,r,i,o,n,a){return function(e){function t(t){var r=e.call(this)||this;return r.variableName=null,r.dimensionName=null,r.values=[],r.isSlice=!1,r}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({variableName:this.variableName,dimensionName:this.dimensionName,values:n.clone(this.values),isSlice:this.isSlice})},i([a.property({type:String,json:{write:!0}})],t.prototype,"variableName",void 0),i([a.property({type:String,json:{write:!0}})],t.prototype,"dimensionName",void 0),i([a.property({json:{write:!0}})],t.prototype,"values",void 0),i([a.property({type:Boolean,json:{write:!0}})],t.prototype,"isSlice",void 0),o=i([a.subclass("esri.layers.support.DimensionalDefinition")],t)}(a.declared(o))}.apply(null,i))||(e.exports=o)},"7ia+":function(e,t,r){var i,o;i=[r("zp6E"),r("rg9i"),r("fw2w"),r("FPqO"),r("bllj")],void 0===(o=function(e,t,r,i,o){return i.createSubclass({declaredClass:"esri.tasks.ImageServiceIdentifyTask",properties:{parsedUrl:{get:function(){var e=this._parseUrl(this.url);return e.path+="/identify",e}},url:{}},execute:function(i,o){var n=i.geometry?[i.geometry]:[];return r.normalizeCentralMeridian(n).then(function(r){var n={query:this._encode(t.mixin({},this.parsedUrl.query,{f:"json"},i.toJSON({geometry:r&&r[0]})))};return(this.requestOptions||o)&&(n=t.mixin({},this.requestOptions,o,n)),e(this.parsedUrl.path,n)}.bind(this)).then(this._handleExecuteResponse)},_handleExecuteResponse:function(e){return o.fromJSON(e.data)}})}.apply(null,i))||(e.exports=o)},"8Gw6":function(e,t,r){var i,o;i=[r("Gtr7"),r("rg9i"),r("jfWY"),r("qMld"),r("zp6E"),r("N7S/"),r("Z4y+"),r("dXLH"),r("Rc7o"),r("EZfi"),r("D34G"),r("0fRT")],void 0===(o=function(e,t,r,i,o,n,a,s,l,u,p,f){return e.createSubclass({declaredClass:"esri.layers.support.Raster",validPixelTypes:["u1","u2","u4","u8","u16","u32","s8","s16","s32","f32"],validFormats:["lerc","jpeg","jpg","jpgpng","png","png8","png24","png32","bip","bsq"],properties:{parsedUrl:{readOnly:!0,dependsOn:["url"],get:function(){return this.url?r.urlToObject(this.url):null}},url:null},read:function(e){if(!e.imageServiceParameters||!e.nBands)return i.reject(new Error("Insufficient parameters to read data"));var r=t.clone(e.imageServiceParameters),o=e.nBands,n=e.pixelType||"f32",a=e.requestAsImageElement;this.validPixelTypes.indexOf(n.toUpperCase())<=-1&&(r.pixelType="f32"),r.format=r.format||"lerc",this.validFormats.indexOf(r.format.toLowerCase())<=-1&&(r.format="lerc"),this._prepareGetImageParameters(r);var s=t.clone(r);return this._cleanupRequestParams(s),this._requestArrayBuffer(r,s,o,n,a)},_requestArrayBuffer:function(e,r,n,a,s){return o(this.parsedUrl.path+"/exportImage",{responseType:"array-buffer",query:t.mixin(r,{f:"image"})}).then(function(t){var r=t.data;if(!this._isDataValid(r)){var o=new Error(String.fromCharCode.apply(null,new Uint8Array(r)));return i.reject(o)}var l=e.format.toUpperCase(),u=l;if("BSQ"!==u&&"BIP"!==u&&(u=this._getFormat(r)),this.validFormats.indexOf(u.toLowerCase())<=-1)return i.reject(new Error("Cannot decode the pixelBlock. Unsupported Format: "+u));if(!("PNG"!==l&&"JPGPNG"!==l||"PNG"!==u&&"JPEG"!==u)&&s){var p=new Blob([r],{type:"image/"+("PNG"===u?"png":"jpeg")}),f=URL.createObjectURL(p),c=new Image,d=i.createResolver(),h=d.promise;return c.addEventListener("load",d),c.addEventListener("error",d.reject),c.src=f,h.then(function(){return URL.revokeObjectURL(f),{imageElement:c,params:e}},function(e){return URL.revokeObjectURL(f),i.reject(new Error("Failed to load raster"))})}try{return{pixelData:{pixelBlock:this._decodePixelBlock(r,{width:e.width,height:e.height,planes:n,pixelType:a,noDataValue:e.noData,format:u}),extent:e.extent},params:e}}catch(e){return i.reject(e)}}.bind(this))},_prepareGetImageParameters:function(e){if(e.size&&e.bbox){var r=e.size.split(",");if(e.width=parseFloat(r[0]),e.height=parseFloat(r[1]),!e.extent){var i=e.bbox.split(",");e.extent=new n(parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]),new a(e.bboxSR))}}else{if(!e.width||Math.floor(e.width)!==e.width||!e.height||Math.floor(e.height)!==e.height)throw new Error("Incorrect Image Dimensions");if(!e.extent||"esri.geometry.Extent"!==e.extent.declaredClass)throw new Error("Incorrect extent");var o=e.extent,s=o.spatialReference.wkid||JSON.stringify(o.spatialReference.toJSON());delete e._ts,t.mixin(e,{bbox:o.xmin+","+o.ymin+","+o.xmax+","+o.ymax,imageSR:s,bboxSR:s,size:e.width+","+e.height},e.disableClientCaching?{_ts:Date.now()}:{})}},_adjustExtent:function(e,t,r){var i=e.ymax-e.ymin,o=e.xmax-e.xmin;return r>=t?(i=o*t/r,e.ymax=e.ymin+i):(o=i*r/t,e.xmax=e.xmin+o),e},_cleanupRequestParams:function(e){if(!e)return e;var t,r=["width","height","extent"];for(t in r)e.hasOwnProperty(r[t])&&delete e[r[t]];return e},_getFormat:function(e){var t=new Uint8Array(e,0,10),r="";return 255===t[0]&&216===t[1]?r="JPEG":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?r="PNG":67===t[0]&&110===t[1]&&116===t[2]&&90===t[3]&&73===t[4]&&109===t[5]&&97===t[6]&&103===t[7]&&101===t[8]&&32===t[9]?r="LERC":String.fromCharCode.apply(null,t).toLowerCase().indexOf("error")>-1&&(r="ERROR"),r},_isDataValid:function(e){var t=new Uint8Array(e,0,10);return!(String.fromCharCode.apply(null,t).toLowerCase().indexOf("error")>-1)},_calculateBandStatistics:function(e){var t,r=1/0,i=-1/0,o=e.length,n=0;for(t=0;t<o;t++)r=(n=e[t])<r?n:r,i=n>i?n:i;return{minValue:r,maxValue:i}},_verifyResult:function(e,t){return!(!e||e.height!==t.height||e.width!==t.width)},_getPixelTypeAndNoData:function(e){var t,r=e.noDataValue,i=e.pixelType;return"u1"===i||"u2"===i||"u4"===i||"u8"===i?(i="u8",r=Math.pow(2,8)-1,t=Uint8Array):"u16"===i?(r=r||Math.pow(2,16)-1,t=Uint16Array):"u32"===i?(r=r||Math.pow(2,32)-1,t=Uint32Array):"s8"===i?(r=r||0-Math.pow(2,7),t=Int8Array):"s16"===i?(r=r||0-Math.pow(2,15),t=Int16Array):"s32"===i?(r=r||0-Math.pow(2,31),t=Int32Array):t=Float32Array,{pixelType:i,pixelDataType:t,noDataValue:r}},_decodePixelBlock:function(e,t){if(!e||!t)throw new Error("Cannot decode the pixelBlock. Invalid parameters provided for decoding.");if(!t.height||Math.floor(t.height)!==t.height)throw new Error("Cannot decode the pixelBlock. Height is not provided.");if(!t.width||Math.floor(t.width)!==t.width)throw new Error("Cannot decode the pixelBlock. Width is not provided.");var r=this._decodeLerc;switch(t.format.toUpperCase()){case"JPEG":r=this._decodeJpeg;break;case"PNG":r=this._decodePng;break;case"BSQ":r=this._decodeBsq;break;case"BIP":r=this._decodeBip}var i,o,n=(r=r.bind(this))(e,t),a=n.statistics||[];if(a.length<=0)for(i=0;i<n.pixels.length;i++)o=n.pixels[i],a.push(this._calculateBandStatistics(o));return new s({width:t.width,height:t.height,pixels:n.pixels,pixelType:t.pixelType,mask:n.mask,statistics:a})},_decodeJpeg:function(e,t){if(!u)throw new Error("The jpeg decoder module is not loaded.");var r=(new u).decode(e);if(!this._verifyResult(r,t))throw new Error("Error in decoding the image. The decoded image dimensions are incorrect.");return t.width=r.width,t.height=r.height,t.pixelType="U8",r},_decodePng:function(e,t){if(!p)throw new Error("The png decoder module is not loaded.");var r=new Uint8Array(e),i=new p(r),o=new Uint8Array(t.width*t.height*4);i.copyToImageData(o,i.decodePixels());var n,a=0,s=0,l=new Uint8Array(t.width*t.height);for(a=0;a<t.width*t.height;a++)l[a]=o[4*a+3];var u={pixels:[],mask:l};for(a=0;a<3;a++){for(n=new Uint8Array(t.width*t.height),s=0;s<t.width*t.height;s++)n[s]=o[4*s+a];u.pixels.push(n)}return t.pixelType="U8",u},_decodeBsq:function(e,t){if(!f)throw new Error("The bsq decoder module is not loaded.");var r=this._getPixelTypeAndNoData(t);return f.decodeBSQ(e,{bandCount:t.planes,width:t.width,height:t.height,pixelType:r.pixelDataType,noDataValue:r.noDataValue})},_decodeBip:function(e,t){if(!f)throw new Error("The bsq decoder module is not loaded.");var r=this._getPixelTypeAndNoData(t);return f.decodeBIP(e,{bandCount:t.planes,width:t.width,height:t.height,pixelType:r.pixelDataType,noDataValue:r.noDataValue})},_decodeLerc:function(e,t){var r=this._getPixelTypeAndNoData(t);t.pixelType=r.pixelType;for(var i,o=0,n=0,a=e.byteLength-10,s={pixels:[],statistics:[]};n<a;){var u=l.decode(e,{inputOffset:n,encodedMaskData:i,returnMask:0===o,returnEncodedMask:0===o,returnFileInfo:!0,pixelType:r.pixelDataType,noDataValue:r.noDataValue});if(n=u.fileInfo.eofOffset,0===o&&(i=u.encodedMaskData,s.mask=u.maskData),o++,!this._verifyResult(u,t))throw new Error("Error in decoding the image. The decoded image dimensions are incorrect.");s.pixels.push(u.pixelData),s.statistics.push({minValue:u.minValue,maxValue:u.maxValue,noDataValue:u.noDataValue})}return s}})}.apply(null,i))||(e.exports=o)},"97bx":function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("9opi"),r("qKT0"),r("PND3"),r("ycL1"),r("0+sO"),r("rg9i"),r("Vx27")],void 0===(o=function(e,t,r,i,o,n,a,s,l){var u=new a.KebabDictionary({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"}),p=new o.default(["Raster","Raster2","DEM","FillRaster"]),f=new o.default(["Rasters"]),c=function(e){return e&&e.rasterFunction?h.fromJSON(e):e},d=function(e){return e&&e instanceof h?e.toJSON():e},h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.functionArguments=null,t.functionName=null,t.outputPixelType="unknown",t.variableName=null,t}var o;return r(t,e),o=t,t.prototype.readFunctionArguments=function(e,t){for(var r={},i=0,o=Object.keys(e);i<o.length;i++){var n=o[i];p.has(n)?r[n]=c(e[n]):f.has(n)&&Array.isArray(e[n])?r[n]=e[n].map(c):r[n]=e[n]}return r},t.prototype.writeFunctionArguments=function(e,t,r){for(var i={},o=0,n=Object.keys(e);o<n.length;o++){var a=n[o];p.has(a)?i[a]=d(e[a]):f.has(a)&&Array.isArray(e[a])?i[a]=e[a].map(d):i[a]=d(e[a])}t[r]=i},t.prototype.readFunctionName=function(e,t){var r=t.rasterFunctionInfos;return r&&r.length&&"None"!==r[0].name?r[0].name:t.rasterFunction},t.prototype.writeOutputPixelType=function(e,t,r){t[r]="unknown"!==e?u.toJSON(e):void 0},t.prototype.clone=function(){return new o({functionName:this.functionName,functionArguments:s.clone(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName})},i([l.property({json:{read:{source:"rasterFunctionArguments"},write:{target:"rasterFunctionArguments"}}})],t.prototype,"functionArguments",void 0),i([l.reader("functionArguments")],t.prototype,"readFunctionArguments",null),i([l.writer("functionArguments")],t.prototype,"writeFunctionArguments",null),i([l.property({json:{type:String,write:{target:"rasterFunction"}}})],t.prototype,"functionName",void 0),i([l.reader("functionName",["rasterFunction","rasterFunctionInfos"])],t.prototype,"readFunctionName",null),i([l.property({type:String,json:{read:{reader:u.read}}})],t.prototype,"outputPixelType",void 0),i([l.writer("outputPixelType")],t.prototype,"writeOutputPixelType",null),i([l.property({type:String,json:{read:!0,write:!0}})],t.prototype,"variableName",void 0),o=i([l.subclass("esri.layers.support.RasterFunction")],t)}(l.declared(n));return h}.apply(null,i))||(e.exports=o)},ADZV:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("qMld")],void 0===(o=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.when=function e(t,i){return Array.isArray(i)?r.create(function(e){t(i,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(t)})}):e(t,[i]).then(function(e){return e[0]})},t.getAbsMid=function(e,t,r){return t.toAbsMid?t.toAbsMid(e):r.id.replace(/\/[^\/]*$/gi,"/")+e}}.apply(null,i))||(e.exports=o)},D34G:function(e,t,r){var i,o;i=[r("r5V0")],void 0===(o=function(e){return function(t){function r(e){var t,r,i,o,n,a,s,l,u,p,f,c,d;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},n=null;;){switch(t=this.readUInt32(),l=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":n&&this.animation.frames.push(n),this.pos+=4,n={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},o=this.readUInt16(),i=this.readUInt16()||100,n.delay=1e3*o/i,n.disposeOp=this.data[this.pos++],n.blendOp=this.data[this.pos++],n.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,t-=4),e=(null!=n?n.data:void 0)||this.imgData,f=0;0<=t?f<t:f>t;0<=t?++f:--f)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(t),(u=255-this.transparency.indexed.length)>0)for(c=0;0<=u?c<u:c>u;0<=u?++c:--c)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":a=(p=this.read(t)).indexOf(0),s=String.fromCharCode.apply(String,p.slice(0,a)),this.text[s]=String.fromCharCode.apply(String,p.slice(a+1));break;case"IEND":return n&&this.animation.frames.push(n),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(d=this.colorType)||6===d,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}var i,o,n;return r.load=function(e,t,i){var o;return"function"==typeof t&&(i=t),(o=new XMLHttpRequest).open("GET",e,!0),o.responseType="arraybuffer",o.onload=function(){var e;return e=new r(new Uint8Array(o.response||o.mozResponseArrayBuffer)),"function"==typeof(null!=t?t.getContext:void 0)&&e.render(t),"function"==typeof i?i(e):void 0},o.send(null)},1,2,0,r.prototype.read=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)r.push(this.data[this.pos++]);return r},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(t){var r,i,o,n,a,s,l,u,p,f,c,d,h,m,g,y,v,w,b,x,C,R,k;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);for(t=(t=new e(t)).getBytes(),y=(d=this.pixelBitlength/8)*this.width,h=new Uint8Array(y*this.height),s=t.length,g=0,m=0,i=0;m<s;){switch(t[m++]){case 0:for(n=b=0;b<y;n=b+=1)h[i++]=t[m++];break;case 1:for(n=x=0;x<y;n=x+=1)r=t[m++],a=n<d?0:h[i-d],h[i++]=(r+a)%256;break;case 2:for(n=C=0;C<y;n=C+=1)r=t[m++],o=(n-n%d)/d,v=g&&h[(g-1)*y+o*d+n%d],h[i++]=(v+r)%256;break;case 3:for(n=R=0;R<y;n=R+=1)r=t[m++],o=(n-n%d)/d,a=n<d?0:h[i-d],v=g&&h[(g-1)*y+o*d+n%d],h[i++]=(r+Math.floor((a+v)/2))%256;break;case 4:for(n=k=0;k<y;n=k+=1)r=t[m++],o=(n-n%d)/d,a=n<d?0:h[i-d],0===g?v=w=0:(v=h[(g-1)*y+o*d+n%d],w=o&&h[(g-1)*y+(o-1)*d+n%d]),l=a+v-w,u=Math.abs(l-a),f=Math.abs(l-v),c=Math.abs(l-w),p=u<=f&&u<=c?a:f<=c?v:w,h[i++]=(r+p)%256;break;default:throw new Error("Invalid filter algorithm: "+t[m-1])}g++}return h},r.prototype.decodePalette=function(){var e,t,r,i,o,n,a,s,l;for(r=this.palette,n=this.transparency.indexed||[],o=new Uint8Array((n.length||0)+r.length),i=0,r.length,e=0,t=a=0,s=r.length;a<s;t=a+=3)o[i++]=r[t],o[i++]=r[t+1],o[i++]=r[t+2],o[i++]=null!=(l=n[e++])?l:255;return o},r.prototype.copyToImageData=function(e,t){var r,i,o,n,a,s,l,u,p,f,c;if(i=this.colors,p=null,r=this.hasAlphaChannel,this.palette.length&&(p=null!=(c=this._decodedPalette)?c:this._decodedPalette=this.decodePalette(),i=4,r=!0),u=(o=e.data||e).length,a=p||t,n=s=0,1===i)for(;n<u;)l=p?4*t[n/4]:s,f=a[l++],o[n++]=f,o[n++]=f,o[n++]=f,o[n++]=r?a[l++]:this.transparency.grayscale&&this.transparency.grayscale===f?0:255,s=l;else for(;n<u;)l=p?4*t[n/4]:s,o[n++]=a[l++],o[n++]=a[l++],o[n++]=a[l++],o[n++]=r?a[l++]:this.transparency.rgb&&this.transparency.rgb[1]===a[l-3]&&this.transparency.rgb[3]===a[l-2]&&this.transparency.rgb[5]===a[l-1]?0:255,s=l},r.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e},o=t.document&&t.document.createElement("canvas"),n=o&&o.getContext("2d"),i=function(e){var t;return n.width=e.width,n.height=e.height,n.clearRect(0,0,e.width,e.height),n.putImageData(e,0,0),(t=new Image).src=o.toDataURL(),t},r.prototype.decodeFrames=function(e){var t,r,o,n,a,s,l,u;if(this.animation){for(u=[],r=a=0,s=(l=this.animation.frames).length;a<s;r=++a)t=l[r],o=e.createImageData(t.width,t.height),n=this.decodePixels(new Uint8Array(t.data)),this.copyToImageData(o,n),t.imageData=o,u.push(t.image=i(o));return u}},r.prototype.renderFrame=function(e,t){var r,i,o;return r=(i=this.animation.frames)[t],o=i[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=o?o.disposeOp:void 0)?e.clearRect(o.xOffset,o.yOffset,o.width,o.height):2===(null!=o?o.disposeOp:void 0)&&e.putImageData(o.imageData,o.xOffset,o.yOffset),0===r.blendOp&&e.clearRect(r.xOffset,r.yOffset,r.width,r.height),e.drawImage(r.image,r.xOffset,r.yOffset)},r.prototype.animate=function(e){var t,r,i,o,n,a,s=this;return r=0,a=this.animation,o=a.numFrames,i=a.frames,n=a.numPlays,(t=function(){var a,l;if(a=r++%o,l=i[a],s.renderFrame(e,a),o>1&&r/o<n)return s.animation._timeout=setTimeout(t,l.delay)})()},r.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},r.prototype.render=function(e){var t,r;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(r=t.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),t.putImageData(r,0,0))},r}(this)}.apply(null,i))||(e.exports=o)},EZfi:function(e,t,r){var i,o;i=[r("ajsq"),r("r5V0"),r("xIS7")],void 0===(o=function(e,t,r){"use strict";return e(null,{constructor:function(){},decode:function(e){var i=new Uint8Array(e),o=new r;o.parse(i);var n,a=o.numComponents,s=o.getData(o.width,o.height,!0),l=o.width*o.height,u=o.eof,p=0,f=0,c=0;if(u<i.length-1){var d=new t(i.subarray(u)).getBytes();n=new Uint8Array(l);var h=0;for(p=0;p<d.length;p++)for(c=7;c>=0;c--)n[h++]=d[p]>>c&1}var m,g=[];if(1===a)g=[s,s,s];else{for(p=0;p<3;p++)m=new Uint8Array(l),g.push(m);for(c=0,f=0;f<l;f++)for(p=0;p<3;p++)g[p][f]=s[c++]}return{width:o.width,height:o.height,pixels:g,mask:n}}})}.apply(null,i))||(e.exports=o)},G5N4:function(e,t,r){var i,o;i=[r.dj.c(e.i),r("rg9i"),r("qMld"),r("0RER"),r("Odfd"),r("FEX1"),r("QJ8R"),r("OXmT"),r("WaJo"),r("EtsK")],void 0===(o=function(e,t,i,o,n,a,s,l,u,p){var f={canvas2D:"2d",webGL:"webgl",expWebGL:"experimental-webgl",webGL2:"webgl2",expWebGL2:"experimental-webgl2"};return o.createSubclass([n,a,s,l,u],{declaredClass:"esri.layers.ImageryLayer",normalizeCtorArgs:function(e,r){return"string"==typeof e?t.mixin({},{url:e},r):e},load:function(){this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]}).then(this._fetchService.bind(this),this._fetchService.bind(this)))},properties:{url:p.url,listMode:{type:["show","hide"]},drawMode:!0,drawType:{value:f.canvas2D,cast:function(e){return e in f?e:f.canvas2D}},legendEnabled:p.legendEnabled,operationalLayerType:{type:["ArcGISImageServiceLayer"],value:"ArcGISImageServiceLayer"},popupEnabled:p.popupEnabled,pixelFilter:null,type:{value:"imagery",json:{read:!1}}},redraw:function(){this.emit("redraw")},importLayerViewModule:function(e){switch(e.type){case"2d":return i.create(function(e){Promise.all([r.e(18),r.e(78)]).then(function(){var t=[r("Zruw")];e.apply(null,t)}.bind(this)).catch(r.oe)});case"3d":return i.create(function(e){Promise.all([r.e(0),r.e(1),r.e(7),r.e(16),r.e(79)]).then(function(){var t=[r("t7z+")];e.apply(null,t)}.bind(this)).catch(r.oe)})}}})}.apply(null,i))||(e.exports=o)},KtQ6:function(e,t,r){var i,o;i=[r.dj.c(e.i),t],void 0===(o=function(e,t){function r(e){return"r"in e&&"g"in e&&"b"in e}function i(e){return"h"in e&&"s"in e&&"v"in e}function o(e){return"l"in e&&"a"in e&&"b"in e}function n(e){return"l"in e&&"c"in e&&"h"in e}function a(e){return"x"in e&&"y"in e&&"z"in e}function s(e,t){var r,i,o=[];if(e[0].length!==t.length)throw"dimensions do not match";var n=e.length,a=e[0].length,s=0;for(r=0;r<n;r++){for(s=0,i=0;i<a;i++)s+=e[r][i]*t[i];o.push(s)}return o}function l(e){var t=[e.r/255,e.g/255,e.b/255].map(function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}),r=s(x,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function u(e){var t=s(C,[e.x/100,e.y/100,e.z/100]).map(function(e){var t=e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;return Math.min(1,Math.max(t,0))});return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function p(e){var t=[e.x/95.047,e.y/100,e.z/108.883].map(function(e){return e>Math.pow(6/29,3)?Math.pow(e,1/3):1/3*Math.pow(29/6,2)*e+4/29});return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function f(e){var t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map(function(e){return e>6/29?Math.pow(e,3):3*Math.pow(6/29,2)*(e-4/29)});return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function c(e){var t=e.l,r=e.a,i=e.b,o=Math.sqrt(r*r+i*i),n=Math.atan2(i,r);return{l:t,c:o,h:n=n>0?n:n+2*Math.PI}}function d(e){var t=e.l,r=e.c,i=e.h;return{l:t,a:r*Math.cos(i),b:r*Math.sin(i)}}function h(e){return p(l(e))}function m(e){return u(f(e))}function g(e){return c(p(l(e)))}function y(e){return u(f(d(e)))}function v(e){var t,r,i,o=e.r,n=e.g,a=e.b,s=Math.max(o,n,a),l=s-Math.min(o,n,a);return i=s,0===l?t=0:s===o?t=(n-a)/l%6:s===n?t=(a-o)/l+2:s===a&&(t=(o-n)/l+4),r=0===l?0:l/i,t<0&&(t+=6),{h:t*=60,s:r*=100,v:i*=100/255}}function w(e){var t,r=(e.h+360)%360/60,i=e.s/100,o=e.v/100*255,n=o*i,a=n*(1-Math.abs(r%2-1));switch(Math.floor(r)){case 0:t={r:n,g:a,b:0};break;case 1:t={r:a,g:n,b:0};break;case 2:t={r:0,g:n,b:a};break;case 3:t={r:0,g:a,b:n};break;case 4:t={r:a,g:0,b:n};break;case 5:case 6:t={r:n,g:0,b:a};break;default:t={r:0,g:0,b:0}}return t.r=Math.round(t.r+o-n),t.g=Math.round(t.g+o-n),t.b=Math.round(t.b+o-n),t}function b(e){return r(e)?e:n(e)?y(e):o(e)?m(e):a(e)?u(e):i(e)?w(e):void 0}Object.defineProperty(t,"__esModule",{value:!0});var x=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],C=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];t.toRGB=b,t.toHSV=function(e){return i(e)?e:v(b(e))},t.toLAB=function(e){return o(e)?e:h(b(e))},t.toLCH=function(e){return n(e)?e:g(b(e))},t.toXYZ=function(e){return a(e)?e:l(b(e))}}.apply(null,i))||(e.exports=o)},Odfd:function(e,t,r){var i,o;i=[r("2fnV"),r("KQcO"),r("8Gw6"),r("dXLH"),r("ouPT"),r("97bx"),r("7Rj3"),r("YM6P"),r("N7S/"),r("oxlp"),r("Z4y+"),r("hz/Y"),r("begh"),r("uajq"),r("7ia+"),r("nakx"),r("zp6E"),r("jZlN"),r("ifLZ"),r("rg9i"),r("Gtr7"),r("0+sO"),r("qMld"),r("qsST"),r("ma1f")],void 0===(o=function(e,t,r,i,o,n,a,s,l,u,p,f,c,d,h,m,g,y,v,w,b,x,C,R,k){var T=new x.KebabDictionary({S8:"s8",S16:"s16",S32:"s32",U8:"u8",U16:"u16",U32:"u32",F32:"f32",F64:"f64"}),D=R.getLogger("esri.layers.mixins.ArcGISImageService"),_=b.createSubclass({properties:{layer:{},mosaicRule:{dependsOn:["layer.mosaicRule"],get:function(){return this.get("layer.mosaicRule")||null}},version:{value:0,dependsOn:["layer.bandIds","layer.format","layer.compressionQuality","layer.compressionTolerance","layer.interpolation","layer.noData","layer.noDataInterpretation","layer.mosaicRule","layer.renderingRule","layer.adjustAspectRatio","layer.pixelFilter","layer.renderer"],get:function(){var e=this.layer;return e.bandIds,e.format,e.compressionQuality,e.compressionTolerance,e.interpolation,e.noData,e.noDataInterpretation,e.mosaicRule,e.renderingRule,e.adjustAspectRatio,e.pixelFilter,e.renderer,this._get("version")+1}}},getExportImageRenderingRule:function(){var e=this.layer,t=e.renderer;return t&&s.isSupportedRendererType(t)?s.combineRenderingRules(s.convertRendererToRenderingRule(t,{rasterAttributeTable:e.rasterAttributeTable,pixelType:e.pixelType,convertColorRampToColormap:e.version<10.6}),e.renderingRule):e.renderingRule},toJSON:function(){var e=this.layer,t=this.getExportImageRenderingRule();return{bandIds:e.bandIds?e.bandIds.join(","):null,format:e.format,compressionQuality:e.compressionQuality,compressionTolerance:e.compressionTolerance,interpolation:e.interpolation,noData:e.noData,noDataInterpretation:e.noDataInterpretation,mosaicRule:this.mosaicRule?JSON.stringify(this.mosaicRule):null,renderingRule:t?JSON.stringify(t):null,adjustAspectRatio:e.adjustAspectRatio}}});return e.createSubclass({declaredClass:"esri.layers.mixins.ArcGISImageService",constructor:function(){this.exportImageServiceParameters=new _({layer:this})},_raster:null,properties:{adjustAspectRatio:{},bandCount:{},bandIds:{type:[Number],json:{write:!0}},capabilities:{json:{read:function(e){return e&&e.split(",").map(function(e){return e.trim()})}}},compressionQuality:{type:Number,json:{write:!0}},compressionTolerance:.01,copyright:{json:{read:{source:["copyrightText"],reader:function(e,t){return t.copyrightText}}}},definitionExpression:{get:function(){return this.mosaicRule?this.mosaicRule.where:null},set:function(e){var t=this.mosaicRule||new o;t.where=e,this._set("mosaicRule",t)},json:{read:{source:["definitionExpression","layerDefinition.definitionExpression"],reader:function(e,t){return e||t.layerDefinition&&t.layerDefinition.definitionExpression||void 0}}}},domainFields:{value:null,type:[t],dependsOn:["fields"],get:function(){return this.fields&&this.fields.filter(function(e){return null!=e.domain})||[]}},exportImageServiceParameters:{constructOnly:!0},fields:{type:[t]},fullExtent:{type:l,json:{read:{source:["extent"],reader:function(e,t){return l.fromJSON(t.extent)}}}},format:{type:String,dependsOn:["pixelFilter"],get:function(){return null!=this.pixelFilter?"lerc":"jpgpng"},json:{write:!0}},hasRasterAttributeTable:{},hasMultidimensions:{},imageMaxHeight:{value:4100,json:{origins:{service:{read:{source:"maxImageHeight"}}}}},imageMaxWidth:{value:15e3,json:{origins:{service:{read:{source:"maxImageWidth"}}}}},interpolation:{type:String,json:{write:!0}},mosaicRule:{value:null,type:o,json:{origins:{service:{read:{source:["defaultMosaicMethod"],reader:function(e,t){return o.fromJSON(t)}}}},write:!0}},multidimensionalInfo:null,noData:{type:Number,json:{write:!0}},noDataInterpretation:{type:String,json:{write:!0}},objectIdField:{json:{read:{source:["fields"],reader:function(e,t){return!e&&t.fields&&t.fields.some(function(t){return"esriFieldTypeOID"===t.type&&(e=t.name),!!e}),e}}}},pixelFilter:{},pixelType:{type:String,value:null,json:{read:T.read,write:T.write}},pixelSizeX:{value:0},pixelSizeY:{value:0},popupTemplate:{value:null,type:v,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}},defaultPopupTemplate:{readOnly:!0,json:{read:!1},dependsOn:["fields","title"],get:function(){return this.createPopupTemplate()}},queryTask:{readOnly:!0,dependsOn:["url"],get:function(){return new d({url:this.url})}},renderer:{value:null,json:{origins:{service:{read:!1}},read:{source:"layerDefinition.drawingInfo.renderer",reader:function(e,t,r){var i=t&&t.layerDefinition,o=f.read(e,i,r)||void 0;return s.isSupportedRendererType(o)||D.warn("ArcGISImageService","Imagery layer doesn't support given renderer type."),o}},write:{target:"layerDefinition.drawingInfo.renderer"}}},rasterAttributeTable:null,rasterAttributeTableFieldPrefix:"Raster.",rasterFields:{value:null,dependsOn:["fields","rasterAttributeTable","rasterAttributeTableFieldPrefix"],get:function(){var e=this.rasterAttributeTableFieldPrefix,t=this.fields?w.clone(this.fields):[],r=t.length;if(t[r]={name:"Raster.ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:"string"},(this.capabilities&&this.capabilities.indexOf("Catalog")>-1||this.fields&&this.fields.length>0)&&(t[r+1]={name:"Raster.ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:"string"}),null!=this.pixelFilter&&("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType)){t[r+2]={name:"Raster.Magnitude",alias:"Magnitude",domain:null,editable:!1,type:"double"},t[r+3]={name:"Raster.Direction",alias:"Direction",domain:null,editable:!1,type:"double"}}var i=this.rasterAttributeTable&&this.rasterAttributeTable.fields||null;if(i&&i.length>0){var o=i.filter(function(e){return"esriFieldTypeOID"!==e.type&&"value"!==e.name.toLowerCase()}).map(function(t){var r=w.clone(t);return r.name=e+t.name,r});t=t.concat(o)}return t}},renderingRule:{value:null,type:n,json:{origins:{service:{read:{source:["rasterFunctionInfos"],reader:function(e,t){var r=t.rasterFunctionInfos;return t.renderingRule||r&&r.length&&"None"!==r[0].name?n.fromJSON(t.renderingRule||{rasterFunctionInfos:t.rasterFunctionInfos}):null}}}},write:!0}},serviceDataType:{},spatialReference:{value:null,readOnly:!0,json:{read:{source:["extent"],reader:function(e,t){return(e=t.extent&&t.extent.spatialReference)&&p.fromJSON(e)}}}},url:{},version:{value:null,readOnly:!0,json:{read:{source:["currentVersion","fields","timeInfo"],reader:function(e,t){return(e=t.currentVersion)||(e=t.hasOwnProperty("fields")||t.hasOwnProperty("objectIdField")||t.hasOwnProperty("timeInfo")?10:9.3),e}}}}},applyFilter:function(e){var t=this._clonePixelData(e);return this.pixelFilter&&this.pixelFilter(t),t},fetchImage:function(e,t,r,i){if(i=i||{},null==this._raster||null==e||null==t||null==r)return C.reject(new Error("Insufficient parameters for requesting an image. A valid extent, width and height values are required."));var o={imageServiceParameters:this.getExportImageServiceParameters(e,t,r,i),nBands:Math.min(this.bandCount,3),pixelType:this.pixelType,requestAsImageElement:i.requestAsImageElement&&!this.pixelFilter||!1};return this._raster.read(o)},fetchKeyProperties:function(e){var t=e&&e.renderingRule&&e.renderingRule.toJSON();return g(this.parsedUrl.path+"/keyProperties",{query:{f:"json",renderingRule:t}}).then(function(e){return e.data})},getExportImageServiceParameters:function(e,t,r,i){var o=(e=e.clone().shiftCentralMeridian())&&e.spatialReference;return o=o&&(o.wkid||JSON.stringify(o.toJSON())),w.mixin({bbox:e&&e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,bboxSR:o,imageSR:o,size:t+","+r},this.exportImageServiceParameters.toJSON())},fetchRasterAttributeTable:function(e){var t=e&&e.renderingRule;if(this.version>10&&this.hasRasterAttributeTable){var r={f:"json"};return t&&"esri.layers.support.RasterFunction"===t.declaredClass&&this.version>=10.3&&(r.renderingRule=JSON.stringify(t.toJSON())),g(this.parsedUrl.path+"/rasterAttributeTable",{query:r}).then(function(e){return e.data})}return C.reject(new k("#fetchRasterAttributeTable()","Failed to get rasterAttributeTable"))},queryRasters:function(e){return this.queryTask.execute(e)},queryVisibleRasters:function(e,t){this._visibleRasters=[];var r,i,o,n,a=!1,s=t.popupTemplate||this.popupTemplate;if(s&&s.fieldInfos&&s.fieldInfos.length>0&&(a=s.fieldInfos.length>1||"raster.servicepixelvalue"!==s.fieldInfos[0].toLowerCase()),s&&!a&&this.rasterFields&&(a=this.rasterFields.some(function(e){var t=e&&e.name?e.name.toLowerCase():null;return t&&"raster.servicepixelvalue"!==t&&(s.title&&s.title.toLowerCase().indexOf(t)>-1||s.content&&s.content.toLowerCase().indexOf(t)>-1)})),t.layerView&&t.layerView.view){var l=t.layerView.view;if("2d"===l.type){var p=l.state;r=p.spatialReference.clone(),i=p.resolution}else r=l.spatialReference.clone(),i=l.resolution;i&&(o=new u(.5*i,.5*i,r)),n=r.equals(this.spatialReference)}var f=new m({geometry:e.geometry,returnCatalogItems:a,timeExtent:e.timeExtent,mosaicRule:this.mosaicRule||null,renderingRule:this.renderingRule||null,returnGeometry:n,outSpatialReference:r,pixelSize:o});return new h({url:this.url}).execute(f).then(function(e){return this._processVisibleRastersResponse(e,t)}.bind(this)).catch(function(e){throw new Error("Error querying for visible rasters")})},createPopupTemplate:function(e){return c.createPopupTemplate(this,e)},_isScientificData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType||"esriImageServiceDataTypeScientific"===this.serviceDataType},_fetchService:function(){return C.resolve().then(function(){return this.resourceInfo||g(this.parsedUrl.path,{query:w.mixin({f:"json"},this.parsedUrl.query),responseType:"json"})}.bind(this)).then(function(e){e.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.read(e.data,{origin:"service",url:this.parsedUrl}),this._raster=new r({url:this.url})}.bind(this)).then(function(){if(this.version>10&&this.hasRasterAttributeTable)return g(this.parsedUrl.path+"/rasterAttributeTable",{query:{f:"json"},responseType:"json"}).then(function(e){var t=e.data;t&&t.features&&t.fields&&this.read({rasterAttributeTable:t},{origin:"service",url:this.parsedUrl})}.bind(this))}.bind(this)).then(function(){if(this.version>=10.3&&this._isScientificData()&&this.hasMultidimensions)return g(this.parsedUrl.path+"/multiDimensionalInfo",{query:{f:"json"},responseType:"json"}).then(function(e){var t=e.data;t&&t.multidimensionalInfo&&(this._updateMultidimensionalDefinition(t.multidimensionalInfo),this.multidimensionalInfo=t.multidimensionalInfo)}.bind(this))}.bind(this))},_updateMultidimensionalDefinition:function(e){var t,r=e.variables[0].dimensions,i=[];for(t in r)if(r.hasOwnProperty(t)){var n=r[t],s=!0,l=n.extent,u=[l[0]];n.hasRanges&&!0===n.hasRanges?(s=!1,u=[n.values[0]]):"stdz"===n.name.toLowerCase()&&Math.abs(l[1])<=Math.abs(l[0])&&(u=[l[1]]),i.push(new a({variableName:"",dimensionName:r[t].name,isSlice:s,values:u}))}if(i.length>0){this.mosaicRule=this.mosaicRule||new o;var p=this.mosaicRule.multidimensionalDefinition;(!p||p&&p.length<=0)&&(this.mosaicRule.multidimensionalDefinition=i)}},_clonePixelData:function(e){if(null==e)return e;var t={};e.extent&&(t.extent=e.extent.clone());var r=e.pixelBlock;return null==r?t:(t.pixelBlock=r.clone(),t)},_processVisibleRastersResponse:function(e,t){var r,i,o,n,a=e.value,s=0,u=this.objectIdField,p=e.catalogItems&&e.catalogItems.features&&e.catalogItems.features.length||0;if(p){var f,c,d=0,h=0;for(i=[p],r=[p],n=[p],s=0;s<p;s++)e.properties.Values[s].toLowerCase().indexOf("nodata")>-1&&h++;for(f=p-h,s=0;s<p;s++)i[c=e.properties.Values[s].toLowerCase().indexOf("nodata")>-1?f++:d++]=e.catalogItems.features[s],r[c]=e.properties.Values[s],n[c]=i[c].attributes[u]}this._visibleRasters=[];var m,g=a.toLowerCase().indexOf("nodata")>-1;if(a&&!i&&!g){u="ObjectId",i=[];var v={ObjectId:0};(m=new y(new l(this.fullExtent),null,v)).sourceLayer=this,i.push(m)}var w=[];if(!i)return w;var b,x=t&&t.returnDomainValues||!1;for(s=0,o=i.length;s<o;s++)(m=i[s]).sourceLayer=this,a&&(b=a,r&&r.length>=s&&(b=r[s].replace(/ /gi,", ")),m.attributes["Raster.ItemPixelValue"]=b,m.attributes["Raster.ServicePixelValue"]=a,this._updateFeatureWithMagDirValues(m,b),this._updateFeatureWithRasterAttributeTableValues(m,b)),x&&this._updateFeatureWithDomainValues(m),w.push(m);return w},_updateFeatureWithRasterAttributeTableValues:function(e,t){var r=this.rasterAttributeTable&&this.rasterAttributeTable.features;if(r&&!(r.length<1)&&this.rasterAttributeTableFieldPrefix){var i=null;if(r.forEach(function(e){e&&e.attributes&&(e.attributes.Value!=t&&e.attributes.VALUE!=t||(i=e))}),i){var o,n={};for(o in i.attributes)i.attributes.hasOwnProperty(o)&&(n[this.rasterAttributeTableFieldPrefix+o]=i.attributes[o]);e.attributes=w.mixin(e.attributes,n)}}},_updateFeatureWithMagDirValues:function(e,t){if(this.pixelFilter&&("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType)){var r=t.replace(" ","").split(","),o=new i({height:1,width:1,pixelType:"f32",pixels:[],statistics:[]});r.forEach(function(e){o.addData({pixels:[e],statistics:{minValue:e,maxValue:e,noDataValue:null}})}),this.pixelFilter({pixelBlock:o,extent:new l(0,0,0,0,this.spatialReference)}),e.attributes["Raster.Magnitude"]=o.pixels[0][0],e.attributes["Raster.Direction"]=o.pixels[1][0]}},_updateFeatureWithDomainValues:function(e){var t=this.domainFields;null!=t&&t.forEach(function(t){if(t){var r=e.attributes[t.name];if(null!=r){var i=this._findMatchingDomainValue(t.domain,r);null!=i&&(e.attributes[t.name]=i)}}},this)},_findMatchingDomainValue:function(e,t){var r,i=e&&e.codedValues;if(i)return i.some(function(e){return e.code===t&&(r=e.name,!0)}),r}})}.apply(null,i))||(e.exports=o)},Rc7o:function(e,t,r){var i;void 0===(i=function(){var e={defaultNoDataValue:-34027999387901484e22,decode:function(n,a){var s=(a=a||{}).encodedMaskData||null===a.encodedMaskData,l=o(n,a.inputOffset||0,s),u=null!=a.noDataValue?a.noDataValue:e.defaultNoDataValue,p=t(l,a.pixelType||Float32Array,a.encodedMaskData,u,a.returnMask),f={width:l.width,height:l.height,pixelData:p.resultPixels,minValue:l.pixels.minValue,maxValue:l.pixels.maxValue,noDataValue:u};return p.resultMask&&(f.maskData=p.resultMask),a.returnEncodedMask&&l.mask&&(f.encodedMaskData=l.mask.bitset?l.mask.bitset:null),a.returnFileInfo&&(f.fileInfo=r(l),a.computeUsedBitDepths&&(f.fileInfo.bitDepths=i(l))),f}},t=function(e,t,r,i,o){var a,s,l=0,u=e.pixels.numBlocksX,p=e.pixels.numBlocksY,f=Math.floor(e.width/u),c=Math.floor(e.height/p),d=2*e.maxZError;r=r||(e.mask?e.mask.bitset:null),a=new t(e.width*e.height),o&&r&&(s=new Uint8Array(e.width*e.height));for(var h,m,g=new Float32Array(f*c),y=0;y<=p;y++){var v=y!==p?c:e.height%p;if(0!==v)for(var w=0;w<=u;w++){var b=w!==u?f:e.width%u;if(0!==b){var x,C,R,k,T=y*e.width*c+w*f,D=e.width-b,_=e.pixels.blocks[l];if(_.encoding<2?(0===_.encoding?x=_.rawData:(n(_.stuffedData,_.bitsPerPixel,_.numValidPixels,_.offset,d,g,e.pixels.maxValue),x=g),C=0):R=2===_.encoding?0:_.offset,r)for(m=0;m<v;m++){for(7&T&&(k=r[T>>3],k<<=7&T),h=0;h<b;h++)7&T||(k=r[T>>3]),128&k?(s&&(s[T]=1),a[T++]=_.encoding<2?x[C++]:R):(s&&(s[T]=0),a[T++]=i),k<<=1;T+=D}else if(_.encoding<2)for(m=0;m<v;m++){for(h=0;h<b;h++)a[T++]=x[C++];T+=D}else for(m=0;m<v;m++)if(a.fill)a.fill(R,T,T+b),T+=b+D;else{for(h=0;h<b;h++)a[T++]=R;T+=D}if(1===_.encoding&&C!==_.numValidPixels)throw"Block and Mask do not match";l++}}}return{resultPixels:a,resultMask:s}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,minValue:e.pixels.minValue,noDataValue:this.noDataValue}}},i=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},i=0;i<t;i++){var o=e.pixels.blocks[i];0===o.encoding?r.float32=!0:1===o.encoding?r[o.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},o=function(e,t,r){var i={},o=new Uint8Array(e,t,10);if(i.fileIdentifierString=String.fromCharCode.apply(null,o),"CntZImage"!=i.fileIdentifierString.trim())throw"Unexpected file identifier string: "+i.fileIdentifierString;t+=10;var n=new DataView(e,t,24);if(i.fileVersion=n.getInt32(0,!0),i.imageType=n.getInt32(4,!0),i.height=n.getUint32(8,!0),i.width=n.getUint32(12,!0),i.maxZError=n.getFloat64(16,!0),t+=24,!r)if(n=new DataView(e,t,16),i.mask={},i.mask.numBlocksY=n.getUint32(0,!0),i.mask.numBlocksX=n.getUint32(4,!0),i.mask.numBytes=n.getUint32(8,!0),i.mask.maxValue=n.getFloat32(12,!0),t+=16,i.mask.numBytes>0){var a=new Uint8Array(Math.ceil(i.width*i.height/8)),s=(n=new DataView(e,t,i.mask.numBytes)).getInt16(0,!0),l=2,u=0;do{if(s>0)for(;s--;)a[u++]=n.getUint8(l++);else{var p=n.getUint8(l++);for(s=-s;s--;)a[u++]=p}s=n.getInt16(l,!0),l+=2}while(l<i.mask.numBytes);if(-32768!==s||u<a.length)throw"Unexpected end of mask RLE encoding";i.mask.bitset=a,t+=i.mask.numBytes}else if(0==(i.mask.numBytes|i.mask.numBlocksY|i.mask.maxValue)){a=new Uint8Array(Math.ceil(i.width*i.height/8));i.mask.bitset=a}n=new DataView(e,t,16),i.pixels={},i.pixels.numBlocksY=n.getUint32(0,!0),i.pixels.numBlocksX=n.getUint32(4,!0),i.pixels.numBytes=n.getUint32(8,!0),i.pixels.maxValue=n.getFloat32(12,!0),t+=16;var f=i.pixels.numBlocksX,c=i.pixels.numBlocksY,d=f+(i.width%f>0?1:0),h=c+(i.height%c>0?1:0);i.pixels.blocks=new Array(d*h);for(var m=1e9,g=0,y=0;y<h;y++)for(var v=0;v<d;v++){var w=0,b=e.byteLength-t;n=new DataView(e,t,Math.min(10,b));var x={};i.pixels.blocks[g++]=x;var C=n.getUint8(0);if(w++,x.encoding=63&C,x.encoding>3)throw"Invalid block encoding ("+x.encoding+")";if(2!==x.encoding){if(0!==C&&2!==C){if(C>>=6,x.offsetType=C,2===C)x.offset=n.getInt8(1),w++;else if(1===C)x.offset=n.getInt16(1,!0),w+=2;else{if(0!==C)throw"Invalid block offset type";x.offset=n.getFloat32(1,!0),w+=4}if(m=Math.min(x.offset,m),1===x.encoding)if(C=n.getUint8(w),w++,x.bitsPerPixel=63&C,C>>=6,x.numValidPixelsType=C,2===C)x.numValidPixels=n.getUint8(w),w++;else if(1===C)x.numValidPixels=n.getUint16(w,!0),w+=2;else{if(0!==C)throw"Invalid valid pixel count type";x.numValidPixels=n.getUint32(w,!0),w+=4}}var R;if(t+=w,3!=x.encoding)if(0===x.encoding){var k=(i.pixels.numBytes-1)/4;if(k!==Math.floor(k))throw"uncompressed block has invalid length";R=new ArrayBuffer(4*k),new Uint8Array(R).set(new Uint8Array(e,t,4*k));for(var T=new Float32Array(R),D=0;D<T.length;D++)m=Math.min(m,T[D]);x.rawData=T,t+=4*k}else if(1===x.encoding){var _=Math.ceil(x.numValidPixels*x.bitsPerPixel/8),S=Math.ceil(_/4);R=new ArrayBuffer(4*S),new Uint8Array(R).set(new Uint8Array(e,t,_)),x.stuffedData=new Uint32Array(R),t+=_}}else t++,m=Math.min(m,0)}return i.pixels.minValue=m,i.eofOffset=t,i},n=function(e,t,r,i,o,n,a){var s,l,u,p=(1<<t)-1,f=0,c=0,d=Math.ceil((a-i)/o),h=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*h,s=0;s<r;s++){if(0===c&&(u=e[f++],c=32),c>=t)l=u>>>c-t&p,c-=t;else{var m=t-c;l=(u&p)<<m&p,l+=(u=e[f++])>>>(c=32-m)}n[s]=l<d?i+l*o:a}return n};return e}.apply(null,[]))||(e.exports=i)},TsGx:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("9opi"),r("qKT0"),r("ycL1"),r("rg9i"),r("Vx27")],void 0===(o=function(e,t,r,i,o,n,a){return function(e){function t(t){var r=e.call(this,t)||this;return r.attachmentTypes=null,r.globalIds=null,r.num=null,r.objectIds=null,r.returnMetadata=!1,r.size=null,r.start=null,r.where=null,r}var o;return r(t,e),o=t,t.prototype.writeStart=function(e,t,r){t.resultOffset=this.start,t.resultRecordCount=this.num||10},t.prototype.clone=function(){return new o(n.clone({attachmentTypes:this.attachmentTypes,where:this.where,globalIds:this.globalIds,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))},i([a.property({type:[String],json:{write:!0}})],t.prototype,"attachmentTypes",void 0),i([a.property({type:[Number],json:{write:!0}})],t.prototype,"globalIds",void 0),i([a.property({type:Number,json:{read:{source:"resultRecordCount"}}})],t.prototype,"num",void 0),i([a.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),i([a.property({type:Boolean,json:{default:!1,write:!0}})],t.prototype,"returnMetadata",void 0),i([a.property({type:[Number],json:{write:!0}})],t.prototype,"size",void 0),i([a.property({type:Number,json:{read:{source:"resultOffset"}}})],t.prototype,"start",void 0),i([a.writer("start"),a.writer("num")],t.prototype,"writeStart",null),i([a.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],t.prototype,"where",void 0),o=i([a.subclass("esri.tasks.support.AttachmentQuery")],t)}(a.declared(o))}.apply(null,i))||(e.exports=o)},UVEp:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("QDcU"),r("KtQ6")],void 0===(o=function(e,t,r,i){function o(e,t){if(!e||!t||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]>t[r]+2||e[r]<t[r]-2)return!1;return!0}function n(e,t,r){var o=i.toLAB(e),n=i.toLAB(t),a={l:o.l*(1-r)+r*n.l,a:o.a*(1-r)+r*n.a,b:o.b*(1-r)+r*n.b};return i.toRGB(a)}function a(e,i){if(e){var n,a=i||t.PREDEFINED_JSON_COLOR_RAMPS,s=null;return"algorithmic"===e.type?a.some(function(t){if(o(e.fromColor.toRgb(),t.fromColor)&&o(e.toColor.toRgb(),t.toColor))return s=t.id,!0}):"multipart"===e.type&&a.some(function(t){if(e.colorRamps&&t.colorRamps&&e.colorRamps.length===t.colorRamps.length&&(n=e.colorRamps,!t.colorRamps.some(function(e,t){if(!o(n[t].fromColor.toRgb(),new r(e.fromColor).toRgb())||!o(n[t].toColor.toRgb(),new r(e.toColor).toRgb()))return!0}))){if(s)return!0;s=t.id}}),s}}Object.defineProperty(t,"__esModule",{value:!0}),t.PREDEFINED_JSON_COLOR_RAMPS=[{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],t.PREDEFINED_COLOR_RAMP_NAME_MAP={aspect_predefined:"Aspect",blackToWhite_predefined:"Black to White",blueBright_predefined:"Blue Bright",blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",conditionNumber_predefined:"Condition Number",cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",errors_predefined:"Errors",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",partialSpectrum_predefined:"Partial Spectrum",partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",slope_predefined:"Slope",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",yellowToRed_predefined:"Yellow to Red",yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"},t.getColorRampId=a,t.getColorRampName=function(e){var r=a(e);return r?t.PREDEFINED_COLOR_RAMP_NAME_MAP[r]:null},t.convertColorRampToColormap=function(e,t){if(e&&t){for(var i,o,a,s,l,u="multipart"===e.type?e.colorRamps.length:1,p=[],f=[],c=0,d=0;d<u;d++)p[d]={start:null,end:null},p[d].start=c,p[d].end=c+1/u,c=p[d].end;for(d=0;d<t;d++)!function(u){s=(u+.5)/t,p.forEach(function(t,p){s>=t.start&&s<t.end&&(l=(s-t.start)/(t.end-t.start),"multipart"===e.type?(i=new r(e.colorRamps[p].fromColor),o=new r(e.colorRamps[p].toColor)):(i=new r(e.fromColor),o=new r(e.toColor)),a=n(i,o,l),f.push([u,a.r,a.g,a.b]))})}(d);return f}}}.apply(null,i))||(e.exports=o)},YM6P:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("KY0m"),r("rg9i"),r("97bx"),r("UVEp"),r("hBcF")],void 0===(o=function(e,t,r,i,o,n,a){function s(e){var t=e.Raster;return t&&"esri.layers.support.RasterFunction"===t.declaredClass?s(t.functionArguments):e}function l(e,t){var r=new o;r.functionName="Stretch";var i=h[a.stretchTypeJSONDict.toJSON(e.stretchType)],s={StretchType:i,Statistics:e.statistics,DRA:e.dynamicRangeAdjustment,UseGamma:e.useGamma,Gamma:e.gamma,ComputeGamma:e.computeGamma};if(null!=e.outputMin&&(s.Min=e.outputMin),null!=e.outputMax&&(s.Max=e.outputMax),i===h.standardDeviation?(s.NumberOfStandardDeviations=e.numberOfStandardDeviations,r.outputPixelType="u8"):i===h.percentClip?(s.MinPercent=e.minPercent,s.MaxPercent=e.maxPercent,r.outputPixelType="u8"):i===h.minMax?r.outputPixelType="u8":i===h.sigmoid&&(s.SigmoidStrengthLevel=e.sigmoidStrengthLevel),r.functionArguments=s,r.variableName="Raster",e.colorRamp){var l=e.colorRamp,u=new o;return!t.convertColorRampToColormap||"algorithmic"!==l.type&&"multipart"!==l.type?u.functionArguments={colorRamp:e.colorRamp.toJSON()}:u.functionArguments={Colormap:n.convertColorRampToColormap(l,256)},u.functionArguments={colorRamp:e.colorRamp.toJSON()},u.variableName="Raster",u.functionName="Colormap",u.functionArguments.Raster=r,u}return r}function u(e,t){var r=[],i=[],n=[],a=[],s=t.pixelType,l=t.rasterAttributeTable,u=l&&l.features,c=f(l);if(u&&Array.isArray(u)&&e.classBreakInfos){e.classBreakInfos.forEach(function(t,r){var i,o=t.symbol.color;o.a&&u.forEach(function(n){((i=n.attributes[e.field])>=t.minValue&&i<t.maxValue||r===e.classBreakInfos.length-1&&i>=t.minValue)&&a.push([n.attributes[c],o.r,o.g,o.b])})});var d=s?p(a,s):a,h=new o;return h.functionName="Colormap",h.functionArguments={},h.functionArguments.Colormap=d,h.variableName="Raster",h}e.classBreakInfos.forEach(function(e,t){var o=e.symbol&&e.symbol.color;o.a?(0===t?r.push(e.minValue,e.maxValue+1e-6):r.push(e.minValue+1e-6,e.maxValue+1e-6),i.push(t),a.push([t,o.r,o.g,o.b])):n.push(e.minValue,e.maxValue)});var m=s?p(a,s):a,g=new o;g.functionName="Remap",g.functionArguments={InputRanges:r,OutputValues:i,NoDataRanges:n},g.variableName="Raster";var y=new o;return y.functionName="Colormap",y.functionArguments={Colormap:m,Raster:g},y}function p(e,t){var r=d[String(t).toLowerCase()];return r&&e.push([Math.floor(r[0]-1),0,0,0],[Math.ceil(r[1]+1),0,0,0]),e}function f(e){if(e){var t=e.fields,i=t&&r.find(t,function(e){return e&&e.name&&"value"===e.name.toLowerCase()});return i&&i.name}}function c(e,t){var r=[],i=t.pixelType,n=t.rasterAttributeTable,a=n&&n.features,s=f(n);e.uniqueValueInfos&&e.uniqueValueInfos.forEach(function(t){var i=t.symbol.color;i.a&&(e.field!==s&&a?a&&a.forEach(function(o){String(o.attributes[e.field])===String(t.value)&&r.push([o.attributes[s],i.r,i.g,i.b])}):r.push([t.value,i.r,i.g,i.b]))});var l=i?p(r,i):r,u=new o;return u.functionName="Colormap",u.functionArguments={},u.functionArguments.Colormap=l,u.variableName="Raster",u}Object.defineProperty(t,"__esModule",{value:!0});var d={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767]};t.isSupportedRendererType=function(e){var t=e.type;return"raster-stretch"===t||"unique-value"===t||"class-breaks"===t},t.combineRenderingRules=function(e,t){if(!e||!t)return i.clone(e||t);var r=i.clone(e);return"none"!==t.functionName.toLowerCase()&&(s(r.functionArguments).Raster=t),r},t.convertRendererToRenderingRule=function(e,t){switch(t=t||{},e.type){case"raster-stretch":return l(e,t);case"class-breaks":return u(e,t);case"unique-value":return c(e,t)}};var h={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9}}.apply(null,i))||(e.exports=o)},begh:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("2Atf"),r("I08w"),r("ifLZ"),r("O4In"),r("Ctes"),r("BwRt")],void 0===(o=function(e,t,r,i,o,n,a,s){function l(e,t){var r=e;if(t.ignoreFieldTypes&&(e=e.filter(function(e){return-1===t.ignoreFieldTypes.indexOf(e.type)})),0===e.length)return null;var i=t.maximumFields&&e.length>t.maximumFields;return i&&(e=e.slice(0,t.maximumFields)),e===r&&(e=e.slice()),e.sort(u),{fields:e,limitExceeded:i}}function u(e,t){return"oid"===e.type?-1:"oid"===t.type?1:h(e)?-1:h(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function p(e){return e.map(function(e){return new a({fieldName:e.name,label:e.alias,format:f(e),visible:!0})})}function f(e){switch(e.type){case"small-integer":case"integer":case"single":return new s({digitSeparator:!0,places:0});case"double":return new s({digitSeparator:!0,places:2});case"date":return new s({dateFormat:"long-month-day-year"});default:return null}}function c(e){var t=[new n.FieldsContent,new n.AttachmentsContent];return e&&t.push(new n.TextContent({text:"<small>"+i.tooManyFields+"</small>"})),t}function d(e,t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(h(o))return e+": {"+o.name+"}"}return e}function h(e){return"name"===(e.name&&e.name.toLowerCase())||"name"===(e.alias&&e.alias.toLowerCase())||void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.createPopupTemplate=function(e,t){var i=e.fields,n=e.title;if(!i)return null;var a=l(i,r({},m,t));if(!a)return null;var s=d(n,a.fields),u=c(a.limitExceeded),f=p(a.fields);return new o({title:s,content:u,fieldInfos:f})};var m={ignoreFieldTypes:["geometry","blob","raster","guid","xml"],maximumFields:75}}.apply(null,i))||(e.exports=o)},bllj:function(e,t,r){var i,o;i=[r("ycL1"),r("oxlp"),r("w1v0")],void 0===(o=function(e,t,r){return e.createSubclass({declaredClass:"esri.tasks.support.ImageServiceIdentifyResult",properties:{catalogItemVisibilities:null,catalogItems:{value:null,type:r},location:{value:null,type:t},name:null,objectId:null,properties:null,value:null}})}.apply(null,i))||(e.exports=o)},dXLH:function(e,t,r){var i,o;i=[r("Gtr7"),r("rg9i")],void 0===(o=function(e,t){return e.createSubclass({declaredClass:"esri.layers.support.PixelBlock",normalizeCtorArgs:function(e){if(!e.width||Math.floor(e.width)!==e.width)throw"PixelBlock: incorrect width";if(!e.height||Math.floor(e.height)!==e.height)throw"PixelBlock: incorrect height";if(!e.pixels||!e.statistics)throw"PixelBlock: pixel data or statistics not present"},properties:{height:null,mask:null,pixels:[],pixelType:null,planes:null,statistics:[],width:null},getPlaneCount:function(){return this.pixels.length!==this.statistics.length?void 0:this.statistics.length},addData:function(e){if(!e.pixels||!e.statistics)throw"Pixel data or statistics are not present";if(e.pixels.length!==this.width*this.height)throw"Inconsistent pixel data size";this.statistics.push(e.statistics),this.pixels.push(e.pixels)},getAsRGBA:function(){var e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(e);break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)},getAsRGBAFloat:function(){var e=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(e),e},clone:function(){var e,r,i=new this.constructor;if(i.width=this.width,i.height=this.height,i.pixelType=this.pixelType,this.mask&&(i.mask=new Uint8Array(this.mask)),this.pixels)for(i.pixels=[],r=this.pixels.length,e=0;e<r;e++)i.pixels[e]=new Float32Array(this.pixels[e]);if(this.statistics)for(i.statistics=[],r=this.statistics.length,e=0;e<r;e++)i.statistics[e]=t.clone(this.statistics[e]);return i},_fillFrom8Bit:function(e){var t=this.pixels,r=this.mask;if(e&&t&&t.length){var i,o,n,a;i=o=n=t[0],t.length>=3&&(o=t[1],n=t[2]);var s=new Uint32Array(e),l=this.width*this.height;if(i.length===l)if(r&&r.length===l)for(a=0;a<l;a++)r[a]&&(s[a]=255<<24|n[a]<<16|o[a]<<8|i[a]);else for(a=0;a<l;a++)s[a]=255<<24|n[a]<<16|o[a]<<8|i[a]}},_fillFromNon8Bit:function(e){var t=this.pixels,r=this.mask,i=this.statistics;if(e&&t&&t.length){var o=1,n=0;if(i&&i.length>0)n=i[0].minValue,o=255/(i[0].maxValue-i[0].minValue);else{var a=255;"s8"===this.pixelType?(n=-128,a=127):"u16"===this.pixelType?a=65535:"s16"===this.pixelType?(n=-32768,a=32767):"u32"===this.pixelType?a=4294967295:"s32"===this.pixelType?(n=-2147483648,a=2147483647):"f32"===this.pixelType?(n=-34e38,a=34e38):"f64"===this.pixelType&&(n=-Number.MAX_VALUE,a=Number.MAX_VALUE),o=255/(a-n)}var s,l,u,p,f,c=new Uint32Array(e),d=this.width*this.height;if((s=t[0]).length===d)if(t.length>=3)if(l=t[1],u=t[2],r&&r.length===d)for(p=0;p<d;p++)r[p]&&(c[p]=255<<24|(u[p]-n)*o<<16|(l[p]-n)*o<<8|(s[p]-n)*o);else for(p=0;p<d;p++)c[p]=255<<24|(u[p]-n)*o<<16|(l[p]-n)*o<<8|(s[p]-n)*o;else if(r&&r.length===d)for(p=0;p<d;p++)f=(s[p]-n)*o,r[p]&&(c[p]=255<<24|f<<16|f<<8|f);else for(p=0;p<d;p++)f=(s[p]-n)*o,c[p]=255<<24|f<<16|f<<8|f}},_fillFrom32Bit:function(e){var t=this.pixels,r=this.mask;if(e&&t&&t.length){var i,o,n,a;i=o=n=t[0],t.length>=3&&(o=t[1],n=t[2]);var s=this.width*this.height;if(i.length===s){var l=0;if(r&&r.length===s)for(a=0;a<s;a++)e[l++]=i[a],e[l++]=o[a],e[l++]=n[a],e[l++]=r[a];else for(a=0;a<s;a++)e[l++]=i[a],e[l++]=o[a],e[l++]=n[a],e[l++]=255}}}})}.apply(null,i))||(e.exports=o)},fw2w:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("0J3i"),r("ma1f"),r("qsST"),r("qMld"),r("Vt+U"),r("aYWh"),r("Z4y+"),r("nrlZ"),r("vtMp"),r("xuSL")],void 0===(o=function(e,t,r,i,o,n,a,s,l,u,p,f){function c(e){return"polygon"===e.type}function d(e){return"polygon"===e[0].type}function h(e){return"polyline"===e[0].type}function m(e){return c(e)?e.rings:e.paths}function g(e,t){return Math.ceil((e-t)/(2*t))}function y(e,t){for(var r=0,i=m(e);r<i.length;r++)for(var o=0,n=i[r];o<n.length;o++){n[o][0]+=t}return e}function v(e){for(var t=[],r=0,i=0,o=0;o<e.length;o++){for(var n=e[o],a=null,s=0;s<n.length;s++)a=n[s],t.push(a),0===s?i=r=a[0]:(r=Math.min(r,a[0]),i=Math.max(i,a[0]));a&&t.push([(r+i)/2,0])}return t}function w(e,t){if(!(e instanceof s||e instanceof a)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw T.error(r),new i(r)}for(var o=[],n=0,l=m(e);n<l.length;n++){var u=l[n],p=[];o.push(p),p.push([u[0][0],u[0][1]]);for(var f=0;f<u.length-1;f++){var d=u[f][0],h=u[f][1],g=u[f+1][0],y=u[f+1][1],v=Math.sqrt((g-d)*(g-d)+(y-h)*(y-h)),w=(y-h)/v,b=(g-d)/v,x=v/t;if(x>1){for(var C=1;C<=x-1;C++){var R=C*t,k=b*R+d,D=w*R+h;p.push([k,D])}var _=(v+Math.floor(x-1)*t)/2,S=b*_+d,B=w*_+h;p.push([S,B])}p.push([g,y])}}return c(e)?new a({rings:o,spatialReference:e.spatialReference}):new s({paths:o,spatialReference:e.spatialReference})}function b(e,t,r){if(t){var i=w(e,1e6);e=p.webMercatorToGeographic(i,!0)}return r&&(e=y(e,r)),e}function x(e,t,r){var i;if(Array.isArray(e)){if((i=e[0])>t){var o=g(i,t);e[0]=i+o*(-2*t)}else if(i<r){o=g(i,r);e[0]=i+o*(-2*r)}}else if((i=e.x)>t){o=g(i,t);e=e.clone().offset(o*(-2*t),0)}else if(i<r){o=g(i,r);e=e.clone().offset(o*(-2*r),0)}return e}function C(e,t){for(var r=-1,i=0;i<t.cutIndexes.length;i++)!function(i){for(var o=t.cutIndexes[i],n=t.geometries[i],a=m(n),s=0;s<a.length;s++)!function(e){var t=a[e];t.some(function(r){if(r[0]<180)return!0;for(var i=0,o=0;o<t.length;o++){var a=t[o][0];i=a>i?a:i}for(var s=-360*g(i=Number(i.toFixed(9)),180),l=0;l<t.length;l++){var u=n.getPoint(e,l);n.setPoint(e,l,u.clone().offset(s,0))}return!0})}(s);if(o===r){if(d(e))for(var l=0,u=m(n);l<u.length;l++){var p=u[l];e[o]=e[o].addRing(p)}else if(h(e))for(var f=0,c=m(n);f<c.length;f++){var y=c[f];e[o]=e[o].addPath(y)}}else r=o,e[o]=n}(i);return e}function R(){return k||(k=new f({url:r.geometryServiceUrl})),k}Object.defineProperty(t,"__esModule",{value:!0});var k,T=o.getLogger("esri.geometry.support.normalizeUtils"),D={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new s({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:l.WebMercator}),minus180Line:new s({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:l.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new s({paths:[[[180,-180],[180,180]]],spatialReference:l.WebMercator}),minus180Line:new s({paths:[[[-180,-180],[-180,180]]],spatialReference:l.WebMercator})}};t.straightLineDensify=w,t.normalizeCentralMeridian=function e(t,r,i){if(!Array.isArray(t))return e([t],r);r||(r=R());for(var o,l,f,c,d,h,m,v,w=0,k=[],T=[],_=0,S=t;_<S.length;_++){var B=S[_];if(B)if(o||(o=B.spatialReference,l=u.getInfo(o),f=o.isWebMercator,c=D[h=f?102100:4326].maxX,d=D[h].minX,m=D[h].plus180Line,v=D[h].minus180Line),l)if("mesh"===B.type)T.push(B);else if("point"===B.type)T.push(x(B.clone(),c,d));else if("multipoint"===B.type){var I=B.clone();I.points=I.points.map(function(e){return x(e,c,d)}),T.push(I)}else if("extent"===B.type){var A=(M=B.clone())._normalize(!1,!1,l);T.push(A.rings?new a(A):A)}else if(B.extent){var M,P=g((M=B.extent).xmin,d)*(2*c),L=0===P?B.clone():y(B.clone(),P);M.offset(P,0),M.intersects(m)&&M.xmax!==c?(w=M.xmax>w?M.xmax:w,L=b(L,f),k.push(L),T.push("cut")):M.intersects(v)&&M.xmin!==d?(w=M.xmax*(2*c)>w?M.xmax*(2*c):w,L=b(L,f,360),k.push(L),T.push("cut")):T.push(L)}else T.push(B.clone());else T.push(B);else T.push(B)}for(var O=g(w,c),j=-90,F=O,V=new s;O>0;){var N=360*O-180;V.addPath([[N,j],[N,-1*j]]),j*=-1,O--}if(k.length>0&&F>0)return r.cut(k,V,i).then(function(e){return C(k,e)}).then(function(e){for(var o=[],n=[],a=0;a<T.length;a++){var s=T[a];if("cut"!==s)n.push(s);else{var l=e.shift(),u=t[a];"polygon"===u.type&&u.rings&&u.rings.length>1&&l.rings.length>=u.rings.length?(o.push(l),n.push("simplify")):n.push(f?p.geographicToWebMercator(l):l)}}return o.length?r.simplify(o,i).then(function(e){for(var t=[],r=0;r<n.length;r++){var i=n[r];"simplify"!==i?t.push(i):t.push(f?p.geographicToWebMercator(e.shift()):e.shift())}return t}):n});for(var U=[],E=0;E<T.length;E++){var G=T[E];if("cut"!==G)U.push(G);else{var q=k.shift();U.push(!0===f?p.geographicToWebMercator(q):q)}}return n.resolve(U)},t.getDenormalizedExtent=function(e){var t;if(!e)return null;var r=e.extent;if(!r)return null;var i=e.spatialReference&&u.getInfo(e.spatialReference);if(!i)return r;var o,n=i.valid,a=n[0],s=n[1],l=2*s,p=r.width,f=r.xmin,c=r.xmax;if(f=(t=[c,f])[0],c=t[1],"extent"===e.type||0===p||p<=s||p>l||f<a||c>s)return r;switch(e.type){case"polygon":if(!(e.rings.length>1))return r;o=v(e.rings);break;case"polyline":if(!(e.paths.length>1))return r;o=v(e.paths);break;case"multipoint":o=e.points}for(var d=r.clone(),h=0;h<o.length;h++){var m=o[h][0];m<0?(m+=s,c=Math.max(m,c)):(m-=s,f=Math.min(m,f))}return d.xmin=f,d.xmax=c,d.width<p?(d.xmin-=s,d.xmax-=s,d):r},t.normalizeMapX=function(e,t){var r=u.getInfo(t);if(r){var i=r.valid,o=i[0],n=i[1],a=n-o;if(e<o)for(;e<o;)e+=a;if(e>n)for(;e>n;)e-=a}return e}}.apply(null,i))||(e.exports=o)},nakx:function(e,t,r){var i,o;i=[r("Gtr7"),r("Lzvl")],void 0===(o=function(e,t){return e.createSubclass({declaredClass:"esri.tasks.support.ImageServiceIdentifyParameters",properties:{geometry:null,mosaicRule:null,noData:null,renderingRule:null,pixelSizeX:null,pixelSizeY:null,pixelSize:null,returnGeometry:!1,returnCatalogItems:!0,timeExtent:null},toJSON:function(e){var r=e&&e.geometry||this.geometry,i={geometry:r,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,mosaicRule:this.mosaicRule?JSON.stringify(this.mosaicRule.toJSON()):null,renderingRule:this.renderingRule?JSON.stringify(this.renderingRule.toJSON()):null};r&&(i.geometryType=t.getJsonType(r));var o=this.timeExtent;return i.time=o?o.toJSON().join(","):null,null!=this.pixelSizeX&&null!=this.pixelSizeY?i.pixelSize=JSON.stringify({x:parseFloat(this.pixelSizeX),y:parseFloat(this.pixelSizeY)}):this.pixelSize&&(i.pixelSize=this.pixelSize?JSON.stringify(this.pixelSize.toJSON()):null),i}})}.apply(null,i))||(e.exports=o)},ouPT:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("9opi"),r("qKT0"),r("ycL1"),r("0+sO"),r("rg9i"),r("Vx27"),r("oxlp"),r("7Rj3"),r("97bx")],void 0===(o=function(e,t,r,i,o,n,a,s,l,u,p){var f=new n.default({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),c=new n.default({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});return function(e){function t(t){var r=e.call(this)||this;return r.ascending=!0,r.itemRenderingRule=null,r.lockRasterIds=null,r.method=null,r.multidimensionalDefinition=null,r.objectIds=null,r.operation=null,r.sortField=null,r.sortValue=null,r.viewpoint=null,r.where=null,r}var o;return r(t,e),o=t,t.prototype.writeAscending=function(e,t,r,i){e||(t[r]=!1)},t.prototype.readMethod=function(e,t){var r=t.mosaicMethod||t.defaultMosaicMethod,i=r.toLowerCase();switch(i){case"byattribute":r="attribute";break;case"lockraster":r="lock-raster";break;case"center":case"northwest":case"nadir":case"viewpoint":case"seamline":case"none":r=i}return c.fromJSON(r)},t.prototype.readOperation=function(e,t){return f.fromJSON(t.mosaicOperation||t.mosaicOperator&&t.mosaicOperator.toLowerCase())},t.prototype.clone=function(){return new o({ascending:this.ascending,itemRenderingRule:a.clone(this.itemRenderingRule),lockRasterIds:a.clone(this.lockRasterIds),method:this.method,multidimensionalDefinition:a.clone(this.multidimensionalDefinition),objectIds:a.clone(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:a.clone(this.viewpoint),where:this.where})},i([s.property({type:Boolean})],t.prototype,"ascending",void 0),i([s.writer("ascending")],t.prototype,"writeAscending",null),i([s.property({type:p,json:{write:!0}})],t.prototype,"itemRenderingRule",void 0),i([s.property({type:[Number],json:{write:!0}})],t.prototype,"lockRasterIds",void 0),i([s.property({json:{write:{target:"mosaicMethod",writer:c.write}}})],t.prototype,"method",void 0),i([s.reader("method",["mosaicMethod","defaultMosaicMethod"])],t.prototype,"readMethod",null),i([s.property({type:[u],json:{write:!0}})],t.prototype,"multidimensionalDefinition",void 0),i([s.property({json:{read:{source:"fids"},write:{target:"fids"}}})],t.prototype,"objectIds",void 0),i([s.property({json:{read:{reader:f.read},write:{target:"mosaicOperation",writer:f.write}}})],t.prototype,"operation",void 0),i([s.reader("operation",["mosaicOperation","mosaicOperator"])],t.prototype,"readOperation",null),i([s.property({type:String,json:{write:!0}})],t.prototype,"sortField",void 0),i([s.property({json:{write:!0}})],t.prototype,"sortValue",void 0),i([s.property({type:l,json:{write:!0}})],t.prototype,"viewpoint",void 0),i([s.property({type:String,json:{write:!0}})],t.prototype,"where",void 0),o=i([s.subclass("esri.layers.support.MosaicRule")],t)}(s.declared(o))}.apply(null,i))||(e.exports=o)},r5V0:function(e,t,r){var i;void 0===(i=function(){var e=function(){function e(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return e.prototype={ensureBuffer:function(e){var t=this.buffer,r=t?t.byteLength:0;if(e<r)return t;for(var i=512;i<e;)i<<=1;for(var o=new Uint8Array(i),n=0;n<r;++n)o[n]=t[n];return this.buffer=o},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(e){var t=this.pos;if(e){this.ensureBuffer(t+e);for(var r=t+e;!this.eof&&this.bufferLength<r;)this.readBlock();var i=this.bufferLength;r>i&&(r=i)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}return this.pos=r,this.buffer.subarray(t,r)},lookChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(e,t,r){for(var i=e+t;this.bufferLength<=i&&!this.eof;)this.readBlock();return new Stream(this.buffer,e,t,r)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0}},e}();return function(){function t(e){throw new Error(e)}function r(r){var i=0,o=r[i++],n=r[i++];-1!=o&&-1!=n||t("Invalid header in flate stream"),8!=(15&o)&&t("Unknown compression method in flate stream"),((o<<8)+n)%31!=0&&t("Bad FCHECK in flate stream"),32&n&&t("FDICT bit set in flate stream"),this.bytes=r,this.bytesPos=2,this.codeSize=0,this.codeBuf=0,e.call(this)}var i=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),n=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),a=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],s=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];return r.prototype=Object.create(e.prototype),r.prototype.getBits=function(e){for(var r,i=this.codeSize,o=this.codeBuf,n=this.bytes,a=this.bytesPos;i<e;)void 0===(r=n[a++])&&t("Bad encoding in flate stream"),o|=r<<i,i+=8;return r=o&(1<<e)-1,this.codeBuf=o>>e,this.codeSize=i-=e,this.bytesPos=a,r},r.prototype.getCode=function(e){for(var r=e[0],i=e[1],o=this.codeSize,n=this.codeBuf,a=this.bytes,s=this.bytesPos;o<i;){var l;void 0===(l=a[s++])&&t("Bad encoding in flate stream"),n|=l<<o,o+=8}var u=r[n&(1<<i)-1],p=u>>16,f=65535&u;return(0==o||o<p||0==p)&&t("Bad encoding in flate stream"),this.codeBuf=n>>p,this.codeSize=o-p,this.bytesPos=s,f},r.prototype.generateHuffmanTable=function(e){for(var t=e.length,r=0,i=0;i<t;++i)e[i]>r&&(r=e[i]);for(var o=1<<r,n=new Uint32Array(o),a=1,s=0,l=2;a<=r;++a,s<<=1,l<<=1)for(var u=0;u<t;++u)if(e[u]==a){var p=0,f=s;for(i=0;i<a;++i)p=p<<1|1&f,f>>=1;for(i=p;i<o;i+=l)n[i]=a<<16|u;++s}return[n,r]},r.prototype.readBlock=function(){function e(e,t,r,i,o){for(var n=e.getBits(r)+i;n-- >0;)t[h++]=o}var r=this.getBits(3);if(1&r&&(this.eof=!0),0!=(r>>=1)){var l,u;if(1==r)l=a,u=s;else if(2==r){for(var p=this.getBits(5)+257,f=this.getBits(5)+1,c=this.getBits(4)+4,d=Array(i.length),h=0;h<c;)d[i[h++]]=this.getBits(3);for(var m=this.generateHuffmanTable(d),g=0,y=(h=0,p+f),v=new Array(y);h<y;){var w=this.getCode(m);16==w?e(this,v,2,3,g):17==w?e(this,v,3,3,g=0):18==w?e(this,v,7,11,g=0):v[h++]=g=w}l=this.generateHuffmanTable(v.slice(0,p)),u=this.generateHuffmanTable(v.slice(p,y))}else t("Unknown block type in flate stream");for(var b=(M=this.buffer)?M.length:0,x=this.bufferLength;;){var C=this.getCode(l);if(C<256)x+1>=b&&(b=(M=this.ensureBuffer(x+1)).length),M[x++]=C;else{if(256==C)return void(this.bufferLength=x);var R=(C=o[C-=257])>>16;R>0&&(R=this.getBits(R));g=(65535&C)+R;C=this.getCode(u),(R=(C=n[C])>>16)>0&&(R=this.getBits(R));var k=(65535&C)+R;x+g>=b&&(b=(M=this.ensureBuffer(x+g)).length);for(var T=0;T<g;++T,++x)M[x]=M[x-k]}}}else{var D,_=this.bytes,S=this.bytesPos;void 0===(D=_[S++])&&t("Bad block header in flate stream");var B=D;void 0===(D=_[S++])&&t("Bad block header in flate stream"),B|=D<<8,void 0===(D=_[S++])&&t("Bad block header in flate stream");var I=D;void 0===(D=_[S++])&&t("Bad block header in flate stream"),(I|=D<<8)!=(65535&~B)&&t("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var A=this.bufferLength,M=this.ensureBuffer(A+B),P=A+B;this.bufferLength=P;for(var L=A;L<P;++L){if(void 0===(D=_[S++])){this.eof=!0;break}M[L]=D}this.bytesPos=S}},r}()}.apply(null,[]))||(e.exports=i)},w1v0:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r("qKT0"),r("9opi"),r("TMur"),r("jZlN"),r("ycL1"),r("0+sO"),r("Vx27"),r("Z4y+"),r("Lzvl"),r("KQcO")],void 0===(o=function(e,t,r,i,o,n,a,s,l,u,p,f){var c=new s.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"}),d=function(e){function t(t){var r=e.call(this,t)||this;return r.displayFieldName=null,r.exceededTransferLimit=!1,r.features=[],r.fields=null,r.geometryType=null,r.hasM=!1,r.hasZ=!1,r.queryGeometry=null,r.spatialReference=null,r}return i(t,e),t.prototype.readFeatures=function(e,t){for(var r=u.fromJSON(t.spatialReference),i=[],o=0;o<e.length;o++){var a=e[o],s=n.fromJSON(a),l=a.geometry&&a.geometry.spatialReference;s.geometry&&!l&&(s.geometry.spatialReference=r),i.push(s)}return i},t.prototype.writeGeometryType=function(e,t,r,i){if(e)c.write(e,t,r,i);else{var o=this.features;if(o)for(var n=0,a=o;n<a.length;n++){var s=a[n];if(s&&s.geometry)return void c.write(s.geometry.type,t,r,i)}}},t.prototype.writeSpatialReference=function(e,t,r,i){if(e)t.spatialReference=e.toJSON();else{var o=this.features;if(o)for(var n=0,a=o;n<a.length;n++){var s=a[n];s&&s.geometry&&s.geometry.spatialReference&&(t.spatialReference=s.geometry.spatialReference.toJSON())}}},t.prototype.toJSON=function(e){var t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var i=t.features[r];if(i.geometry){var o=e&&e[r];i.geometry=o&&o.toJSON()||i.geometry}}return t},t.prototype.quantize=function(e){for(var t=e.scale,r=t[0],i=t[1],o=e.translate,n=o[0],a=o[1],s=this.features,l=this._getQuantizationFunction(this.geometryType,function(e){return Math.round((e-n)/r)},function(e){return Math.round((a-e)/i)}),u=0,p=s.length;u<p;u++)l(s[u].geometry)||(s.splice(u,1),u--,p--);return this.transform=e,this},t.prototype.unquantize=function(){var e=this,t=e.geometryType,r=e.features,i=e.transform;if(!i)return this;for(var o=i.translate,n=o[0],a=o[1],s=i.scale,l=s[0],u=s[1],p=this._getHydrationFunction(t,function(e){return e*l+n},function(e){return a-e*u}),f=0,c=r;f<c.length;f++){var d=c[f].geometry;d&&p(d)}return this},t.prototype._quantizePoints=function(e,t,r){for(var i,o,n=[],a=0,s=e.length;a<s;a++){var l=e[a];if(a>0){var u=t(l[0]),p=r(l[1]);u===i&&p===o||(n.push([u-i,p-o]),i=u,o=p)}else i=t(l[0]),o=r(l[1]),n.push([i,o])}return n.length>0?n:null},t.prototype._getQuantizationFunction=function(e,t,r){var i=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var o=p.isPolygon(e)?e.rings:e.paths,n=[],a=0,s=o.length;a<s;a++){var l=o[a],u=i._quantizePoints(l,t,r);u&&n.push(u)}return n.length>0?(p.isPolygon(e)?e.rings=n:e.paths=n,e):null}:"multipoint"===e?function(e){var o;return(o=i._quantizePoints(e.points,t,r)).length>0?(e.points=o,e):null}:"extent"===e?function(e){return e}:void 0},t.prototype._getHydrationFunction=function(e,t,r){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var i,o,n=p.isPolygon(e)?e.rings:e.paths,a=0,s=n.length;a<s;a++)for(var l=n[a],u=0,f=l.length;u<f;u++){var c=l[u];u>0?(i+=c[0],o+=c[1]):(i=c[0],o=c[1]),c[0]=t(i),c[1]=r(o)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?function(e){for(var i,o,n=e.points,a=0,s=n.length;a<s;a++){var l=n[a];a>0?(i+=l[0],o+=l[1]):(i=l[0],o=l[1]),l[0]=t(i),l[1]=r(o)}}:void 0},r([l.property({type:String,json:{write:!0}})],t.prototype,"displayFieldName",void 0),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"exceededTransferLimit",void 0),r([l.property({type:[n],json:{write:!0}})],t.prototype,"features",void 0),r([l.reader("features")],t.prototype,"readFeatures",null),r([l.property({type:[f],json:{write:!0}})],t.prototype,"fields",void 0),r([l.property({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:c.read}}})],t.prototype,"geometryType",void 0),r([l.writer("geometryType")],t.prototype,"writeGeometryType",null),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasM",void 0),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasZ",void 0),r([l.property({types:o.geometryTypes,json:{read:p.fromJSON,write:!0}})],t.prototype,"queryGeometry",void 0),r([l.property({type:u,json:{write:!0}})],t.prototype,"spatialReference",void 0),r([l.writer("spatialReference")],t.prototype,"writeSpatialReference",null),r([l.property({json:{write:!0}})],t.prototype,"transform",void 0),r([l.subclass("esri.tasks.support.FeatureSet")],t)}(l.declared(a));return d.prototype.toJSON.isDefaultToJSON=!0,d||(d={}),d}.apply(null,i))||(e.exports=o)},xIS7:function(e,t,r){var i;void 0===(i=function(){"use strict";return function(){function e(){}function t(e,t){for(var r,i,o=0,n=[],a=16;a>0&&!e[a-1];)a--;n.push({children:[],index:0});var s,l=n[0];for(r=0;r<a;r++){for(i=0;i<e[r];i++){for((l=n.pop()).children[l.index]=t[o];l.index>0;)l=n.pop();for(l.index++,n.push(l);n.length<=r;)n.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;o++}r+1<a&&(n.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return n[0].children}function r(e,t,r){return 64*((e.blocksPerLine+1)*t+r)}function i(e,t,i,o,n,a,l,u,p){function f(){if(D>0)return T>>--D&1;if(255===(T=e[t++])){var r=e[t++];if(r)throw"unexpected marker: "+(T<<8|r).toString(16)}return D=7,T>>>7}function c(e){for(var t=e;;){if("number"==typeof(t=t[f()]))return t;if("object"!=typeof t)throw"invalid huffman sequence"}}function d(e){for(var t=0;e>0;)t=t<<1|f(),e--;return t}function h(e){if(1===e)return 1===f()?1:-1;var t=d(e);return t>=1<<e-1?t:t+(-1<<e)+1}var m,g,y,v,w,b,x,C=(i.precision,i.samplesPerLine,i.scanLines,i.mcusPerLine),R=i.progressive,k=(i.maxH,i.maxV,t),T=0,D=0,_=0,S=0,B=o.length;x=R?0===a?0===u?function(e,t){var r=c(e.huffmanTableDC),i=0===r?0:h(r)<<p;e.blockData[t]=e.pred+=i}:function(e,t){e.blockData[t]|=f()<<p}:0===u?function(e,t){if(_>0)_--;else for(var r=a,i=l;r<=i;){var o=c(e.huffmanTableAC),n=15&o,u=o>>4;if(0!==n){var f=s[r+=u];e.blockData[t+f]=h(n)*(1<<p),r++}else{if(u<15){_=d(u)+(1<<u)-1;break}r+=16}}}:function(e,t){for(var r,i,o=a,n=l,u=0;o<=n;){var g=s[o];switch(S){case 0:if(u=(i=c(e.huffmanTableAC))>>4,0==(r=15&i))u<15?(_=d(u)+(1<<u),S=4):(u=16,S=1);else{if(1!==r)throw"invalid ACn encoding";m=h(r),S=u?2:3}continue;case 1:case 2:e.blockData[t+g]?e.blockData[t+g]+=f()<<p:0==--u&&(S=2===S?3:0);break;case 3:e.blockData[t+g]?e.blockData[t+g]+=f()<<p:(e.blockData[t+g]=m<<p,S=0);break;case 4:e.blockData[t+g]&&(e.blockData[t+g]+=f()<<p)}o++}4===S&&0==--_&&(S=0)}:function(e,t){var r=c(e.huffmanTableDC),i=0===r?0:h(r);e.blockData[t]=e.pred+=i;for(var o=1;o<64;){var n=c(e.huffmanTableAC),a=15&n,l=n>>4;if(0!==a){var u=s[o+=l];e.blockData[t+u]=h(a),o++}else{if(l<15)break;o+=16}}};var I,A,M,P,L=0;for(A=1===B?o[0].blocksPerLine*o[0].blocksPerColumn:C*i.mcusPerColumn,n||(n=A);L<A;){for(y=0;y<B;y++)o[y].pred=0;if(_=0,1===B)for(g=o[0],b=0;b<n;b++)!function(e,t,i){x(e,r(e,i/e.blocksPerLine|0,i%e.blocksPerLine))}(g,0,L),L++;else for(b=0;b<n;b++){for(y=0;y<B;y++)for(M=(g=o[y]).h,P=g.v,v=0;v<P;v++)for(w=0;w<M;w++)!function(e,t,i,o,n){var a=L%C;x(e,r(e,(L/C|0)*e.v+o,a*e.h+n))}(g,0,0,v,w);L++}if(D=0,(I=e[t]<<8|e[t+1])<=65280)throw"marker was not found";if(!(I>=65488&&I<=65495))break;t+=2}return t-k}function o(e,t,r){for(var i,o,n,a,s,g,y,v,w,b,x,C,R,k,T,D,_,S=e.quantizationTable,B=e.blockData,I=0;I<64;I+=8)w=B[t+I],b=B[t+I+1],x=B[t+I+2],C=B[t+I+3],R=B[t+I+4],k=B[t+I+5],T=B[t+I+6],D=B[t+I+7],w*=S[I],0!=(b|x|C|R|k|T|D)?(b*=S[I+1],x*=S[I+2],C*=S[I+3],R*=S[I+4],k*=S[I+5],T*=S[I+6],D*=S[I+7],o=(i=(i=h*w+128>>8)+(o=h*R+128>>8)+1>>1)-o,_=(n=x)*d+(a=T)*c+128>>8,n=n*c-a*d+128>>8,y=(s=(s=m*(b-D)+128>>8)+(y=k<<4)+1>>1)-y,g=(v=(v=m*(b+D)+128>>8)+(g=C<<4)+1>>1)-g,a=(i=i+(a=_)+1>>1)-a,n=(o=o+n+1>>1)-n,_=s*f+v*p+2048>>12,s=s*p-v*f+2048>>12,v=_,_=g*u+y*l+2048>>12,g=g*l-y*u+2048>>12,y=_,r[I]=i+v,r[I+7]=i-v,r[I+1]=o+y,r[I+6]=o-y,r[I+2]=n+g,r[I+5]=n-g,r[I+3]=a+s,r[I+4]=a-s):(_=h*w+512>>10,r[I]=_,r[I+1]=_,r[I+2]=_,r[I+3]=_,r[I+4]=_,r[I+5]=_,r[I+6]=_,r[I+7]=_);for(var A=0;A<8;++A)w=r[A],0!=((b=r[A+8])|(x=r[A+16])|(C=r[A+24])|(R=r[A+32])|(k=r[A+40])|(T=r[A+48])|(D=r[A+56]))?(o=(i=4112+((i=h*w+2048>>12)+(o=h*R+2048>>12)+1>>1))-o,_=(n=x)*d+(a=T)*c+2048>>12,n=n*c-a*d+2048>>12,a=_,y=(s=(s=m*(b-D)+2048>>12)+(y=k)+1>>1)-y,g=(v=(v=m*(b+D)+2048>>12)+(g=C)+1>>1)-g,_=s*f+v*p+2048>>12,s=s*p-v*f+2048>>12,v=_,_=g*u+y*l+2048>>12,g=g*l-y*u+2048>>12,w=(w=(i=i+a+1>>1)+v)<16?0:w>=4080?255:w>>4,b=(b=(o=o+n+1>>1)+(y=_))<16?0:b>=4080?255:b>>4,x=(x=(n=o-n)+g)<16?0:x>=4080?255:x>>4,C=(C=(a=i-a)+s)<16?0:C>=4080?255:C>>4,R=(R=a-s)<16?0:R>=4080?255:R>>4,k=(k=n-g)<16?0:k>=4080?255:k>>4,T=(T=o-y)<16?0:T>=4080?255:T>>4,D=(D=i-v)<16?0:D>=4080?255:D>>4,B[t+A]=w,B[t+A+8]=b,B[t+A+16]=x,B[t+A+24]=C,B[t+A+32]=R,B[t+A+40]=k,B[t+A+48]=T,B[t+A+56]=D):(_=(_=h*w+8192>>14)<-2040?0:_>=2024?255:_+2056>>4,B[t+A]=_,B[t+A+8]=_,B[t+A+16]=_,B[t+A+24]=_,B[t+A+32]=_,B[t+A+40]=_,B[t+A+48]=_,B[t+A+56]=_)}function n(e,t){for(var i=t.blocksPerLine,n=t.blocksPerColumn,a=new Int16Array(64),s=0;s<n;s++)for(var l=0;l<i;l++){o(t,r(t,s,l),a)}return t.blockData}function a(e){return e<=0?0:e>=255?255:e}var s=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),l=4017,u=799,p=3406,f=2276,c=1567,d=3784,h=5793,m=2896;return e.prototype={parse:function(e){function r(){var t=e[l]<<8|e[l+1];return l+=2,t}var o,a,l=0,u=(e.length,null),p=null,f=[],c=[],d=[],h=r();if(65496!==h)throw"SOI not found";for(h=r();65497!==h;){var m,g,y;switch(h){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=function(){var t=r(),i=e.subarray(l,l+t-2);return l+=i.length,i}();65504===h&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(u={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65518===h&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&(p={version:v[5]<<8|v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:for(var w=r()+l-2;l<w;){var b=e[l++],x=new Uint16Array(64);if(b>>4==0)for(g=0;g<64;g++)x[s[g]]=e[l++];else{if(b>>4!=1)throw"DQT: invalid table spec";for(g=0;g<64;g++)x[s[g]]=r()}f[15&b]=x}break;case 65472:case 65473:case 65474:if(o)throw"Only single frame JPEGs supported";r(),(o={}).extended=65473===h,o.progressive=65474===h,o.precision=e[l++],o.scanLines=r(),o.samplesPerLine=r(),o.components=[],o.componentIds={};var C,R=e[l++],k=0,T=0;for(m=0;m<R;m++){C=e[l];var D=e[l+1]>>4,_=15&e[l+1];k<D&&(k=D),T<_&&(T=_);var S=e[l+2];y=o.components.push({h:D,v:_,quantizationTable:f[S]}),o.componentIds[C]=y-1,l+=3}o.maxH=k,o.maxV=T,function(e){for(var t=Math.ceil(e.samplesPerLine/8/e.maxH),r=Math.ceil(e.scanLines/8/e.maxV),i=0;i<e.components.length;i++){L=e.components[i];var o=Math.ceil(Math.ceil(e.samplesPerLine/8)*L.h/e.maxH),n=Math.ceil(Math.ceil(e.scanLines/8)*L.v/e.maxV),a=t*L.h,s=64*(r*L.v)*(a+1);L.blockData=new Int16Array(s),L.blocksPerLine=o,L.blocksPerColumn=n}e.mcusPerLine=t,e.mcusPerColumn=r}(o);break;case 65476:var B=r();for(m=2;m<B;){var I=e[l++],A=new Uint8Array(16),M=0;for(g=0;g<16;g++,l++)M+=A[g]=e[l];var P=new Uint8Array(M);for(g=0;g<M;g++,l++)P[g]=e[l];m+=17+M,(I>>4==0?d:c)[15&I]=t(A,P)}break;case 65501:r(),a=r();break;case 65498:var L,O=(r(),e[l++]),j=[];for(m=0;m<O;m++){var F=o.componentIds[e[l++]];L=o.components[F];var V=e[l++];L.huffmanTableDC=d[V>>4],L.huffmanTableAC=c[15&V],j.push(L)}var N=e[l++],U=e[l++],E=e[l++],G=i(e,l,o,j,a,N,U,E>>4,15&E);l+=G;break;case 65535:255!==e[l]&&l--;break;default:if(255===e[l-3]&&e[l-2]>=192&&e[l-2]<=254){l-=3;break}throw"unknown JPEG marker "+h.toString(16)}h=r()}for(this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=u,this.eof=l,this.adobe=p,this.components=[],m=0;m<o.components.length;m++)L=o.components[m],this.components.push({output:n(0,L),scaleX:L.h/o.maxH,scaleY:L.v/o.maxV,blocksPerLine:L.blocksPerLine,blocksPerColumn:L.blocksPerColumn});this.numComponents=this.components.length},_getLinearizedBlockData:function(e,t){var r,i,o,n,a,s,l,u,p,f,c,d=this.width/e,h=this.height/t,m=0,g=this.components.length,y=e*t*g,v=new Uint8Array(y),w=new Uint32Array(e);for(l=0;l<g;l++){for(i=(r=this.components[l]).scaleX*d,o=r.scaleY*h,m=l,c=r.output,n=r.blocksPerLine+1<<3,a=0;a<e;a++)u=0|a*i,w[a]=(4294967288&u)<<3|7&u;for(s=0;s<t;s++)for(f=n*(4294967288&(u=0|s*o))|(7&u)<<3,a=0;a<e;a++)v[m]=c[f+w[a]],m+=g}var b=this.decodeTransform;if(b)for(l=0;l<y;)for(u=0,p=0;u<g;u++,l++,p+=2)v[l]=(v[l]*b[p]>>8)+b[p+1];return v},_isColorConversionNeeded:function(){return!(!this.adobe||!this.adobe.transformCode)||3===this.numComponents},_convertYccToRgb:function(e){for(var t,r,i,o=0,n=e.length;o<n;o+=3)t=e[o],r=e[o+1],i=e[o+2],e[o]=a(t-179.456+1.402*i),e[o+1]=a(t+135.459-.344*r-.714*i),e[o+2]=a(t-226.816+1.772*r);return e},_convertYcckToRgb:function(e){for(var t,r,i,o,n=0,s=0,l=e.length;s<l;s+=4){t=e[s];var u=(r=e[s+1])*(-660635669420364e-19*r+.000437130475926232*(i=e[s+2])-54080610064599e-18*t+.00048449797120281*(o=e[s+3])-.154362151871126)-122.67195406894+i*(-.000957964378445773*i+.000817076911346625*t-.00477271405408747*o+1.53380253221734)+t*(.000961250184130688*t-.00266257332283933*o+.48357088451265)+o*(-.000336197177618394*o+.484791561490776),p=107.268039397724+r*(219927104525741e-19*r-.000640992018297945*i+.000659397001245577*t+.000426105652938837*o-.176491792462875)+i*(-.000778269941513683*i+.00130872261408275*t+.000770482631801132*o-.151051492775562)+t*(.00126935368114843*t-.00265090189010898*o+.25802910206845)+o*(-.000318913117588328*o-.213742400323665),f=r*(-.000570115196973677*r-263409051004589e-19*i+.0020741088115012*t-.00288260236853442*o+.814272968359295)-20.810012546947+i*(-153496057440975e-19*i-.000132689043961446*t+.000560833691242812*o-.195152027534049)+t*(.00174418132927582*t-.00255243321439347*o+.116935020465145)+o*(-.000343531996510555*o+.24165260232407);e[n++]=a(u),e[n++]=a(p),e[n++]=a(f)}return e},_convertYcckToCmyk:function(e){for(var t,r,i,o=0,n=e.length;o<n;o+=4)t=e[o],r=e[o+1],i=e[o+2],e[o]=a(434.456-t-1.402*i),e[o+1]=a(119.541-t+.344*r+.714*i),e[o+2]=a(481.816-t-1.772*r);return e},_convertCmykToRgb:function(e){for(var t,r,i,o,n=0,a=-16581375,s=0,l=e.length;s<l;s+=4){var u=(t=e[s])*(-4.387332384609988*t+54.48615194189176*(r=e[s+1])+18.82290502165302*(i=e[s+2])+212.25662451639585*(o=e[s+3])-72734.4411664936)+r*(1.7149763477362134*r-5.6096736904047315*i-17.873870861415444*o-1401.7366389350734)+i*(-2.5217340131683033*i-21.248923337353073*o+4465.541406466231)-o*(21.86122147463605*o+48317.86113160301),p=t*(8.841041422036149*t+60.118027045597366*r+6.871425592049007*i+31.159100130055922*o-20220.756542821975)+r*(-15.310361306967817*r+17.575251261109482*i+131.35250912493976*o-48691.05921601825)+i*(4.444339102852739*i+9.8632861493405*o-6341.191035517494)-o*(20.737325471181034*o+47890.15695978492),f=t*(.8842522430003296*t+8.078677503112928*r+30.89978309703729*i-.23883238689178934*o-3616.812083916688)+r*(10.49593273432072*r+63.02378494754052*i+50.606957656360734*o-28620.90484698408)+i*(.03296041114873217*i+115.60384449646641*o-49363.43385999684)-o*(22.33816807309886*o+45932.16563550634);e[n++]=u>=0?255:u<=a?0:255+u*(1/255/255)|0,e[n++]=p>=0?255:p<=a?0:255+p*(1/255/255)|0,e[n++]=f>=0?255:f<=a?0:255+f*(1/255/255)|0}return e},getData:function(e,t,r){if(this.numComponents>4)throw"Unsupported color mode";var i=this._getLinearizedBlockData(e,t);if(3===this.numComponents)return this._convertYccToRgb(i);if(4===this.numComponents){if(this._isColorConversionNeeded())return r?this._convertYcckToRgb(i):this._convertYcckToCmyk(i);if(r)return this._convertCmykToRgb(i)}return i}},e}()}.apply(null,[]))||(e.exports=i)}}]);