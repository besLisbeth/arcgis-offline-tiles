(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/support/kmlUtils":"N3Jt","esri/layers/support/KMLSublayer":"bIi9","esri/layers/KMLLayer":"hPxN","esri/tasks/support/FeatureSet":"w1v0"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[27,91],{N3Jt:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t("0J3i"),t("ifLZ"),t("zp6E"),t("rg9i"),t("hz/Y"),t("w1v0")],void 0===(n=function(e,r,t,o,n,i,l,a){function s(e,r,t){t.forEach(function(t){e.set(t.attributes[r],t)})}function u(e,r){var t;return r.some(function(r){return r.id===e&&(t=r,!0)}),t}function p(e,r,t){var o=u(e,t);return o&&(o.parentFolderId=r,o.networkLink=o),o}Object.defineProperty(r,"__esModule",{value:!0});var y={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};r.parseKML=function(e){var r=e.folders.slice(),t=new Map,o=new Map,n=new Map,l=new Map,a=new Map,u={esriGeometryPoint:o,esriGeometryPolyline:n,esriGeometryPolygon:l};return e.featureCollection.layers.forEach(function(e){var r=i.clone(e);r.featureSet.features=[];var a=e.featureSet.geometryType;t.set(a,r);var u=e.layerDefinition.objectIdField;"esriGeometryPoint"===a?s(o,u,e.featureSet.features):"esriGeometryPolyline"===a?s(n,u,e.featureSet.features):"esriGeometryPolygon"===a&&s(l,u,e.featureSet.features)}),e.groundOverlays&&e.groundOverlays.forEach(function(e){a.set(e.id,e)}),e.folders.forEach(function(t){t.networkLinkIds.forEach(function(o){var n=p(o,t.id,e.networkLinks);n&&r.push(n)})}),r.forEach(function(e){e.featureInfos&&(e.points=i.clone(t.get("esriGeometryPoint")),e.polylines=i.clone(t.get("esriGeometryPolyline")),e.polygons=i.clone(t.get("esriGeometryPolygon")),e.mapImages=[],e.featureInfos.map(function(r){switch(r.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":var t=u[r.type].get(r.id);t&&e[y[r.type]].featureSet.features.push(t);break;case"GroundOverlay":var o=a.get(r.id);o&&e.mapImages.push(o)}}))}),{folders:e.folders,sublayers:r}},r.fetchService=function(e,r,o){var i=t.kmlServiceUrl;return n(i,{query:{url:e,model:"simple",folders:"",refresh:0!==o||void 0,outSR:JSON.stringify(r)},responseType:"json"})},r.sublayersFromJSON=function(e,r,t,o){void 0===t&&(t=null),void 0===o&&(o=[]);var n=[],i={},l=r.sublayers,a=r.folders.map(function(e){return e.id});return l.forEach(function(r){var l=new e;if(t?l.read(r,t):l.read(r),o.length&&a.indexOf(l.id)>-1&&(l.visible=-1!==o.indexOf(l.id)),i[r.id]=l,null!=r.parentFolderId&&-1!==r.parentFolderId){var s=i[r.parentFolderId];s.sublayers||(s.sublayers=[]),s.sublayers.unshift(l)}else n.unshift(l)}),n},r.getGraphics=function(e){var r=a.fromJSON(e.featureSet).features,t=e.layerDefinition,n=l.fromJSON(t.drawingInfo.renderer),i=o.fromJSON(e.popupInfo);return r.map(function(e){var r=n.getSymbol(e);return e.symbol=r,e.popupTemplate=i,e})}}.apply(null,o))||(e.exports=n)},bIi9:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t("9opi"),t("qKT0"),t("dxjN"),t("y4WC"),t("ycL1"),t("R7Ts"),t("8MXS"),t("Vx27"),t("1dvD"),t("N3Jt")],void 0===(n=function(e,r,t,o,n,i,l,a,s,u,p,y){return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r._sublayersHandles=null,r.description=null,r.id=null,r.networkLink=null,r.title=null,r}var n;return t(r,e),n=r,r.prototype.initialize=function(){var e=this;s.whenOnce(this,"networkLink").then(function(r){return s.whenTrueOnce(e,"visible")}).then(function(){return e.load()})},r.prototype.load=function(){var e=this;if(!this.networkLink)return this.when();var r=this._fetchService(this._get("networkLink").href).then(function(r){var t=p.default(i.ofType(n),y.sublayersFromJSON(n,r));e.sublayers?e.sublayers.addMany(t):e.sublayers=t,e.layer&&e.layer.notifyChange("visibleSublayers")});return this.addResolvingPromise(r),this.when()},Object.defineProperty(r.prototype,"layer",{set:function(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach(function(r){return r.layer=e})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sublayers",{set:function(e){var r=this,t=this._get("sublayers");t&&(t.forEach(function(e){e.parent=null,e.layer=null}),this._sublayersHandles.forEach(function(e){return e.remove()}),this._sublayersHandles=null),e&&(e.forEach(function(e){e.parent=r,e.layer=r.layer}),this._sublayersHandles=[e.on("after-add",function(e){var t=e.item;t.parent=r,t.layer=r.layer}),e.on("after-remove",function(e){var r=e.item;r.parent=null,r.layer=null})]),this._set("sublayers",e)},enumerable:!0,configurable:!0}),r.prototype.castSublayers=function(e){return p.default(i.ofType(n),e)},Object.defineProperty(r.prototype,"visible",{get:function(){return this._get("visible")},set:function(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))},enumerable:!0,configurable:!0}),r.prototype.readVisible=function(e,r){return!!r.visibility},r.prototype._fetchService=function(e){return y.fetchService(e,this.layer.outSpatialReference,this.layer.refreshInterval).then(function(e){return y.parseKML(e.data)})},o([u.property()],r.prototype,"description",void 0),o([u.property()],r.prototype,"id",void 0),o([u.property({value:null})],r.prototype,"layer",null),o([u.property({readOnly:!0,value:null})],r.prototype,"networkLink",void 0),o([u.property({json:{write:{allowNull:!0}}})],r.prototype,"parent",void 0),o([u.property({value:null,json:{write:{allowNull:!0}}})],r.prototype,"sublayers",null),o([u.cast("sublayers")],r.prototype,"castSublayers",null),o([u.property({value:null,json:{read:{source:"name"}}})],r.prototype,"title",void 0),o([u.property({value:!0})],r.prototype,"visible",null),o([u.reader("visible",["visibility"])],r.prototype,"readVisible",null),n=o([u.subclass("esri.layers.support.KMLSublayer")],r)}(u.declared(l,a))}.apply(null,o))||(e.exports=n)},hPxN:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t("2Atf"),t("9opi"),t("qKT0"),t("y4WC"),t("6Ej+"),t("ma1f"),t("qMld"),t("Vx27"),t("Z4y+"),t("0RER"),t("FEX1"),t("QJ8R"),t("WaJo"),t("OXmT"),t("bIi9"),t("N3Jt")],void 0===(n=function(e,r,o,n,i,l,a,s,u,p,y,f,c,d,h,v,b,m){return function(e){function r(r,t){var o=e.call(this)||this;return o._visibleFolders=[],o.allSublayers=new a({root:o,rootCollectionNames:["sublayers"],getChildrenFunction:function(e){return e.sublayers}}),o.outSpatialReference=y.WGS84,o.path=null,o.operationalLayerType="KML",o.sublayers=null,o.type="kml",o.url=null,o.watch("sublayers",function(e,r){r&&r.forEach(function(e){e.parent=null,e.layer=null}),e&&e.forEach(function(e){e.parent=o,e.layer=o})},!0),o}return n(r,e),r.prototype.normalizeCtorArgs=function(e,r){return"string"==typeof e?o({url:e},r):e},r.prototype.readSublayersFromItemOrWebMap=function(e,r,t){this._visibleFolders=r.visibleFolders},r.prototype.readSublayers=function(e,r,t){return m.sublayersFromJSON(b,r,t,this._visibleFolders)},r.prototype.writeSublayers=function(e,r,t,o){for(var n=[],i=e.toArray();i.length;){var l=i[0];l.networkLink||(l.visible&&n.push(l.id),l.sublayers&&i.push.apply(i,l.sublayers.toArray())),i.shift()}r.visibleFolders=n},Object.defineProperty(r.prototype,"title",{get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var e=this.url.substring(this.url.lastIndexOf("/")+1,this.parsedUrl.path.lastIndexOf("."));return 0===e.length&&(e="KML"),e}return this._get("title")||""},set:function(e){this._set("title",e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visibleSublayers",{get:function(){var e=this.sublayers,r=[],t=function(e){e.visible&&(r.push(e),e.sublayers&&e.sublayers.forEach(t))};return e&&e.forEach(t),r},enumerable:!0,configurable:!0}),r.prototype.load=function(){var e=this;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"]}).then(function(){return e._fetchService()})),this.when()},r.prototype.importLayerViewModule=function(e){switch(e.type){case"2d":return u.create(function(e){return Promise.all([t.e(3),t.e(8),t.e(10),t.e(12),t.e(51)]).then(function(){var r=[t("1Afs")];e.apply(null,r)}.bind(this)).catch(t.oe)});case"3d":return u.reject(new s("kml-layer:view-not-supported","KMLLayer is only supported in 2D"))}},r.prototype._fetchService=function(){var e=this;return u.resolve().then(function(){return e.resourceInfo?{ssl:!1,data:e.resourceInfo}:m.fetchService(e.url,e.outSpatialReference,e.refreshInterval)}).then(function(r){var t=m.parseKML(r.data);t&&e.read(t,{origin:"service"})})},i([p.property({readOnly:!0})],r.prototype,"allSublayers",void 0),i([p.property({type:y})],r.prototype,"outSpatialReference",void 0),i([p.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],r.prototype,"path",void 0),i([p.property({type:["show","hide"]})],r.prototype,"listMode",void 0),i([p.property({type:["KML"]})],r.prototype,"operationalLayerType",void 0),i([p.property({type:l.ofType(b),json:{write:{ignoreOrigin:!0}}})],r.prototype,"sublayers",void 0),i([p.reader(["web-map","portal-item"],"sublayers",["visibleFolders"])],r.prototype,"readSublayersFromItemOrWebMap",null),i([p.reader("service","sublayers",["sublayers"])],r.prototype,"readSublayers",null),i([p.writer("sublayers")],r.prototype,"writeSublayers",null),i([p.property({readOnly:!0,json:{read:!1}})],r.prototype,"type",void 0),i([p.property({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}},dependsOn:["url","parsedUrl"]})],r.prototype,"title",null),i([p.property()],r.prototype,"url",void 0),i([p.property({readOnly:!0,dependsOn:["sublayers"]})],r.prototype,"visibleSublayers",null),i([p.subclass("esri.layers.KMLLayer")],r)}(p.declared(f,c,d,h,v))}.apply(null,o))||(e.exports=n)},w1v0:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t("qKT0"),t("9opi"),t("TMur"),t("jZlN"),t("ycL1"),t("0+sO"),t("Vx27"),t("Z4y+"),t("Lzvl"),t("KQcO")],void 0===(n=function(e,r,t,o,n,i,l,a,s,u,p,y){var f=new a.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"}),c=function(e){function r(r){var t=e.call(this,r)||this;return t.displayFieldName=null,t.exceededTransferLimit=!1,t.features=[],t.fields=null,t.geometryType=null,t.hasM=!1,t.hasZ=!1,t.queryGeometry=null,t.spatialReference=null,t}return o(r,e),r.prototype.readFeatures=function(e,r){for(var t=u.fromJSON(r.spatialReference),o=[],n=0;n<e.length;n++){var l=e[n],a=i.fromJSON(l),s=l.geometry&&l.geometry.spatialReference;a.geometry&&!s&&(a.geometry.spatialReference=t),o.push(a)}return o},r.prototype.writeGeometryType=function(e,r,t,o){if(e)f.write(e,r,t,o);else{var n=this.features;if(n)for(var i=0,l=n;i<l.length;i++){var a=l[i];if(a&&a.geometry)return void f.write(a.geometry.type,r,t,o)}}},r.prototype.writeSpatialReference=function(e,r,t,o){if(e)r.spatialReference=e.toJSON();else{var n=this.features;if(n)for(var i=0,l=n;i<l.length;i++){var a=l[i];a&&a.geometry&&a.geometry.spatialReference&&(r.spatialReference=a.geometry.spatialReference.toJSON())}}},r.prototype.toJSON=function(e){var r=this.write(null);if(r.features&&Array.isArray(e)&&e.length>0)for(var t=0;t<r.features.length;t++){var o=r.features[t];if(o.geometry){var n=e&&e[t];o.geometry=n&&n.toJSON()||o.geometry}}return r},r.prototype.quantize=function(e){for(var r=e.scale,t=r[0],o=r[1],n=e.translate,i=n[0],l=n[1],a=this.features,s=this._getQuantizationFunction(this.geometryType,function(e){return Math.round((e-i)/t)},function(e){return Math.round((l-e)/o)}),u=0,p=a.length;u<p;u++)s(a[u].geometry)||(a.splice(u,1),u--,p--);return this.transform=e,this},r.prototype.unquantize=function(){var e=this,r=e.geometryType,t=e.features,o=e.transform;if(!o)return this;for(var n=o.translate,i=n[0],l=n[1],a=o.scale,s=a[0],u=a[1],p=this._getHydrationFunction(r,function(e){return e*s+i},function(e){return l-e*u}),y=0,f=t;y<f.length;y++){var c=f[y].geometry;c&&p(c)}return this},r.prototype._quantizePoints=function(e,r,t){for(var o,n,i=[],l=0,a=e.length;l<a;l++){var s=e[l];if(l>0){var u=r(s[0]),p=t(s[1]);u===o&&p===n||(i.push([u-o,p-n]),o=u,n=p)}else o=r(s[0]),n=t(s[1]),i.push([o,n])}return i.length>0?i:null},r.prototype._getQuantizationFunction=function(e,r,t){var o=this;return"point"===e?function(e){return e.x=r(e.x),e.y=t(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var n=p.isPolygon(e)?e.rings:e.paths,i=[],l=0,a=n.length;l<a;l++){var s=n[l],u=o._quantizePoints(s,r,t);u&&i.push(u)}return i.length>0?(p.isPolygon(e)?e.rings=i:e.paths=i,e):null}:"multipoint"===e?function(e){var n;return(n=o._quantizePoints(e.points,r,t)).length>0?(e.points=n,e):null}:"extent"===e?function(e){return e}:void 0},r.prototype._getHydrationFunction=function(e,r,t){return"point"===e?function(e){e.x=r(e.x),e.y=t(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var o,n,i=p.isPolygon(e)?e.rings:e.paths,l=0,a=i.length;l<a;l++)for(var s=i[l],u=0,y=s.length;u<y;u++){var f=s[u];u>0?(o+=f[0],n+=f[1]):(o=f[0],n=f[1]),f[0]=r(o),f[1]=t(n)}}:"extent"===e?function(e){e.xmin=r(e.xmin),e.ymin=t(e.ymin),e.xmax=r(e.xmax),e.ymax=t(e.ymax)}:"multipoint"===e?function(e){for(var o,n,i=e.points,l=0,a=i.length;l<a;l++){var s=i[l];l>0?(o+=s[0],n+=s[1]):(o=s[0],n=s[1]),s[0]=r(o),s[1]=t(n)}}:void 0},t([s.property({type:String,json:{write:!0}})],r.prototype,"displayFieldName",void 0),t([s.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],r.prototype,"exceededTransferLimit",void 0),t([s.property({type:[i],json:{write:!0}})],r.prototype,"features",void 0),t([s.reader("features")],r.prototype,"readFeatures",null),t([s.property({type:[y],json:{write:!0}})],r.prototype,"fields",void 0),t([s.property({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:f.read}}})],r.prototype,"geometryType",void 0),t([s.writer("geometryType")],r.prototype,"writeGeometryType",null),t([s.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],r.prototype,"hasM",void 0),t([s.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],r.prototype,"hasZ",void 0),t([s.property({types:n.geometryTypes,json:{read:p.fromJSON,write:!0}})],r.prototype,"queryGeometry",void 0),t([s.property({type:u,json:{write:!0}})],r.prototype,"spatialReference",void 0),t([s.writer("spatialReference")],r.prototype,"writeSpatialReference",null),t([s.property({json:{write:!0}})],r.prototype,"transform",void 0),t([s.subclass("esri.tasks.support.FeatureSet")],r)}(s.declared(l));return c.prototype.toJSON.isDefaultToJSON=!0,c||(c={}),c}.apply(null,o))||(e.exports=n)}}]);