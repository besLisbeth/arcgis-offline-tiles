(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/support/ElevationSampler":"+TTo","esri/layers/support/ElevationTile":"C7Q9","esri/layers/support/ElevationQuery":"T16p"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"+TTo":function(e,t,n){var i,o;i=[n.dj.c(e.i),t,n("TMur"),n("pcDC"),n("qsST"),n("8uEs"),n("lRq4"),n("k1EI"),n("vtMp")],void 0===(o=function(e,t,n,i,o,r,a,l,s){function u(e,t){var n=c(e,t.spatialReference);if(!n)return null;switch(e.type){case"point":p(e,n,t);break;case"polyline":f(e,n,t);break;case"multipoint":h(e,n,t);break;default:i.neverReached(e)}return e}function c(e,t){var n=e.spatialReference;return n.equals(t)?e:s.canProject(n,t)?s.project(e,t):(v.error("Cannot project geometry spatial reference (wkid:"+n.wkid+") to elevation sampler spatial reference (wkid:"+t.wkid+")"),null)}function p(e,t,n){e.z=n.elevationAt(t)||0}function f(e,t,n){y.spatialReference=t.spatialReference;for(var i=e.hasM&&!e.hasZ,o=0;o<e.paths.length;o++)for(var r=e.paths[o],a=t.paths[o],l=0;l<r.length;l++){var s=r[l],u=a[l];y.x=u[0],y.y=u[1];var c=n.elevationAt(y)||0;i&&(s[3]=s[2]),s[2]=c}e.hasZ=!0}function h(e,t,n){y.spatialReference=t.spatialReference;for(var i=e.hasM&&!e.hasZ,o=0;o<e.points.length;o++){var r=e.points[o],a=t.points[o];y.x=a[0],y.y=a[1];var l=n.elevationAt(y)||0;i&&(r[3]=r[2]),r[2]=l}e.hasZ=!0}Object.defineProperty(t,"__esModule",{value:!0});var v=o.getLogger("esri.layers.support.ElevationSampler"),d=function(){function e(e,t,n){this.tile=e,this.noDataValue=n,this.extent=a.toExtent(e.tile.extent,t.spatialReference);var i=r.getMetersPerUnitForSR(t.spatialReference),o=t.lodAt(e.tile.level).resolution*i;this.demResolution={min:o,max:o}}return Object.defineProperty(e.prototype,"spatialReference",{get:function(){return this.extent.spatialReference},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){var t=c(e,this.spatialReference);return l.extentContainsPoint(this.extent,t)},e.prototype.elevationAt=function(e){var t=c(e,this.spatialReference);if(!t)return null;if(!this.contains(e)){var n=this.extent,i=n.xmin+", "+n.ymin+", "+n.xmax+", "+n.ymax;v.warn("#elevationAt()","Point used to sample elevation ("+e.x+", "+e.y+") is outside of the sampler extent ("+i+")")}return this.tile.sample(t.x,t.y)},e.prototype.queryElevation=function(e){return u(e.clone(),this)},e.prototype.on=function(e,t){return T},e}();t.TileElevationSampler=d;var m=function(){function e(e,t,n){var i,o=this;"number"==typeof t?(this.noDataValue=t,i=null):(i=t,this.noDataValue=n),this.samplers=i?e.map(function(e){return new d(e,i,o.noDataValue)}):e;var r=this.samplers[0];if(r){this.extent=r.extent.clone();var l=r.demResolution,s=l.min,u=l.max;this.demResolution={min:s,max:u};for(var c=1;c<this.samplers.length;c++){var p=this.samplers[c];this.extent.union(p.extent),this.demResolution.min=Math.min(this.demResolution.min,p.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,p.demResolution.max)}}else this.extent=a.toExtent(a.create(),i.spatialReference),this.demResolution={min:0,max:0}}return Object.defineProperty(e.prototype,"spatialReference",{get:function(){return this.extent.spatialReference},enumerable:!0,configurable:!0}),e.prototype.elevationAt=function(e){var t=c(e,this.spatialReference);if(!t)return null;for(var n=0,i=this.samplers;n<i.length;n++){var o=i[n];if(o.contains(t))return o.elevationAt(t)}return v.warn("#elevationAt()","Point used to sample elevation ("+e.x+", "+e.y+") is outside of the sampler"),null},e.prototype.queryElevation=function(e){return u(e.clone(),this)},e.prototype.on=function(e,t){return T},e}();t.MultiTileElevationSampler=m,t.updateGeometryElevation=u;var y=new n.Point,T={remove:function(){}}}.apply(null,i))||(e.exports=o)},C7Q9:function(e,t,n){var i,o;i=[n.dj.c(e.i),t],void 0===(o=function(e,t){function n(e,t,n){var o=e.safeWidth,r=e.width,a=e.values,l=e.noDataValue,s=i(e.dy*(e.y1-n),0,o),u=i(e.dx*(t-e.x0),0,o),c=Math.floor(s),p=Math.floor(u),f=c*r+p,h=f+r,v=a[f],d=a[h],m=a[f+1],y=a[h+1];if(v!==l&&d!==l&&m!==l&&y!==l){var T=u-p,x=v+(m-v)*T;return x+(d+(y-d)*T-x)*(s-c)}}function i(e,t,n){return e<t?t:e>n?n:e}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this.tile=e,this.update(t)}return e.prototype.update=function(e){if(e){var t=this.tile.extent;this.samplerData={values:e.values,width:e.width,height:e.height,safeWidth:.99999999*(e.width-1),noDataValue:e.noDataValue,dx:(e.width-1)/(t[2]-t[0]),dy:(e.width-1)/(t[3]-t[1]),x0:t[0],y1:t[3]}}else this.samplerData=null},e.prototype.sample=function(e,t){if(this.samplerData)return n(this.samplerData,e,t)},e}();t.ElevationTile=o,t.sample=n,t.default=o}.apply(null,i))||(e.exports=o)},T16p:function(e,t,n){var i,o;i=[n.dj.c(e.i),t,n("2Atf"),n("HZ3d"),n("xhoE"),n("Q2wQ"),n("KY0m"),n("ma1f"),n("qMld"),n("8uEs"),n("t78F"),n("oxlp"),n("aYWh"),n("lRq4"),n("vtMp"),n("+TTo"),n("C7Q9")],void 0===(o=function(e,t,n,i,o,r,a,l,s,u,c,p,f,h,v,d,m){function y(e,t){var n=e.lods.length-1;if(t>0){var i=a.findIndex(e.lods,function(e){return e.resolution<t});0===i?n=0:i>0&&(n=i-1)}return n}Object.defineProperty(t,"__esModule",{value:!0});var T=function(){function e(){}return e.prototype.queryAll=function(e,t,o){return i(this,void 0,void 0,function(){var i,a,u,c,p;return r(this,function(r){switch(r.label){case 0:return(e=o&&o.ignoreInvisibleLayers?e.filter(function(e){return e.visible}):e.slice()).length?(i=x.fromGeometry(t),a=!1,o&&o.returnSampleInfo||(a=!0),u=n({noDataValue:0,maximumAutoTileRequests:20},o,{returnSampleInfo:!0,demResolution:"auto"}),[4,this.query(e[e.length-1],i,u)]):[2,s.reject(new l("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from"))];case 1:return c=r.sent(),[4,this._queryAllContinue(e,c,u)];case 2:return(p=r.sent()).geometry=p.geometry.export(),a&&delete p.sampleInfo,[2,p]}})})},e.prototype.query=function(e,t,o){return i(this,void 0,void 0,function(){var i;return r(this,function(r){switch(r.label){case 0:return e?t&&(t instanceof x||"point"===t.type||"multipoint"===t.type||"polyline"===t.type)?(o=n({noDataValue:0,demResolution:"auto",minDemResolution:0,maximumAutoTileRequests:20,returnSampleInfo:!1},o),i=new R(e,t.spatialReference,o),[4,e.load()]):[2,s.reject(new l("elevation-query:invalid-geometry","Only point, polyline and multipoint geometries can be used to query elevation"))]:[2,s.reject(new l("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from"))];case 1:return r.sent(),this._createGeometryDescriptor(i,t),[4,this._selectTiles(i)];case 2:return r.sent(),[4,this._populateElevationTiles(i)];case 3:return r.sent(),this._sampleGeometryWithElevation(i),[2,this._createQueryResult(i)]}})})},e.prototype.createSampler=function(e,t,o){return i(this,void 0,void 0,function(){return r(this,function(i){return e?t&&"extent"===t.type?(o=n({noDataValue:0,demResolution:"auto",maximumAutoTileRequests:20,returnSampleInfo:!1},o),[2,this._createSampler(e,t,o)]):[2,s.reject(new l("elevation-query:invalid-extent","Invalid or undefined extent"))]:[2,s.reject(new l("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from"))]})})},e.prototype.createSamplerAll=function(e,t,o){return i(this,void 0,void 0,function(){var i,a;return r(this,function(r){switch(r.label){case 0:return(e=o&&o.ignoreInvisibleLayers?e.filter(function(e){return e.visible}):e.slice()).length?t&&"extent"===t.type?(i=n({noDataValue:0,maximumAutoTileRequests:20},o,{returnSampleInfo:!0,demResolution:"auto"}),[4,this._createSampler(e[e.length-1],t,i)]):[2,s.reject(new l("elevation-query:invalid-extent","Invalid or undefined extent"))]:[2,s.reject(new l("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from"))];case 1:return a=r.sent(),[2,this._createSamplerAllContinue(e,t,a,i)]}})})},e.prototype._createSampler=function(e,t,n,o){return i(this,void 0,void 0,function(){var i,a,u;return r(this,function(r){switch(r.label){case 0:return[4,e.load()];case 1:if(r.sent(),i=t.spatialReference,a=e.tileInfo.spatialReference,!i.equals(a)){if(!v.canProject(i,a))return[2,s.reject(new l("elevation-query:invalid-extent","Extent spatial reference ("+i.wkid+") must be compatible with tile spatial reference ("+a.wkid+")"))];t=v.project(t,a)}return u=new w(e,t,n,o),[4,this._selectTiles(u)];case 2:return r.sent(),[4,this._populateElevationTiles(u)];case 3:return r.sent(),[2,new d.MultiTileElevationSampler(u.elevationTiles,u.layer.tileInfo,u.options.noDataValue)]}})})},e.prototype._createSamplerAllContinue=function(e,t,n,o){return i(this,void 0,void 0,function(){var i,a,l,s;return r(this,function(r){switch(r.label){case 0:return e.pop(),e.length?(i=n.samplers.map(function(e){return h.fromExtent(e.extent)}),[4,this._createSampler(e[e.length-1],t,o,i)]):[2,n];case 1:return 0===(a=r.sent()).samplers.length?[2,n]:(l=n.samplers.concat(a.samplers),s=new d.MultiTileElevationSampler(l,o.noDataValue),[2,this._createSamplerAllContinue(e,t,s,o)])}})})},e.prototype._queryAllContinue=function(e,t,n){return i(this,void 0,void 0,function(){var i,o,a,l,s,u,c;return r(this,function(r){switch(r.label){case 0:if(i=e.pop(),t.geometry.coordinates.forEach(function(e,n){t.sampleInfo[n].demResolution>=0&&!t.sampleInfo[n].source&&(t.sampleInfo[n].source=i)}),!e.length)return[2,t];for(o=t.geometry.coordinates,a=[],l=[],s=0;s<o.length;s++)t.sampleInfo[s].demResolution<0&&(a.push(o[s]),l.push(s));return 0===a.length?[2,t]:(u=t.geometry.clone(a),[4,this.query(e[e.length-1],u,n)]);case 1:return c=r.sent(),l.forEach(function(e,n){o[e].z=c.geometry.coordinates[n].z,t.sampleInfo[e].demResolution=c.sampleInfo[n].demResolution}),[2,this._queryAllContinue(e,t,n)]}})})},e.prototype._createQueryResult=function(e){var t={geometry:(e.outSpatialReference.equals(e.geometry.spatialReference)?e.geometry:e.geometry.project(e.outSpatialReference)).export(),noDataValue:e.options.noDataValue};return e.options.returnSampleInfo&&(t.sampleInfo=this._extractSampleInfo(e)),e.geometry.coordinates.forEach(function(e){e.tile=null,e.elevationTile=null}),t},e.prototype._createGeometryDescriptor=function(e,t){var n,i=e.layer.tileInfo.spatialReference;if(!(n=t instanceof x?t.project(i):v.project(t,i)))throw new l("elevation-query:spatial-reference-mismatch","Cannot query elevation in '"+t.spatialReference.wkid+"' on an elevation service in '"+i.wkid+"'");e.geometry=x.fromGeometry(n)},e.prototype._selectTiles=function(e){return i(this,void 0,void 0,function(){var t;return r(this,function(n){switch(n.label){case 0:return t=e.options.demResolution,"geometry"===e.type&&this._preselectOutsideLayerExtent(e),"number"!=typeof t?[3,1]:(this._selectTilesClosestResolution(e),[3,6]);case 1:return"finest-contiguous"!==t?[3,3]:[4,this._selectTilesFinestContiguous(e)];case 2:return n.sent(),[3,6];case 3:return"auto"!==t?[3,5]:[4,this._selectTilesAuto(e)];case 4:return n.sent(),[3,6];case 5:throw new l("elevation-query:invalid-dem-resolution","Invalid dem resolution value '"+t+'\', expected a number, "finest-contiguous" or "auto"');case 6:return[2]}})})},e.prototype._preselectOutsideLayerExtent=function(e){var t=new m.ElevationTile(null);t.sample=function(t,n){return e.options.noDataValue},e.outsideExtentTile=t;var n=e.layer.fullExtent;e.geometry.coordinates.forEach(function(e){var i=e.x,o=e.y;(i<n.xmin||i>n.xmax||o<n.ymin||o>n.ymax)&&(e.elevationTile=t)})},e.prototype._selectTilesClosestResolution=function(e){var t=e.layer.tileInfo,n=this._findNearestDemResolutionLODIndex(t,e.options.demResolution);e.selectTilesAtLOD(n)},e.prototype._findNearestDemResolutionLODIndex=function(e,t){for(var n=t/u.getMetersPerUnitForSR(e.spatialReference),i=e.lods[0],o=0,r=1;r<e.lods.length;r++){var a=e.lods[r];Math.abs(a.resolution-n)<Math.abs(i.resolution-n)&&(i=a,o=r)}return o},e.prototype._selectTilesFinestContiguous=function(e){return i(this,void 0,void 0,function(){var t;return r(this,function(n){switch(n.label){case 0:return t=y(e.layer.tileInfo,e.options.minDemResolution),[4,this._selectTilesFinestContiguousAt(e,t)];case 1:return n.sent(),[2]}})})},e.prototype._selectTilesFinestContiguousAt=function(e,t){return i(this,void 0,void 0,function(){var n,i,o;return r(this,function(r){switch(r.label){case 0:if(n=e.layer,e.selectTilesAtLOD(t),t<0)return[2];i=n.tilemapCache,o=e.getTilesToFetch(),r.label=1;case 1:return r.trys.push([1,6,,8]),i?[4,s.all(o.map(function(e){return i.fetchAvailability(e.level,e.row,e.col)}))]:[3,3];case 2:return r.sent(),[3,5];case 3:return[4,this._populateElevationTiles(e)];case 4:if(r.sent(),!e.allElevationTilesFetched())throw e.clearElevationTiles(),new l("elevation-query:has-unavailable-tiles");r.label=5;case 5:return[3,8];case 6:return r.sent(),[4,this._selectTilesFinestContiguousAt(e,t-1)];case 7:return r.sent(),[3,8];case 8:return[2]}})})},e.prototype._populateElevationTiles=function(e){return i(this,void 0,void 0,function(){var t,n,i,o;return r(this,function(r){switch(r.label){case 0:return t=e.options.noDataValue,n=e.getTilesToFetch(),i={},o=n.map(function(n){return e.layer.fetchTile(n.level,n.row,n.col,t).then(function(e){return i[n.id]=new m.ElevationTile(n,e)})}),[4,s.eachAlways(o)];case 1:return r.sent(),e.populateElevationTiles(i),[2]}})})},e.prototype._selectTilesAuto=function(e){return i(this,void 0,void 0,function(){var t,n,o,a,l=this;return r(this,function(u){switch(u.label){case 0:return this._selectTilesAutoFinest(e),this._reduceTilesForMaximumRequests(e),(t=e.layer.tilemapCache)?(n=e.getTilesToFetch(),o={},a=n.map(function(e){return i(l,void 0,void 0,function(){var n;return r(this,function(i){switch(i.label){case 0:n={id:null,level:0,row:0,col:0,extent:h.create()},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.fetchAvailabilityUpsample(e.level,e.row,e.col,n)];case 2:return i.sent(),o[e.id]=n,[3,4];case 3:return i.sent(),[3,4];case 4:return[2]}})})}),[4,s.all(a)]):[2,this._selectTilesAutoPrefetchUpsample(e)];case 1:return u.sent(),e.remapTiles(o),[2]}})})},e.prototype._reduceTilesForMaximumRequests=function(e){var t=e.layer.tileInfo,n=0,i={},o=function(e){e.id in i?i[e.id]++:(i[e.id]=1,n++)},r=function(e){var t=i[e.id];1===t?(delete i[e.id],n--):i[e.id]=t-1};e.forEachTileToFetch(o,r);for(var a=!0;a&&(a=!1,e.forEachTileToFetch(function(i){n<=e.options.maximumAutoTileRequests||(r(i),t.upsampleTile(i)&&(a=!0),o(i))},r),a););},e.prototype._selectTilesAutoFinest=function(e){var t=y(e.layer.tileInfo,e.options.minDemResolution);e.selectTilesAtLOD(t,e.options.maximumAutoTileRequests)},e.prototype._selectTilesAutoPrefetchUpsample=function(e){return i(this,void 0,void 0,function(){var t,n;return r(this,function(i){switch(i.label){case 0:return t=e.layer.tileInfo,[4,this._populateElevationTiles(e)];case 1:return i.sent(),n=!1,e.forEachTileToFetch(function(e,i){t.upsampleTile(e)?n=!0:i()}),n?[4,this._selectTilesAutoPrefetchUpsample(e)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},e.prototype._sampleGeometryWithElevation=function(e){e.geometry.coordinates.forEach(function(t){var n=t.elevationTile,i=e.options.noDataValue;if(n){var o=n.sample(t.x,t.y);void 0!==o?i=o:t.elevationTile=null}t.z=i})},e.prototype._extractSampleInfo=function(e){var t=e.layer.tileInfo,n=u.getMetersPerUnitForSR(t.spatialReference);return e.geometry.coordinates.map(function(i){var o=-1;return i.elevationTile&&i.elevationTile!==e.outsideExtentTile&&(o=t.lodAt(i.elevationTile.tile.level).resolution*n),{demResolution:o}})},e}();t.ElevationQuery=T;var x=function(){function e(){}return e.prototype.export=function(){return this._exporter(this.coordinates,this.spatialReference)},e.prototype.clone=function(t){var n=this,i=new e;return i.geometry=this.geometry,i.spatialReference=this.spatialReference,i.coordinates=t||this.coordinates.map(function(e){return n._cloneCoordinate(e)}),i._exporter=this._exporter,i},e.prototype.project=function(e){var t=this;if(this.spatialReference.equals(e))return this.clone();if(v.canProject(this.spatialReference,e)){var n=e.isWGS84?v.xyToLngLat:v.lngLatToXY,i=[0,0],o=this.coordinates.map(function(e){var o=t._cloneCoordinate(e);return n(o.x,o.y,i),o.x=i[0],o.y=i[1],o}),r=this.clone(o);return r.spatialReference=e,r}return null},e.prototype._cloneCoordinate=function(e){return{x:e.x,y:e.y,z:e.z,m:e.m,tile:null,elevationTile:null}},e.fromGeometry=function(t){var n=new e;if(n.geometry=t,n.spatialReference=t.spatialReference,t instanceof e)n.coordinates=t.coordinates.map(function(e){return n._cloneCoordinate(e)}),n._exporter=function(e,n){var i=t.clone(e);return i.spatialReference=n,i};else switch(t.type){case"point":var i=t;t.hasM?n.coordinates=[{x:i.x,y:i.y,m:i.m}]:n.coordinates=[{x:i.x,y:i.y}],n._exporter=function(e,n){return t.hasM?new p(e[0].x,e[0].y,e[0].z,e[0].m,n):new p(e[0].x,e[0].y,e[0].z,n)};break;case"multipoint":var o=t;n.coordinates=o.points.map(function(e){if(t.hasM){var n=t.hasZ?3:2;return{x:e[0],y:e[1],m:e[n]}}return{x:e[0],y:e[1]}}),n._exporter=function(e,n){return t.hasM?new c({points:e.map(function(e){return[e.x,e.y,e.z,e.m]}),hasZ:!0,hasM:!0,spatiaReference:n}):new c(e.map(function(e){return[e.x,e.y,e.z]}),n)};break;case"polyline":var r=[],a=[],l=0;t.paths.forEach(function(e){a.push([l,l+e.length]),l+=e.length,r.push.apply(r,e.map(function(e){if(t.hasM){var n=t.hasZ?3:2;return{x:e[0],y:e[1],m:e[n]}}return{x:e[0],y:e[1]}}))}),n.coordinates=r,n._exporter=function(e,n){var i=t.hasM?e.map(function(e){return[e.x,e.y,e.z,e.m]}):e.map(function(e){return[e.x,e.y,e.z]}),o=a.map(function(e){return i.slice(e[0],e[1])});return new f({paths:o,hasM:t.hasM,hasZ:!0,spatialReference:n})}}return n},e}();t.GeometryDescriptor=x;var g=function(e,t){this.layer=e,this.options=t},R=function(e){function t(t,n,i){var o=e.call(this,t,i)||this;return o.type="geometry",o.outSpatialReference=n,o}return o(t,e),t.prototype.selectTilesAtLOD=function(e,t){if(e<0)this.geometry.coordinates.forEach(function(e){return e.tile=null});else{var n=this.layer.tileInfo,i=n.lods[e].level;this.geometry.coordinates.forEach(function(e){e.tile=n.tileAt(i,e.x,e.y)})}},t.prototype.allElevationTilesFetched=function(){return!this.geometry.coordinates.some(function(e){return!e.elevationTile})},t.prototype.clearElevationTiles=function(){for(var e=0,t=this.geometry.coordinates;e<t.length;e++){var n=t[e];n.elevationTile!==this.outsideExtentTile&&(n.elevationTile=null)}},t.prototype.populateElevationTiles=function(e){for(var t=0,n=this.geometry.coordinates;t<n.length;t++){var i=n[t];!i.elevationTile&&i.tile&&(i.elevationTile=e[i.tile.id])}},t.prototype.remapTiles=function(e){for(var t=0,n=this.geometry.coordinates;t<n.length;t++){var i=n[t];i.tile=e[i.tile.id]}},t.prototype.getTilesToFetch=function(){for(var e={},t=[],n=0,i=this.geometry.coordinates;n<i.length;n++){var o=i[n],r=o.tile;o.elevationTile||!o.tile||e[r.id]||(e[r.id]=r,t.push(r))}return t},t.prototype.forEachTileToFetch=function(e,t){for(var n=0,i=this.geometry.coordinates;n<i.length;n++){!function(t){t.tile&&!t.elevationTile&&e(t.tile,function(){return t.tile=null})}(i[n])}},t}(g),w=function(e){function t(t,n,i,o){var r=e.call(this,t,i)||this;return r.type="extent",r.elevationTiles=[],r.candidateTiles=[],r.fetchedCandidates=new Set,r.extent=n.intersection(t.fullExtent),r.maskExtents=o,r}return o(t,e),t.prototype.selectTilesAtLOD=function(e,t){var n=this._maximumLodForRequests(t),i=Math.min(n,e);i<0?this.candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(i)},t.prototype._maximumLodForRequests=function(e){var t=this.layer.tileInfo;if(!e)return t.lods.length-1;for(var n=this.extent,i=t.lods.length-1;i>=0;i--){var o=t.lods[i],r=o.resolution*t.size[0],a=o.resolution*t.size[1];if(Math.ceil(n.width/r)*Math.ceil(n.height/a)<=e)return i}return-1},t.prototype.allElevationTilesFetched=function(){return this.candidateTiles.length===this.elevationTiles.length},t.prototype.clearElevationTiles=function(){this.elevationTiles.length=0,this.fetchedCandidates.clear()},t.prototype.populateElevationTiles=function(e){for(var t=0,n=this.candidateTiles;t<n.length;t++){var i=n[t],o=e[i.id];o&&(this.fetchedCandidates.add(i),this.elevationTiles.push(o))}},t.prototype.remapTiles=function(e){this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles.map(function(t){return e[t.id]}))},t.prototype.getTilesToFetch=function(){return this.candidateTiles},t.prototype.forEachTileToFetch=function(e,t){var n=this,i=this.candidateTiles;this.candidateTiles=[],i.forEach(function(i){if(n.fetchedCandidates.has(i))t&&t(i);else{var o=!1;e(i,function(){return o=!0}),o?t&&t(i):n.candidateTiles.push(i)}}),this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles,t)},t.prototype._uniqueNonOverlappingTiles=function(e,t){for(var n={},i=[],o=0,r=e;o<r.length;o++){var a=r[o];n[a.id]?t&&t(a):(n[a.id]=a,i.push(a))}var l=i.sort(function(e,t){return e.level-t.level});return l.filter(function(e,n){for(var i=0;i<n;i++)if(h.contains(l[i].extent,e.extent))return t&&t(e),!1;return!0})},t.prototype._selectCandidateTilesCoveringExtentAt=function(e){this.candidateTiles.length=0;for(var t=this.layer.tileInfo,n=t.lods[e],i=this.extent,o=t.tileAt(n.level,i.xmin,i.ymin),r=n.resolution*t.size[0],a=n.resolution*t.size[1],l=Math.ceil((i.xmax-o.extent[0])/r),s=Math.ceil((i.ymax-o.extent[1])/a),u=0;u<s;u++)for(var c=0;c<l;c++){var p={id:null,level:o.level,row:o.row-u,col:o.col+c};t.updateTileInfo(p),this._tileIsMasked(p)||this.candidateTiles.push(p)}},t.prototype._tileIsMasked=function(e){return!!this.maskExtents&&this.maskExtents.some(function(t){return h.contains(t,e.extent)})},t}(g);t.getFinestLodIndex=y,t.default=T}.apply(null,i))||(e.exports=o)}}]);