(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/ElevationLayer":"GAgw","esri/layers/support/LercDecoder":"M/KD","esri/views/3d/support/WorkerHandle":"ecY5"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{GAgw:function(e,t,r){var o,n;o=[r.dj.c(e.i),t,r("zOht"),r("zp6E"),r("7bfM"),r("ma1f"),r("qsST"),r("LxLY"),r("EUqE"),r("qMld"),r("jfWY"),r("Vx27"),r("MFVu"),r("0RER"),r("WhPF"),r("2fnV"),r("FEX1"),r("QJ8R"),r("EtsK"),r("M/KD"),r("2Kdy")],void 0===(n=function(e,t,o,n,i,a,s,l,p,c,u,d,h,y,f,v,_,g,m,w){var b=s.getLogger("esri.layers.ElevationLayer");return function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.apply(this,t)||this;return o.copyright=null,o.heightModelInfo=null,o.path=null,o.opacity=1,o.operationalLayerType="ArcGISTiledElevationServiceLayer",o.sourceJSON=null,o.type="elevation",o.url=null,o.version=null,o._lercDecoder=w.acquireInstance(),o}return o.__extends(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?o.__assign({url:e},t):e},t.prototype.destroy=function(){w.releaseInstance(this._lercDecoder),this._lercDecoder=null},Object.defineProperty(t.prototype,"minScale",{get:function(){},set:function(e){this.constructed&&b.warn(this.declaredClass+".minScale support has been removed (since 4.5)")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxScale",{get:function(){},set:function(e){this.constructed&&b.warn(this.declaredClass+".maxScale support has been removed (since 4.5)")},enumerable:!0,configurable:!0}),t.prototype.readVersion=function(e,t){var r=t.currentVersion;return r||(r=9.3),r},t.prototype.load=function(e){var t=this,r=l.isSome(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:function(e){for(var t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new a("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}},e).then((function(){return t._fetchImageService(r)}),(function(){return t._fetchImageService(r)}))),c.resolve(this)},t.prototype.fetchTile=function(e,t,r,o){var a=this;void 0===o&&(o={}),null!=o&&"number"==typeof o&&(i.deprecated(b,"Passing 'noDataValue' directly as a parameter",{replacement:"use { noDataValue } options object instead",version:"4.12"}),o={noDataValue:o});var s={responseType:"array-buffer",signal:o.signal},l={noDataValue:o.noDataValue,returnFileInfo:!0};return this.load().then((function(){return a._fetchTileAvailability(e,t,r,o)})).then((function(){return n(a.getTileUrl(e,t,r),s)})).then((function(e){return a._lercDecoder.decode(e.data,l,o.signal)})).then((function(e){return{values:e.pixelData,width:e.width,height:e.height,maxZError:e.fileInfo.maxZError,noDataValue:e.noDataValue,minValue:e.minValue,maxValue:e.maxValue}}))},t.prototype.getTileUrl=function(e,t,r){var n=!this.tilemapCache&&this.supportsBlankTile,i=u.objectToQuery(o.__assign(o.__assign({},this.parsedUrl.query),{blankTile:!n&&null}));return this.parsedUrl.path+"/tile/"+e+"/"+t+"/"+r+(i?"?"+i:"")},t.prototype.queryElevation=function(e,t){var r=this;return this._importElevationQuery().then((function(o){return(new o.ElevationQuery).query(r,e,t)}))},t.prototype.createElevationSampler=function(e,t){var r=this;return this._importElevationQuery().then((function(o){return(new o.ElevationQuery).createSampler(r,e,t)}))},t.prototype._fetchTileAvailability=function(e,t,r,o){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,r,o):c.resolve("unknown")},t.prototype._fetchImageService=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,r;return o.__generator(this,(function(i){switch(i.label){case 0:return this.sourceJSON?[2,this.sourceJSON]:(t={query:o.__assign({f:"json"},this.parsedUrl.query),responseType:"json",signal:e},[4,n(this.parsedUrl.path,t)]);case 1:return(r=i.sent()).ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=r.data,this.read(r.data,{origin:"service",url:this.parsedUrl}),[2]}}))}))},t.prototype._importElevationQuery=function(){return new Promise((function(e,t){r.e(23).then(function(){var t=[r("T16p")];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))},o.__decorate([d.property({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),o.__decorate([d.property({readOnly:!0,type:h})],t.prototype,"heightModelInfo",void 0),o.__decorate([d.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],t.prototype,"path",void 0),o.__decorate([d.property({type:["show","hide"]})],t.prototype,"listMode",void 0),o.__decorate([d.property({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],t.prototype,"minScale",null),o.__decorate([d.property({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],t.prototype,"maxScale",null),o.__decorate([d.property({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"opacity",void 0),o.__decorate([d.property({type:["ArcGISTiledElevationServiceLayer"]})],t.prototype,"operationalLayerType",void 0),o.__decorate([d.property()],t.prototype,"sourceJSON",void 0),o.__decorate([d.property({json:{read:!1},value:"elevation",readOnly:!0})],t.prototype,"type",void 0),o.__decorate([d.property(m.url)],t.prototype,"url",void 0),o.__decorate([d.property()],t.prototype,"version",void 0),o.__decorate([d.reader("version",["currentVersion"])],t.prototype,"readVersion",null),o.__decorate([d.subclass("esri.layers.ElevationLayer")],t)}(f.ArcGISCachedService(v.ArcGISService(_.OperationalLayer(g.PortalLayer(p.MultiOriginJSONMixin(y))))))}.apply(null,o))||(e.exports=n)},"M/KD":function(e,t,r){var o,n;o=[r.dj.c(e.i),t,r("zOht"),r("qMld"),r("ecY5"),r("2Kdy")],void 0===(n=function(e,t,r,o,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){var r=e.call(this,"LercWorker","_decode",t,{strategy:"dedicated"})||this;return r.scheduler=t,r}return r.__extends(t,e),t.prototype.decode=function(e,t,r){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},r):o.resolve(null)},t.prototype.getTransferList=function(e){return[e.buffer]},t}(n.WorkerHandle),a=new Map;t.acquireInstance=function(e){var t=a.get(e);return t||(t={instance:new i(e),ref:0},a.set(e,t)),++t.ref,t.instance},t.releaseInstance=function(e){if(null!=e){var t=e.scheduler,r=a.get(t);r&&--r.ref<=0&&(r.instance.destroy(),a.delete(t))}}}.apply(null,o))||(e.exports=n)},ecY5:function(e,t,r){var o,n;o=[r.dj.c(e.i),t,r("zOht"),r("qsST"),r("qMld"),r("8V7H")],void 0===(n=function(e,t,r,o,n,i){Object.defineProperty(t,"__esModule",{value:!0});var a=o.getLogger("esri.views.3d.support.WorkerHandle"),s=function(){function e(e,t,o,n){var s=this;void 0===n&&(n={}),this._methodName=t,this._promise=i.open(e,r.__assign(r.__assign({},n),{scheduler:o})).then((function(e){void 0===s._thread?(s._thread=e,s._promise=null):e.close()})),this._promise.catch((function(t){return a.error("Failed to initialize "+e+" worker: "+t)}))}return e.prototype.destroy=function(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null},e.prototype.invoke=function(e,t){var r=this;if(void 0===t&&(t=null),this._thread){var o=this.getTransferList(e);return this._thread.invoke(this._methodName,e,{transferList:o,signal:t})}return this._promise?this._promise.then((function(){return n.throwIfAborted(t),r.invoke(e,t)})):n.reject(null)},e.prototype.broadcast=function(e,t){var r=this;return this._thread?n.all(this._thread.broadcast(t,e)).then((function(){})):this._promise?this._promise.then((function(){return r.broadcast(e,t)})):n.reject()},Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!0,configurable:!0}),e}();t.WorkerHandle=s}.apply(null,o))||(e.exports=n)}}]);