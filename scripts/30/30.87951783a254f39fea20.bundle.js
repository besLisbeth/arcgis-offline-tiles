(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/graphics/data/timeSupport":"/61J","esri/layers/graphics/dehydratedFeatureComparison":"/Vvo","esri/views/2d/layers/features/support/ClusterStore":"0SZq","esri/core/sql/WhereClause":"1eyA","esri/tasks/geometry/cut":"2QEt","esri/layers/graphics/data/BoundsStore":"2xGR","esri/layers/graphics/data/QueryEngineCapabilities":"4/qq","esri/tasks/operations/pbfOptimizedFeatureSet":"6/KI","esri/layers/graphics/data/AttributesBuilder":"700l","esri/geohash/geohashUtils":"8pdz","esri/layers/graphics/sources/geojson/geojson":"9K5t","esri/tasks/operations/query":"B16N","esri/views/2d/layers/features/controllers/BaseController":"Btct","esri/layers/graphics/sources/support/clientSideDefaults":"DaHD","esri/layers/graphics/centroid":"Fzzg","esri/tasks/operations/pbfQueryUtils":"G+Sd","esri/layers/ogc/ogcFeatureUtils":"GI9R","esri/geometry/geometryAdapters/json":"H9Hv","esri/tasks/operations/zscale":"HoQt","esri/geohash/GeohashTree":"JOu6","esri/views/2d/layers/features/support/DataTile":"KgG2","esri/core/SetPool":"L6z/","esri/geometry/support/GeographicTransformationStep":"MbkH","esri/geometry/support/GeographicTransformation":"OkCb","esri/layers/graphics/data/projectionSupport":"Q2Em","esri/layers/graphics/data/spatialQuerySupport":"V1i6","esri/views/2d/layers/features/support/DataTileFeaturesIndex":"W1uT","esri/geometry/support/aaBoundingBox":"WRgd","esri/tasks/operations/pbfFeatureServiceParser":"YhCz","esri/layers/graphics/data/attributeSupport":"Ytki","esri/layers/graphics/data/executeTileQuery":"ZGAQ","esri/core/ItemCache":"ZHL0","esri/layers/graphics/dehydratedFeatures":"ZcgO","esri/layers/graphics/data/QueryEngine":"ZooB","esri/views/2d/layers/features/controllers/EditsQueue":"ak1O","esri/tasks/operations/urlUtils":"cGHk","esri/layers/graphics/data/QueryEngineResult":"d81A","esri/core/sql/WhereGrammar":"fsiH","esri/geometry/support/normalizeUtils":"fw2w","esri/layers/graphics/contains":"gT/q","esri/core/sql/sql92grammar":"ixhC","esri/core/sql/StandardizedFunctions":"l8NS","esri/views/2d/layers/features/support/pixelBuffering":"oWCy","esri/layers/graphics/data/FeatureStore":"rfv1","esri/views/2d/layers/features/support/TileUpdateQueue":"sOkP","esri/tasks/geometry/simplify":"sqdO","esri/layers/support/PromiseQueue":"tZaU","esri/views/2d/layers/features/controllers/OnDemandController":"uqzM","esri/core/sql/AggregateFunctions":"vjUK","esri/tasks/support/FeatureSet":"w1v0","esri/geometry/pe":"w7fK","esri/geometry/projection":"wIC5","esri/views/2d/layers/graphics/graphicsUtils":"wjMf","esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":"yLD6","esri/tasks/operations/pbfDehydratedFeatureSet":"yre/","esri/layers/graphics/data/utils":"zDti","esri/core/sql/WhereClauseCache":"ztx9"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[30,6,7,9,13,144],{"/61J":function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeExtent=function(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach((function(e){var t=r.getAttribute(e,n),s=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==s||isNaN(s)||(o=Math.max(o,s))}));else{var s=n||i;t.forEach((function(e){var t=r.getAttribute(e,s);null==t||isNaN(t)||(a=Math.min(a,t),o=Math.max(o,t))}))}return{start:a,end:o}},t.getTimeOperator=function(e,t,r){if(!t||!e)return null;var n=e.startTimeField,i=e.endTimeField;if(!n&&!i)return null;var a=t.start,o=t.end;return null===a&&null===o?null:void 0===a&&void 0===o?function(){return!1}:n&&i?function(e,t,r,n,i){if(null!=n&&null!=i&&n===i){var a=n;return function(n){return a>=e.getAttribute(n,t)&&a<=e.getAttribute(n,r)}}return null!=n&&null!=i?function(a){return o=n,s=i,u=e.getAttribute(a,t),l=e.getAttribute(a,r),!(u>s||l<o);var o,s,u,l}:null!=n?function(t){return!(e.getAttribute(t,r)<n)}:null!=i?function(r){return!(e.getAttribute(r,t)>i)}:void 0}(r,n,i,a,o):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){return e.getAttribute(i,t)>=r&&e.getAttribute(i,t)<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(r,n||i,a,o)}}.apply(null,n))||(e.exports=i)},"/Vvo":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("pcDC"),r("LxLY")],void 0===(i=function(e,t,r,n){function i(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var n=e[r],i=t[r];if(n.length!==i.length)return!1;for(var a=0;a<n.length;a++)if(n[a]!==i[a])return!1}return!0}function a(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1;return!0}function o(e,t){return e===t||e&&t&&e.equals(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.equals=function(e,t){return e===t||null!=e&&null!=t&&e.objectId===t.objectId&&!!function(e,t){if(e===t)return!0;if(n.isNone(e)||n.isNone(t))return!1;if(e.type!==t.type)return!1;switch(e.type){case"point":return function(e,t){return!!o(e.spatialReference,t.spatialReference)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.m===t.m}(e,t);case"extent":return function(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!o(e.spatialReference,t.spatialReference)&&e.xmin===t.xmin&&e.ymin===t.ymin&&e.zmin===t.zmin&&e.xmax===t.xmax&&e.ymax===t.ymax&&e.zmax===t.zmax}(e,t);case"polyline":return function(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!o(e.spatialReference,t.spatialReference)&&a(e.paths,t.paths)}(e,t);case"polygon":return function(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!o(e.spatialReference,t.spatialReference)&&a(e.rings,t.rings)}(e,t);case"multipoint":return function(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!o(e.spatialReference,t.spatialReference)&&i(e.points,t.points)}(e,t);case"mesh":return!1;default:return void r.neverReached(e)}}(e.geometry,t.geometry)&&!!function(e,t){if(e===t)return!0;if(!e||!t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var i=0,a=r;i<a.length;i++){var o=a[i];if(e[o]!==t[o])return!1}return!0}(e.attributes,t.attributes)}}.apply(null,n))||(e.exports=i)},"0SZq":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("TMur"),r("H1tY"),r("LxLY"),r("qMld"),r("jBNx"),r("JOu6"),r("8pdz"),r("nrlZ"),r("vtMp"),r("/COu"),r("Jvs9"),r("rfv1"),r("Q2Em"),r("ZooB"),r("zDti"),r("sCbS"),r("WEAo"),r("tI6k")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d,y,g,v,m,_,b){Object.defineProperty(t,"__esModule",{value:!0});var x=function(e){return a.andThen(e,(function(e){return"cluster"!==e.type?null:r.__assign(r.__assign({},e),{clusterRadius:s.pt2px(e.clusterRadius/2)})}))};function S(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,a,s,u;return r.__generator(this,(function(r){for(i=[],a=0,s=e;a<s.length;a++)u=s[a],i.push(I(u,t,n));return[2,o.all(i)]}))}))}function I(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,a,o;return r.__generator(this,(function(r){switch(r.label){case 0:return"onStatisticValueExpression"in e.outStatistic?(a=(i=e).outStatistic.onStatisticValueExpression,o=i,[4,m.createRendererExpression(a,t,n)]):[3,2];case 1:return o.expression=r.sent(),[2,i];case 2:return[2,e]}}))}))}var T=function(e){function t(t,r,n,i,a){var o=this,s=new p.default([],[r,n]);return(o=e.call(this,s,i,null,t)||this).invalid=!1,o.canDelete=!1,o.geohashBoundsInfo=a,o}return r.__extends(t,e),Object.defineProperty(t.prototype,"count",{get:function(){return this.attributes.cluster_count},enumerable:!0,configurable:!0}),t.create=function(e,r,n,i,a,o,s){var u=new t(r,n,i,o,s);return u.localId=e.createLocalId(u.objectId,!0),u.tileLevel=a,u},t.prototype.update=function(e,t,r,n,i){return this.geometry.coords[0]=e,this.geometry.coords[1]=t,this.tileLevel=r,this.attributes=n,this.geohashBoundsInfo=i,this.referenceId=null,this.invalid=!1,this},t.prototype.toJSON=function(){return{objectId:this.objectId,referenceId:this.referenceId,attributes:r.__assign(r.__assign({},this.attributes),{clusterId:this.objectId}),geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}},t}(h.default),w=function(e){function t(t,r,i,a){var o=e.call(this,t)||this;return o._deferredDeletionQueue=[],o._invalidated=!1,o._aggregateFieldsHash=null,o._geohashLevel=0,o._aggregateValueRanges={},o._aggregateValueRangesChanged=!1,o._aggregateFields=[],o._hasAggregateValueExpression=!1,o._hasViewExpression=!1,o._$view={scale:0,viewingMode:"none"},o._clusters=new Map,o._tiles=new Map,o._spatialReference=r,o._attributeStore=i,o._featureReduction=x(a),o._projectionSupportCheck=y.checkProjectionSupport(r,n.SpatialReference.WGS84),o}return r.__extends(t,e),t.prototype.setScale=function(e){var t=e!==this._$view.scale&&this._hasViewExpression,r=this._featureReduction;this._$view.scale=e,a.isSome(r)&&t&&(this._tree=new u.GeohashTree(this._aggregateFields),this._unindexFeatures(),this._reindexFeatures(!0))},t.prototype.update=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,l,c,f,h,p,d,y,g,v=this;return r.__generator(this,(function(r){switch(r.label){case 0:return i=this._featureReduction,o=a.andThen(t.featureReduction,x),s=t.aggregateFields.reduce((function(e,t){return e+JSON.stringify(t)}),""),l=null===i&&t.featureReduction,c=s!==this._aggregateFieldsHash,f=l||c,c?(h=this,[4,S(t.aggregateFields,this._spatialReference,n)]):[3,2];case 1:for(h._aggregateFields=r.sent(),this._hasViewExpression=!1,p=0,d=this._aggregateFields;p<d.length;p++)"onStatisticValueExpression"in(y=d[p]).outStatistic&&(g=y,this._hasAggregateValueExpression=!0,this._hasViewExpression=this._hasViewExpression||g.expression.referencesScale());r.label=2;case 2:return[4,this._projectionSupportCheck];case 3:return r.sent(),this._featureReduction=o,this._aggregateFieldsHash=s,this._aggregateValueRanges={},this._invalidated=!0,a.isNone(o)?(this._tree=null,[2]):(a.isSome(i)&&i.clusterRadius!==o.clusterRadius&&this._clusters.forEach((function(e){return e.canDelete=!0})),f&&(this._tree=new u.GeohashTree(t.aggregateFields),this._unindexFeatures()),(f||e)&&this._reindexFeatures(c),this._handleClusterUpdates(),this._tiles.forEach((function(e){return v._getClustersForTile(e,0,o.clusterRadius,null,!1)})),[2])}}))}))},t.prototype._ensureAggregateFields=function(e){if(this._hasAggregateValueExpression)for(var t=this._$view,r=0,n=this._aggregateFields;r<n.length;r++){var i=n[r];if("onStatisticValueExpression"in i.outStatistic){var a=i,o=a.expression,s=a.outStatistic.onStatisticField;e.attributes[s]=_.callWithOptimizedFeature(o,e,{$view:t},this.geometryInfo)}}},t.prototype._unindexFeatures=function(){this._featuresById.forEach((function(e){e.geohashIndexed=!1}))},t.prototype._reindexFeatures=function(e){var t=this;this._featuresById.forEach((function(r){r.geohashX||r.geohashY||t._setGeohash(r),e&&t._ensureAggregateFields(r),t._attributeStore.isVisible(r)?t._insertIntoIndex(r):t._removeFromIndex(r)}))},t.prototype.onTileUpdate=function(e){var t=this,r=e.added,n=e.removed;if(r.length){var i=Math.max.apply(Math,r.map((function(e){return e.level})));this._setGeohashLevel(i),r.forEach((function(e){return t._tiles.set(e.key.id,e)}))}if(!a.isNone(this._featureReduction)){var o=this._featureReduction.clusterRadius;n.forEach((function(e){t._tiles.delete(e.key.id),t._markTileClustersForDeletion(e,o)}))}},t.prototype.sweepClusters=function(){var e=this;this._clusters.forEach((function(t,r){t.canDelete&&(e._attributeStore.freeLocalId(t.objectId),e._clusters.delete(r))}));for(var t=0,r=this._deferredDeletionQueue;t<r.length;t++){var n=r[t];this._attributeStore.addLocalId(n)}this._deferredDeletionQueue=[]},t.prototype.executeTileQuery=function(t,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:return a.isNone(this._featureReduction)?[2,e.prototype.executeTileQuery.call(this,t,n,i)]:[4,this._projectionSupportCheck];case 1:return r.sent(),this._handleClusterUpdates(),o=this._featureReduction.clusterRadius,s=this._getTransforms(t,n),u=this._getClustersForTile(t,i.pixelBuffer,o,s),this._aggregateValueRangesChanged&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1),[2,u]}}))}))},t.prototype.getAggregate=function(e){var t=null;return this._clusters.forEach((function(r){r.localId===e&&(t=r.toJSON())})),t},t.prototype.getAggregateValueRanges=function(){return this._aggregateValueRanges},t.prototype._getClustersForTile=function(e,t,o,s,u){var l=this;void 0===u&&(u=!0),t=Math.max(t,50);for(var c=2*o,h=new Set,p=this._getGeohashLevel(e.key.level),d=Math.pow(2,e.key.level)*Math.ceil(b.TILE_SIZE/c),m=Math.ceil(t/c)+2,_=Math.ceil(b.TILE_SIZE/c)+2*m,x=e.key,S=x.row,I=x.col*b.TILE_SIZE,T=S*b.TILE_SIZE,w=Math.floor(I/c)-m,P=Math.floor(T/c)-m,M=w+_,E=P+_,F=new Array,N=e.tileInfoView.getLODInfoAt(e.key.level),R=w;R<=M;R++)for(var O=function(t){var o,c,m=R;N.wrap&&(m=R<0?R+d:R%d);var _=N.wrap&&R<0,b=N.wrap&&R%d!==R,x=A._lookupCluster(N,e.key.level,m,t,p);if(a.isSome(x)){var S=a.andThen(s,(function(e){return _?e.left:b?e.right:e.tile}));if(u&&a.isNone(S))return"continue";if(!x.count)return"continue";if(u&&1===x.count){var I=x.geohashBoundsInfo,T=I.xLL,w=I.yLL,P=I.xTR,M=I.yTR,E=I.level,O=a.unwrap(A._tree).findSingleOccupancyNode(T,w,P,M,E),C=a.unwrap(O).getLngLatBounds(),j={x:C[0],y:C[1]},G={x:C[2],y:C[3]},k=0,L=0,q=0,D=0;if(A._spatialReference.isWebMercator)k=(o=f.lngLatToXY(j.x,j.y))[0],L=o[1],q=(c=f.lngLatToXY(G.x,G.y))[0],D=c[1];else{var z=y.project(j,n.SpatialReference.WGS84,A._spatialReference),B=y.project(G,n.SpatialReference.WGS84,A._spatialReference);if(!z||!B)return i("esri-2d-debug"),"continue";k=z.x,L=z.y,q=B.x,D=B.y}var Q=[k,L,q,D],Z=null;if(A.forEachInBounds(Q,(function(e){l._attributeStore.isVisible(e)&&(Z&&i("esri-2d-debug"),Z=e)})),!Z)return i("esri-2d-debug"),"continue";var V=v.getGeometry(A.geometryInfo.geometryType,A.geometryInfo.hasZ,A.geometryInfo.hasM,Z.geometry,0,a.unwrap(S)),Y=r.__assign(r.__assign({},Z.attributes),x.attributes);x.referenceId=Z.localId,h.add(x.objectId),F.push(new g.Feature(Y,x.localId,V))}else u&&(h.add(x.objectId),V=v.getGeometry(A.geometryInfo.geometryType,A.geometryInfo.hasZ,A.geometryInfo.hasM,x.geometry,0,a.unwrap(S)),F.push(new g.Feature(x.attributes,x.localId,V)))}},A=this,C=P;C<=E;C++)O(C);return{features:F,objectIds:h}},t.prototype._getGeohashLevel=function(e){return Math.min(Math.ceil(e/2+2),12)},t.prototype._setGeohashLevel=function(e){var t=this,r=this._geohashLevel,n=this._getGeohashLevel(e),i=2*(Math.floor(n/2)+1)-1,o=this._tree;this._geohashLevel=i,a.isNone(o)||(i>r?(o.dropLevels(0),this._featuresById.forEach((function(e){e.geohashIndexed&&(t._setGeohash(e),o.insert(e,t._geohashLevel),e.geohashIndexed=!0)}))):i<r&&o.dropLevels(this._geohashLevel))},t.prototype._insertIntoIndex=function(e){e.geohashIndexed||(this._invalidated=!0,e.geohashIndexed=!0,a.unwrap(this._tree).insert(e,this._geohashLevel))},t.prototype._removeFromIndex=function(e){e.geohashIndexed&&(this._invalidated=!0,a.unwrap(this._tree).remove(e,this._geohashLevel),e.geohashIndexed=!1)},t.prototype._handleClusterUpdates=function(){var e=this;this._invalidated&&this._clusters.size&&this._clusters.forEach((function(t){a.isSome(t)&&(t.invalid=t.invalid||e._invalidated)})),this._invalidated=!1},t.prototype._getTransforms=function(e,t){var n={originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]},i=c.getInfo(t);if(!i)return{tile:n,left:null,right:null};var a=i.valid,o=a[0],s=a[1];return{tile:n,left:r.__assign(r.__assign({},n),{translate:[s,e.bounds[3]]}),right:r.__assign(r.__assign({},n),{translate:[o-s+e.bounds[0],e.bounds[3]]})}},t.prototype._getClusterId=function(e,t,r){return(15&e)<<28|(16383&t)<<14|16383&r},t.prototype._markForDeletion=function(e,t,r){var n=this._getClusterId(e,t,r);if(this._clusters.has(n)){var i=this._clusters.get(n);a.isSome(i)?i.canDelete=!0:this._clusters.delete(n)}},t.prototype._getClusterBounds=function(e,t,r){if(a.isNone(this._featureReduction))return null;var n=this._featureReduction.clusterRadius,i=2*n,o=r%2?t*i:t*i+n,s=r*i,u=o/b.TILE_SIZE,l=s/b.TILE_SIZE,c=(o+i)/b.TILE_SIZE,f=(s-i)/b.TILE_SIZE;return[e.getXForColumn(u),e.getYForRow(l),e.getXForColumn(c),e.getYForRow(f)]},t.prototype._lookupCluster=function(e,t,i,o,s){var u,c;if(a.isNone(this._featureReduction)||a.isNone(this._tree))return null;var h=this._getClusterId(t,i,o),p=this._clusters.get(h);if(p&&a.isSome(p)&&!p.invalid&&!p.canDelete)return p;var d=this._getClusterBounds(e,i,o),g=d[0],v=d[1],m=d[2],_=d[3],b={x:g,y:v},x={x:m,y:_},S=0,I=0,w=0,P=0;if(this._spatialReference.isWebMercator)S=(u=f.xyToLngLat(b.x,b.y))[0],I=u[1],w=(c=f.xyToLngLat(x.x,x.y))[0],P=c[1];else{var M=y.project(b,this._spatialReference,n.SpatialReference.WGS84),E=y.project(x,this._spatialReference,n.SpatialReference.WGS84);if(!M||!E)return null;S=M.x,I=M.y,w=E.x,P=E.y}S>w&&(w=180);var F={geohashX:0,geohashY:0},N={geohashX:0,geohashY:0};l.setGeohashXY(F,I,S,s),l.setGeohashXY(N,P,w,s);var R=F.geohashX,O=F.geohashY,A=N.geohashX,C=N.geohashY,j={xLL:R,yLL:O,xTR:A,yTR:C,level:s},G=this._tree.getRegionStatistics(R,O,A,C,s),k=G.count,L=G.xTotal,q=G.yTotal,D=k?L/k:0,z=k?q/k:0;if(a.isSome(p)&&p.canDelete){var B=this._attributeStore.removeLocalId(p.objectId);this._deferredDeletionQueue.push(B)}var Q=a.isSome(p)&&!p.canDelete&&p.invalid,Z=r.__assign({cluster_count:k},G.attributes),V=this._attributeStore,Y=Q?p.update(D,z,t,Z,j):T.create(V,h,D,z,t,Z,j);return 0===k&&(Y.geometry.coords[0]=(g+m)/2,Y.geometry.coords[1]=(v+_)/2),this._attributeStore.setAttributeData(Y.localId,Y,this.geometryInfo,null),this._clusters.set(h,Y),this._updateAggregateValueRangeForCluster(Y,Y.tileLevel),Y},t.prototype._updateAggregateValueRangeForCluster=function(e,t){var r=this._aggregateValueRanges[t]||{minValue:1/0,maxValue:0},n=r.minValue,i=r.maxValue;r.minValue=Math.min(n,e.count),r.maxValue=Math.max(i,e.count),this._aggregateValueRanges[t]=r,n===r.minValue&&i===r.maxValue||(this._aggregateValueRangesChanged=!0)},t.prototype._markTileClustersForDeletion=function(e,t){for(var r=2*t,n=Math.ceil(b.TILE_SIZE/r),i=e.key,a=i.row,o=i.col*b.TILE_SIZE,s=a*b.TILE_SIZE,u=Math.floor(o/r),l=Math.floor(s/r),c=u;c<u+n;c++)for(var f=l;f<l+n;f++)this._markForDeletion(e.key.level,c,f)},t.prototype._setGeohash=function(e){var t=e.geometry;if(t&&t.coords.length){var r={x:t.coords[0],y:t.coords[1]},a=y.project(r,this._spatialReference,n.SpatialReference.WGS84);a?l.setGeohashXY(e,a.y,a.x,12):i("esri-2d-debug")}},t.prototype._add=function(t){var r=this._featuresById.get(t.objectId);e.prototype._add.call(this,t),this._ensureAggregateFields(t),a.isSome(this._featureReduction)&&a.isSome(this._tree)&&(r?(t.geohashIndexed=r.geohashIndexed,t.geohashX=r.geohashX,t.geohashY=r.geohashY):this._setGeohash(t),!t.geohashIndexed&&this._attributeStore.isVisible(t)&&this._insertIntoIndex(t))},t.prototype._remove=function(t){return a.isSome(this._featureReduction)&&a.isSome(this._tree)&&this._removeFromIndex(t),e.prototype._remove.call(this,t)},t}(d.default);t.ClusterStore=w}.apply(null,n))||(e.exports=i)},"1eyA":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("H1tY"),r("R2Zq"),r("vjUK"),r("l8NS"),r("fsiH")],void 0===(i=function(e,t,r,n,i,a,o){Object.defineProperty(t,"__esModule",{value:!0});var s=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,u=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,l=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,c=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,f=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function h(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}function p(e,t,r,n,i,a,o,s,u){if(void 0===r&&(r="0"),void 0===n&&(n="0"),void 0===i&&(i="0"),void 0===a&&(a="0"),void 0===o&&(o=""),void 0===s&&(s="0"),void 0===u&&(u="0"),"+"===o||"-"===o){var l=h(parseInt(e,10),4)+"-"+h(parseInt(t,10),2)+"-"+h(parseInt(r,10),2),c="";parseFloat(a)<10&&(c="0");var f=h(parseInt(n,10),2)+":"+h(parseInt(i,10),2)+":"+(c+parseFloat(a).toString()),p=""+o+h(parseInt(s,10),2)+":"+h(parseInt(u,10),2);return new Date(l+"T"+f+p)}return new Date(parseInt(e,10),parseInt(t,10)-1,parseInt(r,10),parseInt(n,10),parseInt(i,10),parseFloat(a))}var d=function(){function e(){}return e.makeBool=function(e){return m(e)},e.featureValue=function(e,t,r,n){return F(e,t,r,n)},e.equalsNull=function(e){return null===e},e.applyLike=function(e,t,r){return T(e,t,r)},e.ensureArray=function(e){return _(e)},e.applyIn=function(e,t){return I(e,t)},e.currentDate=function(){var e=new Date;return e.setHours(0,0,0,0),e},e.makeSqlInterval=function(e,t,r){return a.SqlInterval.createFromValueAndQualifer(e,t,r)},e.convertInterval=function(e){return e instanceof a.SqlInterval?e.valueInMilliseconds():e},e.currentTimestamp=function(){return new Date},e.compare=function(e,t,r){return P(e,t,r)},e.calculate=function(e,t,r){return E(e,t,r)},e.makeComparable=function(e){return w(e)},e.evaluateFunction=function(e,t){return a.evaluateFunction(e,t)},e.lookup=function(e,t){var r=t[e];return void 0===r?null:r},e.between=function(e,t){return null==e||null==t[0]||null==t[1]?null:e>=t[0]&&e<=t[1]},e.notbetween=function(e,t){return null==e||null==t[0]||null==t[1]?null:e<t[0]||e>t[1]},e.ternaryNot=function(e){return b(e)},e.ternaryAnd=function(e,t){return x(e,t)},e.ternaryOr=function(e,t){return S(e,t)},e}(),y=function(){function e(e,t){this.fieldsIndex=t,this.datefields={},this.parameters={},this.parseTree=o.WhereGrammar.parse(e);var r=this.extractExpressionInfo(t),n=r.isStandardized,i=r.isAggregate,a=r.referencedFieldNames;this.referencedFieldNames=a,this.isStandardized=n,this.isAggregate=i}return e.create=function(t,r){return new e(t,r)},Object.defineProperty(e.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0}),e.prototype.testSet=function(e,r){void 0===r&&(r=t.defaultAttributeAdapter);for(var n={},i=function(t){n[t]=e.map((function(e){return r.getAttribute(e,t)}))},a=0,o=this.fieldNames;a<o.length;a++)i(o[a]);return!!this.evaluateNode(this.parseTree,{attributes:n},t.defaultAttributeAdapter)},e.prototype.calculateValue=function(e,r){void 0===r&&(r=t.defaultAttributeAdapter);var n=this.evaluateNode(this.parseTree,e,r);return n instanceof a.SqlInterval?n.valueInMilliseconds()/864e5:n},e.prototype.calculateValueCompiled=function(e,n){return void 0===n&&(n=t.defaultAttributeAdapter),null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,n,this.datefields):r("csp-restrictions")?this.calculateValue(e,n):(this.compileMe(),this.parseTree._compiledVersion(e,this.parameters,n,this.datefields))},e.prototype.testFeature=function(e,r){return void 0===r&&(r=t.defaultAttributeAdapter),!!this.evaluateNode(this.parseTree,e,r)},e.prototype.testFeatureCompiled=function(e,n){return void 0===n&&(n=t.defaultAttributeAdapter),null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,n,this.datefields):r("csp-restrictions")?this.testFeature(e,n):(this.compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,n,this.datefields))},e.prototype.getFunctions=function(){var e=[];return this.visitAll(this.parseTree,(function(t){"function"===t.type&&e.push(t.name.toLowerCase())})),M(e)},e.prototype.getExpressions=function(){var e=new Map;return this.visitAll(this.parseTree,(function(t){if("function"===t.type){var r=t.name.toLowerCase(),n=t.args.value[0];if("column_ref"===n.type){var i=n.column,a=r+"-"+i;e.has(a)||e.set(a,{aggregateType:r,field:i})}}})),n.valuesOfMap(e)},e.prototype.getVariables=function(){var e=[];return this.visitAll(this.parseTree,(function(t){"param"===t.type&&e.push(t.value.toLowerCase())})),M(e)},e.prototype.compileMe=function(){var e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",e).bind(d)},e.prototype.extractExpressionInfo=function(e){var t=this,r=[],n=!0,o=!0;return this.visitAll(this.parseTree,(function(s){switch(s.type){case"column_ref":var u=e.get(s.column),l=u&&u.name;!u||"date"!==u.type&&"esriFieldTypeDate"!==u.type||(t.datefields[u.name]=1),void 0!==l?(r.push(l),s.column=l):r.push(s.column);break;case"function":var c=s.name,f=s.args.value.length;n&&(n=a.isStandardized(c,f)),o&&(o=i.isAggregate(c,f))}})),{referencedFieldNames:M(r),isStandardized:n,isAggregate:o}},e.prototype.visitAll=function(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":for(var r=0,n=e.clauses;r<n.length;r++){var i=n[r];this.visitAll(i,t)}"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":for(var a=0,o=e.value;a<o.length;a++)i=o[a],this.visitAll(i,t);break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}},e.prototype.evaluateNodeToJavaScript=function(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case_expression":var t="";if("simple"===e.format){var r="this.makeComparable("+this.evaluateNodeToJavaScript(e.operand)+")";t="( ";for(var n=0;n<e.clauses.length;n++)t+=" ("+r+" === this.makeComparable("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")) ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{for(t="( ",n=0;n<e.clauses.length;n++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t;case"param":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expr_list":for(var i="[",a=0,o=e.value;a<o.length;a++){var s=o[a];"["!==i&&(i+=","),i+=this.evaluateNodeToJavaScript(s)}return i+"]";case"unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary_expr":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")"}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return JSON.stringify(e.value);case"date":return"(new Date("+v(e.value).getTime().toString()+"))";case"timestamp":return"(new Date("+g(e.value).getTime().toString()+"))";case"current_time":return"date"===e.mode?"this.currentDate()":"this.currentTimestamp()";case"column_ref":return"this.featureValue(feature,"+JSON.stringify(e.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+")"}throw new Error("Unsupported sql syntax "+e.type)},e.prototype.evaluateNode=function(e,t,r){switch(e.type){case"interval":var n=this.evaluateNode(e.value,t,r);return a.SqlInterval.createFromValueAndQualifer(n,e.qualifier,e.op);case"case_expression":if("simple"===e.format){for(var o=w(this.evaluateNode(e.operand,t,r)),s=0;s<e.clauses.length;s++)if(o===w(this.evaluateNode(e.clauses[s].operand,t,r)))return this.evaluateNode(e.clauses[s].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}else{for(s=0;s<e.clauses.length;s++)if(m(this.evaluateNode(e.clauses[s].operand,t,r)))return this.evaluateNode(e.clauses[s].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":for(var u=[],l=0,c=e.value;l<c.length;l++){var f=c[l];u.push(this.evaluateNode(f,t,r))}return u;case"unary_expr":return b(this.evaluateNode(e.expr,t,r));case"binary_expr":switch(e.operator){case"AND":return x(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"OR":return S(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t,r);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t,r);case"IN":var h=_(this.evaluateNode(e.right,t,r));return I(this.evaluateNode(e.left,t,r),h);case"NOT IN":return h=_(this.evaluateNode(e.right,t,r)),b(I(this.evaluateNode(e.left,t,r),h));case"BETWEEN":var p=this.evaluateNode(e.left,t,r),d=this.evaluateNode(e.right,t,r);return null==p||null==d[0]||null==d[1]?null:p>=w(d[0])&&p<=w(d[1]);case"NOTBETWEEN":return p=this.evaluateNode(e.left,t,r),d=this.evaluateNode(e.right,t,r),null==p||null==d[0]||null==d[1]?null:p<w(d[0])||p>w(d[1]);case"LIKE":return T(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape);case"NOT LIKE":return b(T(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return P(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"-":case"+":case"*":case"/":return E(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r))}case"null":case"bool":case"string":case"number":return e.value;case"date":return v(e.value);case"timestamp":return g(e.value);case"current_time":var y=new Date;return"date"===e.mode&&y.setHours(0,0,0,0),y;case"column_ref":return F(t,e.column,this.datefields,r);case"function":var M=this.evaluateNode(e.args,t,r);return this.isAggregate?i.aggregateFunction(e.name,M):a.evaluateFunction(e.name,M)}throw new Error("Unsupported sql syntax "+e.type)},e}();function g(e){var t=u.exec(e);if(null!==t)return p(t[1],t[2],t[3],t[4],t[5],t[6]);if(null!==(t=l.exec(e)))return p(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);if(null!==(t=c.exec(e)))return p(t[1],t[2],t[3],t[4],t[5],"0",t[6],t[7],t[8]);if(null!==(t=f.exec(e)))return p(t[1],t[2],t[3],t[4],t[5]);if(null!==(t=s.exec(e)))return p(t[1],t[2],t[3]);throw new Error("SQL Invalid Timestamp")}function v(e){var t=s.exec(e);if(null===t)throw new Error("SQL Invalid Date");var r=t[1],n=t[2],i=t[3];return new Date(parseInt(r,10),parseInt(n,10)-1,parseInt(i,10))}function m(e){return!0===e}function _(e){return Array.isArray(e)?e:[e]}function b(e){return null!==e?!0!==e:null}function x(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function S(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function I(e,t){if(null==e)return null;for(var r=!1,n=0,i=t;n<i.length;n++){var a=i[n];if(null==a)r=null;else if(e===a){r=!0;break}}return r}function T(e,t,r){if(null==e)return null;for(var n=t,i=r,a="",o=0,s=0;s<n.length;s++){var u=n.charAt(s);switch(o){case 0:u===i?o=1:"-[]/{}()*+?.\\^$|".indexOf(u)>=0?a+="\\"+u:a+="%"===u?".*":"_"===u?".":u;break;case 1:"-[]/{}()*+?.\\^$|".indexOf(u)>=0?a+="\\"+u:a+=u,o=0}}return new RegExp("^"+a+"$").test(e)}function w(e){return e instanceof Date?e.valueOf():e}function P(e,t,r){if(null==t||null==r)return null;var n=w(t),i=w(r);switch(e){case"<>":return n!==i;case"=":return n===i;case">":return n>i;case"<":return n<i;case">=":return n>=i;case"<=":return n<=i}}function M(e){for(var t=[],r={},n=0,i=e;n<i.length;n++){var a=i[n],o=a.toLowerCase();void 0===r[o]&&(t.push(a),r[o]=1)}return t}function E(e,t,r){if(t instanceof a.SqlInterval)if(r instanceof Date)switch(e){case"+":return new Date(t.valueInMilliseconds()+r.getTime());case"-":return t.valueInMilliseconds()-r.getTime();case"*":return t.valueInMilliseconds()*r.getTime();case"/":return t.valueInMilliseconds()/r.getTime()}else if(r instanceof a.SqlInterval)switch(e){case"+":return a.SqlInterval.createFromMilliseconds(t.valueInMilliseconds()+r.valueInMilliseconds());case"-":return a.SqlInterval.createFromMilliseconds(t.valueInMilliseconds()-r.valueInMilliseconds());case"*":return t.valueInMilliseconds()*r.valueInMilliseconds();case"/":return t.valueInMilliseconds()/r.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(r instanceof a.SqlInterval)if(t instanceof Date)switch(e){case"+":return new Date(r.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-r.valueInMilliseconds());case"*":return t.getTime()*r.valueInMilliseconds();case"/":return t.getTime()/r.valueInMilliseconds()}else r=r.valueInMilliseconds();else if(t instanceof Date&&"number"==typeof r)switch(r=24*r*60*60*1e3,t=t.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}else if(r instanceof Date&&"number"==typeof t)switch(t=24*t*60*60*1e3,r=r.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r}}function F(e,t,r,n){var i=n.getAttribute(e,t);return null!=i&&1===r[t]?new Date(i):i}t.WhereClause=y,t.defaultAttributeAdapter={getAttribute:function(e,t){var r;return((r=e)&&"object"==typeof r.attributes?e.attributes:e)[t]}}}.apply(null,n))||(e.exports=i)},"2QEt":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("TMur"),r("zp6E"),r("jfWY"),r("Lzvl")],void 0===(i=function(e,t,r,n,i,a,o){Object.defineProperty(t,"__esModule",{value:!0}),t.cut=function(e,t,s,u){return r.__awaiter(this,void 0,void 0,(function(){var l,c,f,h,p,d,y;return r.__generator(this,(function(g){switch(g.label){case 0:return l="string"==typeof e?a.urlToObject(e):e,c=t[0].spatialReference,f=r.__assign(r.__assign({},u),{query:r.__assign(r.__assign({},l.query),{f:"json",sr:JSON.stringify(c),target:JSON.stringify({geometryType:o.getJsonType(t[0]),geometries:t}),cutter:JSON.stringify(s)})}),[4,i(l.path+"/cut",f)];case 1:return h=g.sent(),p=h.data,d=p.cutIndexes,y=p.geometries,[2,{cutIndexes:d,geometries:(void 0===y?[]:y).map((function(e){return n.fromJSON(e).set(c)}))}]}}))}))}}.apply(null,n))||(e.exports=i)},"2xGR":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("H1tY"),r("jEml"),r("2Kdy")],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i={minX:0,minY:0,maxX:0,maxY:0},a=function(){function e(){var e=this;this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=n(9,r("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._loadIndex=function(){if(e._indexInvalid){var t=new Array(e._idByBounds.size),r=0;e._idByBounds.forEach((function(e,n){t[r++]=n})),e._indexInvalid=!1,e._index.clear(),e._index.load(t)}else e._boundsToLoad.length&&(e._index.load(e._boundsToLoad.filter((function(t){return e._idByBounds.has(t)}))),e._boundsToLoad.length=0)}}return e.prototype.clear=function(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()},e.prototype.delete=function(e){var t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))},e.prototype.forEachInBounds=function(e,t){this._loadIndex();for(var r=0,n=function(e,t){return i.minX=t[0],i.minY=t[1],i.maxX=t[2],i.maxY=t[3],e.search(i)}(this._index,e);r<n.length;r++){var a=n[r];t(this._idByBounds.get(a))}},e.prototype.get=function(e){return this._boundsById.get(e)},e.prototype.has=function(e){return this._boundsById.has(e)},e.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)},e.prototype.set=function(e,t){if(!this._indexInvalid){var r=this._boundsById.get(e);r&&(this._index.remove(r),this._idByBounds.delete(r))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))},e}();t.BoundsStore=a}.apply(null,n))||(e.exports=i)},"4/qq":function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}}.apply(null,n))||(e.exports=i)},"6/KI":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("8uEs"),r("nrlZ"),r("/COu"),r("xJgq"),r("Jvs9")],void 0===(i=function(e,t,r,n,i,a,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){this.options=e,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"]}return e.prototype.createFeatureResult=function(){return new a.default},e.prototype.prepareFeatures=function(){},e.prototype.finishFeatureResult=function(e){if(e&&e.features&&e.hasZ&&this.options.sourceSpatialReference&&e.spatialReference&&!n.equals(e.spatialReference,this.options.sourceSpatialReference)&&!e.spatialReference.vcsWkid){var t=r.getMetersPerVerticalUnitForSR(this.options.sourceSpatialReference)/r.getMetersPerVerticalUnitForSR(e.spatialReference);if(1!==t)for(var i=0,a=e.features;i<a.length;i++){var o=a[i];if(o.geometry&&o.geometry.coords)for(var s=o.geometry.coords,u=2;u<s.length;u+=3)s[u]*=t}}},e.prototype.addFeature=function(e,t){e.features.push(t)},e.prototype.createFeature=function(){return new i.default},e.prototype.createSpatialReference=function(){return{wkid:0}},e.prototype.createGeometry=function(){return new o.default},e.prototype.addField=function(e,t){e.fields.push(t)},e.prototype.addCoordinate=function(e,t){e.coords.push(t)},e.prototype.addCoordinatePoint=function(e,t){e.coords.push(t)},e.prototype.addLength=function(e,t){e.lengths.push(t)},e.prototype.createPointGeometry=function(){return new o.default},e}();t.Context=s}.apply(null,n))||(e.exports=i)},"700l":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("LxLY"),r("Ytki")],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=t;var i=e.outFields;if(i&&-1===i.indexOf("*")){this.outFields=i;for(var a=0,o=0,s=i;o<s.length;o++){var u=s[o],l=n.getExpressionFromFieldName(u),c=this.fieldsIndex.get(l),f=c?null:n.getWhereClause(l,r),h=c?c.name:n.getAliasFromFieldName(u)||"FIELD_EXP_"+a++;this._fieldDataCache.set(u,{alias:h,clause:f})}}}return e.prototype.getAttributes=function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)},e.prototype.getFieldValue=function(e,t,r){var i=r?r.name:t,a=null;return this._fieldDataCache.has(i)?a=this._fieldDataCache.get(i).clause:r||(a=n.getWhereClause(t,this.fieldsIndex),this._fieldDataCache.set(i,{alias:i,clause:a})),r?this.featureAdapter.getAttribute(e,i):a.calculateValue(e,this.featureAdapter)},e.prototype.validateItem=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)},e.prototype.validateItems=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)},e.prototype._processAttributesForOutFields=function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);for(var r={},n=0,i=t;n<i.length;n++){var a=i[n],o=this._fieldDataCache.get(a),s=o.alias,u=o.clause;r[s]=u?u.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,s)}return r},e.prototype._processAttributesForDistinctValues=function(e){if(r.isNone(e)||!this.returnDistinctValues)return e;var t=this.outFields,n=[];if(t)for(var i=0,a=t;i<a.length;i++){var o=a[i],s=this._fieldDataCache.get(o).alias;n.push(e[s])}else for(var s in e)n.push(e[s]);var u=(t||["*"]).join(",")+"="+n.join(","),l=this._returnDistinctMap.get(u)||0;return this._returnDistinctMap.set(u,++l),l>1?null:e},e}();t.default=i}.apply(null,n))||(e.exports=i)},"8pdz":function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=new Float64Array(2),n=new Float64Array(2);function i(e){return e<=57?e-48:e<=104?e-88:e<=107?e-89:e<=110?e-90:e-91}function a(e){return"0123456789bcdefghjkmnpqrstuvwxyz"[e]}function o(e){return(e[0]+e[1])/2}function s(e,t,r){return e[0]=t,e[1]=r,e}function u(e,t){var r=o(e),n=t,i=!t;e[0]=i*e[0]+n*r,e[1]=i*r+n*e[1]}function l(e,t){var r=t>o(e);return u(e,r),r}function c(e,t){for(var a=s(r,-90,90),l=s(n,-180,180),c=0;c<t.length;c++){var f=i(t.charCodeAt(c));c%2==0?(u(l,!!(16&f)),u(l,!!(4&f)),u(l,!!(1&f)),u(a,!!(8&f)),u(a,!!(2&f))):(u(a,!!(16&f)),u(a,!!(4&f)),u(a,!!(1&f)),u(l,!!(8&f)),u(l,!!(2&f)))}return e[0]=o(a),e[1]=o(l),e}function f(e,t,i){for(var o="",u=s(r,-90,90),c=s(n,-180,180),f=0;f<i;f++){var h=0;f%2?(h|=l(u,e)<<4,h|=l(c,t)<<3,h|=l(u,e)<<2,h|=l(c,t)<<1,h|=l(u,e)<<0):(h|=l(c,t)<<4,h|=l(u,e)<<3,h|=l(c,t)<<2,h|=l(u,e)<<1,h|=l(c,t)<<0),o+=a(h)}return o}function h(e){var t=Math.floor(5*e/2);return 180/Math.pow(2,t)}function p(e){var t=Math.ceil(5*e/2);return 360/Math.pow(2,t)}function d(e,t){return t?1&e|(4&e)>>1|(16&e)>>2:(2&e)>>1|(8&e)>>2}function y(e,t){return t?(2&e)>>1|(8&e)>>2:1&e|(4&e)>>1|(16&e)>>2}function g(e,t,r){var n=!((e.length-1)%2),o=e.substring(0,e.length-1),s=i(e.charCodeAt(e.length-1)),u=0,l=0,c=0,f=0;n?(u=8,l=4,c=1&s|(4&s)>>1|(16&s)>>2,f=(2&s)>>1|(8&s)>>2):(u=4,l=8,f=1&s|(4&s)>>1|(16&s)>>2,c=(2&s)>>1|(8&s)>>2);var h=c+t,p=f+r,d=Math.floor(h/u),y=Math.floor(p/l),v=a(function(e,t,r){return r?1&e|(1&t)<<1|(2&e)<<1|(2&t)<<2|(4&e)<<2:1&t|(1&e)<<1|(2&t)<<1|(2&e)<<2|(4&t)<<2}(h-d*u,p-y*l,n));return e.length>1&&(d||y)?g(o,d,y)+v:o+v}t.decodeBase32Char=i,t.encodeBase32Char=a,t.decodeGeohash=c,t.convertGeohash32ToXY=function(e,t){for(var r=0,n=0,a=30,o=30,s=0;s<t.length;s++){var u=i(t.charCodeAt(s)),l=s%2==0;r|=d(u,l)<<(a-=l?3:2),n|=y(u,l)<<(o-=l?2:3)}return{geohashX:r,geohashY:n}},t.decodeGeohashXY=function(e,t){for(var r=-90,n=90,i=-180,a=180,o=0;o<t;o++){for(var s=Math.ceil((o+1)/2),u=Math.floor((o+1)/2),l=1-o%2,c=30-(3*s+2*u),f=30-(2*s+3*u),h=3*l+2*(1-l),p=2*l+3*(1-l),d=3*l+7*(1-l)<<f,y=(7*l+3*(1-l)<<c&e.geohashX)>>c,g=(d&e.geohashY)>>f,v=h-1;v>=0;v--){var m=(i+a)/2,_=y&1<<v?1:0;i=(1-_)*i+_*m,a=(1-_)*m+_*a}for(v=p-1;v>=0;v--){var b=(r+n)/2,x=g&1<<v?1:0;r=(1-x)*r+x*b,n=(1-x)*b+x*n}}return[i,r,a,n]},t.setGeohashXY=function(e,t,r,n){n%2&&(n+=1);for(var i=0,a=0,o=-90,s=90,u=-180,l=180,c=0;c<n/2;c++){for(var f=0;f<5;f++){var h=(u+l)/2,p=r>h?1:0;i|=p<<29-(f+5*c),u=(1-p)*u+p*h,l=(1-p)*h+p*l}for(f=0;f<5;f++){var d=(o+s)/2,y=t>d?1:0;a|=y<<29-(f+5*c),o=(1-y)*o+y*d,s=(1-y)*d+y*s}}e.geohashX=i,e.geohashY=a},t.encodeGeohash=f,t.latDistPerGeohash=h,t.lonDistPerGeohash=p,t.unpackXBits=d,t.unpackYBits=y,t.getRelativeGeohash=g,t.getIntersectingGeohashes=function(e,t,r,n,i){for(var a=Math.abs(r-e),o=Math.abs(n-t),s=h(i),u=p(i),l=Math.ceil(o/u),c=Math.ceil(a/s),d=f(e,t,i),y=new Array,v=0;v<l;v++)for(var m=0;m<c;m++)y.push(g(d,v,m));return y},t.forEachIntersectingGeohash=function(e,t,r,n,i,a){for(var o=Math.abs(r-e),s=Math.abs(n-t),u=h(i),l=p(i),d=Math.ceil(s/l),y=Math.ceil(o/u),v=f(e,t,i),m=0;m<d;m++)for(var _=0;_<y;_++){var b=g(v,m,_),x=c([0,0],b),S=x[0],I=x[1],T=S-u/2,w=I-l/2,P=S+u/2,M=I+l/2,E=u*l,F=Math.max(e,T),N=Math.max(t,w),R=Math.min(r,P)-F,O=Math.min(n,M)-N;a(b,Math.abs(R*O)/E)}}}.apply(null,n))||(e.exports=i)},"9K5t":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("/COu"),r("Jvs9")],void 0===(i=function(e,t,r,n,i,a){Object.defineProperty(t,"__esModule",{value:!0});var o={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function s(e){var t,n,i;return r.__generator(this,(function(r){switch(r.label){case 0:switch(e.type){case"Feature":return[3,1];case"FeatureCollection":return[3,3]}return[3,7];case 1:return[4,e];case 2:return r.sent(),[3,7];case 3:t=0,n=e.features,r.label=4;case 4:return t<n.length?(i=n[t])?[4,i]:[3,6]:[3,7];case 5:r.sent(),r.label=6;case 6:return t++,[3,4];case 7:return[2]}}))}function u(e){for(var t=0,r=0;r<e.length;r++){var n=e[r],i=e[(r+1)%e.length];t+=n[0]*i[1]-i[0]*n[1]}return t<=0}function l(e){var t=e[0],r=e[e.length-1];return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]||e.push(t),e}function c(e,t,r){var n=l(t);u(n)?h(e,n,r):p(e,n,r)}function f(e,t,r){var n=l(t);u(n)?p(e,n,r):h(e,n,r)}function h(e,t,r){for(var n=0,i=t;n<i.length;n++)d(e,i[n],r);e.lengths.push(t.length)}function p(e,t,r){for(var n=t.length-1;n>=0;n--)d(e,t[n],r);e.lengths.push(t.length)}function d(e,t,r){var n=t[0],i=t[1],a=t[2];e.coords.push(n,i),r.hasZ&&e.coords.push(a||0)}function y(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}t.validateGeoJSON=function(e){if(!e)throw new n("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new n("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});var t=e.crs;if(t){var r="string"==typeof t?t:"name"===t.type?t.properties.name:null,i=new RegExp(".*(CRS84H?|4326)$","i");if(!r||!i.test(r))throw new n("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:t})}},t.inferLayerProperties=function(e,t){void 0===t&&(t={});for(var n=s(e),i=[],a=new Set,u=new Set,l=!1,c=Number.NEGATIVE_INFINITY,f=null,h=!1,p=void 0,d=t.geometryType,g=void 0===d?null:d,v=!1,m=function(){var e,t,s=n.next(),d=s.value;if(s.done){var m=f&&1===f.length&&f[0]||null;if(m)for(var _=0,b=i;_<b.length;_++){var x=b[_];x.name===m&&(x.type="esriFieldTypeOID")}return{value:{fields:i,geometryType:g,hasZ:l,maxObjectId:Math.max(0,c),objectIdFieldName:m,objectIdFieldType:p,unknownFields:(e=u,t=[],e.forEach((function(e){return t.push(e)})),t)}}}var S=d.geometry,I=d.properties,T=d.id;if(S&&(g||(g=o[S.type]),o[S.type]!==g))return"continue";if(!l){var w=function(e){var t,n,i,a,o,s,u,l,c;return r.__generator(this,(function(f){switch(f.label){case 0:if(!e)return[2,null];switch(e.type){case"Point":return[3,1];case"LineString":case"MultiPoint":return[3,3];case"MultiLineString":case"Polygon":return[3,5];case"MultiPolygon":return[3,10]}return[3,17];case 1:return[4,e.coordinates];case 2:return f.sent(),[3,17];case 3:return[5,r.__values(e.coordinates)];case 4:return f.sent(),[3,17];case 5:t=0,n=e.coordinates,f.label=6;case 6:return t<n.length?(i=n[t],[5,r.__values(i)]):[3,9];case 7:f.sent(),f.label=8;case 8:return t++,[3,6];case 9:return[3,17];case 10:a=0,o=e.coordinates,f.label=11;case 11:if(!(a<o.length))return[3,16];s=o[a],u=0,l=s,f.label=12;case 12:return u<l.length?(c=l[u],[5,r.__values(c)]):[3,15];case 13:f.sent(),f.label=14;case 14:return u++,[3,12];case 15:return a++,[3,11];case 16:return[3,17];case 17:return[2]}}))}(S);l=function(e){for(;;){var t=e.next(),r=t.value;if(t.done)return!1;if(r.length>2)return!0}}(w)}if(h||(h=null!=T)&&"number"==(p=typeof T)&&(f=Object.keys(I).filter((function(e){return I[e]===T}))),h&&"number"===p&&null!=T&&(c=Math.max(c,T),f.length>1?f=f.filter((function(e){return I[e]===T})):1===f.length&&(f=I[f[0]]===T?f:[])),!v&&I){var P=!0;for(var M in I)if(!a.has(M)){var E=I[M];if(null!=E){var F=y(E);"unknown"!==F?(u.delete(M),a.add(M),i.push({name:M,alias:M,type:F})):u.add(M)}else P=!1,u.add(M)}v=P}};;){var _=m();if("object"==typeof _)return _.value}},t.createOptimizedFeatures=function(e,t){return function(e){for(var t=[];;){var r=e.next(),n=r.value;if(r.done)return t;t.push(n)}}(function(e,t){var n,s,u,l,p,y,g,v;return void 0===t&&(t={}),r.__generator(this,(function(r){switch(r.label){case 0:n=t.geometryType,s=t.objectIdFieldName,r.label=1;case 1:return u=e.next(),l=u.value,u.done?[2]:(p=l.geometry,y=l.properties,g=l.id,p&&o[p.type]!==n?[3,1]:(v=y||{},s&&null!=g&&!v[s]&&(v[s]=g),[4,new i.default(p?function(e,t,r){switch(t.type){case"LineString":return function(e,t,r){return h(e,t.coordinates,r),e}(e,t,r);case"MultiLineString":return function(e,t,r){for(var n=0,i=t.coordinates;n<i.length;n++){h(e,i[n],r)}return e}(e,t,r);case"MultiPoint":return function(e,t,r){return h(e,t.coordinates,r),e}(e,t,r);case"MultiPolygon":return function(e,t,r){for(var n=0,i=t.coordinates;n<i.length;n++){var a=i[n];c(e,a[0],r);for(var o=1;o<a.length;o++)f(e,a[o],r)}return e}(e,t,r);case"Point":return function(e,t,r){return d(e,t.coordinates,r),e}(e,t,r);case"Polygon":return function(e,t,r){var n=t.coordinates;c(e,n[0],r);for(var i=1;i<n.length;i++)f(e,n[i],r);return e}(e,t,r)}}(new a.default,p,t):null,v)]));case 2:return r.sent(),[3,1];case 3:return[2]}}))}(s(e),t))}}.apply(null,n))||(e.exports=i)},B16N:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("zp6E"),r("LxLY"),r("qMld"),r("jfWY"),r("Lzvl"),r("fw2w"),r("xJgq"),r("G+Sd"),r("cGHk"),r("HoQt"),r("2Kdy")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h){function p(e,t){var r=e.geometry,n=e.toJSON(),i=n;if(r&&(i.geometry=JSON.stringify(r),i.geometryType=s.getJsonType(r),i.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),n.groupByFieldsForStatistics&&(i.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(i.objectIds=n.objectIds.join(",")),n.orderByFields&&(i.orderByFields=n.orderByFields.join(",")),!n.outFields||t&&(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)?delete i.outFields:-1!==n.outFields.indexOf("*")?i.outFields="*":i.outFields=n.outFields.join(","),n.outSR?i.outSR=n.outSR.wkid||JSON.stringify(n.outSR):r&&(n.returnGeometry||n.returnCentroid)&&(i.outSR=i.inSR),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(i.outStatistics=JSON.stringify(n.outStatistics)),n.pixelSize&&(i.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(i.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.source&&(i.layer=JSON.stringify({source:n.source}),delete n.source),n.timeExtent){var a=n.timeExtent,o=a.start,u=a.end;null==o&&null==u||(i.time=o===u?o:(null==o?"null":o)+","+(null==u?"null":u)),delete n.timeExtent}return i}function d(e,t,a,s,l){void 0===s&&(s={});var c="string"==typeof e?o.urlToObject(e):e,h=t.geometry?[t.geometry]:[];return s.responseType="pbf"===a?"array-buffer":"json",u.normalizeCentralMeridian(h,null,s).then((function(e){var o=e&&e[0];i.isSome(o)&&((t=t.clone()).geometry=o);var u=f.mapParameters(r.__assign(r.__assign(r.__assign(r.__assign({},c.query),{f:a}),l),p(t,l)));return n(c.path+"/query",r.__assign(r.__assign({},s),{query:u}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.queryToQueryStringParameters=p,t.executeQuery=function(e,t,n,i){var a;return r.__awaiter(this,void 0,void 0,(function(){var o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return(null===(a=t.timeExtent)||void 0===a?void 0:a.isEmpty)?(s={data:{features:[]}},[3,3]):[3,1];case 1:return[4,d(e,t,"json",i)];case 2:s=r.sent(),r.label=3;case 3:return o=s,h.applyFeatureSetZUnitScaling(t,n,o.data),[2,o]}}))}))},t.executeQueryPBF=function(e,t,r,n){var i;return(null===(i=t.timeExtent)||void 0===i?void 0:i.isEmpty)?a.resolve({data:new l.default}):d(e,t,"pbf",n).then((function(e){var t,n;return t=c.parsePBFFeatureQuery(e.data,r),(n=e).data=t,n}))},t.executeQueryForIds=function(e,t,r){var n;return(null===(n=t.timeExtent)||void 0===n?void 0:n.isEmpty)?a.resolve({data:{objectIds:[]}}):d(e,t,"json",r,{returnIdsOnly:!0})},t.executeQueryForCount=function(e,t,r){var n;return(null===(n=t.timeExtent)||void 0===n?void 0:n.isEmpty)?a.resolve({data:{count:0}}):d(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})},t.executeQueryForExtent=function(e,t,r){var n;return(null===(n=t.timeExtent)||void 0===n?void 0:n.isEmpty)?a.resolve({data:{count:0,extent:null}}):d(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error("Layer does not support extent calculation.");if(t.hasOwnProperty("count"))throw new Error("Layer does not support extent calculation.");return e}))},t.runQuery=d}.apply(null,n))||(e.exports=i)},Btct:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("7MDj"),r("H1tY"),r("qsST"),r("LxLY"),r("qMld"),r("Vx27"),r("Ytki"),r("ZooB"),r("I90O"),r("hz/Y"),r("IpeC"),r("YaB4"),r("lvbU"),r("0SZq"),r("oWCy")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d,y,g,v,m){Object.defineProperty(t,"__esModule",{value:!0});var _=o.getLogger("esri.views.2d.layers.features.controllers.BaseController"),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._availableFields=[],t._pixelBuffer=0,t.config=null,t.filters=new Array(y.definitions.MAX_FILTERS),t.processor=null,t.remoteClient=null,t.service=null,t.tileStore=null,t}return r.__extends(t,e),t.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]),this._initAttributeStore()},t.prototype.startup=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this._initAttributeStore(),[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)];case 1:return e.sent(),[4,u.all([this.attributeStore.updateFilters(this),this.updatePixelBuffer()])];case 2:return e.sent(),[2]}}))}))},t.prototype.destroy=function(){this.attributeStore&&this.attributeStore.destroy()},Object.defineProperty(t.prototype,"arcadeInfo",{get:function(){return{geometryType:this.service.geometryType,fields:this.service.fields,spatialReference:this.spatialReference}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"featureReduction",{get:function(){return this.config.featureReduction},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldsIndex",{get:function(){return new h(this.service.fields)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geometryInfo",{get:function(){return{geometryType:this.service.geometryType,hasZ:!1,hasM:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"returnCentroid",{get:function(){return this._get("returnCentroid")||function(e,t,r){if("esriGeometryPolygon"===t&&e.labelingInfo)return!0;if("esriGeometryPolygon"!==t)return!1;function n(e){if(!e)return!1;var t=e.type;return"simple-marker"===t||"picture-marker"===t||"text"===t||"web-style"===t||"cim"===t}switch(r.type){case"simple":return n(r.symbol);case"unique-value":return n(r.defaultSymbol)||r.uniqueValueInfos.some((function(e){return n(e.symbol)}));case"class-breaks":return n(r.defaultSymbol)||r.classBreakInfos.some((function(e){return n(e.symbol)}));case"dot-density":return!1;default:return!0}}(this.config,this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"returnOutline",{get:function(){return function(e,t){switch(e){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryMultipoint":return!0;case"esriGeometryPolygon":return function(e){var t=e&&e.getSymbols();return"backgroundFillSymbol"in e&&null!=e.backgroundFillSymbol&&"outline"in e.backgroundFillSymbol&&null!=e.backgroundFillSymbol.outline||t.some((function(e){return"outline"in e&&null!=e.outline}))}(t)}}(this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryInfo",{get:function(){return{returnCentroid:this.returnCentroid,returnGeometry:!0,outFields:this.availableFields,definitionExpression:this.config.definitionExpression,gdbVersion:this.config.gdbVersion,historicMoment:this.config.historicMoment}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this.config?p.fromJSON(this.config.renderer):(_.error("mapview-controller","Unable to create renderer for undefined configuration"),null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availableFields",{get:function(){var e=this,t=this.config.availableFields.filter((function(t){return-1===e._availableFields.indexOf(t)}));return this._availableFields=r.__spreadArrays(this._availableFields,t),this._availableFields},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewParams",{get:function(){return{viewingMode:"",scale:this.viewState&&this.viewState.scale||1}},enumerable:!0,configurable:!0}),t.prototype.getObjectId=function(e){return this.attributeStore.getFeatureId(e)},t.prototype.getAggregate=function(e){return null},t.prototype.getAggregateValueRanges=function(){return{}},t.prototype.getLocalId=function(e){return this.attributeStore.getLocalId(e)},t.prototype.mapValidLocalIds=function(e){var t=this;return e.map((function(e){return t.attributeStore.getLocalId(e)})).filter((function(e){return null!=e}))},t.prototype.setViewState=function(e){this._set("viewState",e)},t.prototype.updatePixelBuffer=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return[4,m.computePxBuffer(this.renderer,this.service.geometryType)];case 1:return e=t.sent(),this._pixelBuffer=Math.max(this._pixelBuffer,e),[2]}}))}))},t.prototype.setHighlight=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,this.attributeStore.setHighlight(e)]}))}))},t.prototype.validateConfig=function(e){for(var t=0,r=e.filters;t<r.length;t++){var i=r[t];if(s.isSome(i)&&i.where)try{c.validateWhere(this.fieldsIndex,i.where)}catch(e){throw new n("mapview-bad-filter",e.message,{filter:i,missingFields:e.details})}}},t.prototype.onFeatureAdd=function(e){e.localId=this.attributeStore.createLocalId(e.objectId),this.attributeStore.setAttributeData(e.localId,e,this.geometryInfo,this.viewParams)},t.prototype.onFeatureRemove=function(e){!e.localId&&a("esri-2d-debug"),this.attributeStore.freeLocalId(e.objectId)},t.prototype.enableEvent=function(e){},t.prototype._initAttributeStore=function(){var e=this;this.attributeStore?this.attributeStore.invalidateResources():this.attributeStore=new g.default({type:"remote",initialize:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",t,{signal:r})},update:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",t,{signal:r})},render:function(){return e.remoteClient.invoke("tileRenderer.featuresView.requestRender")}})},t.prototype._createQueryEngine=function(e){return new f.default({definitionExpression:this.config.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:e,timeInfo:this.service.timeInfo})},t.prototype._createTempQueryEngine=function(e){return void 0===e&&(e=this._createFeatureStore()),this._createQueryEngine(e)},t.prototype._createFeatureStore=function(){var e={geometryType:this.service.geometryType,hasM:!1,hasZ:!1};return new v.ClusterStore(e,this.spatialReference,this.attributeStore,this.featureReduction)},t.prototype._createDefaultQuery=function(e){var t=new d,r=e.outFields,n=this.config,i=n.gdbVersion,a=n.historicMoment,o=n.definitionExpression;return r=r.length/this.service.fields.length>=.75?["*"]:r,t.gdbVersion=i,t.historicMoment=null!=a?new Date(a):null,t.num=e.num,t.outFields=r,t.outSpatialReference=this.spatialReference,t.returnGeometry=e.returnGeometry,t.returnCentroid=e.returnCentroid,t.start=e.resultOffset,t.where=o||"1=1",t},t.prototype.hasGeometryFilter=function(){return this.filters.some((function(e){return s.isSome(e)&&!!e.geometry}))},r.__decorate([l.property({readOnly:!0,dependsOn:["config","service","spatialReference"]})],t.prototype,"arcadeInfo",null),r.__decorate([l.property()],t.prototype,"config",void 0),r.__decorate([l.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"featureReduction",null),r.__decorate([l.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"fieldsIndex",null),r.__decorate([l.property()],t.prototype,"filters",void 0),r.__decorate([l.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"geometryInfo",null),r.__decorate([l.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"returnCentroid",null),r.__decorate([l.property({readOnly:!0,dependsOn:["service","config"]})],t.prototype,"returnOutline",null),r.__decorate([l.property({readOnly:!0,dependsOn:["config","availableFields"]})],t.prototype,"queryInfo",null),r.__decorate([l.property({dependsOn:["config"],readOnly:!0})],t.prototype,"renderer",null),r.__decorate([l.property()],t.prototype,"processor",void 0),r.__decorate([l.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"availableFields",null),r.__decorate([l.property({constructOnly:!0})],t.prototype,"remoteClient",void 0),r.__decorate([l.property({constructOnly:!0})],t.prototype,"service",void 0),r.__decorate([l.property({dependsOn:["tileStore"]})],t.prototype,"spatialReference",null),r.__decorate([l.property({constructOnly:!0})],t.prototype,"tileInfo",void 0),r.__decorate([l.property({constructOnly:!0})],t.prototype,"tileStore",void 0),r.__decorate([l.property({readOnly:!0})],t.prototype,"viewState",void 0),r.__decorate([l.property({readOnly:!0,dependsOn:["viewState"]})],t.prototype,"viewParams",null),r.__decorate([l.subclass("esri.views.2d.layers.features.controllers.BaseController")],t)}(i.HandleOwner);t.default=b}.apply(null,n))||(e.exports=i)},DaHD:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("H1tY"),r("rg9i"),r("35hF")],void 0===(i=function(e,t,r,n,i,a){Object.defineProperty(t,"__esModule",{value:!0}),t.createDrawingInfo=function(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?a.defaultPointSymbolJSON:"esriGeometryPolyline"===e?a.defaultPolylineSymbolJSON:a.defaultPolygonSymbolJSON}}},t.createDefaultAttributesFunction=function(e,t){if(n("csp-restrictions"))return function(){var n;return r.__assign(((n={})[t]=null,n),e)};try{var i="this."+t+" = null;";for(var a in e)i+="this."+a+" = "+JSON.stringify(e[a])+";";var o=new Function(i);return function(){return new o}}catch(n){return function(){var n;return r.__assign(((n={})[t]=null,n),e)}}},t.createDefaultTemplate=function(e){return void 0===e&&(e={}),[{name:"New Feature",description:"",prototype:{attributes:i.clone(e)}}]}}.apply(null,n))||(e.exports=i)},Fzzg:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function n(e,t,n,i,a,o){for(var s=r(a,o),u=n,l=n+s,c=0,f=0,h=0,p=0,d=0,y=0,g=i-1;y<g;y++,u+=s,l+=s){var v=t[u],m=t[u+1],_=t[u+2],b=t[l],x=t[l+1],S=t[l+2],I=v*x-b*m;p+=I,c+=(v+b)*I,f+=(m+x)*I,a&&(h+=(_+S)*(I=v*S-b*_),d+=I),v<e[0]&&(e[0]=v),v>e[1]&&(e[1]=v),m<e[2]&&(e[2]=m),m>e[3]&&(e[3]=m),a&&(_<e[4]&&(e[4]=_),_>e[5]&&(e[5]=_))}if(p>0&&(p*=-1),d>0&&(d*=-1),!p)return null;var T=[c,f,.5*p];return a&&(T[3]=h,T[4]=.5*d),T}function i(e,t,n,i,l){for(var c=r(i,l),f=t,h=t+c,p=0,d=0,y=0,g=0,v=0,m=n-1;v<m;v++,f+=c,h+=c){var _,b=e[f],x=e[f+1],S=e[f+2],I=e[h],T=e[h+1],w=e[h+2],P=i?o(b,x,S,I,T,w):a(b,x,I,T);P&&(p+=P,i?(d+=P*(_=u(b,x,S,I,T,w))[0],y+=P*_[1],g+=P*_[2]):(d+=P*(_=s(b,x,I,T))[0],y+=P*_[1]))}return p>0?i?[d/p,y/p,g/p]:[d/p,y/p]:n>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function a(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function o(e,t,r,n,i,a){var o=n-e,s=i-t,u=a-r;return Math.sqrt(o*o+s*s+u*u)}function s(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function u(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCentroidOptimizedGeometry=function(e,t,a,o){if(!t||!t.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);for(var s=e.coords,u=[],l=a?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],c=t.lengths,f=t.coords,h=r(a,o),p=0,d=0,y=c;d<y.length;d++){var g=y[d],v=n(l,f,p,g,a,o);v&&u.push(v),p+=g*h}if(u.sort((function(e,t){var r=e[2]-t[2];return 0===r&&a&&(r=e[4]-t[4]),r})),u.length){var m=6*u[0][2];s[0]=u[0][0]/m,s[1]=u[0][1]/m,a&&(m=6*u[0][4],s[2]=0!==m?u[0][3]/m:0),(s[0]<l[0]||s[0]>l[1]||s[1]<l[2]||s[1]>l[3]||a&&(s[2]<l[4]||s[2]>l[5]))&&(s.length=0)}if(!s.length){var _=t.lengths[0]?i(f,0,c[0],a,o):null;if(!_)return null;s[0]=_[0],s[1]=_[1],a&&_.length>2&&(s[2]=_[2])}return e},t.lineCentroid=i}.apply(null,n))||(e.exports=i)},"G+Sd":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("YhCz")],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.parsePBFFeatureQuery=function(e,t){var n=r.parseFeatureQuery(e,t).queryResult.featureResult;if(n&&n.features&&n.features.length&&n.objectIdFieldName)for(var i=n.objectIdFieldName,a=0,o=n.features;a<o.length;a++){var s=o[a];s.attributes&&(s.objectId=s.attributes[i])}return n}}.apply(null,n))||(e.exports=i)},GI9R:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("zp6E"),r("KY0m"),r("ma1f"),r("qsST"),r("nrlZ"),r("+6sX"),r("xJgq"),r("Q2Em"),r("Q2Em"),r("9K5t"),r("DaHD"),r("I90O"),r("Q3lp"),r("w1v0")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d,y,g){Object.defineProperty(t,"__esModule",{value:!0});var v=o.getLogger("esri.layers.graphics.sources.ogcfeature");function m(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,_(e,t,n)];case 1:return i=r.sent(),[2,u.convertToFeatureSet(i)]}}))}))}function _(e,t,i){var a;return r.__awaiter(this,void 0,void 0,(function(){var o,p,d,y,g,v,m,_,b,x,S,I,T,w,P,M,E,F,N,R,O,A,C,j,G,k,L,q,D,z,B,Q,Z;return r.__generator(this,(function(V){switch(V.label){case 0:return o=e.capabilities.query.maxRecordCount,p=e.collectionId,d=e.layerDefinition,y=e.url,g=y+"/collections/"+p+"/items",v=t.geometry,m=t.num,_=t.outSpatialReference,b=t.start,x=t.timeExtent,S=t.where,I=f.project(v,s.WGS84),T=function(e){return e?e.xmin+","+e.ymin+","+e.xmax+","+e.ymax:null}(I),w=function(e){if(!e)return null;var t=e.start,r=e.end;return(t?t.toISOString():"..")+"/"+(r?r.toISOString():"..")}(x),P=function(e){return e&&"1=1"!==e?e:null}(S),M=null!=b?b:0,E=null!=m?m:null!=b&&void 0!==b?10:o,[4,n(g,r.__assign(r.__assign({},i),{query:{bbox:T,datetime:w,query:P,limit:E,startindex:M,f:"application/geo+json"}}))];case 1:if(F=V.sent().data,N=null===(a=F.links)||void 0===a?void 0:a.filter((function(e){return"next"===e.rel})),R=0!==(null==N?void 0:N.length),O=d.fields,A=d.globalIdField,C=d.hasM,j=d.hasZ,G=d.objectIdField,k=d.geometryType,L=h.createOptimizedFeatures(F,{geometryType:k,hasZ:j,objectIdFieldName:G}),!s.equals(_,s.WGS84))for(q=0,D=L;q<D.length;q++)(Q=D[q]).geometry&&(Q.geometry=u.convertFromGeometry(c.project(u.convertToGeometry(Q.geometry,k,j,!1),s.WGS84,_)));for(z=0,B=L;z<B.length;z++)(Q=B[z]).objectId=Q.attributes[G];return(Z=new l.default).exceededTransferLimit=R,Z.features=L,Z.fields=O,Z.geometryType=k,Z.globalIdFieldName=A,Z.hasM=C,Z.hasZ=j,Z.objectIdFieldName=G,Z.spatialReference=_||s.WGS84,[2,Z]}}))}))}t.getCollectionDefinition=function(e,t,o,u,l){return void 0===l&&(l=5),r.__awaiter(this,void 0,void 0,(function(){var f,g,m,_,b,x,S,I,T,w,P,M,E,F,N;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,c.checkProjectionSupport(s.WGS84,o.spatialReference)];case 1:return r.sent(),[3,3];case 2:throw r.sent(),new a("ogc-feature-layer:projection-not-supported","Projection not supported");case 3:return[4,n(e+"/collections/"+t+"/items",{signal:u,query:{limit:l,f:"application/geo+json"}})];case 4:return f=r.sent().data,[4,h.validateGeoJSON(f)];case 5:if(r.sent(),g=h.inferLayerProperties(f,{geometryType:o.geometryType}),m=o.fields||g.fields||[],_=null!=o.hasZ?o.hasZ:g.hasZ,b=g.geometryType,x=o.objectIdField||g.objectIdFieldName||"OBJECTID",S=o.timeInfo,I=i.find(m,(function(e){return e.name===x})))I.type="esriFieldTypeOID",I.editable=!1,I.nullable=!1;else{if(!g.objectIdFieldType)throw new a("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");m.unshift({name:x,alias:x,type:"esriFieldTypeOID",editable:!1,nullable:!1})}if(x!==g.objectIdFieldName&&(P=i.find(m,(function(e){return e.name===g.objectIdFieldName})))&&(P.type="esriFieldTypeInteger"),!b)throw new a("ogc-feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");for(m===g.fields&&g.unknownFields.length>0&&v.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:g.unknownFields}}),T=0,w=m;T<w.length;T++){if(null==(P=w[T]).name&&(P.name=P.alias),null==P.alias&&(P.alias=P.name),"esriFieldTypeOID"!==P.type&&"esriFieldTypeGlobalID"!==P.type&&(P.editable=null==P.editable||!!P.editable,P.nullable=null==P.nullable||!!P.nullable),!P.name)throw new a("ogc-feature-layer:invalid-field-name","field name is missing",{field:P});if(-1===y.kebabDict.jsonValues.indexOf(P.type))throw new a("ogc-feature-layer:invalid-field-type",'invalid type for field "'+P.name+'"',{field:P})}return S&&(M=new d(m),S.startTimeField&&((E=M.get(S.startTimeField))?(S.startTimeField=E.name,E.type="esriFieldTypeDate"):S.startTimeField=null),S.endTimeField&&((F=M.get(S.endTimeField))?(S.endTimeField=F.name,F.type="esriFieldTypeDate"):S.endTimeField=null),S.trackIdField&&((N=M.get(S.trackIdField))?S.trackIdField=N.name:(S.trackIdField=null,v.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:S}}))),S.startTimeField||S.endTimeField||(v.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:S}}),S=null)),[2,{drawingInfo:p.createDrawingInfo(b),geometryType:b,fields:m,hasZ:!!_,objectIdField:x,timeInfo:S}]}}))}))},t.getServerCollection=function(e,t,i,a){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,n(e+"/collections/"+t,{signal:a,query:{f:i}})];case 1:return[2,r.sent().data]}}))}))},t.getServerCollections=function(e,t,i){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,n(e+"/collections",{signal:i,query:{f:t}})];case 1:return[2,r.sent().data]}}))}))},t.getServerConformance=function(e,t,i){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,n(e+"/conformance",{signal:i,query:{f:t}})];case 1:return[2,r.sent().data]}}))}))},t.getServerLandingPage=function(e,t,i){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,n(e,{signal:i,query:{f:t}})];case 1:return[2,r.sent().data]}}))}))},t.queryFeatureSet=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,m(e,t,n)];case 1:return i=r.sent(),[2,g.fromJSON(i)]}}))}))},t.queryFeatureSetJSON=m,t.queryOptimizedFeatureSet=_}.apply(null,n))||(e.exports=i)},H9Hv:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.jsonAdapter={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,n){var i=new r(e.getPointX(t),e.getPointY(t),n),a=e.hasZ(t),o=e.hasM(t);return a&&(i.z=e.getPointZ(t)),o&&(i.m=e.getPointM(t)),i},exportPolygon:function(e,t,r){return new n(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new i(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new a(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){var n=e.hasZ(t),i=e.hasM(t),a=new o(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){var s=e.getZExtent(t);a.zmin=s.vmin,a.zmax=s.vmax}if(i){var u=e.getMExtent(t);a.mmin=u.vmin,a.mmax=u.vmax}return a}};var r=function(e,t,r){this.x=e,this.y=t,this.spatialReference=r,this.z=void 0,this.m=void 0},n=function(e,t,r,n){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)},i=function(e,t,r,n){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)},a=function(e,t,r,n){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)},o=function(e,t,r,n,i){this.xmin=e,this.ymin=t,this.xmax=r,this.ymax=n,this.spatialReference=i,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}.apply(null,n))||(e.exports=i)},HoQt:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("8uEs"),r("nrlZ")],void 0===(i=function(e,t,r,n){function i(e,t,i){if(!t||!i||i.vcsWkid||n.equals(t,i))return null;var a=r.getMetersPerVerticalUnitForSR(t)/r.getMetersPerVerticalUnitForSR(i);if(1===a)return null;switch(e){case"point":case"esriGeometryPoint":return function(e){return r=a,void((t=e)&&null!=t.z&&(t.z*=r));var t,r};case"polyline":case"esriGeometryPolyline":return function(e){return function(e,t){if(e)for(var r=0,n=e.paths;r<n.length;r++)for(var i=0,a=n[r];i<a.length;i++){var o=a[i];o.length>2&&(o[2]*=t)}}(e,a)};case"polygon":case"esriGeometryPolygon":return function(e){return function(e,t){if(e)for(var r=0,n=e.rings;r<n.length;r++)for(var i=0,a=n[r];i<a.length;i++){var o=a[i];o.length>2&&(o[2]*=t)}}(e,a)};case"multipoint":case"esriGeometryMultipoint":return function(e){return function(e,t){if(e)for(var r=0,n=e.points;r<n.length;r++){var i=n[r];i.length>2&&(i[2]*=t)}}(e,a)};default:return null}}function a(e,t,r){if(null==e.hasM||e.hasZ)for(var n=0,i=t;n<i.length;n++)for(var a=0,o=i[n];a<o.length;a++){var s=o[a];s.length>2&&(s[2]*=r)}}function o(e,t,r){if(e)for(var n=0,i=e;n<i.length;n++)s(i[n].geometry,t,r)}function s(e,t,i){if(e&&e.spatialReference&&!n.equals(e.spatialReference,t)){var o=r.getMetersPerVerticalUnitForSR(e.spatialReference)/i;if(1!==o)if("x"in e)null!=e.z&&(e.z*=o);else if("rings"in e)a(e,e.rings,o);else if("paths"in e)a(e,e.paths,o);else if("points"in e&&(null==e.hasM||e.hasZ))for(var s=0,u=e.points;s<u.length;s++){var l=u[s];l.length>2&&(l[2]*=o)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.getGeometryZScaler=i,t.applyFeatureSetZUnitScaling=function(e,t,r){if(r&&r.features&&r.hasZ){var n=i(r.geometryType,t,e.outSpatialReference);if(n)for(var a=0,o=r.features;a<o.length;a++)n(o[a].geometry)}},t.unapplyEditsZUnitScaling=function(e,t,n){if((e||t)&&n){var i=r.getMetersPerVerticalUnitForSR(n);o(e,n,i),o(t,n,i)}}}.apply(null,n))||(e.exports=i)},JOu6:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zIqJ"),r("LxLY"),r("8pdz")],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this._pool=new r.default(8024),this._nodes=0,this._root=new o(0,0,0),this._fields=e}return e.prototype._acquire=function(e,t,r){var i=this._pool.dequeue();return this._nodes++,n.isSome(i)?i.realloc(e,t,r):new o(e,t,r)},e.prototype._release=function(e){this._nodes--,this._pool.enqueue(e)},Object.defineProperty(e.prototype,"count",{get:function(){return this._root.count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"poolSize",{get:function(){return this._pool.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){var e=0;return this._forEachNode((function(t){return e=Math.max(e,t.depth)})),e},enumerable:!0,configurable:!0}),e.prototype.dropLevels=function(e){var t=this;this._forEachNode((function(r){if(r.depth>=e)for(var n=0;n<r.children.length;n++){var i=r.children[n];r.children[n]=null,i&&t._release(i)}}))},e.prototype.insert=function(e,t,r){void 0===r&&(r=0);for(var n=this._root,i=0,a=0,o=0;null!==n;){if(n.depth>=r&&(n.count+=1,n.xTotal+=e.geometry.coords[0],n.yTotal+=e.geometry.coords[1],n.xGeohashTotal+=e.geohashX,n.yGeohashTotal+=e.geohashY,this._updateStatistics(e,n,1)),i>=t)return;var s=Math.ceil((i+1)/2),u=Math.floor((i+1)/2),l=1-i%2,c=30-(3*s+2*u),f=30-(2*s+3*u),h=7*l+3*(1-l)<<c,p=3*l+7*(1-l)<<f,d=8*l+4*(1-l),y=(e.geohashX&h)>>c,g=(e.geohashY&p)>>f,v=y+g*d;a=a<<3*l+2*(1-l)|y,o=o<<2*l+3*(1-l)|g,null==n.children[v]&&(n.children[v]=this._acquire(a,o,i+1)),i+=1,n=n.children[v]}},e.prototype.remove=function(e,t){for(var r=this._root,n=0;null!==r;){if(r.count-=1,r.xTotal-=e.geometry.coords[0],r.yTotal-=e.geometry.coords[1],r.xGeohashTotal-=e.geohashX,r.yGeohashTotal-=e.geohashY,this._updateStatistics(e,r,-1),n>=t)return;var i=Math.ceil((n+1)/2),a=Math.floor((n+1)/2),o=1-n%2,s=30-(3*i+2*a),u=30-(2*i+3*a),l=7*o+3*(1-o)<<s,c=3*o+7*(1-o)<<u,f=8*o+4*(1-o),h=((e.geohashX&l)>>s)+((e.geohashY&c)>>u)*f,p=r.children[h];1===p.count&&(this._release(p),r.children[h]=null),n+=1,r=p}},e.prototype.find=function(e,t,r){return this._root.find(e,t,r,0,0,0)},e.prototype.findSingleOccupancyNode=function(e,t,r,n,i){for(var a=this._root;null!==a;){var o=a.depth,s=a.xNode,u=a.yNode,l=1-o%2,c=a.xGeohashTotal/a.count,f=a.yGeohashTotal/a.count;if(1===a.count&&e<c&&c<=r&&t<f&&f<=n)return a;if(o>=i)a=a.next;else{for(var h=Math.ceil((o+1)/2),p=Math.floor((o+1)/2),d=30-(3*h+2*p),y=30-(2*h+3*p),g=~((1<<d)-1),v=~((1<<y)-1),m=(e&g)>>d,_=(t&v)>>y,b=(r&g)>>d,x=(n&v)>>y,S=s<<3*l+2*(1-l),I=u<<2*l+3*(1-l),T=S+8*l+4*(1-l),w=I+4*l+8*(1-l),P=Math.max(S,m),M=Math.max(I,_),E=Math.min(T,b),F=Math.min(w,x),N=null,R=null,O=M;O<=F;O++)for(var A=P;A<=E;A++){var C=A-S+(O-I)*(8*l+4*(1-l)),j=a.children[C];j&&(N||((N=j).next=a.next),R&&(R.next=j),R=j,j.next=a.next)}a=N||a.next}}return null},e.prototype.getRegionStatistics=function(e,t,r,n,i){for(var a=this._root,o=0,s=0,u=0,l={};null!==a;){var c=a.depth,f=a.xNode,h=a.yNode;if(c>=i){var p=a.xGeohashTotal/a.count,d=a.yGeohashTotal/a.count;e<p&&p<=r&&t<d&&d<=n&&(o+=a.count,s+=a.xTotal,u+=a.yTotal,this._aggregateStatistics(l,a.statistics)),a=a.next}else{for(var y=Math.ceil((c+1)/2),g=Math.floor((c+1)/2),v=1-c%2,m=30-(3*y+2*g),_=30-(2*y+3*g),b=~((1<<m)-1),x=~((1<<_)-1),S=(e&b)>>m,I=(t&x)>>_,T=(r&b)>>m,w=(n&x)>>_,P=f<<3*v+2*(1-v),M=h<<2*v+3*(1-v),E=P+8*v+4*(1-v),F=M+4*v+8*(1-v),N=Math.max(P,S),R=Math.max(M,I),O=Math.min(E,T),A=Math.min(F,w),C=null,j=null,G=R;G<=A;G++)for(var k=N;k<=O;k++){var L=k-P+(G-M)*(8*v+4*(1-v)),q=a.children[L];if(q){if(G!==R&&G!==A&&k!==N&&k!==O){p=q.xGeohashTotal/q.count,d=q.yGeohashTotal/q.count,e<p&&p<=r&&t<d&&d<=n&&(o+=q.count,s+=q.xTotal,u+=q.yTotal,this._aggregateStatistics(l,q.statistics));continue}C||((C=q).next=a.next),j&&(j.next=q),j=q,q.next=a.next}}a=C||a.next}}return{count:o,attributes:this._normalizeStatistics(l,o),xTotal:s,yTotal:u}},e.prototype._forEachNode=function(e){for(var t=this._root;null!==t;){var r=this._linkChildren(t)||t.next;e(t),t=r}},e.prototype._linkChildren=function(e){for(var t=null,r=null,n=0;n<=e.children.length;n++){var i=e.children[n];i&&(t||((t=i).next=e.next),r&&(r.next=i),r=i,i.next=e.next)}return t},e.prototype._updateStatistics=function(e,t,r){for(var n=0,i=this._fields;n<i.length;n++){var a=i[n],o=a.name,s=a.outStatistic.onStatisticField,u=e.attributes[s];switch(a.outStatistic.statisticType){case"norm":t.statistics[o]||(t.statistics[o]={});var l=a.outStatistic.onStatisticNormalizationField,c=e.attributes[l],f=t.statistics[o].onStatisticField||0,h=t.statistics[o].onStatisticNormalizationField||0;null==u||isNaN(u)||null==c||0===c||isNaN(c)||(t.statistics[o].onStatisticField=f+r*u,t.statistics[o].onStatisticNormalizationField=h+r*c);break;case"sum":case"avg":t.statistics[o]||(t.statistics[o]={value:0,nanCount:0});var p=t.statistics[o].value,d=t.statistics[o].nanCount;null==u||isNaN(u)?t.statistics[o].nanCount=d+r:t.statistics[o].value=p+r*u;break;case"avg_angle":t.statistics[o]||(t.statistics[o]={x:0,y:0,nanCount:0});var y=t.statistics[o].x,g=t.statistics[o].y,v=(d=t.statistics[o].nanCount,Math.PI/180);null==u||isNaN(u)?t.statistics[o].nanCount=d+r:(t.statistics[o].x=y+r*Math.cos(u*v),t.statistics[o].y=g+r*Math.sin(u*v));break;case"mode":t.statistics[o]||(t.statistics[o]={}),p=t.statistics[o][u]||0,t.statistics[o][u]=p+r}}},e.prototype._aggregateStatistics=function(e,t){for(var r=0,n=this._fields;r<n.length;r++){var i=n[r],a=i.name;switch(i.outStatistic.statisticType){case"sum":case"avg":case"avg_angle":case"mode":case"norm":for(var o in e[a]||(e[a]={}),t[a]){var s=e[a][o]||0;e[a][o]=s+t[a][o]}}}},e.prototype._normalizeStatistics=function(e,t){for(var r={},n=0,i=this._fields;n<i.length;n++){var a=i[n],o=a.name;switch(a.outStatistic.statisticType){case"norm":var s=e[o];if(t&&null==s.onStatisticNormalizationField)break;if(t&&s.onStatisticNormalizationField){r[o]=s.onStatisticField/s.onStatisticNormalizationField;break}r[o]=0;break;case"sum":if(!t)break;var u=e[o],l=u.value;if(!(t-(f=u.nanCount)))break;r[o]=l;break;case"avg":if(!t)break;var c=e[o];if(l=c.value,!(t-(f=c.nanCount)))break;r[o]=l/(t-f);break;case"avg_angle":if(!t)break;var f,h=e[o],p=h.x,d=h.y;if(!(t-(f=h.nanCount)))break;var y=p/(t-f),g=d/(t-f),v=180/Math.PI,m=Math.atan2(g,y)*v;r[o]=m;break;case"mode":var _=e[o],b=0,x=null;for(var S in _){var I=_[S];I>b&&(b=I,x=S)}r[o]="null"===x?null:x}}return r},e}();t.GeohashTree=a;var o=function(){function e(e,t,r){this.count=0,this.xTotal=0,this.yTotal=0,this.statistics={},this.next=null,this.depth=0,this.xNode=0,this.yNode=0,this.xGeohashTotal=0,this.yGeohashTotal=0,this.children=new Array(32);for(var n=0;n<this.children.length;n++)this.children[n]=null;this.xNode=e,this.yNode=t,this.depth=r}return e.prototype.realloc=function(e,t,r){for(var n=0;n<this.children.length;n++)this.children[n]=null;return this.xNode=e,this.yNode=t,this.depth=r,this.next=null,this.xGeohashTotal=0,this.yGeohashTotal=0,this.xTotal=0,this.yTotal=0,this.count=0,this.statistics={},this},e.prototype.getLngLatBounds=function(){var e=this.depth,t=Math.ceil(e/2),r=Math.floor(e/2),n=30-(3*t+2*r),a=30-(2*t+3*r),o=this.xNode<<n,s=this.yNode<<a;return i.decodeGeohashXY({geohashX:o,geohashY:s},this.depth)},e.prototype.find=function(e,t,r,n,i,a){if(n>=r)return this;var o=1-n%2,s=3*o+2*(1-o),u=2*o+3*(1-o),l=30-i-s,c=30-a-u,f=((e&7*o+3*(1-o)<<l)>>l)+((t&3*o+7*(1-o)<<c)>>c)*(8*o+4*(1-o)),h=this.children[f];return null==h?null:h.find(e,t,r,n+1,i+s,a+u)},e}()}.apply(null,n))||(e.exports=i)},KgG2:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.displayTile=null,this.tile=null,this.done=!1,this.queryInfoHash=null,this.returnExceeded=!1}return Object.defineProperty(e.prototype,"key",{get:function(){return this.tile.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.tile.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.tile.bounds},enumerable:!0,configurable:!0}),e}();t.default=r}.apply(null,n))||(e.exports=i)},"L6z/":function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._pool=[],this._set=new Set}return e.prototype.acquire=function(){if(0===this._pool.length)return new Set;var e=this._pool.pop();return this._set.delete(e),e},e.prototype.release=function(e){e&&!this._set.has(e)&&(e.clear(),this._pool.length<5e4&&(this._pool.push(e),this._set.add(e)))},e.acquire=function(){return n.acquire()},e.release=function(e){return n.release(e)},e}();t.default=r;var n=new r}.apply(null,n))||(e.exports=i)},MbkH:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){var r=0;return function(){function e(e){void 0===e&&(e=null),this.uid=r++,e?(this._wkt=void 0!==e.wkt?e.wkt:null,this._wkid=void 0!==e.wkid?e.wkid:-1,this._isInverse=void 0!==e.isInverse&&!0===e.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}return e.fromGE=function(t){var r=new e;return r._wkt=t.wkt,r._wkid=t.wkid,r._isInverse=t.isInverse,r},Object.defineProperty(e.prototype,"wkt",{get:function(){return this._wkt},set:function(e){this._wkt=e,this.uid=r++},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wkid",{get:function(){return this._wkid},set:function(e){this._wkid=e,this.uid=r++},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInverse",{get:function(){return this._isInverse},set:function(e){this._isInverse=e,this.uid=r++},enumerable:!0,configurable:!0}),e.prototype.getInverse=function(){var t=new e;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t},e}()}.apply(null,n))||(e.exports=i)},OkCb:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("MbkH")],void 0===(i=function(e,t,r){return function(){function e(e){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,e&&e.steps)for(var t=0,n=e.steps;t<n.length;t++){var i=n[t];i instanceof r?this.steps.push(i):this.steps.push(new r({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}}return e.cacheKey=function(e,t){return[void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():"",void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():""].join(",")},e.fromGE=function(t){for(var n=new e,i="",a=0,o=t.steps;a<o.length;a++){var s=o[a],u=r.fromGE(s);n.steps.push(u),i+=u.uid.toString()+","}return n._cached_projection={},n._gtlistentry=null,n._chain=i,n},e.prototype.getInverse=function(){var t=new e;t.steps=[];for(var r=this.steps.length-1;r>=0;r--){var n=this.steps[r];t.steps.push(n.getInverse())}return t},e.prototype.getGTListEntry=function(){for(var e="",t=0,r=this.steps;t<r.length;t++)e+=r[t].uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=e),this._gtlistentry},e.prototype.assignCachedGe=function(t,r,n){this._cached_projection[e.cacheKey(t,r)]=n},e.prototype.getCachedGeTransformation=function(t,r){for(var n="",i=0,a=this.steps;i<a.length;i++)n+=a[i].uid.toString()+",";n!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=n);var o=this._cached_projection[e.cacheKey(t,r)];return void 0===o?null:o},e}()}.apply(null,n))||(e.exports=i)},Q2Em:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("qMld"),r("wIC5"),r("H9Hv"),r("nrlZ"),r("vtMp")],void 0===(i=function(e,t,r,n,i,a,o,s,u){Object.defineProperty(t,"__esModule",{value:!0});var l=[0,0];function c(e,t){var r,n,i;if(!t)return null;if("x"in t){var a={x:0,y:0};return r=e(t.x,t.y,l),a.x=r[0],a.y=r[1],null!=t.z&&(a.z=t.z),null!=t.m&&(a.m=t.m),a}return"xmin"in t?(a={xmin:0,ymin:0,xmax:0,ymax:0},n=e(t.xmin,t.ymin,l),a.xmin=n[0],a.ymin=n[1],i=e(t.xmax,t.ymax,l),a.xmax=i[0],a.ymax=i[1],t.hasZ&&(a.zmin=t.zmin,a.zmax=t.zmax,a.hasZ=!0),t.hasM&&(a.mmin=t.mmin,a.mmax=t.mmax,a.hasM=!0),a):"rings"in t?{rings:f(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:f(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:h(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function f(e,t){for(var r=[],n=0,i=e;n<i.length;n++){var a=i[n];r.push(h(a,t))}return r}function h(e,t){for(var r=[],n=0,i=e;n<i.length;n++){var a=i[n],o=t(a[0],a[1],[0,0]);r.push(o),a.length>2&&o.push(a[2]),a.length>3&&o.push(a[3])}return r}function p(e,t){return!(!s.isValid(e)||!s.isValid(t)||s.equals(e,t)||u.canProject(e,t))}t.doesBrowserSupportProjection=function(e,t){return!p(e,t)||a.isSupported()},t.checkProjectionSupport=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s;return r.__generator(this,(function(r){if(!t)return[2];if(Array.isArray(e)){for(i=0,o=e;i<o.length;i++)if(p((s=o[i]).geometry&&s.geometry.spatialReference,t)){if(a.isSupported())return[2,a.load()];throw new n("feature-store:unsupported-query","projection not supported",{inSpatialReference:e,outSpatialReference:t})}return[2]}if(!p(e,t))return[2];if(a.isSupported())return[2,a.load()];throw new n("feature-store:unsupported-query","projection not supported",{inSpatialReference:e,outSpatialReference:t})}))}))};var d=c.bind(null,u.lngLatToXY),y=c.bind(null,u.xyToLngLat);t.project=function(e,t,r){return e?(r||(r=t,t=e.spatialReference),s.isValid(t)&&s.isValid(r)&&!s.equals(t,r)?u.canProject(t,r)?s.isWebMercator(r)?d(e):y(e):a.projectMany(o.jsonAdapter,[e],t,r,null)[0]:e):e};var g=new(function(){function e(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return e.prototype.push=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var a,o=this;return r.__generator(this,(function(r){return e&&e.length&&t&&n&&!s.equals(t,n)||i.resolve(e),a={geometries:e,inSpatialReference:t,outSpatialReference:n,resolve:null},this._jobs.push(a),[2,i.create((function(e){a.resolve=e,null===o._timer&&(o._timer=setTimeout(o._process,10))}))]}))}))},e.prototype._process=function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,n=e.outSpatialReference,i=e.resolve;u.canProject(r,n)?s.isWebMercator(n)?i(t.map(d)):i(t.map(y)):i(a.projectMany(o.jsonAdapter,t,r,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}},e}());t.projectMany=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return[2,g.push(e,t,n)]}))}))}}.apply(null,n))||(e.exports=i)},V1i6:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("qMld"),r("k1EI"),r("Thzy"),r("Lzvl"),r("nrlZ"),r("gT/q"),r("+6sX"),r("Jvs9"),r("Q2Em"),r("zDti"),r("2Kdy")],void 0===(i=function(e,t,n,i,a,o,s,u,l,c,f,h,p,d){Object.defineProperty(t,"__esModule",{value:!0});var y={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},g={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},v={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},m={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function _(){return new Promise((function(e,t){Promise.all([r.e(8),r.e(25)]).then(function(){var t=[r("tNTp")];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))}t.importGeometryEngine=_,t.getGeodesicBufferOperator=function(){return _().then((function(e){return e.geodesicBuffer}))},t.getSpatialQueryOperator=function(e,t,r,n,i){if(u.isPolygon(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var l=f.convertFromPolygon(new h.default,t,!1,!1);return a.resolve((function(e){return c.polygonContainsPoint(l,!1,!1,e)}))}if(u.isPolygon(t)&&"esriGeometryMultipoint"===r){var p=f.convertFromPolygon(new h.default,t,!1,!1);if("esriSpatialRelContains"===e)return a.resolve((function(e){return c.polygonContainsMultipoint(p,!1,!1,e,n,i)}))}if(u.isExtent(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return a.resolve((function(e){return o.extentContainsPoint(t,d.getGeometry(r,n,i,e))}));if(u.isExtent(t)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return a.resolve((function(e){return o.extentContainsMultipoint(t,d.getGeometry(r,n,i,e))}));if(u.isExtent(t)&&"esriSpatialRelIntersects"===e){var g=s.getExtentIntersector(r);return a.resolve((function(e){return g(t,d.getGeometry(r,n,i,e))}))}return _().then((function(a){var o=a[y[e]].bind(null,t.spatialReference,t);return function(e){return o(d.getGeometry(r,n,i,e))}}))},t.checkSpatialQuerySupport=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var a,o;return n.__generator(this,(function(n){if(a=e.spatialRel,!(o=e.geometry))return[2];if(!0!==g[a])throw new i("feature-store:unsupported-query","Unsupported query spatial relationship",{query:e});if(!l.isValid(o.spatialReference)||!l.isValid(r))return[2];if(!function(e){return!0===v[u.getJsonType(e)]}(o))throw new i("feature-store:unsupported-query","Unsupported query geometry type",{query:e});if(!function(e){return!0===m[e]}(t))throw new i("feature-store:unsupported-query","Unsupported layer geometry type",{query:e});return e.outSR?[2,p.checkProjectionSupport(e.geometry&&e.geometry.spatialReference,e.outSR)]:[2]}))}))},t.canQueryWithRBush=function(e){if(u.isExtent(e))return!0;if(u.isPolygon(e)){for(var t=0,r=e.rings;t<r.length;t++){var n=r[t];if(5!==n.length)return!1;if(n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1}return!0}return!1}}.apply(null,n))||(e.exports=i)},W1uT:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("L6z/"),r("rfv1"),r("fUL3")],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var a=[],o=new Set,s=function(){function e(){this._tileById=new Map,this._tilesToFeatures=new Map,this._featureToTiles=new Map}return e.prototype.destroy=function(){this.clear()},e.prototype.add=function(e){var t=this;if(!this.has(e.id)){var n=e;this._tileById.set(n.id,n),this._tilesToFeatures.set(n,r.default.acquire()),this._tilesToFeatures.forEach((function(e,r){n!==r&&(i.isParentOf(n,r)?e.forEach((function(e){t._link(n,e)})):i.isChildOf(n,r)&&t.featureStore.forEachInBounds(n.bounds,(function(r){e.has(r.objectId)&&t._link(n,r.objectId)})))}))}},e.prototype.clear=function(){this._tilesToFeatures.forEach((function(e){return r.default.release(e)})),this._tilesToFeatures.clear(),this._featureToTiles.forEach((function(e){return r.default.release(e)})),this._featureToTiles.clear(),this._tileById.clear()},e.prototype.delete=function(e){var t=this,r=this.get(e.id);a.length=0,this._tilesToFeatures.get(r).forEach((function(e){var n=t._featureToTiles.get(e);n.has(r)&&1===n.size?a.push(e):t._unlink(r,e)}));for(var n=0,i=a;n<i.length;n++){var o=i[n];this._unlink(r,o)}this.featureStore.removeManyById(a),this._tilesToFeatures.delete(r),this._tileById.delete(r.id),a.length=0},e.prototype.forEach=function(e,t){return this._tileById.forEach(e,t)},e.prototype.get=function(e){return this._tileById.get(e)},e.prototype.has=function(e){return this._tileById.has(e)},e.prototype.setTileFeatures=function(e,t){var n=this,i=this.get(e.id);this._tilesToFeatures.has(i)||(this._tileById.set(i.id,i),this._tilesToFeatures.set(i,r.default.acquire()));for(var s=0,u=t;s<u.length;s++){var l=u[s];o.add(l.objectId)}a.length=0,this._tilesToFeatures.get(i).forEach((function(e){if(!o.has(e)){var t=n._featureToTiles.get(e);t.has(i)&&1===t.size?a.push(e):n._unlink(i,e)}}));for(var c=0,f=a;c<f.length;c++){var h=f[c];this._unlink(i,h)}this.featureStore.removeManyById(a),this.featureStore.addMany(t),o.forEach((function(e){n._link(i,e)})),o.clear(),a.length=0},e.prototype.addOrUpdateFeatures=function(e){for(var t=this,r=new Set,i=new n.default({geometryType:this.featureStore.geometryType,hasM:this.featureStore.hasM,hasZ:this.featureStore.hasZ}),a=0,o=this.deleteFeaturesById(e.map((function(e){return e.objectId})));a<o.length;a++){var s=o[a];r.add(s)}i.addMany(e),this._tileById.forEach((function(e){i.forEachInBounds(e.bounds,(function(n){t._link(e,n.objectId),r.add(e)}))})),this.featureStore.addMany(e);var u=[];return r.forEach((function(e){return u.push(e)})),u},e.prototype.deleteFeaturesById=function(e){for(var t=this,n=new Set,i=function(e){var i=a._featureToTiles.get(e);i&&(i.forEach((function(r){n.add(r),t._tilesToFeatures.get(r).delete(e)})),r.default.release(i),a._featureToTiles.delete(e))},a=this,o=0,s=e;o<s.length;o++)i(s[o]);this.featureStore.removeManyById(e);var u=[];return n.forEach((function(e){return u.push(e)})),u},e.prototype._link=function(e,t){this._featureToTiles.get(t)||this._featureToTiles.set(t,r.default.acquire()),this._featureToTiles.get(t).add(e),this._tilesToFeatures.get(e).add(t)},e.prototype._unlink=function(e,t){this._featureToTiles.get(t).delete(e),this._tilesToFeatures.get(e).delete(t),0===this._featureToTiles.get(t).size&&(r.default.release(this._featureToTiles.get(t)),this._featureToTiles.delete(t))},e}();t.default=s}.apply(null,n))||(e.exports=i)},WRgd:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("LxLY"),r("N7S/"),r("lRq4")],void 0===(i=function(e,t,r,n,i){function a(e){return void 0===e&&(e=t.ZERO),[e[0],e[1],e[2],e[3],e[4],e[5]]}function o(e,t,r,n,i,o,s){return void 0===s&&(s=a()),s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s}function s(e){return e[0]>=e[3]?0:e[3]-e[0]}function u(e){return e[1]>=e[4]?0:e[4]-e[1]}function l(e){return e[2]>=e[5]?0:e[5]-e[2]}function c(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])}function f(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function h(e){return 6===e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.create=a,t.fromValues=o,t.fromExtent=function(e,t){return void 0===t&&(t=a()),t[0]=e.xmin,t[1]=e.ymin,t[2]=e.zmin,t[3]=e.xmax,t[4]=e.ymax,t[5]=e.zmax,t},t.toExtent=function(e,t){var r=isFinite(e[2])||isFinite(e[5]);return new n(r?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})},t.fromMinMax=function(e,t,r){return void 0===r&&(r=a()),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t[0],r[4]=t[1],r[5]=t[2],r},t.expandPointInPlace=function(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[3]&&(e[3]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[4]&&(e[4]=t[1]),t[2]<e[2]&&(e[2]=t[2]),t[2]>e[5]&&(e[5]=t[2])},t.expand=function(e,t,r){return void 0===r&&(r=e),h(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.max(e[3],t[3]),r[4]=Math.max(e[4],t[4]),r[5]=Math.max(e[5],t[5])):i.is(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[3]=Math.max(e[3],t[2]),r[4]=Math.max(e[4],t[3])):2===t.length?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[3]=Math.max(e[3],t[0]),r[4]=Math.max(e[4],t[1])):3===t.length&&(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.max(e[3],t[0]),r[4]=Math.max(e[4],t[1]),r[5]=Math.max(e[5],t[2])),r},t.expandWithBuffer=function(e,t,r,n,i){void 0===r&&(r=0),void 0===n&&(n=t.length/3),void 0===i&&(i=e);for(var a=e[0],o=e[1],s=e[2],u=e[3],l=e[4],c=e[5],f=0;f<n;f++)a=Math.min(a,t[r+3*f]),o=Math.min(o,t[r+3*f+1]),s=Math.min(s,t[r+3*f+2]),u=Math.max(u,t[r+3*f]),l=Math.max(l,t[r+3*f+1]),c=Math.max(c,t[r+3*f+2]);return i[0]=a,i[1]=o,i[2]=s,i[3]=u,i[4]=l,i[5]=c,i},t.expandWithOffset=function(e,t,r,n,i){return void 0===i&&(i=e),i[0]=Math.min(e[0],e[0]+t),i[3]=Math.max(e[3],e[3]+t),i[1]=Math.min(e[1],e[1]+r),i[4]=Math.max(e[4],e[4]+r),i[2]=Math.min(e[2],e[2]+n),i[5]=Math.max(e[5],e[5]+n),i},t.expandWithNestedArray=function(e,t,r,n){void 0===n&&(n=e);var i=t.length,a=e[0],o=e[1],s=e[2],u=e[3],l=e[4],c=e[5];if(r)for(var f=0;f<i;f++){var h=t[f];a=Math.min(a,h[0]),o=Math.min(o,h[1]),s=Math.min(s,h[2]),u=Math.max(u,h[0]),l=Math.max(l,h[1]),c=Math.max(c,h[2])}else for(f=0;f<i;f++)h=t[f],a=Math.min(a,h[0]),o=Math.min(o,h[1]),u=Math.max(u,h[0]),l=Math.max(l,h[1]);return n[0]=a,n[1]=o,n[2]=s,n[3]=u,n[4]=l,n[5]=c,n},t.allFinite=function(e){for(var t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0},t.width=s,t.depth=u,t.height=l,t.diameter=function(e){var t=s(e),r=l(e),n=u(e);return Math.sqrt(t*t+r*r+n*n)},t.center=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=e[0]+s(e)/2,t[1]=e[1]+u(e)/2,t[2]=e[2]+l(e)/2,t},t.size=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=s(e),t[1]=u(e),t[2]=l(e),t},t.maximumDimension=function(e){return Math.max(s(e),l(e),u(e))},t.containsPoint=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]},t.containsPointWithMargin=function(e,t,r){return t[0]>=e[0]-r&&t[1]>=e[1]-r&&t[2]>=e[2]-r&&t[0]<=e[3]+r&&t[1]<=e[4]+r&&t[2]<=e[5]+r},t.contains=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[3]<=e[3]&&t[4]<=e[4]&&t[5]<=e[5]},t.intersects=c,t.intersectsClippingArea=function(e,t){return!!r.isNone(t)||c(e,t)},t.offset=function(e,t,r,n,i){return void 0===i&&(i=e),i[0]=e[0]+t,i[1]=e[1]+r,i[2]=e[2]+n,i[3]=e[3]+t,i[4]=e[4]+r,i[5]=e[5]+n,i},t.getMin=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.getMax=function(e,t){return t[0]=e[3],t[1]=e[4],t[2]=e[5],t},t.setMin=function(e,t,r){return void 0===r&&(r=e),r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r},t.setMax=function(e,t,r){return void 0===r&&(r=e),r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e},t.set=f,t.empty=function(e){return e?f(e,t.NEGATIVE_INFINITY):a(t.NEGATIVE_INFINITY)},t.toRect=function(e,t){return t||(t=i.create()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t},t.fromRect=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e},t.is=h,t.isPoint=function(e){return 0===s(e)&&0===u(e)&&0===l(e)},t.equals=function(e,t,n){if(r.isNone(e)||r.isNone(t))return e===t;if(!h(e)||!h(t))return!1;if(n){for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1}else for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},t.wrap=function(e,t,r,n,i,a){return o(e,t,r,n,i,a,p)},t.POSITIVE_INFINITY=[-1/0,-1/0,-1/0,1/0,1/0,1/0],t.NEGATIVE_INFINITY=[1/0,1/0,1/0,-1/0,-1/0,-1/0],t.ZERO=[0,0,0,0,0,0];var p=a()}.apply(null,n))||(e.exports=i)},YhCz:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("ma1f"),r("qsST"),r("v7zm"),r("yre/"),r("6/KI")],void 0===(i=function(e,t,r,n,i,a,o){Object.defineProperty(t,"__esModule",{value:!0});var s=n.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),u=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],l=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],c=["upperLeft","lowerLeft"];function f(e){return e>=u.length?null:u[e]}function h(e){return e>=c.length?null:c[e]}function p(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function d(e,t,r){for(var n=t.createPointGeometry(r);e.next();)switch(e.tag()){case 3:for(var i=e.getUInt32(),a=e.pos()+i,o=0;e.pos()<a;)t.addCoordinatePoint(n,e.getSInt64(),0,o++);break;case 1:case 2:default:e.skip()}return n}function y(e,t,r){for(var n=t.createGeometry(r),i=2+(r.hasZ?1:0)+(r.hasM?1:0);e.next();)switch(e.tag()){case 2:for(var a=e.getUInt32(),o=e.pos()+a,s=0;e.pos()<o;)t.addLength(n,e.getUInt32(),s++);break;case 3:for(var u=e.getUInt32(),l=(o=e.pos()+u,0),c=0;e.pos()<o;)t.addCoordinate(n,e.getSInt64(),c,l),++l===i&&(c++,l=0);break;case 1:default:e.skip()}return n}function g(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function v(e){for(var t,r={type:f(0)};e.next();)switch(e.tag()){case 1:r.name=e.getString();break;case 2:r.type=f(e.getEnum());break;case 3:r.alias=e.getString();break;case 4:r.sqlType=(t=e.getEnum())>=l.length?null:l[t];break;case 5:case 6:default:e.skip()}return r}function m(e,t,r,n){for(var i=t.createFeature(r),a=0;e.next();)switch(e.tag()){case 1:var o=n[a++].name;i.attributes[o]=e.processMessage(g);break;case 2:i.geometry=e.processMessageWithArgs(y,t,r);break;case 4:i.centroid=e.processMessageWithArgs(d,t,r);break;default:e.skip()}return i}function _(e){for(var t=[1,1,1,1];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function b(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function x(e){for(var t={originPosition:h(0)};e.next();)switch(e.tag()){case 1:t.originPosition=h(e.getEnum());break;case 2:t.scale=e.processMessage(_);break;case 3:t.translate=e.processMessage(b);break;default:e.skip()}return t}function S(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function I(e,t){for(var r=t.createSpatialReference();e.next();)switch(e.tag()){case 1:r.wkid=e.getUInt32();break;case 5:r.wkt=e.getString();break;case 2:case 3:case 4:default:e.skip()}return r}function T(e,t){var r=t.createFeatureResult();r.geometryType=p(t,0);for(var n=!1;e.next();)switch(e.tag()){case 1:r.objectIdFieldName=e.getString();break;case 3:r.globalIdFieldName=e.getString();break;case 4:r.geohashFieldName=e.getString();break;case 5:r.geometryProperties=e.processMessage(S);break;case 7:r.geometryType=p(t,e.getEnum());break;case 8:r.spatialReference=e.processMessageWithArgs(I,t);break;case 10:r.hasZ=e.getBool();break;case 11:r.hasM=e.getBool();break;case 12:r.transform=e.processMessage(x);break;case 9:var i=e.getBool();r.exceededTransferLimit=i;break;case 13:t.addField(r,e.processMessage(v));break;case 15:n||(t.prepareFeatures(r),n=!0),t.addFeature(r,e.processMessageWithArgs(m,t,r,r.fields));break;case 2:case 6:default:e.skip()}return t.finishFeatureResult(r),r}function w(e,t){for(var r={};e.next();)switch(e.tag()){case 1:r.featureResult=e.processMessageWithArgs(T,t);break;default:e.skip()}return r}t.parseFeatureQuery=function(e,t){var n=function(e){return e&&"dehydrated"===e.type?new a.Context(e):new o.Context(e)}(t);try{for(var u=new i(new Uint8Array(e),new DataView(e)),l={};u.next();)switch(u.tag()){case 2:l.queryResult=u.processMessageWithArgs(w,n);break;default:u.skip()}return l}catch(e){var c=new r("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e});return s.error(c),{queryResult:{featureResult:n.createFeatureResult()}}}}}.apply(null,n))||(e.exports=i)},Ytki:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("ma1f"),r("ULaq"),r("ztx9")],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var a=new i.WhereClauseCache(50,500),o="feature-store:unsupported-query",s=n.SetFromValues(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function u(e,t){return e?a.get(e,t):null}function l(e,t,n,i){void 0===i&&(i=!0);for(var a=[],s=0,f=t;s<f.length;s++){var h=f[s];if("*"!==h&&!e.has(h))if(i){var p=c(h);try{var d=u(p,e);if(!d)throw new r(o,"invalid SQL expression",{where:p});if(!d.isStandardized)throw new r(o,"expression is not standard",{clause:d});l(e,d.fieldNames,"expression contains missing fields")}catch(e){var y=e&&e.details;if(y&&(y.clause||y.where))throw e;y&&y.missingFields?a.push.apply(a,y.missingFields):a.push(h)}}else a.push(h)}if(a.length)throw new r(o,n,{missingFields:a})}function c(e){return e.split(" as ")[0]}t.validateWhere=function(e,t){if(!t)return!0;var n=a.get(t,e);if(!n)throw new r(o,"invalid SQL expression",{where:t});if(!n.isStandardized)throw new r(o,"where clause is not standard",{where:t});return l(e,n.fieldNames,"where clause contains missing fields"),!0},t.validateHaving=function(e,t,n){if(!t)return!0;var i=a.get(t,e);if(!i)throw new r(o,"invalid SQL expression",{having:t});if(!i.isAggregate)throw new r(o,"having does not contain a valid aggregate function",{having:t});var s=i.fieldNames;if(l(e,s,"having contains missing fields"),!i.getExpressions().every((function(t){var r=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return n.some((function(t){var n=t.onStatisticField,i=t.statisticType;return(e.has(n)&&e.get(n).name)===a&&i.toLowerCase().trim()===r}))})))throw new r(o,"expressions in having should also exist in outStatistics",{having:t});return!0},t.getWhereClause=u,t.validateFields=l,t.getExpressionFromFieldName=c,t.getAliasFromFieldName=function(e){return e.split(" as ")[1]},t.hasInvalidFieldType=function(e,t){var r=t.get(e);return!!r&&!s.has(r.type)}}.apply(null,n))||(e.exports=i)},ZGAQ:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("lRq4"),r("+6sX"),r("Jvs9"),r("ZooB"),r("zDti")],void 0===(i=function(e,t,r,n,i,a,o){Object.defineProperty(t,"__esModule",{value:!0});var s=new i.default,u={esriGeometryPoint:n.convertToPoint,esriGeometryPolyline:n.convertToPolyline,esriGeometryPolygon:n.convertToPolygon,esriGeometryMultipoint:n.convertToMultipoint};t.executeTileQueryForIds=function(e,t,n){var i=n.pixelBuffer*t.resolution,a=r.pad(t.bounds,i,r.create()),o=[];return e.featureStore.forEachInBounds(a,(function(t){return o.push(e.featureAdapter.getObjectId(t))})),o},t.createTileFeatures=function(e,t,r,n,i,f,h,p,d){var y=u[r.geometryType],g=l[r.geometryType],v="esriGeometryPolygon"===r.geometryType&&!p,m=r.hasZ?r.hasM?4:3:r.hasM?3:2;h&&!f?n.forEachInBounds(i,(function(n){return function(e,t,r,n,i){if(!t.has(r.objectId)){var s=o.getCentroid(n,r,i),u=r.attributes;s&&(t.add(r.objectId),e.push(new a.Feature(u,r.localId,null,s)))}}(e,t,n,r,d)})):f&&!h?n.forEachInBounds(i,(function(r){return function(e,t,r,n,i,o,u,l){if(!t.has(r.objectId)){var f=r.attributes,h=n(c(s,r.geometry,i,o,l,u),!1,!1);h&&(t.add(r.objectId),e.push(new a.Feature(f,r.localId,h,null)))}}(e,t,r,y,m,g,d,v)})):n.forEachInBounds(i,(function(n){return function(e,t,r,n,i,u,l,f,h){if(!t.has(r.objectId)){var p=o.getCentroid(n,r,i),d=r.attributes,y=u(c(s,r.geometry,l,f,h,i),!1,!1);y&&p&&(t.add(r.objectId),e.push(new a.Feature(d,r.localId,y,p)))}}(e,t,n,r,d,y,m,g,v)}))};var l={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};function c(e,t,r,i,a,o){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;var s,u,l,c,f=t.coords,h=t.lengths;if(!h.length)return e.coords[0]=n.quantizeX(o,f[0]),e.coords[1]=n.quantizeY(o,f[1]),e.coords.length=r,e;for(var p=0,d=0,y=d,g=0,v=h;g<v.length;g++){var m=v[g];if(!(m<i))if(d=y,l=s=n.quantizeX(o,f[p]),c=u=n.quantizeY(o,f[p+1]),e.coords[d]=l,e.coords[d+1]=c,p+=r,1!==m){var _=(l=n.quantizeX(o,f[p]))-s,b=(c=n.quantizeY(o,f[p+1]))-u,x=b/_;d+=2,e.coords[d]=_,e.coords[d+1]=b,s=l,u=c,p+=r;for(var S=2;S<m;S++){if(l=n.quantizeX(o,f[p]),c=n.quantizeY(o,f[p+1]),l!==s||c!==u){var I=l-s,T=c-u,w=T/I;x!==w&&(isFinite(x)||isFinite(w))||!(a||(b>=0&&T>=0||b<=0&&T<=0)&&(_>=0&&I>=0||_<=0&&I<=0))?(_=I,b=T,d+=2):(_+=I,b+=T),e.coords[d]=_,e.coords[d+1]=b,x=w,s=l,u=c}p+=r}var P=(d+2-y)/2;P>=i&&(e.lengths.push(P),y=d+2)}else e.lengths.push(1),y=d+2}return e.coords.length>y&&(e.coords.length=y),e.coords.length?e:null}t.quantizeOptimizedGeometryForDisplay=c}.apply(null,n))||(e.exports=i)},ZHL0:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("r7jh")],void 0===(i=function(e,t,r){return function(){function e(e,t){this._storage=new r.MemCacheStorage,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}return e.prototype.put=function(e,t){this._storage.put(e,t,1,1)},e.prototype.pop=function(e){return this._storage.pop(e)},e.prototype.get=function(e){return this._storage.get(e)},e.prototype.clear=function(){this._storage.clearAll()},e.prototype.destroy=function(){this._storage.clearAll()},e}()}.apply(null,n))||(e.exports=i)},ZcgO:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("TMur"),r("jZlN"),r("pcDC"),r("H1tY"),r("rg9i"),r("LxLY"),r("rusB"),r("Z4y+"),r("WRgd"),r("lRq4"),r("Lzvl"),r("u90+"),r("KQcO"),r("/Vvo")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d,y){Object.defineProperty(t,"__esModule",{value:!0}),t.equals=y.equals;t.DehydratedFeatureClass=function(e,t,r){this.uid=e,this.geometry=t,this.attributes=r,this.visible=!0,this.objectId=null,this.centroid=null},t.hasGeometry=function(e){return s.isSome(e.geometry)},t.isFeatureGeometry=function(e){return r.isFeatureGeometryType(e.type)};function g(e,t,r){if(!e)return null;switch(t){case"point":var n=e;return{x:n.x,y:n.y,z:n.z,m:n.m,hasZ:null!=n.z,hasM:null!=n.m,type:"point",spatialReference:r};case"polyline":var i=e;return{paths:i.paths,hasZ:!!i.hasZ,hasM:!!i.hasM,type:"polyline",spatialReference:r};case"polygon":var a=e;return{rings:a.rings,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"polygon",spatialReference:r};case"multipoint":var o=e;return{points:o.points,hasZ:!!o.hasZ,hasM:!!o.hasM,type:"multipoint",spatialReference:r}}}function v(e,t,r,n){return{x:e,y:t,z:r,hasZ:null!=r,hasM:!1,spatialReference:n,type:"point"}}function m(e){return"declaredClass"in e}function _(e){return"declaredClass"in e}function b(e){return"declaredClass"in e}function x(e){return s.isNone(e)?null:m(e)?e:h.fromJSON(function(e){var t=e.spatialReference.toJSON();switch(e.type){case"point":return{x:e.x,y:e.y,z:e.z,m:e.m,spatialReference:t};case"polygon":var r=e.rings,n=e.hasZ,a=e.hasM;return{rings:w(r),hasZ:n,hasM:a,spatialReference:t};case"polyline":var o=e.paths;return n=e.hasZ,a=e.hasM,{paths:w(o),hasZ:n,hasM:a,spatialReference:t};case"extent":return{xmin:e.xmin,xmax:e.xmax,ymin:e.ymin,ymax:e.ymax,zmin:e.zmin,zmax:e.zmax,mmin:e.mmin,mmax:e.mmax,hasZ:n=e.hasZ,hasM:a=e.hasM,spatialReference:t};case"multipoint":var s=e.points;return n=e.hasZ,a=e.hasM,{points:M(s)?P(s):s,hasZ:n,hasM:a,spatialReference:t};default:return void i.neverReached(e)}}(e))}t.DehydratedFeatureSetClass=function(){this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null},t.isPoint=function(e){return"point"===e.type},t.fromFeatureSetJSON=function(e){var t=r.featureGeometryTypeKebabDictionary.fromJSON(e.geometryType),a=l.fromJSON(e.spatialReference),o=e.transform,s=e.features.map((function(r){var s=function(e,t,r,i){return{uid:n.generateUID(),objectId:i&&e.attributes?e.attributes[i]:null,attributes:e.attributes,geometry:g(e.geometry,t,r),visible:!0}}(r,t,a,e.objectIdFieldName),u=s.geometry;if(u&&o)switch(u.type){case"point":s.geometry=p.hydratePoint(o,u,u,u.hasZ,u.hasM);break;case"multipoint":s.geometry=p.hydrateMultipoint(o,u,u,u.hasZ,u.hasM);break;case"polygon":s.geometry=p.hydratePolygon(o,u,u,u.hasZ,u.hasM);break;case"polyline":s.geometry=p.hydratePolyline(o,u,u,u.hasZ,u.hasM);break;default:i.neverReached(u)}return s}));return{geometryType:t,features:s,spatialReference:a,fields:e.fields?e.fields.map((function(e){return d.fromJSON(e)})):null,objectIdFieldName:e.objectIdFieldName,globalIdFieldName:e.globalIdFieldName,geohashFieldName:e.geohashFieldName,geometryProperties:e.geometryProperties,hasZ:e.hasZ,hasM:e.hasM,exceededTransferLimit:e.exceededTransferLimit,transform:null}},t.fromJSONGeometry=g,t.makeDehydratedPoint=v,t.isHydratedGeometry=m,t.isHydratedPoint=_,t.isHydratedGraphic=b,t.hydrateGraphic=function(e,t){if(!e)return null;if(b(e))return e;var r=new n({layer:t,sourceLayer:t});return r.visible=e.visible,r.symbol=o.clone(e.symbol),r.attributes=o.clone(e.attributes),r.geometry=x(e.geometry),r},t.hydrateGeometry=x,t.clonePoint=function(e,t){if(!e)return null;var r;if(_(e)){if(null==t)return e.clone();if(_(t))return t.copy(e)}return null!=t?((r=t).x=e.x,r.y=e.y,r.spatialReference=e.spatialReference,e.hasZ?(r.z=e.z,r.hasZ=e.hasZ):(r.z=null,r.hasZ=!1),e.hasM?(r.m=e.m,r.hasM=!0):(r.m=null,r.hasM=!1)):(r=v(e.x,e.y,e.z,e.spatialReference),e.hasM&&(r.m=e.m,r.hasM=!0)),r};var S=a("esri-text-decoder")?function(e){return 32+e.length}:function(e){return 32*e.length};function I(e){if(!e)return 0;var t=32;for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];switch(typeof n){case"string":t+=S(n);break;default:case"number":t+=16}}return t}function T(e){if(s.isNone(e))return 0;var t=32;switch(e.type){case"point":t+=42;break;case"polyline":case"polygon":for(var r=0,n=2+(e.hasZ?1:0)+(e.hasM?1:0),a="polyline"===e.type?e.paths:e.rings,o=0,l=a;o<l.length;o++)r+=l[o].length;t+=8*r*n+64,t+=128*r,t+=34,t+=32*(a.length+1);break;case"multipoint":var c=2+(e.hasZ?1:0)+(e.hasM?1:0),f=e.points.length;t+=8*f*c+64,t+=128*f,t+=34,t+=32;break;case"extent":t+=98,e.hasM&&(t+=32),e.hasZ&&(t+=32);break;case"mesh":t+=u.estimateSize(e.vertexAttributes.position),t+=u.estimateSize(e.vertexAttributes.normal),t+=u.estimateSize(e.vertexAttributes.uv),t+=u.estimateSize(e.vertexAttributes.tangent);break;default:i.neverReached(e)}return t}function w(e){return function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];if(0!==n.length)return M(n)}return!1}(e)?e.map((function(e){return P(e)})):e}function P(e){return e.map((function(e){return u.toArray(e)}))}function M(e){return e.length&&(u.isFloat32Array(e[0])||u.isFloat64Array(e[0]))}function E(e,t){switch(c.empty(t),"mesh"===e.type&&(e=e.extent),e.type){case"point":t[0]=t[3]=e.x,t[1]=t[4]=e.y,e.hasZ&&(t[2]=t[5]=e.z);break;case"polyline":for(var r=0;r<e.paths.length;r++)c.expandWithNestedArray(t,e.paths[r],e.hasZ);break;case"polygon":for(r=0;r<e.rings.length;r++)c.expandWithNestedArray(t,e.rings[r],e.hasZ);break;case"multipoint":c.expandWithNestedArray(t,e.points,e.hasZ);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[3]=e.xmax,t[4]=e.ymax,null!=e.zmin&&(t[2]=e.zmin),null!=e.zmax&&(t[5]=e.zmax);break;default:i.neverReached(e)}}function F(e,t){switch(f.empty(t),"mesh"===e.type&&(e=e.extent),e.type){case"point":t[0]=t[2]=e.x,t[1]=t[3]=e.y;break;case"polyline":for(var r=0;r<e.paths.length;r++)f.expandWithNestedArray(t,e.paths[r]);break;case"polygon":for(r=0;r<e.rings.length;r++)f.expandWithNestedArray(t,e.rings[r]);break;case"multipoint":f.expandWithNestedArray(t,e.points);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax;break;default:i.neverReached(e)}}t.estimateAttributesObjectSize=I,t.estimateGeometryObjectSize=T,t.estimateSize=function(e){var t=32;return t+=I(e.attributes),(t+=3)+(8+T(e.geometry))},t.numVertices=function(e){if(s.isNone(e))return 0;switch(e.type){case"point":return 1;case"polyline":for(var t=0,r=0,n=e.paths;r<n.length;r++)t+=n[r].length;return t;case"polygon":t=0;for(var a=0,o=e.rings;a<o.length;a++)t+=o[a].length;return t;case"multipoint":return e.points.length;case"extent":return 2;case"mesh":var u=e.vertexAttributes&&e.vertexAttributes.position;return u?u.length/3:0;default:return void i.neverReached(e)}},t.hasVertices=function(e){if(!e)return!1;switch(e.type){case"extent":case"point":return!0;case"polyline":for(var t=0,r=e.paths;t<r.length;t++)if(r[t].length>0)return!0;return!1;case"polygon":for(var n=0,a=e.rings;n<a.length;n++)if(a[n].length>0)return!0;return!1;case"multipoint":return e.points.length>0;case"mesh":return e.vertexAttributes&&e.vertexAttributes.position&&e.vertexAttributes.position.length>0;default:return void i.neverReached(e)}},t.computeAABB=E,t.expandAABB=function(e,t){E(e,N),c.expand(t,N)},t.computeAABR=F,t.expandAABR=function(e,t){F(e,R),f.expand(t,R)},t.getObjectId=function(e,t){return null!=e.objectId?e.objectId:e.attributes&&t?e.attributes[t]:null};var N=c.create(),R=f.create()}.apply(null,n))||(e.exports=i)},ZooB:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("rg9i"),r("LxLY"),r("r7jh"),r("qMld"),r("ULaq"),r("8uEs"),r("WRgd"),r("lRq4"),r("hBh5"),r("Lzvl"),r("nrlZ"),r("Ytki"),r("Q2Em"),r("4/qq"),r("d81A"),r("V1i6"),r("/61J"),r("zDti"),r("I90O"),r("tZaU")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d,y,g,v,m,_,b,x,S,I){Object.defineProperty(t,"__esModule",{value:!0});t.Feature=function(e,t,r,n,i){void 0===t&&(t=null),this.attributes=e,this.geometry=r,this.centroid=n,this.filterFlags=i,this.groupId=-1,this.localId=t};var T=new Set,w=new o.MemCacheStorage(2e6),P=0,M=function(){function e(e){var t=this;this.capabilities={query:v.queryCapabilities},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this._changeHandle=this.featureStore.events.on("changed",(function(){return t.clearCache()})),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new o.MemCache(P+++"$$",w)),this.fieldsIndex=new S(e.fields),e.scheduler&&e.task&&(this._frameQueue=new I.default,this._frameTask=e.scheduler.registerTask(e.task,(function(e){return t._update(e)}),(function(){return t._frameQueue.length>0})))}return e.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()},Object.defineProperty(e.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullExtent",{get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:x.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeExtent",{get:function(){return this.timeInfo?(this._timeExtent||(this._timeExtent=b.getTimeExtent(this.timeInfo,this.featureStore)),this._timeExtent):null},enumerable:!0,configurable:!0}),e.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null},e.prototype.executeQuery=function(e,t){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){var t,n,a,o=this;return r.__generator(this,(function(r){switch(r.label){case 0:t=i.clone(e),r.label=1;case 1:return r.trys.push([1,8,,9]),[4,this._schedule((function(){return x.normalizeQuery(t,o.definitionExpression,o.spatialReference)}))];case 2:return t=r.sent(),[4,this._reschedule((function(){return o._checkQuerySupport(t)}))];case 3:return t=r.sent(),[4,this._reschedule((function(){return o._executeGeometryQuery(t)}))];case 4:return n=r.sent(),[4,this._reschedule((function(){return n.executeObjectIdsQuery(t)}))];case 5:return n=r.sent(),[4,this._reschedule((function(){return n.executeTimeQuery(t)}))];case 6:return n=r.sent(),[4,this._reschedule((function(){return n.executeAttributesQuery(t)}))];case 7:return n=r.sent(),[3,9];case 8:if((a=r.sent())!==x.QUERY_ENGINE_EMPTY_RESULT)throw a;return n=new m.default([],null,this),[3,9];case 9:return[2,n.createQueryResponse(t)]}}))}))},e.prototype.executeQueryForCount=function(e,t){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){var t,n,a,o=this;return r.__generator(this,(function(r){switch(r.label){case 0:(t=i.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,r.label=1;case 1:return r.trys.push([1,8,,9]),[4,this._schedule((function(){return x.normalizeQuery(t,o.definitionExpression,o.spatialReference)}))];case 2:return t=r.sent(),[4,this._reschedule((function(){return o._checkQuerySupport(t)}))];case 3:return t=r.sent(),[4,this._reschedule((function(){return o._executeGeometryQuery(t)}))];case 4:return n=r.sent(),[4,this._reschedule((function(){return n.executeObjectIdsQuery(t)}))];case 5:return n=r.sent(),[4,this._reschedule((function(){return n.executeTimeQuery(t)}))];case 6:return n=r.sent(),[4,this._reschedule((function(){return n.executeAttributesQuery(t)}))];case 7:return[2,(n=r.sent()).size];case 8:if((a=r.sent())!==x.QUERY_ENGINE_EMPTY_RESULT)throw a;return[2,0];case 9:return[2]}}))}))},e.prototype.executeQueryForExtent=function(e,t){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){var t,n,a,o,s,u,f,h,p=this;return r.__generator(this,(function(r){switch(r.label){case 0:t=i.clone(e),a=t.outSR,r.label=1;case 1:return r.trys.push([1,8,,9]),[4,this._schedule((function(){return x.normalizeQuery(t,p.definitionExpression,p.spatialReference)}))];case 2:return t=r.sent(),[4,this._reschedule((function(){return p._checkQuerySupport(t)}))];case 3:return(t=r.sent()).returnGeometry=!0,t.returnCentroid=!1,t.outSR=null,[4,this._reschedule((function(){return p._executeGeometryQuery(t)}))];case 4:return n=r.sent(),[4,this._reschedule((function(){return n.executeObjectIdsQuery(t)}))];case 5:return n=r.sent(),[4,this._reschedule((function(){return n.executeTimeQuery(t)}))];case 6:return n=r.sent(),[4,this._reschedule((function(){return n.executeAttributesQuery(t)}))];case 7:return n=r.sent(),(o=n.size)?(c.set(F,c.NEGATIVE_INFINITY),this.featureStore.forEachBounds(n.items,(function(e){return c.expand(F,e)}),E),s={xmin:F[0],ymin:F[1],xmax:F[3],ymax:F[4],spatialReference:x.cleanFromGeometryEngine(this.spatialReference)},this.hasZ&&isFinite(F[2])&&isFinite(F[5])&&(s.zmin=F[2],s.zmax=F[5]),(u=g.project(s,n.spatialReference,a)).spatialReference=x.cleanFromGeometryEngine(a||this.spatialReference),u.xmax-u.xmin==0&&(f=l.getMetersPerUnitForSR(u.spatialReference),u.xmin-=f,u.xmax+=f),u.ymax-u.ymin==0&&(f=l.getMetersPerUnitForSR(u.spatialReference),u.ymin-=f,u.ymax+=f),this.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0&&(f=l.getMetersPerUnitForSR(u.spatialReference),u.zmin-=f,u.zmax+=f),[2,{count:o,extent:u}]):[2,{count:o,extent:null}];case 8:if((h=r.sent())===x.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw h;case 9:return[2]}}))}))},e.prototype.executeQueryForIds=function(e,t){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return[2,this.executeQueryForIdSet(e,t).then((function(e){return u.valuesOfSet(e)}))]}))}))},e.prototype.executeQueryForIdSet=function(e,t){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){var t,n,a,o,s,u=this;return r.__generator(this,(function(r){switch(r.label){case 0:(t=i.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,r.label=1;case 1:return r.trys.push([1,9,,10]),[4,this._schedule((function(){return x.normalizeQuery(t,u.definitionExpression,u.spatialReference)}))];case 2:return t=r.sent(),[4,this._reschedule((function(){return u._checkQuerySupport(t)}))];case 3:return t=r.sent(),[4,this._reschedule((function(){return u._executeGeometryQuery(t)}))];case 4:return n=r.sent(),[4,this._reschedule((function(){return n.executeObjectIdsQuery(t)}))];case 5:return n=r.sent(),[4,this._reschedule((function(){return n.executeTimeQuery(t)}))];case 6:return n=r.sent(),[4,this._reschedule((function(){return n.executeAttributesQuery(t)}))];case 7:return n=r.sent(),a=n.items,o=new Set,[4,this._reschedule((function(){for(var e=0,t=a;e<t.length;e++){var r=t[e];o.add(n.featureAdapter.getObjectId(r))}}))];case 8:return r.sent(),[2,o];case 9:if((s=r.sent())===x.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw s;case 10:return[2]}}))}))},e.prototype.executeQueryForLatestObservations=function(e,t){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){var t,a,o,s=this;return r.__generator(this,(function(r){switch(r.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new n("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:this.timeInfo});t=i.clone(e),r.label=1;case 1:return r.trys.push([1,9,,10]),[4,this._schedule((function(){return x.normalizeQuery(t,s.definitionExpression,s.spatialReference)}))];case 2:return t=r.sent(),[4,this._reschedule((function(){return s._checkQuerySupport(t)}))];case 3:return t=r.sent(),[4,this._reschedule((function(){return s._executeGeometryQuery(t)}))];case 4:return a=r.sent(),[4,this._reschedule((function(){return a.executeObjectIdsQuery(t)}))];case 5:return a=r.sent(),[4,this._reschedule((function(){return a.executeTimeQuery(t)}))];case 6:return a=r.sent(),[4,this._reschedule((function(){return a.executeAttributesQuery(t)}))];case 7:return a=r.sent(),[4,this._reschedule((function(){return a.filterLatest()}))];case 8:return a=r.sent(),[3,10];case 9:if((o=r.sent())!==x.QUERY_ENGINE_EMPTY_RESULT)throw o;return a=new m.default([],null,this),[3,10];case 10:return[2,a.createQueryResponse(t)]}}))}))},e.prototype._schedule=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return this._frameQueue?[2,this._frameQueue.push(e)]:[2,e()]}))}))},e.prototype._reschedule=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return this._frameQueue?[2,this._frameQueue.unshift(e)]:[2,e()]}))}))},e.prototype._update=function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null},e.prototype._getAll=function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new m.default(e,null,this)}return this._allItems},e.prototype._executeGeometryQuery=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n,i,o,s,u,l,c,f,h,p,y,g,v,b,x,S,I,T,w=this;return r.__generator(this,(function(P){switch(P.label){case 0:if(t=e.geometry,n=e.outSR,i=e.spatialRel,o=d.isValid(n)&&!d.equals(this.spatialReference,n),(s=this._geometryQueryCache?o?JSON.stringify({geometry:t,spatialRelationship:i,outSpatialReference:n}):JSON.stringify({geometry:t,spatialRelationship:i}):null)&&(u=this._geometryQueryCache.get(s),!a.isUndefined(u)))return[2,u];if(l=function(t){return r.__awaiter(w,void 0,void 0,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:return o&&(e.returnGeometry||e.returnCentroid)?[4,t.project(n)]:[3,2];case 1:return i=r.sent(),s&&this._geometryQueryCache.put(s,i,i.size||1),[2,i];case 2:return s&&this._geometryQueryCache.put(s,t,t.size||1),[2,t]}}))}))},!t)return[2,l(this._getAll())];if(c=this.featureAdapter,"esriSpatialRelDisjoint"!==i)return[3,3];if(!(f=this._searchFeatures(this._getQueryBBoxes(t))).length)return[2,l(this._getAll())];for(y=new Set,g=0,v=f;g<v.length;g++)b=v[g],y.add(c.getObjectId(b));return[4,this._reschedule((function(){var e=0;h=new Array(y.size),w.featureStore.forEach((function(t){return h[e++]=t})),p=y}))];case 1:return P.sent(),[4,this._reschedule((function(){return r.__awaiter(w,void 0,void 0,(function(){var e,n,a;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,_.getSpatialQueryOperator(i,t,this.geometryType,this.hasZ,this.hasM)];case 1:return e=r.sent(),n=function(t){return!p.has(c.getObjectId(t))||e(c.getGeometry(t))},a=m.default.bind,[4,this._runSpatialFilter(h,n)];case 2:return[2,new(a.apply(m.default,[void 0,r.sent(),t,this]))]}}))}))}))];case 2:return S=P.sent(),[2,l(S)];case 3:return(x=this._searchFeatures(this._getQueryBBoxes(t))).length?this._canExecuteSoloPass(t,e)?[2,l(new m.default(x,t,this))]:[4,_.getSpatialQueryOperator(i,t,this.geometryType,this.hasZ,this.hasM)]:(S=new m.default([],t,this),s&&this._geometryQueryCache.put(s,S,S.size||1),[2,S]);case 4:return I=P.sent(),[4,this._runSpatialFilter(x,(function(e){return I(c.getGeometry(e))}))];case 5:return T=P.sent(),[2,l(new m.default(T,t,this))]}}))}))},e.prototype._runSpatialFilter=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,a,o=this;return r.__generator(this,(function(s){return t?this._budget?(n=0,i=new Array,a=function(){return r.__awaiter(o,void 0,void 0,(function(){var o;return r.__generator(this,(function(r){switch(r.label){case 0:return n<e.length?(o=e[n],t(o)&&i.push(o),this._budget.done?[4,this._reschedule((function(){return a()}))]:[3,2]):[3,3];case 1:r.sent(),r.label=2;case 2:return++n,[3,0];case 3:return[2]}}))}))},[2,this._reschedule((function(){return a()})).then((function(){return i}))]):[2,e.filter((function(e){return t(e)}))]:[2,e]}))}))},e.prototype._canExecuteSoloPass=function(e,t){var r=this.geometryType,n=t.spatialRel;return _.canQueryWithRBush(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))},e.prototype._getQueryBBoxes=function(e){if(_.canQueryWithRBush(e)){if(p.isExtent(e))return[f.fromValues(e.xmin,e.ymin,e.xmax,e.ymax)];if(p.isPolygon(e))return e.rings.map((function(e){return f.fromValues(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[h.getBoundsXY(f.create(),e)]},e.prototype._searchFeatures=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this.featureStore.forEachInBounds(n,(function(e){T.add(e)}))}var i=new Array(T.size),a=0;return T.forEach((function(e){return i[a++]=e})),T.clear(),i},e.prototype._checkQuerySupport=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new n("feature-store:unsupported-query","Unsupported query options",{query:e});return[2,s.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),_.checkSpatialQuerySupport(e,this.geometryType,this.spatialReference),g.checkProjectionSupport(this.spatialReference,e.outSR)]).then((function(){return e}))]}))}))},e.prototype._checkAttributesQuerySupport=function(e){var t=e.outFields,r=e.orderByFields,i=e.returnDistinctValues,a=e.outStatistics,o=a?a.map((function(e){return e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()})):[];if(r&&r.length>0){var s=r.map((function(e){var t=e.toLowerCase();return t.indexOf(" asc")>-1?t.split(" asc")[0]:t.indexOf(" desc")>-1?t.split(" desc")[0]:e})).filter((function(e){return-1===o.indexOf(e)}));y.validateFields(this.fieldsIndex,s,"orderByFields contains missing fields")}if(t&&t.length>0)y.validateFields(this.fieldsIndex,t,"outFields contains missing fields");else if(i)throw new n("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});y.validateWhere(this.fieldsIndex,e.where)},e.prototype._checkStatisticsQuerySupport=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,i,a,o,s,u,l,c,f,h,p;return r.__generator(this,(function(r){if(t=e.outStatistics,i=e.groupByFieldsForStatistics,a=e.having,o=i&&i.length,s=t&&t.length,a){if(!o||!s)throw new n("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});y.validateHaving(this.fieldsIndex,a,t)}if(s){if(!function(e){return e.every((function(e){return"exceedslimit"!==e.statisticType}))}(t))return[2];for(u=t.map((function(e){return e.onStatisticField})),y.validateFields(this.fieldsIndex,u,"onStatisticFields contains missing fields"),o&&y.validateFields(this.fieldsIndex,i,"groupByFieldsForStatistics contains missing fields"),l=0,c=t;l<c.length;l++)if(f=c[l],h=f.onStatisticField,"percentile_disc"!==(p=f.statisticType)&&"percentile_cont"!==p||!("statisticParameters"in f)){if("count"!==p&&h&&y.hasInvalidFieldType(h,this.fieldsIndex))throw new n("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:f,query:e})}else if(!f.statisticParameters)throw new n("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:f,query:e})}return[2]}))}))},e}();t.default=M;var E=c.create(),F=c.create()}.apply(null,n))||(e.exports=i)},ak1O:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("Gtr7"),r("qMld"),r("Vx27"),r("2Kdy")],void 0===(i=function(e,t,r,n,i,a){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var r=e.call(this,t)||this;return r._queue=[],r._onGoingRequest=null,r._abortController=i.createAbortController(),r}return r.__extends(t,e),t.prototype.destroy=function(){this.clear()},Object.defineProperty(t.prototype,"updating",{get:function(){return!this.destroyed&&(this._queue.length>0||null!=this._onGoingRequest)},enumerable:!0,configurable:!0}),t.prototype.clear=function(){if(this.destroyed)throw new Error("instance is already destroyed");for(var e=this._queue.pop();e;)e.resolver.reject(i.createAbortError()),e=this._queue.pop();this._queue.length=0,this._abortController.abort(),this._abortController=i.createAbortController()},t.prototype.push=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n=this;return r.__generator(this,(function(r){if(this.destroyed)throw new Error("instance is already destroyed");return t=i.createResolver(),this._queue.push({event:e,resolver:t}),this.notifyChange("updating"),Promise.resolve().then((function(){n._processNext()})),[2,t.promise]}))}))},t.prototype._processNext=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,n,i,a,o,s,u,l,c,f,h,p,d,y,g,v,m,_,b,x,S,I=this;return r.__generator(this,(function(r){switch(r.label){case 0:if(this._onGoingRequest)return[2];for(e=[],t=new Set,n=new Set,i=new Set,a=this._queue.shift();a;){for(o=a.event,s=o.addedFeatures,u=o.deletedFeatures,l=o.updatedFeatures,c=a.resolver,e.push(c),f=0,h=s;f<h.length;f++)p=h[f],b=p.objectId,p.error||(t.add(b),n.add(b),i.delete(b));for(d=0,y=l;d<y.length;d++)g=y[d],b=g.objectId,g.error||(n.add(b),i.delete(b));for(v=0,m=u;v<m.length;v++)_=m[v],b=_.objectId,_.error||(t.has(b)?t.delete(b):i.add(b),n.delete(b));a=this._queue.shift()}return n.size||i.size?(x=[],S=[],n.size&&n.forEach((function(e){x.push(e)})),i.size&&i.forEach((function(e){S.push(e)})),this._onGoingRequest=Promise.resolve().then((function(){return I.processEdits(x,S,{signal:I._abortController.signal})})).catch((function(){})),this.notifyChange("updating"),[4,this._onGoingRequest]):(this.notifyChange("updating"),e.forEach((function(e){return e()})),[2]);case 1:return r.sent(),this._onGoingRequest=null,this.notifyChange("updating"),e.forEach((function(e){return e()})),this._queue.length>0&&this._processNext(),[2]}}))}))},r.__decorate([a.property({constructOnly:!0})],t.prototype,"processEdits",void 0),r.__decorate([a.property({readOnly:!0})],t.prototype,"updating",null),r.__decorate([a.subclass("esri.views.2d.layers.features.controllers.EditsQueue")],t)}(n);t.EditsQueue=o}.apply(null,n))||(e.exports=i)},cGHk:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapParameters=function e(t){var r={};for(var n in t)if("declaredClass"!==n){var i=t[n];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){r[n]=[];for(var a=0;a<i.length;a++)r[n][a]=e(i[a])}else"object"==typeof i?i.toJSON&&(r[n]=JSON.stringify(i)):r[n]=i}return r}}.apply(null,n))||(e.exports=i)},d81A:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("R2Zq"),r("LxLY"),r("qMld"),r("ULaq"),r("u90+"),r("nrlZ"),r("+6sX"),r("700l"),r("Ytki"),r("Q2Em"),r("/61J"),r("zDti")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d){function y(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function g(e,t,r){return(r?e>t:e<t)?-1:(r?e<t:e>t)?1:0}function v(e,t,r){return r?t-e:e-t}function m(e,t,r,n){if(r&&"esriFieldTypeDate"===r.type){var i=new Date(e).getTime(),a=new Date(t).getTime();if(!isNaN(i)&&!isNaN(a))return v(i,a,n)}return"number"==typeof e&&"number"==typeof t?v(e,t,n):"string"==typeof e&&"string"==typeof t?(i=e.toUpperCase(),a=t.toUpperCase(),!r||"esriFieldTypeGUID"!==r.type&&"esriFieldTypeGlobalID"!==r.type?g(i,a,n):g(y(i),y(a),n)):n?1:-1}Object.defineProperty(t,"__esModule",{value:!0});var _=function(){function e(e,t,r){this.items=e,this.queryGeometry=t,this.definitionExpression=r.definitionExpression,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.fieldsIndex=r.fieldsIndex,this.timeInfo=r.timeInfo,this.featureAdapter=r.featureAdapter}return Object.defineProperty(e.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),e.prototype.createQueryResponse=function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(u.isValid(e.outSR)&&!u.equals(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=d.cleanFromGeometryEngine(r.__assign({spatialReference:e.outSR},h.project(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=d.cleanFromGeometryEngine(r.__assign({spatialReference:e.outSR},this.queryGeometry))),t},e.prototype.executeAttributesQuery=function(t){var r=f.getWhereClause(t.where,this.fieldsIndex);if(!r)return a.resolve(this);if(r.isStandardized){for(var n=0,i=[],o=0,s=this.items;o<s.length;o++){var u=s[o];r.testFeature(u,this.featureAdapter)&&(i[n++]=u)}var l=new e(i,this.queryGeometry,this);return l.definitionExpression=t.where,a.resolve(l)}return a.reject(new TypeError("Where clause is not standardized"))},e.prototype.executeObjectIdsQuery=function(t){if(!t.objectIds||!t.objectIds.length)return a.resolve(this);var r=o.SetFromValues(t.objectIds),n=this.featureAdapter.getObjectId;return a.resolve(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))},e.prototype.executeTimeQuery=function(t){var r=p.getTimeOperator(this.timeInfo,t.timeExtent,this.featureAdapter);if(!i.isSome(r))return a.resolve(this);var n=this.items.filter(r);return a.resolve(new e(n,this.queryGeometry,this))},e.prototype.filterLatest=function(){for(var t=this.timeInfo,r=t.trackIdField,i=t.startTimeField,o=t.endTimeField||i,s=new Map,u=this.featureAdapter.getAttribute,l=0,c=this.items;l<c.length;l++){var f=c[l],h=u(f,r),p=u(f,o),d=s.get(h);(!d||p>u(d,o))&&s.set(h,f)}var y=n.valuesOfMap(s);return a.resolve(new e(y,this.queryGeometry,this))},e.prototype.project=function(t){return r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return!t||u.equals(this.spatialReference,t)?[2,this]:(n=this.featureAdapter,[4,h.projectMany(this.items.map((function(e){return d.getGeometry(i.geometryType,i.hasZ,i.hasM,n.getGeometry(e))})),this.spatialReference,t)]);case 1:return[2,new e(r.sent().map((function(e,t){return n.cloneWithGeometry(i.items[t],l.convertFromGeometry(e,i.hasZ,i.hasM))})),this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:t,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}}))}))},e.prototype._sortFeatures=function(e,t,r){if(e.length>1&&t&&t.length)for(var n=function(t){var n=t.split(" "),a=n[0],o=i.fieldsIndex.get(a),s=n[1]&&"desc"===n[1].toLowerCase();e.sort((function(e,t){return m(r(e,a,o),r(t,a,o),o,s)}))},i=this,a=0,o=t.reverse();a<o.length;a++)n(o[a])},e.prototype._createFeatureQueryResponse=function(e){var t=this,n=this.items,i=this,a=i.geometryType,o=i.hasM,u=i.hasZ,l=i.objectIdField,c=i.spatialReference,f=e.outFields,h=e.outSR,p=e.quantizationParameters,y=e.resultRecordCount,g=e.resultOffset,v=e.returnZ,m=e.returnM,_=!1;if(null!=y&&null!=g){var b=g+y;_=n.length>b,n=n.slice(g,Math.min(n.length,b))}var x=f&&(f.indexOf("*")>-1?r.__spreadArrays(this.fieldsIndex.fields):f.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:_,features:this._createFeatures(e,n),fields:x,geometryType:a,hasM:o&&m,hasZ:u&&v,objectIdFieldName:l,spatialReference:d.cleanFromGeometryEngine(h||c),transform:p&&s.toQuantizationTransform(p)||null}},e.prototype._createFeatures=function(e,t){var r=new c.default(e,this.featureAdapter,this.fieldsIndex),n=this.hasM,i=this.hasZ,a=e.orderByFields,o=e.quantizationParameters,u=e.returnGeometry,l=e.returnCentroid,f=e.maxAllowableOffset,h=e.returnZ,p=void 0!==h&&h,y=e.returnM,g=i&&p,v=n&&void 0!==y&&y,m=[],_=0;if(u||l){var b=s.toQuantizationTransform(o);if(u&&!l)for(var x=0,S=t;x<S.length;x++)F=S[x],m[_++]={attributes:r.getAttributes(F),geometry:d.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(F),f,b,g,v)};else if(!u&&l)for(var I=0,T=t;I<T.length;I++)F=T[I],m[_++]={attributes:r.getAttributes(F),centroid:d.transformCentroid(this,this.featureAdapter.getCentroid(F,this),b)};else for(var w=0,P=t;w<P.length;w++)F=P[w],m[_++]={attributes:r.getAttributes(F),centroid:d.transformCentroid(this,this.featureAdapter.getCentroid(F,this),b),geometry:d.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(F),f,b,g,v)}}else for(var M=0,E=t;M<E.length;M++){var F=E[M],N=r.getAttributes(F);N&&(m[_++]={attributes:N})}return this._sortFeatures(m,a,(function(e,t,n){return r.getFieldValue(e,t,n)})),m},e.prototype._createExceedsLimitQueryResponse=function(e){for(var t=!1,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=0,o=e.outStatistics;a<o.length;a++){var s=o[a];if("exceedslimit"===s.statisticType){r=null!=s.maxPointCount?s.maxPointCount:Number.POSITIVE_INFINITY,n=null!=s.maxRecordCount?s.maxRecordCount:Number.POSITIVE_INFINITY,i=null!=s.maxVertexCount?s.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>n)t=!0;else{var u=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;t=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+(r&&r.coords.length||0)}),0)/u>i}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}},e.prototype._createStatisticsQueryResponse=function(e){for(var t=this,r={attributes:{}},i=[],a=new Map,o=new Map,s=new Map,u=new Map,l=new c.default(e,this.featureAdapter,this.fieldsIndex),f=e.outStatistics,h=e.groupByFieldsForStatistics,p=e.having,d=e.orderByFields,y=h&&h.length,g=!!y,v=g&&h[0],m=g&&!this.fieldsIndex.get(v),_=0,b=f;_<b.length;_++){var x=b[_],S=x.outStatisticFieldName,I=x.statisticType,T=x,w="exceedslimit"!==I?x.onStatisticField:void 0,P="percentile_disc"===I||"percentile_cont"===I,M=g&&1===y&&(w===v||m)&&"count"===I;if(g){if(!s.has(w)){for(var E=[],F=0,N=h;F<N.length;F++){var R=N[F],O=this._getAttributeValues(l,R,a);E.push(O)}s.set(w,this._calculateUniqueValues(E))}var A=s.get(w),C=function(e){var r=A[e],n=r.count,i=r.data,o=r.items,s=r.itemPositions,c=i.join(",");if(!p||l.validateItems(o,p)){var f=u.get(c)||{attributes:{}},d=null;if(M)d=n;else{var y=j._getAttributeValues(l,w,a),g=s.map((function(e){return y[e]}));d=P&&"statisticParameters"in T?j._getPercentileValue(T,g):j._getStatisticValue(T,g)}f.attributes[S]=d,h.forEach((function(e,r){return f.attributes[t.fieldsIndex.get(e)?e:"EXPR_"+(r+1)]=i[r]})),u.set(c,f)}},j=this;for(var G in A)C(G)}else O=this._getAttributeValues(l,w,a),r.attributes[S]=P&&"statisticParameters"in T?this._getPercentileValue(T,O):this._getStatisticValue(T,O,o);i.push({name:S,alias:S,type:"esriFieldTypeDouble"})}var k=g?n.valuesOfMap(u):[r];return this._sortFeatures(k,d,(function(e,t){return e.attributes[t]})),{fields:i,features:k}},e.prototype._getStatisticValue=function(e,t,r){var n=e.onStatisticField,i=e.statisticType,a=r&&r.has(n)?r.get(n):this._calculateStatistics(t);return r&&r.set(n,a),a["var"===i?"variance":i]},e.prototype._getPercentileValue=function(e,t){var n=e.onStatisticField,i=e.statisticParameters,a=e.statisticType,o=i.value,s="desc"===i.orderBy,u=this.fieldsIndex.get(n),l=r.__spreadArrays(t).sort((function(e,t){return m(e,t,u,s)}));return this._calculatePercentile(l,o,"percentile_disc"===a)},e.prototype._getAttributeValues=function(e,t,r){if(r.has(t))return r.get(t);var n=this.fieldsIndex.get(t),i=this.items.map((function(r){return e.getFieldValue(r,t,n)}));return r.set(t,i),i},e.prototype._calculateStatistics=function(e){for(var t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=null,i=null,a=null,o=null,s=[],u=0,l=0,c=e;l<c.length;l++)"string"==typeof(d=c[l])?u++:null==d||isNaN(d)||(n+=d,t=Math.min(t,d),r=Math.max(r,d),s.push(d),u++);if(u){i=n/u;for(var f=0,h=0,p=s;h<p.length;h++){var d=p[h];f+=Math.pow(d-i,2)}o=u>1?f/(u-1):0,a=Math.sqrt(o)}else t=null,r=null;return{avg:i,count:u,max:r,min:t,stddev:a,sum:n,variance:o}},e.prototype._calculateUniqueValues=function(e){for(var t={},r=this.items,n=r.length,i=0;i<n;i++){for(var a=r[i],o=[],s=0,u=e;s<u.length;s++){var l=u[s];o.push(l[i])}var c=o.join(",");null==t[c]?t[c]={count:1,data:o,items:[a],itemPositions:[i]}:(t[c].count++,t[c].items.push(a),t[c].itemPositions.push(i))}return t},e.prototype._calculatePercentile=function(e,t,r){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];var n=(e.length-1)*t,i=Math.floor(n),a=i+1,o=n%1,s=e[i],u=e[a];return a>=e.length||r||"string"==typeof s||"string"==typeof u?s:s*(1-o)+u*o},e}();t.default=_}.apply(null,n))||(e.exports=i)},fsiH:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("ixhC")],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.parse=function(e){return r.parse(e)},e}();t.WhereGrammar=n}.apply(null,n))||(e.exports=i)},fw2w:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("0J3i"),r("ma1f"),r("qsST"),r("LxLY"),r("qMld"),r("Vt+U"),r("aYWh"),r("Z4y+"),r("nrlZ"),r("vtMp"),r("2QEt"),r("sqdO")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d){Object.defineProperty(t,"__esModule",{value:!0});var y=a.getLogger("esri.geometry.support.normalizeUtils"),g={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new l({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:c.WebMercator}),minus180Line:new l({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:c.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new l({paths:[[[180,-180],[180,180]]],spatialReference:c.WGS84}),minus180Line:new l({paths:[[[-180,-180],[-180,180]]],spatialReference:c.WGS84})}};function v(e){return"polygon"===e.type}function m(e){return v(e)?e.rings:e.paths}function _(e,t){return Math.ceil((e-t)/(2*t))}function b(e,t){for(var r=0,n=m(e);r<n.length;r++)for(var i=0,a=n[r];i<a.length;i++)a[i][0]+=t;return e}function x(e){for(var t=[],r=0,n=0,i=0;i<e.length;i++){for(var a=e[i],o=null,s=0;s<a.length;s++)o=a[s],t.push(o),0===s?n=r=o[0]:(r=Math.min(r,o[0]),n=Math.max(n,o[0]));o&&t.push([(r+n)/2,0])}return t}function S(e,t){if(!(e instanceof l||e instanceof u)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw y.error(r),new i(r)}for(var n=[],a=0,o=m(e);a<o.length;a++){var s=o[a],c=[];n.push(c),c.push([s[0][0],s[0][1]]);for(var f=0;f<s.length-1;f++){var h=s[f][0],p=s[f][1],d=s[f+1][0],g=s[f+1][1],_=Math.sqrt((d-h)*(d-h)+(g-p)*(g-p)),b=(g-p)/_,x=(d-h)/_,S=_/t;if(S>1){for(var I=1;I<=S-1;I++){var T=I*t,w=x*T+h,P=b*T+p;c.push([w,P])}var M=(_+Math.floor(S-1)*t)/2,E=x*M+h,F=b*M+p;c.push([E,F])}c.push([d,g])}}return v(e)?new u({rings:n,spatialReference:e.spatialReference}):new l({paths:n,spatialReference:e.spatialReference})}function I(e,t,r){if(t){var n=S(e,1e6);e=h.webMercatorToGeographic(n,!0)}return r&&(e=b(e,r)),e}function T(e,t,r){var n;if(Array.isArray(e))if((n=e[0])>t){var i=_(n,t);e[0]=n+i*(-2*t)}else n<r&&(i=_(n,r),e[0]=n+i*(-2*r));else(n=e.x)>t?(i=_(n,t),e=e.clone().offset(i*(-2*t),0)):n<r&&(i=_(n,r),e=e.clone().offset(i*(-2*r),0));return e}t.straightLineDensify=S,t.normalizeCentralMeridian=function e(t,i,a){return r.__awaiter(this,void 0,void 0,(function(){var c,y,v,x,S,w,P,M,E,F,N,R,O,A,C,j,G,k,L,q,D,z,B,Q,Z,V,Y,U,J,H,W,X,K,$,ee,te,re;return r.__generator(this,(function(r){switch(r.label){case 0:if(!Array.isArray(t))return[2,e([t],i)];for(c=i?i.url:n.geometryServiceUrl,F=0,N=[],R=[],O=0,A=t;O<A.length;O++)C=A[O],o.isNone(C)?R.push(C):(y||(y=C.spatialReference,v=f.getInfo(y),x=y.isWebMercator,S=g[P=x?102100:4326].maxX,w=g[P].minX,M=g[P].plus180Line,E=g[P].minus180Line),v?"mesh"===C.type?R.push(C):"point"===C.type?R.push(T(C.clone(),S,w)):"multipoint"===C.type?((j=C.clone()).points=j.points.map((function(e){return T(e,S,w)})),R.push(j)):"extent"===C.type?(k=C.clone(),G=k._normalize(!1,!1,v),R.push(G.rings?new u(G):G)):C.extent?(k=C.extent,L=_(k.xmin,w),D=0==(q=L*(2*S))?C.clone():b(C.clone(),q),k.offset(q,0),k.intersects(M)&&k.xmax!==S?(F=k.xmax>F?k.xmax:F,D=I(D,x),N.push(D),R.push("cut")):k.intersects(E)&&k.xmin!==w?(F=k.xmax*(2*S)>F?k.xmax*(2*S):F,D=I(D,x,360),N.push(D),R.push("cut")):R.push(D)):R.push(C.clone()):R.push(C));for(z=_(F,S),B=-90,Q=z,Z=new l;z>0;)V=360*z-180,Z.addPath([[V,B],[V,-1*B]]),B*=-1,z--;return N.length>0&&Q>0?[4,p.cut(c,N,Z,a)]:[3,3];case 1:for(Y=r.sent(),U=function(e,t){for(var r=-1,n=function(n){for(var i=t.cutIndexes[n],a=t.geometries[n],o=m(a),s=function(e){var t=o[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,i=0;i<t.length;i++){var o=t[i][0];n=o>n?o:n}for(var s=-360*_(n=Number(n.toFixed(9)),180),u=0;u<t.length;u++){var l=a.getPoint(e,u);a.setPoint(e,u,l.clone().offset(s,0))}return!0}))},u=0;u<o.length;u++)s(u);if(i===r){if("polygon"===e[0].type)for(var l=0,c=m(a);l<c.length;l++){var f=c[l];e[i]=e[i].addRing(f)}else if(function(e){return"polyline"===e[0].type}(e))for(var h=0,p=m(a);h<p.length;h++){var d=p[h];e[i]=e[i].addPath(d)}}else r=i,e[i]=a},i=0;i<t.cutIndexes.length;i++)n(i);return e}(N,Y),J=[],H=[],ee=0;ee<R.length;ee++)"cut"!==(te=R[ee])?H.push(te):(re=U.shift(),W=t[ee],o.isSome(W)&&"polygon"===W.type&&W.rings&&W.rings.length>1&&re.rings.length>=W.rings.length?(J.push(re),H.push("simplify")):H.push(x?h.geographicToWebMercator(re):re));return J.length?[4,d.simplify(c,J,a)]:[2,H];case 2:for(X=r.sent(),K=[],ee=0;ee<H.length;ee++)"simplify"!==(te=H[ee])?K.push(te):K.push(x?h.geographicToWebMercator(X.shift()):X.shift());return[2,K];case 3:for($=[],ee=0;ee<R.length;ee++)"cut"!==(te=R[ee])?$.push(te):(re=N.shift(),$.push(!0===x?h.geographicToWebMercator(re):re));return[2,s.resolve($)]}}))}))},t.getDenormalizedExtent=function(e){var t;if(!e)return null;var r=e.extent;if(!r)return null;var n=e.spatialReference&&f.getInfo(e.spatialReference);if(!n)return r;var i,a=n.valid,o=a[0],s=a[1],u=2*s,l=r.width,c=r.xmin,h=r.xmax;if(c=(t=[h,c])[0],h=t[1],"extent"===e.type||0===l||l<=s||l>u||c<o||h>s)return r;switch(e.type){case"polygon":if(!(e.rings.length>1))return r;i=x(e.rings);break;case"polyline":if(!(e.paths.length>1))return r;i=x(e.paths);break;case"multipoint":i=e.points}for(var p=r.clone(),d=0;d<i.length;d++){var y=i[d][0];y<0?(y+=s,h=Math.max(y,h)):(y-=s,c=Math.min(y,c))}return p.xmin=c,p.xmax=h,p.width<l?(p.xmin-=s,p.xmax-=s,p):r},t.normalizeMapX=function(e,t){var r=f.getInfo(t);if(r){var n=r.valid,i=n[0],a=n[1],o=a-i;if(e<i)for(;e<i;)e+=o;if(e>a)for(;e>a;)e-=o}return e}}.apply(null,n))||(e.exports=i)},"gT/q":function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function n(e,t,n,a,o){if(!e)return!1;for(var s=r(t,n),u=e.coords,l=!1,c=0,f=0,h=e.lengths;f<h.length;f++){var p=h[f];l=i(l,u,s,c,p,a,o),c+=p*s}return l}function i(e,t,r,n,i,a,o){for(var s=e,u=n,l=n,c=n+i*r;l<c;l+=r){(u=l+r)===c&&(u=n);var f=t[l],h=t[l+1],p=t[u],d=t[u+1];(h<o&&d>=o||d<o&&h>=o)&&f+(o-h)/(d-h)*(p-f)<a&&(s=!s)}return s}Object.defineProperty(t,"__esModule",{value:!0}),t.polygonContainsPoint=function(e,t,r,i){return n(e,t,r,i.coords[0],i.coords[1])},t.polygonContainsMultipoint=function(e,t,i,a,o,s){var u=r(o,s),l=a.coords,c=a.lengths;if(!c)return!1;for(var f=0,h=0;f<c.length;f++,h+=u)if(!n(e,t,i,l[h],l[h+1]))return!1;return!0},t.polygonContainsCoords=n}.apply(null,n))||(e.exports=i)},ixhC:function(e,t,r){var n,i,a;i=[],void 0===(a="function"==typeof(n=function(){"use strict";function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?a(e.parts[t][0])+"-"+a(e.parts[t][1]):a(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,i,a=new Array(e.length);for(t=0;t<e.length;t++)a[t]=(i=e[t],r[i.type](i));if(a.sort(),a.length>0){for(t=1,n=1;t<a.length;t++)a[t-1]!==a[t]&&(a[n]=a[t],n++);a.length=n}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,i={},a={start:Ze},o=Ze,s=function(e,t){return Ht(e,t)},u=qe("!",!1),l=qe("=",!1),c=qe(">=",!1),f=qe(">",!1),h=qe("<=",!1),p=qe("<>",!1),d=qe("<",!1),y=qe("!=",!1),g=function(e){return e[0]+" "+e[2]},v=qe("+",!1),m=qe("-",!1),_=qe("*",!1),b=qe("/",!1),x=function(e,t){return e+t.join("")},S=/^[A-Za-z_\x80-\uFFFF]/,I=De([["A","Z"],["a","z"],"_",["",""]],!1,!1),T=/^[A-Za-z0-9_]/,w=De([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),P=/^[A-Za-z0-9_.\x80-\uFFFF]/,M=De([["A","Z"],["a","z"],["0","9"],"_",".",["",""]],!1,!1),E=qe("@",!1),F=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},N=function(e,t){return{type:"interval-period",period:"second",precision:e,secondary:t}},R=function(e){return parseFloat(e)},O=qe("'",!1),A=qe("N'",!1),C=qe("''",!1),j=/^[^']/,G=De(["'"],!0,!1),k=function(e,t){return{type:"when_clause",operand:e,value:t}},L=qe(".",!1),q=/^[0-9]/,D=De([["0","9"]],!1,!1),z=/^[eE]/,B=De(["e","E"],!1,!1),Q=/^[+\-]/,Z=De(["+","-"],!1,!1),V=qe("NULL",!0),Y=qe("TRUE",!0),U=qe("FALSE",!0),J=qe("IN",!0),H=qe("IS",!0),W=qe("LIKE",!0),X=qe("ESCAPE",!0),K=qe("NOT",!0),$=qe("AND",!0),ee=qe("OR",!0),te=qe("BETWEEN",!0),re=qe("FROM",!0),ne=qe("FOR",!0),ie=qe("SUBSTRING",!0),ae=qe("EXTRACT",!0),oe=qe("TRIM",!0),se=qe("POSITION",!0),ue=qe("TIMESTAMP",!0),le=qe("DATE",!0),ce=qe("LEADING",!0),fe=qe("TRAILING",!0),he=qe("BOTH",!0),pe=qe("TO",!0),de=qe("INTERVAL",!0),ye=qe("YEAR",!0),ge=qe("MONTH",!0),ve=qe("DAY",!0),me=qe("HOUR",!0),_e=qe("MINUTE",!0),be=qe("SECOND",!0),xe=qe("CASE",!0),Se=qe("END",!0),Ie=qe("WHEN",!0),Te=qe("THEN",!0),we=qe("ELSE",!0),Pe=qe(",",!1),Me=qe("(",!1),Ee=qe(")",!1),Fe=/^[ \t\n\r]/,Ne=De([" ","\t","\n","\r"],!1,!1),Re=qe("`",!1),Oe=/^[^`]/,Ae=De(["`"],!0,!1),Ce=0,je=[{line:1,column:1}],Ge=0,ke=[],Le=0;if("startRule"in r){if(!(r.startRule in a))throw new Error("Can't start parsing from rule \""+r.startRule+'".');o=a[r.startRule]}function qe(e,t){return{type:"literal",text:e,ignoreCase:t}}function De(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function ze(e){var r,n=je[e];if(n)return n;for(r=e-1;!je[r];)r--;for(n={line:(n=je[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return je[e]=n,n}function Be(e,t){var r=ze(e),n=ze(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function Qe(e){Ce<Ge||(Ce>Ge&&(Ge=Ce,ke=[]),ke.push(e))}function Ze(){var e,t;return e=Ce,Yt()!==i&&(t=Ye())!==i&&Yt()!==i?e=t:(Ce=e,e=i),e}function Ve(){var e,t,r,n,a,o,s,u;if(e=Ce,(t=Ye())!==i){for(r=[],n=Ce,(a=Yt())!==i&&(o=Qt())!==i&&(s=Yt())!==i&&(u=Ye())!==i?n=a=[a,o,s,u]:(Ce=n,n=i);n!==i;)r.push(n),n=Ce,(a=Yt())!==i&&(o=Qt())!==i&&(s=Yt())!==i&&(u=Ye())!==i?n=a=[a,o,s,u]:(Ce=n,n=i);r!==i?e=t=function(e,t){var r={type:"expr_list"},n=function(e,t,r){return function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t)}(e,t);return r.value=n,r}(t,r):(Ce=e,e=i)}else Ce=e,e=i;return e}function Ye(){var e,t,r,n,a,o,u,l;if(e=Ce,(t=Ue())!==i){for(r=[],n=Ce,(a=Yt())!==i&&(o=Et())!==i&&(u=Yt())!==i&&(l=Ue())!==i?n=a=[a,o,u,l]:(Ce=n,n=i);n!==i;)r.push(n),n=Ce,(a=Yt())!==i&&(o=Et())!==i&&(u=Yt())!==i&&(l=Ue())!==i?n=a=[a,o,u,l]:(Ce=n,n=i);r!==i?e=t=s(t,r):(Ce=e,e=i)}else Ce=e,e=i;return e}function Ue(){var e,t,r,n,a,o,u,l;if(e=Ce,(t=Je())!==i){for(r=[],n=Ce,(a=Yt())!==i&&(o=Mt())!==i&&(u=Yt())!==i&&(l=Je())!==i?n=a=[a,o,u,l]:(Ce=n,n=i);n!==i;)r.push(n),n=Ce,(a=Yt())!==i&&(o=Mt())!==i&&(u=Yt())!==i&&(l=Je())!==i?n=a=[a,o,u,l]:(Ce=n,n=i);r!==i?e=t=s(t,r):(Ce=e,e=i)}else Ce=e,e=i;return e}function Je(){var e,r,n,a,o;return e=Ce,(r=Pt())===i&&(r=Ce,33===t.charCodeAt(Ce)?(n="!",Ce++):(n=i,0===Le&&Qe(u)),n!==i?(a=Ce,Le++,61===t.charCodeAt(Ce)?(o="=",Ce++):(o=i,0===Le&&Qe(l)),Le--,o===i?a=void 0:(Ce=a,a=i),a!==i?r=n=[n,a]:(Ce=r,r=i)):(Ce=r,r=i)),r!==i&&(n=Yt())!==i&&(a=Je())!==i?e=r={type:"unary_expr",operator:"NOT",expr:a}:(Ce=e,e=i),e===i&&(e=function(){var e,r,n;return e=Ce,(r=Ke())!==i&&Yt()!==i?((n=function(){var e;return(e=function(){var e,t,r,n,a,o;if(e=[],t=Ce,(r=Yt())!==i&&(n=He())!==i&&(a=Yt())!==i&&(o=Ke())!==i?t=r=[r,n,a,o]:(Ce=t,t=i),t!==i)for(;t!==i;)e.push(t),t=Ce,(r=Yt())!==i&&(n=He())!==i&&(a=Yt())!==i&&(o=Ke())!==i?t=r=[r,n,a,o]:(Ce=t,t=i);else e=i;return e!==i&&(e={type:"arithmetic",tail:e}),e}())===i&&(e=function(){var e,t,r,n;return e=Ce,(t=Xe())!==i&&Yt()!==i&&(r=Zt())!==i&&Yt()!==i&&(n=Ve())!==i&&Yt()!==i&&Vt()!==i?e=t={op:t,right:n}:(Ce=e,e=i),e===i&&(e=Ce,(t=Xe())!==i&&Yt()!==i&&(r=Zt())!==i&&Yt()!==i&&(n=Vt())!==i?e=t=function(e){return{op:e,right:{type:"expr_list",value:[]}}}(t):(Ce=e,e=i),e===i&&(e=Ce,(t=Xe())!==i&&Yt()!==i&&(r=st())!==i?e=t=function(e,t){return{op:e,right:t}}(t,r):(Ce=e,e=i))),e}())===i&&(e=function(){var e,t,r,n,a,o;return e=Ce,(t=Pt())!==i&&Yt()!==i&&(r=Ft())!==i&&Yt()!==i&&(n=Ke())!==i&&Yt()!==i&&(a=Mt())!==i&&Yt()!==i&&(o=Ke())!==i?e=t={op:"NOT"+r,right:{type:"expr_list",value:[n,o]}}:(Ce=e,e=i),e===i&&(e=Ce,(t=Ft())!==i&&Yt()!==i&&(r=Ke())!==i&&Yt()!==i&&(n=Mt())!==i&&Yt()!==i&&(a=Ke())!==i?e=t=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}}(t,r,a):(Ce=e,e=i)),e}())===i&&(e=function(){var e,t,r,n;return e=Ce,(t=Tt())!==i&&Yt()!==i&&(r=Pt())!==i&&Yt()!==i&&(n=Ke())!==i?e=t={op:t+"NOT",right:n}:(Ce=e,e=i),e===i&&(e=Ce,(t=Tt())!==i&&Yt()!==i&&(r=Ke())!==i?e=t=function(e,t){return{op:e,right:t}}(t,r):(Ce=e,e=i)),e}())===i&&(e=function(){var e,r,n,a;return e=Ce,(r=We())!==i&&Yt()!==i&&(n=pt())!==i&&Yt()!==i&&function(){var e,r,n,a;return e=Ce,"escape"===t.substr(Ce,6).toLowerCase()?(r=t.substr(Ce,6),Ce+=6):(r=i,0===Le&&Qe(X)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="ESCAPE":(Ce=e,e=i)):(Ce=e,e=i),e}()!==i&&Yt()!==i&&(a=dt())!==i?e=r={op:r,right:n,escape:a.value}:(Ce=e,e=i),e===i&&(e=Ce,(r=We())!==i&&Yt()!==i&&(n=pt())!==i?e=r=function(e,t){return{op:e,right:t,escape:""}}(r,n):(Ce=e,e=i)),e}()),e}())===i&&(n=null),n!==i?e=r=function(e,t){return""==t||null==t||null==t?e:"arithmetic"==t.type?Ht(e,t.tail):Jt(t.op,e,t.right,t.escape)}(r,n):(Ce=e,e=i)):(Ce=e,e=i),e}()),e}function He(){var e;return">="===t.substr(Ce,2)?(e=">=",Ce+=2):(e=i,0===Le&&Qe(c)),e===i&&(62===t.charCodeAt(Ce)?(e=">",Ce++):(e=i,0===Le&&Qe(f)),e===i&&("<="===t.substr(Ce,2)?(e="<=",Ce+=2):(e=i,0===Le&&Qe(h)),e===i&&("<>"===t.substr(Ce,2)?(e="<>",Ce+=2):(e=i,0===Le&&Qe(p)),e===i&&(60===t.charCodeAt(Ce)?(e="<",Ce++):(e=i,0===Le&&Qe(d)),e===i&&(61===t.charCodeAt(Ce)?(e="=",Ce++):(e=i,0===Le&&Qe(l)),e===i&&("!="===t.substr(Ce,2)?(e="!=",Ce+=2):(e=i,0===Le&&Qe(y)))))))),e}function We(){var e,t,r,n,a;return e=Ce,t=Ce,(r=Pt())!==i&&(n=Yt())!==i&&(a=wt())!==i?t=r=[r,n,a]:(Ce=t,t=i),t!==i&&(t=g(t)),(e=t)===i&&(e=wt()),e}function Xe(){var e,t,r,n,a;return e=Ce,t=Ce,(r=Pt())!==i&&(n=Yt())!==i&&(a=It())!==i?t=r=[r,n,a]:(Ce=t,t=i),t!==i&&(t=g(t)),(e=t)===i&&(e=It()),e}function Ke(){var e,t,r,n,a,o,u,l;if(e=Ce,(t=et())!==i){for(r=[],n=Ce,(a=Yt())!==i&&(o=$e())!==i&&(u=Yt())!==i&&(l=et())!==i?n=a=[a,o,u,l]:(Ce=n,n=i);n!==i;)r.push(n),n=Ce,(a=Yt())!==i&&(o=$e())!==i&&(u=Yt())!==i&&(l=et())!==i?n=a=[a,o,u,l]:(Ce=n,n=i);r!==i?e=t=s(t,r):(Ce=e,e=i)}else Ce=e,e=i;return e}function $e(){var e;return 43===t.charCodeAt(Ce)?(e="+",Ce++):(e=i,0===Le&&Qe(v)),e===i&&(45===t.charCodeAt(Ce)?(e="-",Ce++):(e=i,0===Le&&Qe(m))),e}function et(){var e,t,r,n,a,o,s,u;if(e=Ce,(t=rt())!==i){for(r=[],n=Ce,(a=Yt())!==i&&(o=tt())!==i&&(s=Yt())!==i&&(u=rt())!==i?n=a=[a,o,s,u]:(Ce=n,n=i);n!==i;)r.push(n),n=Ce,(a=Yt())!==i&&(o=tt())!==i&&(s=Yt())!==i&&(u=rt())!==i?n=a=[a,o,s,u]:(Ce=n,n=i);r!==i?e=t=Ht(t,r):(Ce=e,e=i)}else Ce=e,e=i;return e}function tt(){var e;return 42===t.charCodeAt(Ce)?(e="*",Ce++):(e=i,0===Le&&Qe(_)),e===i&&(47===t.charCodeAt(Ce)?(e="/",Ce++):(e=i,0===Le&&Qe(b))),e}function rt(){var e,r,n;return(e=function(){var e;return(e=dt())===i&&(e=function(){var e,t,r,n;return e=Ce,(t=function(){var e,t,r,n;return e=Ce,(t=mt())!==i&&(r=_t())!==i&&(n=bt())!==i?e=t=parseFloat(t+r+n):(Ce=e,e=i),e===i&&(e=Ce,(t=mt())!==i&&(r=_t())!==i?e=t=function(e,t){return parseFloat(e+t)}(t,r):(Ce=e,e=i),e===i&&(e=Ce,(t=mt())!==i&&(r=bt())!==i?e=t=function(e,t){return parseFloat(e+t)}(t,r):(Ce=e,e=i),e===i&&(e=Ce,(t=mt())!==i&&(t=function(e){return parseFloat(e)}(t)),e=t))),e}())!==i?(r=Ce,Le++,n=it(),Le--,n===i?r=void 0:(Ce=r,r=i),r!==i?e=t={type:"number",value:t}:(Ce=e,e=i)):(Ce=e,e=i),e}())===i&&(e=function(){var e,r;return e=Ce,(r=function(){var e,r,n,a;return e=Ce,"true"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(Y)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r=[r,n]:(Ce=e,e=i)):(Ce=e,e=i),e}())!==i&&(r={type:"bool",value:!0}),(e=r)===i&&(e=Ce,(r=function(){var e,r,n,a;return e=Ce,"false"===t.substr(Ce,5).toLowerCase()?(r=t.substr(Ce,5),Ce+=5):(r=i,0===Le&&Qe(U)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r=[r,n]:(Ce=e,e=i)):(Ce=e,e=i),e}())!==i&&(r={type:"bool",value:!1}),e=r),e}())===i&&(e=function(){var e;return(e=function(){var e,r,n,a;return e=Ce,"null"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(V)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r=[r,n]:(Ce=e,e=i)):(Ce=e,e=i),e}())!==i&&(e={type:"null",value:null}),e}())===i&&(e=function(){var e,r;return e=Ce,function(){var e,r,n,a;return e=Ce,"date"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(le)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="DATE":(Ce=e,e=i)):(Ce=e,e=i),e}()!==i&&Yt()!==i&&(r=pt())!==i?e={type:"date",value:r.value}:(Ce=e,e=i),e}())===i&&(e=function(){var e,r;return e=Ce,function(){var e,r,n,a;return e=Ce,"timestamp"===t.substr(Ce,9).toLowerCase()?(r=t.substr(Ce,9),Ce+=9):(r=i,0===Le&&Qe(ue)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="TIMESTAMP":(Ce=e,e=i)):(Ce=e,e=i),e}()!==i&&Yt()!==i&&(r=pt())!==i?e={type:"timestamp",value:r.value}:(Ce=e,e=i),e}())===i&&(e=function(){var e,r,n,a;return e=Ce,Ot()!==i&&Yt()!==i?(45===t.charCodeAt(Ce)?(r="-",Ce++):(r=i,0===Le&&Qe(m)),r===i&&(43===t.charCodeAt(Ce)?(r="+",Ce++):(r=i,0===Le&&Qe(v))),r!==i&&Yt()!==i&&(n=pt())!==i&&Yt()!==i&&(a=lt())!==i?e={type:"interval",value:n,qualifier:a,op:r}:(Ce=e,e=i)):(Ce=e,e=i),e===i&&(e=Ce,Ot()!==i&&Yt()!==i&&(r=pt())!==i&&Yt()!==i&&(n=lt())!==i?e=function(e,t){return{type:"interval",value:e,qualifier:t,op:""}}(r,n):(Ce=e,e=i)),e}()),e}())===i&&(e=function(){var e,r,n;return e=Ce,function(){var e,r,n,a;return e=Ce,"extract"===t.substr(Ce,7).toLowerCase()?(r=t.substr(Ce,7),Ce+=7):(r=i,0===Le&&Qe(ae)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="EXTRACT":(Ce=e,e=i)):(Ce=e,e=i),e}()!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i&&(r=function(){var e;return(e=At())===i&&(e=Ct())===i&&(e=jt())===i&&(e=Gt())===i&&(e=kt())===i&&(e=Lt()),e}())!==i&&Yt()!==i&&Nt()!==i&&Yt()!==i&&(n=Ye())!==i&&Yt()!==i&&Vt()!==i?e={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:r},n]}}:(Ce=e,e=i),e}())===i&&(e=function(){var e,r,n,a,o,s,u,l,c,f,h;return e=Ce,function(){var e,r,n,a;return e=Ce,"substring"===t.substr(Ce,9).toLowerCase()?(r=t.substr(Ce,9),Ce+=9):(r=i,0===Le&&Qe(ie)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="SUBSTRING":(Ce=e,e=i)):(Ce=e,e=i),e}()!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i&&(r=Ye())!==i&&Yt()!==i&&Nt()!==i&&Yt()!==i&&(n=Ye())!==i&&Yt()!==i?(a=Ce,(o=function(){var e,r,n,a;return e=Ce,"for"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=i,0===Le&&Qe(ne)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="FOR":(Ce=e,e=i)):(Ce=e,e=i),e}())!==i&&(s=Yt())!==i&&(u=Ye())!==i&&(l=Yt())!==i?a=o=[o,s,u,l]:(Ce=a,a=i),a===i&&(a=null),a!==i&&(o=Vt())!==i?(c=r,f=n,e={type:"function",name:"substring",args:{type:"expr_list",value:(h=a)?[c,f,h[2]]:[c,f]}}):(Ce=e,e=i)):(Ce=e,e=i),e}())===i&&(e=function(){var e,t,r,n,a;return e=Ce,Rt()!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i?((t=ut())===i&&(t=null),t!==i&&Yt()!==i&&(r=Ye())!==i&&Yt()!==i&&Nt()!==i&&Yt()!==i&&(n=Ye())!==i&&Yt()!==i&&Vt()!==i?e={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==(a=t)?"BOTH":a},r,n]}}:(Ce=e,e=i)):(Ce=e,e=i),e===i&&(e=Ce,Rt()!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i?((t=ut())===i&&(t=null),t!==i&&Yt()!==i&&(r=Ye())!==i&&Yt()!==i&&Vt()!==i?e=function(e,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t]}}}(t,r):(Ce=e,e=i)):(Ce=e,e=i)),e}())===i&&(e=function(){var e,r,n;return e=Ce,function(){var e,r,n,a;return e=Ce,"position"===t.substr(Ce,8).toLowerCase()?(r=t.substr(Ce,8),Ce+=8):(r=i,0===Le&&Qe(se)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="POSITION":(Ce=e,e=i)):(Ce=e,e=i),e}()!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i&&(r=Ye())!==i&&Yt()!==i&&It()!==i&&Yt()!==i&&(n=Ye())!==i&&Yt()!==i&&Vt()!==i?e={type:"function",name:"position",args:{type:"expr_list",value:[r,n]}}:(Ce=e,e=i),e}())===i&&(e=function(){var e,r,n;return e=Ce,(r=function(){var e,r,n,a;if(e=Ce,(r=nt())!==i&&(r=r),(e=r)===i)if(e=Ce,96===t.charCodeAt(Ce)?(r="`",Ce++):(r=i,0===Le&&Qe(Re)),r!==i){if(n=[],Oe.test(t.charAt(Ce))?(a=t.charAt(Ce),Ce++):(a=i,0===Le&&Qe(Ae)),a!==i)for(;a!==i;)n.push(a),Oe.test(t.charAt(Ce))?(a=t.charAt(Ce),Ce++):(a=i,0===Le&&Qe(Ae));else n=i;n!==i?(96===t.charCodeAt(Ce)?(a="`",Ce++):(a=i,0===Le&&Qe(Re)),a!==i?e=r=n.join(""):(Ce=e,e=i)):(Ce=e,e=i)}else Ce=e,e=i;return e}())!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i?((n=Ve())===i&&(n=null),n!==i&&Yt()!==i&&Vt()!==i?e=r={type:"function",name:r,args:n||{type:"expr_list",value:[]}}:(Ce=e,e=i)):(Ce=e,e=i),e}())===i&&(e=function(){var e;return(e=function(){var e,t,r,n,a;if(e=Ce,qt()!==i)if(Yt()!==i)if((t=Ye())!==i)if(Yt()!==i){for(r=[],n=gt();n!==i;)r.push(n),n=gt();r!==i&&(n=Yt())!==i&&(a=Dt())!==i?e={type:"case_expression",format:"simple",operand:t,clauses:r,else:null}:(Ce=e,e=i)}else Ce=e,e=i;else Ce=e,e=i;else Ce=e,e=i;else Ce=e,e=i;if(e===i)if(e=Ce,qt()!==i)if(Yt()!==i)if((t=Ye())!==i)if(Yt()!==i){for(r=[],n=gt();n!==i;)r.push(n),n=gt();r!==i&&(n=Yt())!==i&&(a=vt())!==i&&Yt()!==i&&Dt()!==i?e=function(e,t,r){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:r.value}}(t,r,a):(Ce=e,e=i)}else Ce=e,e=i;else Ce=e,e=i;else Ce=e,e=i;else Ce=e,e=i;return e}())===i&&(e=function(){var e,t,r,n;if(e=Ce,qt()!==i)if(Yt()!==i){for(t=[],r=yt();r!==i;)t.push(r),r=yt();t!==i&&(r=Yt())!==i&&(n=Dt())!==i?e={type:"case_expression",format:"searched",clauses:t,else:null}:(Ce=e,e=i)}else Ce=e,e=i;else Ce=e,e=i;if(e===i)if(e=Ce,qt()!==i)if(Yt()!==i){for(t=[],r=yt();r!==i;)t.push(r),r=yt();t!==i&&(r=Yt())!==i&&(n=vt())!==i&&Yt()!==i&&Dt()!==i?e=function(e,t){return{type:"case_expression",format:"searched",clauses:e,else:t.value}}(t,n):(Ce=e,e=i)}else Ce=e,e=i;else Ce=e,e=i;return e}()),e}())===i&&(e=function(){var e,t;return(e=function(){var e;return(e=function(){var e,t,r,n;if(e=Ce,(t=it())!==i){for(r=[],n=ot();n!==i;)r.push(n),n=ot();r!==i?e=t=x(t,r):(Ce=e,e=i)}else Ce=e,e=i;return e}())!==i&&(e=e),e}())!==i&&(e=/^CURRENT_DATE$/i.test(t=e)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(t)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:t}),e}())===i&&(e=st())===i&&(e=Ce,Zt()!==i&&Yt()!==i&&(r=Ye())!==i&&Yt()!==i&&Vt()!==i?((n=r).paren=!0,e=n):(Ce=e,e=i)),e}function nt(){var e,t,r,n;if(e=Ce,(t=it())!==i){for(r=[],n=at();n!==i;)r.push(n),n=at();r!==i?e=t=x(t,r):(Ce=e,e=i)}else Ce=e,e=i;return e}function it(){var e;return S.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=i,0===Le&&Qe(I)),e}function at(){var e;return T.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=i,0===Le&&Qe(w)),e}function ot(){var e;return P.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=i,0===Le&&Qe(M)),e}function st(){var e,r,n;return e=Ce,64===t.charCodeAt(Ce)?(r="@",Ce++):(r=i,0===Le&&Qe(E)),r!==i&&(n=nt())!==i?e=r=[r,n]:(Ce=e,e=i),e!==i&&(e={type:"param",value:e[1]}),e}function ut(){var e;return(e=function(){var e,r,n,a;return e=Ce,"leading"===t.substr(Ce,7).toLowerCase()?(r=t.substr(Ce,7),Ce+=7):(r=i,0===Le&&Qe(ce)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="LEADING":(Ce=e,e=i)):(Ce=e,e=i),e}())===i&&(e=function(){var e,r,n,a;return e=Ce,"trailing"===t.substr(Ce,8).toLowerCase()?(r=t.substr(Ce,8),Ce+=8):(r=i,0===Le&&Qe(fe)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="TRAILING":(Ce=e,e=i)):(Ce=e,e=i),e}())===i&&(e=function(){var e,r,n,a;return e=Ce,"both"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(he)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="BOTH":(Ce=e,e=i)):(Ce=e,e=i),e}()),e}function lt(){var e,r,n;return e=Ce,(r=function(){var e,t,r,n;return e=Ce,(t=ct())!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i&&(r=ht())!==i&&Yt()!==i&&Vt()!==i?(n=r,e=t={type:"interval-period",period:t.value,precision:n,secondary:null}):(Ce=e,e=i),e===i&&(e=Ce,(t=ct())!==i&&(t=F(t)),e=t),e}())!==i&&Yt()!==i&&function(){var e,r,n,a;return e=Ce,"to"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=i,0===Le&&Qe(pe)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="TO":(Ce=e,e=i)):(Ce=e,e=i),e}()!==i&&Yt()!==i&&(n=function(){var e,t,r,n;return e=Ce,(t=ct())!==i&&(t={type:"interval-period",period:t.value,precision:null,secondary:null}),(e=t)===i&&(e=Ce,(t=Lt())!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i&&(r=ht())!==i&&Yt()!==i&&Qt()!==i&&Yt()!==i&&(n=ft())!==i&&Yt()!==i&&Vt()!==i?e=t=N(r,n):(Ce=e,e=i),e===i&&(e=Ce,(t=Lt())!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i&&(r=ht())!==i&&Yt()!==i&&Vt()!==i?e=t={type:"interval-period",period:"second",precision:r,secondary:null}:(Ce=e,e=i),e===i&&(e=Ce,(t=Lt())!==i&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t))),e}())!==i?e=r={type:"interval-qualifier",start:r,end:n}:(Ce=e,e=i),e===i&&(e=function(){var e,t,r,n,a;return e=Ce,(t=ct())!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i&&(r=ft())!==i&&Yt()!==i&&Vt()!==i?(a=r,e=t={type:"interval-period",period:t.value,precision:a,secondary:null}):(Ce=e,e=i),e===i&&(e=Ce,(t=ct())!==i&&(t=F(t)),(e=t)===i&&(e=Ce,(t=Lt())!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i&&(r=ht())!==i&&Yt()!==i&&Qt()!==i&&Yt()!==i&&(n=ft())!==i&&Yt()!==i&&Vt()!==i?e=t=N(r,n):(Ce=e,e=i),e===i&&(e=Ce,(t=Lt())!==i&&Yt()!==i&&Zt()!==i&&Yt()!==i&&(r=ft())!==i&&Yt()!==i&&Vt()!==i?e=t=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(r):(Ce=e,e=i),e===i&&(e=Ce,(t=Lt())!==i&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t)))),e}()),e}function ct(){var e,t;return e=Ce,(t=jt())!==i&&(t={type:"string",value:"day"}),(e=t)===i&&(e=Ce,(t=Gt())!==i&&(t={type:"string",value:"hour"}),(e=t)===i&&(e=Ce,(t=kt())!==i&&(t={type:"string",value:"minute"}),(e=t)===i&&(e=Ce,(t=Ct())!==i&&(t={type:"string",value:"month"}),(e=t)===i&&(e=Ce,(t=At())!==i&&(t={type:"string",value:"year"}),e=t)))),e}function ft(){var e;return(e=xt())!==i&&(e=R(e)),e}function ht(){var e;return(e=xt())!==i&&(e=R(e)),e}function pt(){var e;return(e=dt())===i&&(e=st()),e}function dt(){var e,r,n,a,o;if(e=Ce,39===t.charCodeAt(Ce)?(r="'",Ce++):(r=i,0===Le&&Qe(O)),r===i&&("N'"===t.substr(Ce,2)?(r="N'",Ce+=2):(r=i,0===Le&&Qe(A))),r!==i){for(n=[],a=Ce,"''"===t.substr(Ce,2)?(o="''",Ce+=2):(o=i,0===Le&&Qe(C)),o!==i&&(o="'"),(a=o)===i&&(j.test(t.charAt(Ce))?(a=t.charAt(Ce),Ce++):(a=i,0===Le&&Qe(G)));a!==i;)n.push(a),a=Ce,"''"===t.substr(Ce,2)?(o="''",Ce+=2):(o=i,0===Le&&Qe(C)),o!==i&&(o="'"),(a=o)===i&&(j.test(t.charAt(Ce))?(a=t.charAt(Ce),Ce++):(a=i,0===Le&&Qe(G)));n!==i?(39===t.charCodeAt(Ce)?(a="'",Ce++):(a=i,0===Le&&Qe(O)),a!==i?e=r={type:"string",value:n.join("")}:(Ce=e,e=i)):(Ce=e,e=i)}else Ce=e,e=i;return e}function yt(){var e,t,r;return e=Ce,zt()!==i&&Yt()!==i&&(t=Ye())!==i&&Yt()!==i&&Bt()!==i&&Yt()!==i&&(r=Ye())!==i?e=k(t,r):(Ce=e,e=i),e}function gt(){var e,t,r;return e=Ce,zt()!==i&&Yt()!==i&&(t=Ye())!==i&&Yt()!==i&&Bt()!==i&&Yt()!==i&&(r=Ye())!==i?e=k(t,r):(Ce=e,e=i),e}function vt(){var e,r;return e=Ce,function(){var e,r,n,a;return e=Ce,"else"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(we)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="ELSE":(Ce=e,e=i)):(Ce=e,e=i),e}()!==i&&Yt()!==i&&(r=Ye())!==i?e={type:"else_clause",value:r}:(Ce=e,e=i),e}function mt(){var e,r,n,a;return(e=xt())===i&&(e=Ce,45===t.charCodeAt(Ce)?(r="-",Ce++):(r=i,0===Le&&Qe(m)),r===i&&(43===t.charCodeAt(Ce)?(r="+",Ce++):(r=i,0===Le&&Qe(v))),r!==i&&(n=xt())!==i?(a=n,e=r=r[0]+a):(Ce=e,e=i)),e}function _t(){var e,r,n,a;return e=Ce,46===t.charCodeAt(Ce)?(r=".",Ce++):(r=i,0===Le&&Qe(L)),r!==i?((n=xt())===i&&(n=null),n!==i?e=r="."+(null!=(a=n)?a:""):(Ce=e,e=i)):(Ce=e,e=i),e}function bt(){var e,r,n;return e=Ce,(r=function(){var e,r,n,a;return e=Ce,z.test(t.charAt(Ce))?(r=t.charAt(Ce),Ce++):(r=i,0===Le&&Qe(B)),r!==i?(Q.test(t.charAt(Ce))?(n=t.charAt(Ce),Ce++):(n=i,0===Le&&Qe(Z)),n===i&&(n=null),n!==i?e=r="e"+(null===(a=n)?"":a):(Ce=e,e=i)):(Ce=e,e=i),e}())!==i&&(n=xt())!==i?e=r+=n:(Ce=e,e=i),e}function xt(){var e,t;if(e=[],(t=St())!==i)for(;t!==i;)e.push(t),t=St();else e=i;return e!==i&&(e=e.join("")),e}function St(){var e;return q.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=i,0===Le&&Qe(D)),e}function It(){var e,r,n,a;return e=Ce,"in"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=i,0===Le&&Qe(J)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="IN":(Ce=e,e=i)):(Ce=e,e=i),e}function Tt(){var e,r,n,a;return e=Ce,"is"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=i,0===Le&&Qe(H)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="IS":(Ce=e,e=i)):(Ce=e,e=i),e}function wt(){var e,r,n,a;return e=Ce,"like"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(W)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="LIKE":(Ce=e,e=i)):(Ce=e,e=i),e}function Pt(){var e,r,n,a;return e=Ce,"not"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=i,0===Le&&Qe(K)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="NOT":(Ce=e,e=i)):(Ce=e,e=i),e}function Mt(){var e,r,n,a;return e=Ce,"and"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=i,0===Le&&Qe($)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="AND":(Ce=e,e=i)):(Ce=e,e=i),e}function Et(){var e,r,n,a;return e=Ce,"or"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=i,0===Le&&Qe(ee)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="OR":(Ce=e,e=i)):(Ce=e,e=i),e}function Ft(){var e,r,n,a;return e=Ce,"between"===t.substr(Ce,7).toLowerCase()?(r=t.substr(Ce,7),Ce+=7):(r=i,0===Le&&Qe(te)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="BETWEEN":(Ce=e,e=i)):(Ce=e,e=i),e}function Nt(){var e,r,n,a;return e=Ce,"from"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(re)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="FROM":(Ce=e,e=i)):(Ce=e,e=i),e}function Rt(){var e,r,n,a;return e=Ce,"trim"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(oe)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="TRIM":(Ce=e,e=i)):(Ce=e,e=i),e}function Ot(){var e,r,n,a;return e=Ce,"interval"===t.substr(Ce,8).toLowerCase()?(r=t.substr(Ce,8),Ce+=8):(r=i,0===Le&&Qe(de)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="INTERVAL":(Ce=e,e=i)):(Ce=e,e=i),e}function At(){var e,r,n,a;return e=Ce,"year"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(ye)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="YEAR":(Ce=e,e=i)):(Ce=e,e=i),e}function Ct(){var e,r,n,a;return e=Ce,"month"===t.substr(Ce,5).toLowerCase()?(r=t.substr(Ce,5),Ce+=5):(r=i,0===Le&&Qe(ge)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="MONTH":(Ce=e,e=i)):(Ce=e,e=i),e}function jt(){var e,r,n,a;return e=Ce,"day"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=i,0===Le&&Qe(ve)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="DAY":(Ce=e,e=i)):(Ce=e,e=i),e}function Gt(){var e,r,n,a;return e=Ce,"hour"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(me)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="HOUR":(Ce=e,e=i)):(Ce=e,e=i),e}function kt(){var e,r,n,a;return e=Ce,"minute"===t.substr(Ce,6).toLowerCase()?(r=t.substr(Ce,6),Ce+=6):(r=i,0===Le&&Qe(_e)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="MINUTE":(Ce=e,e=i)):(Ce=e,e=i),e}function Lt(){var e,r,n,a;return e=Ce,"second"===t.substr(Ce,6).toLowerCase()?(r=t.substr(Ce,6),Ce+=6):(r=i,0===Le&&Qe(be)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="SECOND":(Ce=e,e=i)):(Ce=e,e=i),e}function qt(){var e,r,n,a;return e=Ce,"case"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(xe)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="CASE":(Ce=e,e=i)):(Ce=e,e=i),e}function Dt(){var e,r,n,a;return e=Ce,"end"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=i,0===Le&&Qe(Se)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="END":(Ce=e,e=i)):(Ce=e,e=i),e}function zt(){var e,r,n,a;return e=Ce,"when"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(Ie)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="WHEN":(Ce=e,e=i)):(Ce=e,e=i),e}function Bt(){var e,r,n,a;return e=Ce,"then"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=i,0===Le&&Qe(Te)),r!==i?(n=Ce,Le++,a=at(),Le--,a===i?n=void 0:(Ce=n,n=i),n!==i?e=r="THEN":(Ce=e,e=i)):(Ce=e,e=i),e}function Qt(){var e;return 44===t.charCodeAt(Ce)?(e=",",Ce++):(e=i,0===Le&&Qe(Pe)),e}function Zt(){var e;return 40===t.charCodeAt(Ce)?(e="(",Ce++):(e=i,0===Le&&Qe(Me)),e}function Vt(){var e;return 41===t.charCodeAt(Ce)?(e=")",Ce++):(e=i,0===Le&&Qe(Ee)),e}function Yt(){var e,t;for(e=[],t=Ut();t!==i;)e.push(t),t=Ut();return e}function Ut(){var e;return Fe.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=i,0===Le&&Qe(Ne)),e}function Jt(e,t,r,n){var i={type:"binary_expr",operator:e,left:t,right:r};return void 0!==n&&(i.escape=n),i}function Ht(e,t){for(var r=e,n=0;n<t.length;n++)r=Jt(t[n][1],r,t[n][3]);return r}if((n=o())!==i&&Ce===t.length)return n;throw n!==i&&Ce<t.length&&Qe({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(ke,Ge<t.length?t.charAt(Ge):null,Ge<t.length?Be(Ge,Ge+1):Be(Ge,Ge))}}})?n.apply(null,i):n)||(e.exports=a)},l8NS:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("nRUF")],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}return e.fixDefaults=function(e){if(null!==e.precision||null!==e.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")},e.createFromMilliseconds=function(t){var r=new e;return r.second=t/1e3,r},e.createFromValueAndQualifer=function(t,r,n){var i=new e;if(i.op="-"===n?"-":"+","interval-period"===r.type){e.fixDefaults(r);var a=new RegExp("^[0-9]{1,}$");if("year"===r.period||"month"===r.period)throw new Error("Year-Month Intervals not supported");if(!a.test(t))throw new Error("Illegal Interval");i[r.period]=parseFloat(t)}else{if(e.fixDefaults(r.start),e.fixDefaults(r.end),"year"===r.start.period||"month"===r.start.period)throw new Error("Year-Month Intervals not supported");if("year"===r.end.period||"month"===r.end.period)throw new Error("Year-Month Intervals not supported");switch(r.start.period){case"day":switch(r.end.period){case"hour":if(!new RegExp("^[0-9]{1,} [0-9]{1,}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]),i[r.end.period]=parseFloat(t.split(" ")[1]);break;case"minute":if(!new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]);var o=t.split(" ")[1].split(":");i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]);break;case"second":if(!new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]),o=t.split(" ")[1].split(":"),i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]),i.second=parseFloat(o[2]);break;default:throw"Invalid Interval."}break;case"hour":switch(r.end.period){case"minute":if(!new RegExp("^[0-9]{1,}:[0-9]{1,}$").test(t))throw new Error("Illegal Interval");i.hour=parseFloat(t.split(":")[0]),i.minute=parseFloat(t.split(":")[1]);break;case"second":if(!new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");o=t.split(":"),i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]),i.second=parseFloat(o[2]);break;default:throw"Invalid Interval."}break;case"minute":switch(r.end.period){case"second":if(!new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");o=t.split(":"),i.minute=parseFloat(o[0]),i.second=parseFloat(o[1]);break;default:throw"Invalid Interval."}break;default:throw"Invalid Interval."}}return i},e.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)},e}();t.SqlInterval=n,t.evaluateFunction=function(e,t){var r=i[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)},t.isStandardized=function(e,t){var r=i[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams};var i={extract:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];if(null==r)return null;if(r instanceof Date)switch(t.toUpperCase()){case"SECOND":return r.getSeconds();case"MINUTE":return r.getMinutes();case"HOUR":return r.getHours();case"DAY":return r.getDate();case"MONTH":return r.getMonth()+1;case"YEAR":return r.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:function(e){if(2===e.length){var t=e[0],r=e[1];return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){t=e[0],r=e[1];var n=e[2];return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];return null==t||null==r?null:r.indexOf(t)+1}},trim:{minParams:2,maxParams:3,evaluate:function(e){var t=3===e.length,n=t?e[1]:" ",i=t?e[2]:e[1];if(null==n||null==i)return null;var a="("+r.escapeRegExpString(n)+")";switch(e[0]){case"BOTH":return i.replace(new RegExp("^"+a+"*|"+a+"*$","g"),"");case"LEADING":return i.replace(new RegExp("^"+a+"*","g"),"");case"TRAILING":return i.replace(new RegExp(a+"*$","g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.abs(e[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.ceil(e[0])}},floor:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.floor(e[0])}},log:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])}},log10:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sin(e[0])}},cos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.cos(e[0])}},tan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.tan(e[0])}},asin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.asin(e[0])}},acos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.acos(e[0])}},atan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.atan(e[0])}},sign:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0]>0?1:e[1]<0?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:Math.pow(e[0],e[1])}},mod:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:e[0]%e[1]}},round:{minParams:1,maxParams:2,evaluate:function(e){var t=e[0],r=2===e.length?Math.pow(10,e[1]):1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:function(e){return null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(e){return"string"==typeof e[0]||e[0]instanceof String?e[0].length:0}},concat:{minParams:1,maxParams:1/0,evaluate:function(e){for(var t="",r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toUpperCase()}}}}.apply(null,n))||(e.exports=i)},oWCy:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("qMld"),r("jBNx"),r("fb50"),r("YaB4"),r("tI6k"),r("wjMf")],void 0===(i=function(e,t,r,n,i,a,o,s,u){Object.defineProperty(t,"__esModule",{value:!0});var l={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,"picture-fill":1,cim:1,"web-style":1};t.computePxBuffer=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var a,o,s,u,l,c,f;return r.__generator(this,(function(r){switch(r.label){case 0:if("heatmap"===e.type)return[2,Math.round(3*e.blurRadius)];if("dot-density"===e.type)return[2,0];if("dictionary"===e.type)return"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?[2,100]:[2,50];for(a=e.getSymbols(),o=function(e){if(!("visualVariables"in e))return 0;if(!e.hasVisualVariables("size"))return 0;var t=e.getVisualVariablesForType("size");if(!t[0])return 0;var r=t[0];return"stops"===r.transformationType?r.stops.map((function(e){return e.size})).reduce(v,0):"clamped-linear"===r.transformationType?"number"==typeof r.maxSize?r.maxSize:r.maxSize.stops.map((function(e){return e.size})).reduce(v,0):"real-world-size"===r.transformationType?30:void 0}(e),s=[],u=0,l=a;u<l.length;u++)c=l[u],s.push(y(c,o));return[4,n.all(s)];case 1:return f=r.sent(),[2,i.pt2px(f.reduce(v,0))]}}))}))};var c=[0,0,0,0];function f(e,t){return null==e?t:e}function h(e,t){return null==e.outline?t:f(e.outline.width,t)}var p={sdf:!0,code:99,metrics:s.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new a.default(0,0,24,24),page:0,textureBinding:2};function d(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,a,s,l,y,v,m,_,b,x,S,I,T;return r.__generator(this,(function(w){switch(w.label){case 0:return"simple-marker"===e.type?(n=Math.max(f(e.size,12),t),[2,g(e)+.707*n]):"picture-marker"===e.type?(i=Math.max(f(e.height,12),t),a=f(e.width,12)*(i/f(e.height,12)),s=a/2,l=i/2,[2,g(e)+Math.sqrt(s*s+l*l)]):"text"===e.type?(y=function(e){var t=e.text&&e.text.length;if(!t)return{glyphMosaicItems:[p]};for(var n=[],i=0;i<t;i++)n.push(r.__assign(r.__assign({},p),{code:e.text.charCodeAt(i)}));return{glyphMosaicItems:n}}(e),u.getTextSymbolSize(c,e,y),v=Math.abs(c[0]),m=Math.abs(c[1]),_=c[2],b=c[3],[2,Math.max(v,m)+Math.max(_,b)]):"simple-line"===e.type?(x=e,S=Math.max(f(x.width,.75),t)/2,x.marker?[2,Math.max(6*x.width,2*t)]:[2,S]):"simple-fill"===e.type||"picture-fill"===e.type?[2,Math.max(h(e,0),t)/2]:"cim"===e.type?(I=o.CIMSymbolHelper.getEnvelope(e.data))?[2,Math.sqrt(I.width*I.width+I.height*I.height)]:[2,0]:"web-style"!==e.type?[3,2]:(T=d,[4,e.fetchCIMSymbol()]);case 1:return[2,T.apply(void 0,[w.sent(),t])];case 2:return[2,0]}}))}))}function y(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return function(e){return e.type in l}(e)?(i=(n=Math).min,[4,d(e,t)]):[2,0];case 1:return[2,i.apply(n,[r.sent(),75])]}}))}))}function g(e){var t=f(e.xoffset,0),r=f(e.yoffset,0);return Math.sqrt(t*t+r*r)}function v(e,t){return Math.max(e,t)}}.apply(null,n))||(e.exports=i)},rfv1:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("BcWh"),r("qsST"),r("LxLY"),r("WRgd"),r("lRq4"),r("nrlZ"),r("+6sX"),r("2xGR"),r("ZGAQ"),r("yLD6")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p){Object.defineProperty(t,"__esModule",{value:!0});var d=a.getLogger("esri.layers.graphics.data.FeatureStore"),y=function(){function e(e){this.geometryInfo=e,this._boundsStore=new f.BoundsStore,this._featuresById=new Map,this._markedIds=new Set,this.events=new i,this.featureAdapter=p.optimizedFeatureQueryEngineAdapter}return Object.defineProperty(e.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullBounds",{get:function(){var e=this;if(!this.numFeatures)return null;var t=u.create(u.NEGATIVE_INFINITY);return this._featuresById.forEach((function(r){var n=e._boundsStore.get(r.objectId);n&&(t[0]=Math.min(n[0],t[0]),t[1]=Math.min(n[1],t[1]),t[2]=Math.max(n[2],t[2]),t[3]=Math.max(n[3],t[3]))})),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storeStatistics",{get:function(){var e=0;return this._featuresById.forEach((function(t){t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this._add(e),this._emitChanged()},e.prototype.addMany=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this._add(n)}this._emitChanged()},e.prototype.clear=function(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()},e.prototype.removeById=function(e){var t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null},e.prototype.removeManyById=function(e){this._boundsStore.invalidateIndex();for(var t=0,r=e;t<r.length;t++){var n=r[t],i=this._featuresById.get(n);i&&this._remove(i)}this._emitChanged()},e.prototype.forEachBounds=function(e,t,r){for(var n=0,i=e;n<i.length;n++){var a=i[n],o=this._boundsStore.get(a.objectId);o&&t(s.fromRect(r,o))}},e.prototype.getFeature=function(e){return this._featuresById.get(e)},e.prototype.has=function(e){return this._featuresById.has(e)},e.prototype.forEach=function(e){this._featuresById.forEach((function(t){return e(t)}))},e.prototype.forEachInBounds=function(e,t){var r=this;this._boundsStore.forEachInBounds(e,(function(e){t(r._featuresById.get(e))}))},e.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex(),this._markedIds.clear()},e.prototype.sweep=function(){var e=this,t=!1;this._featuresById.forEach((function(r,n){e._markedIds.has(n)||(t=!0,e._remove(r))})),this._markedIds.clear(),t&&this._emitChanged()},e.prototype.executeTileQuery=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,a,o,s,c,f,p,d,y,g,v,m,_,b;return r.__generator(this,(function(r){return i=n.returnGeometry,a=n.returnCentroid,o=n.returnOutline,s=n.pixelBuffer,c=new Set,f=[],p=s*e.resolution,d=u.pad(e.bounds,p,u.create()),h.createTileFeatures(f,c,this.geometryInfo,this,d,i,a,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]}),("esriGeometryPoint"===this.geometryType||a)&&(y=l.getInfo(t))&&(g=y.valid,v=g[0],m=g[1],d[0]<v&&(_=u.fromValues(m-p,d[1],m,d[3]),h.createTileFeatures(f,c,this.geometryInfo,this,_,i,a,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[m,e.bounds[3]]})),d[2]>m&&(b=u.fromValues(v,d[1],v+p,d[3]),h.createTileFeatures(f,c,this.geometryInfo,this,b,i,a,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[v-m+e.bounds[0],e.bounds[3]]}))),f.sort((function(e,t){return e.localId-t.localId})),[2,{features:f,objectIds:c}]}))}))},e.prototype._emitChanged=function(){this.events.emit("changed",void 0)},e.prototype._add=function(e){if(e){var t=e.objectId;if(null!=t){var r,i=this._featuresById.get(t);if(this._markedIds.add(t),i?(e.localId=i.localId,r=this._boundsStore.get(t),this._boundsStore.delete(t)):o.isSome(this.onFeatureAdd)&&this.onFeatureAdd(e),!e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=c.getBoundsOptimizedGeometry(r||u.create(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(t,r),this._featuresById.set(t,e)}else d.error(new n("featurestore:invalid-feature","feature id is missing",{feature:e}))}},e.prototype._remove=function(e){return o.isSome(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e},e}();t.default=y}.apply(null,n))||(e.exports=i)},sOkP:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("Gtr7"),r("qMld"),r("afW+"),r("Vx27"),r("W9tT"),r("ked+")],void 0===(i=function(e,t,r,n,i,a,o,s,u){Object.defineProperty(t,"__esModule",{value:!0});var l=[0,0],c=function(e){function t(t){var r=e.call(this,t)||this;return r._queue=new Map,r._isPaused=!1,r._scheduledNextHandle=null,r._timestamp=Date.now(),r.tileInfoView=null,r._next=r._next.bind(r),r._finalize=r._finalize.bind(r),r}return r.__extends(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._queue.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._queue.size>0||null!=this._onGoingTile},enumerable:!0,configurable:!0}),t.prototype.abort=function(e){this._onGoingTile&&this._onGoingTile.tileId===e&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null),this._queue.delete(e),this._scheduleNext(),this.notifyChange("updating")},t.prototype.clear=function(){this._queue.clear(),this._onGoingTile&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null),this._cancelNext(),this.notifyChange("updating")},t.prototype.has=function(e){return this._queue.has(e)},t.prototype.isOngoing=function(e){return this._onGoingTile&&this._onGoingTile.tileId===e},t.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())},t.prototype.push=function(e,t){if(!this._queue.has(e)){var r=i.createAbortController();this._queue.set(e,{tileId:e,key:u.TileKey.pool.acquire(e),timestamp:t||this._timestamp,abortController:r}),this._scheduleNext(),this.notifyChange("updating")}},t.prototype.refresh=function(){this._timestamp=Date.now(),this.reset()},t.prototype.reset=function(){var e=this._onGoingTile;if(e){var t=e.tileId;this.push(t,this._timestamp)}this.notifyChange("updating")},t.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext()),this.notifyChange("updating")},t.prototype._finalize=function(){this._onGoingTile=null,this.notifyChange("updating"),this._scheduleNext()},t.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},t.prototype._scheduleNext=function(){this._isPaused||this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingTile||(this._scheduledNextHandle=a.schedule(this._next))},t.prototype._next=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,n,i,a;return r.__generator(this,(function(r){switch(r.label){case 0:if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingTile)return this._scheduledNextHandle=null,[2];if(this._scheduledNextHandle=null,e=this._peek(),t=e.abortController.signal,n=e.tileId,i=e.key,u.TileKey.pool.release(i),this._queue.delete(n),this._onGoingTile=e,a=this.process(n,this._timestamp,{signal:t}),this.notifyChange("updating"),!function(e){return e&&"function"==typeof e.then}(a))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a];case 2:case 3:return r.sent(),[3,4];case 4:return this._finalize(),[2]}}))}))},t.prototype._peek=function(){var e=this;if(!this.state)throw new Error("state not set");var t=this.tileInfoView,r=this.state.center,n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=null;return this._queue.forEach((function(o){t.getTileCoords(l,o.key);var u=e._timestamp-o.timestamp;if(isNaN(u))(c=s.vec2.distance(l,r))<i&&(i=c,a=o);else if(u===n){var c;(c=s.vec2.distance(l,r))<i&&(i=c,a=o)}else u>n&&(n=u,i=Number.POSITIVE_INFINITY,a=o)})),a},r.__decorate([o.property({readOnly:!0})],t.prototype,"length",null),r.__decorate([o.property({constructOnly:!0})],t.prototype,"process",void 0),r.__decorate([o.property()],t.prototype,"state",void 0),r.__decorate([o.property({constructOnly:!0})],t.prototype,"tileInfoView",void 0),r.__decorate([o.property({readOnly:!0})],t.prototype,"updating",null),r.__decorate([o.subclass("esri.views.2d.layers.features.support.TileUpdateQueue")],t)}(n);t.default=c}.apply(null,n))||(e.exports=i)},sqdO:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("zp6E"),r("jfWY"),r("Lzvl")],void 0===(i=function(e,t,r,n,i,a){function o(e){return{geometryType:a.getJsonType(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function s(e,t,r){var n=a.getGeometryType(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))}Object.defineProperty(t,"__esModule",{value:!0}),t.simplify=function(e,t,u){return r.__awaiter(this,void 0,void 0,(function(){var l,c,f,h;return r.__generator(this,(function(p){switch(p.label){case 0:return l="string"==typeof e?i.urlToObject(e):e,c=t[0].spatialReference,f=a.getJsonType(t[0]),h=r.__assign(r.__assign({},u),{query:r.__assign(r.__assign({},l.query),{f:"json",sr:c.wkid?c.wkid:JSON.stringify(c),geometries:JSON.stringify(o(t))})}),[4,n(l.path+"/simplify",h)];case 1:return[2,s(p.sent().data,f,c)]}}))}))}}.apply(null,n))||(e.exports=i)},tZaU:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("qMld")],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._tasks=new Array}return Object.defineProperty(e.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0}),e.prototype.push=function(e){var t=this;return r.create((function(r,n){return t._tasks.push(new i(r,n,e))}))},e.prototype.unshift=function(e){var t=this;return r.create((function(r,n){return t._tasks.unshift(new i(r,n,e))}))},e.prototype.process=function(){if(0===this._tasks.length)return!1;var e=this._tasks.shift();try{var t=e.callback();t&&"then"in t&&"function"==typeof t.then?t.then(e.resolve,e.reject):e.resolve(t)}catch(t){e.reject(t)}return!0},e.prototype.cancelAll=function(){for(var e=r.createAbortError(),t=0,n=this._tasks;t<n.length;t++)n[t].reject(e);this._tasks.length=0},e}();t.default=n;var i=function(e,t,r){this.resolve=e,this.reject=t,this.callback=r}}.apply(null,n))||(e.exports=i)},uqzM:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("QVms"),r("ma1f"),r("H1tY"),r("qsST"),r("qMld"),r("8MXS"),r("8V7H"),r("Vx27"),r("N7S/"),r("Lzvl"),r("+6sX"),r("GI9R"),r("B16N"),r("lAK8"),r("YaB4"),r("Btct"),r("ak1O"),r("KgG2"),r("W1uT"),r("fUL3"),r("sOkP"),r("EBSo")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d,y,g,v,m,_,b,x,S,I,T){Object.defineProperty(t,"__esModule",{value:!0});var w=o.getLogger("esri.views.2d.layers.features.controllers.OnDemandController"),P=a("esri-featurelayer-webgl"),M=a("esri-mobile"),E={maxDrillLevel:P&&"object"==typeof P&&null!=P.maxDrillLevel?P.maxDrillLevel:M?1:4,maxRecordCountFactor:P&&"object"==typeof P&&null!=P.maxRecordCountFactor?P.maxRecordCountFactor:M?1:3,enablePBFQuery:!P||"object"!=typeof P||null==P.enablePBFQuery||P.enablePBFQuery},F=new Set,N=[],R=function(){function e(e,t){var r=this;this.objectIdField=t,l.openWithPorts(e).then((function(e){return r.client=e}))}return e.prototype.destroy=function(){this.client.close(),this.client=null},e.prototype.executeQuery=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.client.invoke("queryFeatures",e.toJSON(),t)];case 1:return n=r.sent(),[2,p.convertFromFeatureSet(n,this.objectIdField)]}}))}))},e}(),O=function(){function e(e,t){this.source=e,this.sourceSpatialReference=t}return e.prototype.destroy=function(){},e.prototype.executeQuery=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,y.executeQueryPBF(this.source,e,{type:"optimized",sourceSpatialReference:this.sourceSpatialReference},t)];case 1:return[2,r.sent().data]}}))}))},e}(),A=function(){function e(e,t,r){this.source=e,this.objectIdField=t,this.sourceSpatialReference=r}return e.prototype.destroy=function(){},e.prototype.executeQuery=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,y.executeQuery(this.source,e,this.sourceSpatialReference,t)];case 1:return n=r.sent().data,[2,p.convertFromFeatureSet(n,this.objectIdField)]}}))}))},e}(),C=function(){function e(e,t){this.source=e,this.objectIdField=t}return e.prototype.destroy=function(){},e.prototype.executeQuery=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return[2,d.queryOptimizedFeatureSet(this.source,e,t)]}))}))},e}(),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="on-demand",t._queryInfoHash=null,t._dataTileIndex=new x.default,t._editsQueue=new _.EditsQueue({processEdits:t._processEdits.bind(t)}),t._featuresInFlight=new Map,t.service=null,t}return r.__extends(t,e),t.prototype.initialize=function(){var e=this,t=this._createFeatureStore();t.onFeatureAdd=this.onFeatureAdd.bind(this),t.onFeatureRemove=this.onFeatureRemove.bind(this),this._set("featureStore",t),this._dataTileIndex.featureStore=this.featureStore,this._dataTileIndex.forEach((function(e){return e.done=!1})),this._fetchQueue=new T({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(t,n){return r.__awaiter(e,void 0,void 0,(function(){var e;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this._fetchTile(t,this.queryInfo,n)];case 1:return e=r.sent(),[2,{dataTile:t,featureSet:e}]}}))}))}}),this._patchQueue=new T({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(t,r){return e._fetchTile(t.dataTile,t.queryInfo,r)}}),this._updateQueue=new I.default({tileInfoView:this.tileStore.tileScheme,process:function(t,r,n){return e._updateTile(t,r,n)}});var n,i=this.service,a=i.capabilities,o=i.source,s=i.objectIdField,u=i.spatialReference;(n=o)&&n.capabilities&&n.collectionId&&n.layerDefinition&&n.url?this.sourceAdapter=new C(o,s):Array.isArray(o)?this.sourceAdapter=new R(o,s):E.enablePBFQuery&&a.query.supportsFormatPBF?this.sourceAdapter=new O(o,u):this.sourceAdapter=new A(o,s,u),this.handles.add([this.watch("updating",(function(t){return!t&&e.onIdle()}))]),this.featureStore.events.on("valueRangesChanged",(function(t){e.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:t.valueRanges}})}))},t.prototype.destroy=function(){this._fetchQueue.clear(),this._patchQueue.clear(),this._updateQueue.clear(),this._editsQueue.destroy(),this.queryEngine.destroy(),this.sourceAdapter.destroy()},Object.defineProperty(t.prototype,"queryEngine",{get:function(){return this._createQueryEngine(this.featureStore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.viewState||this._fetchQueue.updating||this._patchQueue.updating||this._updateQueue.updating||this._editsQueue.updating},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,a,o,s,u,l=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.validateConfig(e),n=JSON.stringify(this.config.filters),i=this.renderer.getAttributeHash(),a=e.availableFields.filter((function(e){return-1===l.availableFields.indexOf(e)})),o=this.config.definitionExpression,this._set("config",e),o!==this.config.definitionExpression&&this._set("queryEngine",this._createQueryEngine(this.featureStore)),[4,this.updatePixelBuffer()];case 1:return r.sent(),s=n!==JSON.stringify(e.filters),u=i!==this.renderer.getAttributeHash(),t?u?[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,3]:[3,6];case 2:r.sent(),r.label=3;case 3:return[4,this.attributeStore.updateFilters(this)];case 4:return r.sent(),[4,this.featureStore.update(s,e,this.service.fields)];case 5:return r.sent(),this.refresh(),[2];case 6:return a.length?[4,this._handleAttributeChange(a)]:[3,8];case 7:r.sent(),r.label=8;case 8:return"heatmap"===this.renderer.type?[2]:u?[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,10];case 9:r.sent(),this.featureStore.forEach((function(e){return l.attributeStore.setAttributeData(e.localId,e,l.geometryInfo,l.viewParams)})),r.label=10;case 10:return[4,this.attributeStore.updateFilters(this)];case 11:return r.sent(),[4,this.featureStore.update(s,e,this.service.fields)];case 12:return r.sent(),[4,this.attributeStore.sendUpdates()];case 13:return r.sent(),[2]}}))}))},t.prototype.invalidate=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,n;return r.__generator(this,(function(r){for(e=0,t=this.tileStore.tiles;e<t.length;e++)n=t[e],this._updateQueue.push(n.id,Date.now());return[2]}))}))},t.prototype.onIdle=function(){this.featureStore.sweepClusters()},t.prototype.onEdits=function(e){var t=this;return this._fetchQueue.pause(),this._fetchQueue.reset(),this._editsQueue.push(e).then((function(){t._editsQueue.updating||t._fetchQueue.resume()}))},t.prototype.queryFeatures=function(e){return this.queryEngine.executeQuery(e)},t.prototype.queryFeatureCount=function(e){return this.queryEngine.executeQueryForCount(e)},t.prototype.queryObjectIds=function(e){return this.queryEngine.executeQueryForIds(e)},t.prototype.queryExtent=function(e){return this.queryEngine.executeQueryForExtent(e)},t.prototype.queryStatistics=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,n,i=this;return r.__generator(this,(function(a){switch(a.label){case 0:return e=0,t=0,n=0,[4,s.all(this.tileStore.tiles.map((function(a){return r.__awaiter(i,void 0,void 0,(function(){var i,o,s,u,l,c,f,p,d,y,g;return r.__generator(this,(function(r){switch(r.label){case 0:return i=this.queryInfo,o=i.returnCentroid,s=i.returnGeometry,u=this._pixelBuffer,l={pixelBuffer:u,returnGeometry:s,returnCentroid:o,returnOutline:this.returnOutline},c=performance.now(),[4,this.featureStore.executeTileQuery(a,this.spatialReference,l)];case 1:for(f=r.sent().features,p=performance.now(),n+=p-c,e+=f.length,d=0,y=f;d<y.length;d++)(g=y[d]).geometry&&(h.isPolygon(g.geometry)?t+=g.geometry.rings.reduce((function(e,t){return e+t.length}),0):h.isPolyline(g.geometry)&&(t+=g.geometry.paths.reduce((function(e,t){return e+t.length}),0)));return[2]}}))}))})))];case 1:return a.sent(),[2,r.__assign(r.__assign({},this.featureStore.storeStatistics),{displayedFeatureCount:e,displayedVertexCount:t,displayPreProcessTime:n})]}}))}))},t.prototype.refresh=function(){return r.__awaiter(this,void 0,void 0,(function(){var e=this;return r.__generator(this,(function(t){switch(t.label){case 0:return this._queryInfoHash=Math.random().toString(),this._dataTileIndex.clear(),this._fetchQueue.pause(),this._updateQueue.pause(),this._editsQueue.clear(),this._fetchQueue.clear(),[4,u.whenFalseOnce(this._fetchQueue,"updating")];case 1:return t.sent(),this._updateQueue.clear(),[4,u.whenFalseOnce(this._updateQueue,"updating")];case 2:return t.sent(),this.featureStore.startMarkingUsedFeatures(),this._manageTiles(this.tileStore.tiles),this._fetchQueue.resume(),[4,u.whenFalseOnce(this._fetchQueue,"updating")];case 3:return t.sent(),this.featureStore.sweep(),this.featureStore.forEach((function(t){return e.attributeStore.setAttributeData(t.localId,t,e.geometryInfo,e.viewParams)})),this.attributeStore.sendUpdates(),this._updateQueue.resume(),[2]}}))}))},t.prototype.setViewState=function(t){var r=this,n=this.viewState&&this.viewState.scale;e.prototype.setViewState.call(this,t),this._fetchQueue.state=t,this._updateQueue.state=t,n!==this.viewState.scale&&this.attributeStore.hasScaleExpr&&(this.featureStore.forEach((function(e){return r.attributeStore.setAttributeData(e.localId,e,r.geometryInfo,r.viewParams)})),this.attributeStore.sendUpdates()),this.featureStore.setScale(this.viewState.scale)},t.prototype.getAggregate=function(e){return this.featureStore.getAggregate(e)},t.prototype.getAggregateValueRanges=function(){return this.featureStore.getAggregateValueRanges()},t.prototype.onTileUpdate=function(e){this._manageTiles(e.added,e.removed),this.featureStore.onTileUpdate(e)},t.prototype.onFeatureAdd=function(e){if(this._featuresInFlight.has(e.objectId)){var t=this._featuresInFlight.get(e.objectId).attributes;e.attributes=r.__assign(r.__assign({},t),e.attributes),this._featuresInFlight.delete(e.objectId)}e.localId=this.attributeStore.createLocalId(e.objectId),this.attributeStore.setAttributeData(e.localId,e,this.geometryInfo,this.viewParams)},t.prototype._handleAttributeChange=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._fetchChangedFields(e)];case 1:return t.sent(),[2]}}))}))},t.prototype._fetchChangedTileFields=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){return(n=this._dataTileIndex.get(e.id))?[2,this._fetchChangedTileFieldsDrill(n,t)]:[2]}))}))},t.prototype._fetchChangedTileFieldsDrill=function(e,t,n){return void 0===n&&(n=0),r.__awaiter(this,void 0,void 0,(function(){var i,a,o,u,l,c,f,h,p,d,y=this;return r.__generator(this,(function(g){switch(g.label){case 0:return i=r.__assign(r.__assign({},this.queryInfo),{returnGeometry:!1,returnCentroid:!1,outFields:t.concat([this.service.objectIdField])}),e.returnExceeded=e.returnExceeded||n>=E.maxDrillLevel,a=e.key,o={key:a,dataTile:e,queryInfo:i},[4,this._patchQueue.push(o)];case 1:return(u=g.sent()).exceededTransferLimit&&n<E.maxDrillLevel?(l=e.tile.createChildTiles(),c=l.map((function(t){var r=new b.default;return r.tile=t,r.displayTile=e.displayTile,r})),[4,s.all(c.map((function(e){return y._fetchChangedTileFieldsDrill(e,t,n+1)})))]):[3,3];case 2:return g.sent(),[2];case 3:for(f=0,h=u.features;f<h.length;f++)p=h[f],this.featureStore.has(p.objectId)?(d=this.featureStore.getFeature(p.objectId)).attributes=r.__assign(r.__assign({},d.attributes),p.attributes):this._featuresInFlight.set(p.objectId,p);return[2]}}))}))},t.prototype._fetchChangedTileFieldsPaged=function(e,t,n){return void 0===n&&(n=0),r.__awaiter(this,void 0,void 0,(function(){var i,a,o,s,u,l,c,f,h,p,d;return r.__generator(this,(function(y){switch(y.label){case 0:return i=this.service.capabilities.query.supportsMaxRecordCountFactor,a=this.service.tileMaxRecordCount,o=a*(i?1:E.maxRecordCountFactor),s=r.__assign(r.__assign({},this.queryInfo),{returnGeometry:!1,returnCentroid:!1,outFields:t.concat([this.service.objectIdField]),resultOffset:n*o,num:o}),e.returnExceeded=!0,u=e.key,l={key:u,dataTile:e,queryInfo:s},[4,this._patchQueue.push(l)];case 1:for(c=y.sent(),f=0,h=c.features;f<h.length;f++)p=h[f],this.featureStore.has(p.objectId)?(d=this.featureStore.getFeature(p.objectId)).attributes=r.__assign(r.__assign({},d.attributes),p.attributes):this._featuresInFlight.set(p.objectId,p);return c.exceededTransferLimit?[2,this._fetchChangedTileFieldsPaged(e,t,n+1)]:[2]}}))}))},t.prototype._fetchChangedFields=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return t=this.tileStore.tiles,n=t.map((function(t){return i._fetchChangedTileFields(t,e)})),[4,s.all(n)];case 1:return r.sent(),[2]}}))}))},t.prototype._manageTiles=function(e,t){void 0===t&&(t=null);for(var r=this._dataTileIndex,n=this._fetchQueue,i=this._updateQueue,a="esriGeometryPoint"===this.service.geometryType,o=function(e){var t=r.get(e.id);t?(t.displayTile=e,a?r.forEach((function(r){S.isChildOf(r,t)&&(r.displayTile=e)})):t.done=!1):((t=new b.default).tile=e.clone(),t.displayTile=e,r.add(t)),s._processDataTile(t)},s=this,u=0,l=e;u<l.length;u++)o(h=l[u]);if(t)for(var c=0,f=t;c<f.length;c++){var h=f[c];F.add(h),i.abort(h.id)}r.forEach((function(e){F.has(e.displayTile)&&N.push(e)}));for(var p=0,d=N;p<d.length;p++){var y=d[p];n.abort(y.id),r.delete(y)}N.length=0,F.clear()},t.prototype._processDataTile=function(e){var t=this,r=e.displayTile,n=e.key,a=this._dataTileIndex,o=this._fetchQueue,u=n.id,l=this._queryInfoHash,c=n.level-r.key.level>=E.maxDrillLevel;if(a.add(e),e.done||o.has(u)){if(e.queryInfoHash!==l||e.returnExceeded!==c)if(e.done)e.done=!1;else{if(!o.isOngoing(u))return e.queryInfoHash=l,void(e.returnExceeded=c);o.abort(u)}}else e.queryInfoHash=l,e.returnExceeded=c;e.done?this._invalidateTile(e.displayTile):o.has(u)||o.push(e).then((function(e){return t._handleResponse(e.dataTile,e.featureSet)})).catch((function(r){s.isAbortError(r)||(w.error(new i("featurelayer-controller:tile-error","Encountered an error when handling tile response",r)),e.done=!0,t._invalidateTile(e.displayTile))}))},t.prototype._handleResponse=function(e,t){if(e.done=!0,p.hydrateOptimizedFeatureSet(t),t.exceededTransferLimit)if(e.returnExceeded)this._dataTileIndex.setTileFeatures(e,t.features),this._deleteChildrenDataTiles(e);else{for(var r=e.tile.createChildTiles(),i=0,a=r;i<a.length;i++){var o=a[i],s=new b.default;s.tile=o,s.displayTile=e.displayTile,this._processDataTile(s)}n.release(r)}else this._dataTileIndex.setTileFeatures(e,t.features),this._deleteChildrenDataTiles(e);this._invalidateTile(e.tile)},t.prototype._deleteChildrenDataTiles=function(e){this._dataTileIndex.forEach((function(t){S.isChildOf(t,e)&&N.push(t)}));for(var t=0,r=N;t<r.length;t++){var n=r[t];this._fetchQueue.abort(n.id),this._dataTileIndex.delete(n)}N.length=0},t.prototype._createQuery=function(e,t,r,n,i,a){var o=this.service.geometryType,s=this._createDefaultQuery(n);return s.maxRecordCountFactor=i,s.returnExceededLimitFeatures=a,s.resultType="tile",s.geometry=e,this.service.capabilities.query.supportsQuantization?(s.quantizationParameters=new g.default({mode:"view",originPosition:"upper-left",tolerance:r,extent:t}),"esriGeometryPolyline"===o&&(s.maxAllowableOffset=r)):"esriGeometryPolyline"!==o&&"esriGeometryPolygon"!==o||(s.maxAllowableOffset=r),s},t.prototype._fetchTile=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,a,o,s,u,l,c,h,d,y,g;return r.__generator(this,(function(r){switch(r.label){case 0:return i=new f({xmin:e.bounds[0],ymin:e.bounds[1],xmax:e.bounds[2],ymax:e.bounds[3],spatialReference:this.spatialReference}),a=this.service.geometryType,o="esriGeometryPoint"===a?e.tile:e.displayTile,s=o.extent,u=o.resolution,l=e.returnExceeded,c=this._createQuery(i,s,u,t,E.maxRecordCountFactor,l),[4,this.sourceAdapter.executeQuery(c,n)];case 1:if((h=r.sent()).transform&&"esriGeometryPolygon"===a)for(d=0,y=h.features;d<y.length;d++)(g=y[d]).geometry=p.removeCollinearVectices(g.geometry,g.geometry,a,!1,!1);return[2,h]}}))}))},t.prototype._invalidateTile=function(e){for(var t=this._pixelBuffer,r=this._updateQueue,n=0,i=this.tileStore.intersections(e,t);n<i.length;n++){var a=i[n].tile;r.push(a.id,a.updateTimestamp)}},t.prototype._updateTile=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,a,o,u,l,c,f,h,p,d,y,g,m=this;return r.__generator(this,(function(r){switch(r.label){case 0:return i=this.tileStore.get(e),a=this.queryInfo,o=a.returnCentroid,u=a.returnGeometry,l=this._pixelBuffer,c={pixelBuffer:l,returnGeometry:u,returnCentroid:o,returnOutline:this.returnOutline},[4,this.featureStore.executeTileQuery(i,this.spatialReference,c)];case 1:return f=r.sent(),h=f.features,p=f.objectIds,[4,this.attributeStore.sendUpdates()];case 2:return r.sent(),d={geometryType:this.service.geometryType,features:h,fields:this.service.fields,objectIdFieldName:this.service.objectIdField,transform:i.transform},y=[],g=!0,this._dataTileIndex.forEach((function(e){i.id!==e.id&&S.isChildOf(e,i)&&g&&!e.done&&(g=!1)})),g&&i&&i.objectIds.forEach((function(e){if(!p.has(e)){var t=m.attributeStore.getLocalId(e);y.push(t)}})),p.forEach((function(e){i.objectIds.add(e)})),i.updateTimestamp=t,[2,this.processor.onTileData(i,{clear:!0,addOrUpdate:d.features,remove:y,transformParams:v.Utils.getTransformParams(d)},n).catch((function(e){s.isAbortError(e)||w.error("update-tile",e)}))]}}))}))},t.prototype._processEdits=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,a,o,u,l,c=this;return r.__generator(this,(function(f){switch(f.label){case 0:return i=this._createTempQueryEngine(),a=this._createObjectIdsQuery(e),e.length?[4,this.sourceAdapter.executeQuery(a)]:[3,2];case 1:o=f.sent(),p.hydrateOptimizedFeatureSet(o),this._dataTileIndex.addOrUpdateFeatures(o.features),i.featureStore.addMany(o.features),f.label=2;case 2:return u=t.concat(e).map((function(e){return c.attributeStore.getLocalId(e)})),this._dataTileIndex.deleteFeaturesById(t),this.attributeStore.sendUpdates(),l=r.__assign(r.__assign({},this.queryInfo),{pixelBuffer:this._pixelBuffer,returnOutline:this.returnOutline}),this.tileStore.tiles.map((function(e){return r.__awaiter(c,void 0,void 0,(function(){var t,a;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,i.featureStore.executeTileQuery(e,this.spatialReference,l)];case 1:return t=r.sent().features,a={transform:e.transform,hasZ:!1,hasM:!1},[2,this.processor.onTileData(e,{addOrUpdate:t,remove:u,transformParams:a},n).catch((function(e){s.isAbortError(e)||w.error("update-tile",e)}))]}}))}))})),i.destroy(),[2]}}))}))},t.prototype._createObjectIdsQuery=function(e){var t=this._createDefaultQuery(this.queryInfo);return t.objectIds=e,t},r.__decorate([c.property()],t.prototype,"_fetchQueue",void 0),r.__decorate([c.property()],t.prototype,"_patchQueue",void 0),r.__decorate([c.property()],t.prototype,"_updateQueue",void 0),r.__decorate([c.property()],t.prototype,"_editsQueue",void 0),r.__decorate([c.property({readOnly:!0})],t.prototype,"featureStore",void 0),r.__decorate([c.property({constructOnly:!0})],t.prototype,"service",void 0),r.__decorate([c.property()],t.prototype,"sourceAdapter",void 0),r.__decorate([c.property({readOnly:!0,dependsOn:["featureStore","service"]})],t.prototype,"queryEngine",null),r.__decorate([c.property({dependsOn:["viewState","_fetchQueue.updating","_updateQueue.updating","_patchQueue.updating","_editsQueue.updating"]})],t.prototype,"updating",null),r.__decorate([c.subclass("esri.views.2d.layers.features.controllers.OnDemandController")],t)}(m.default);t.default=j}.apply(null,n))||(e.exports=i)},vjUK:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.aggregateFunction=function(e,t){var n=r[e.toLowerCase()];if(null==n)throw new Error("Function Not Recognised");if(t.length<n.minParams||t.length>n.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return n.evaluate(t)},t.isAggregate=function(e,t){var n=r[e.toLowerCase()];return null!=n&&t>=n.minParams&&t<=n.maxParams};var r={min:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.min.apply(Math,e[0])}},max:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.max.apply(Math,e[0])}},avg:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:n(e[0])}},sum:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}(e[0])}},stddev:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sqrt(i(e[0]))}},count:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].length}},var:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:i(e[0])}}};function n(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}function i(e){for(var t=n(e),r=e.length,i=0,a=0,o=e;a<o.length;a++){var s=o[a];i+=Math.pow(s-t,2)}return r>1?i/(r-1):0}}.apply(null,n))||(e.exports=i)},w1v0:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("TMur"),r("jZlN"),r("ImIS"),r("ycL1"),r("LxLY"),r("Vx27"),r("Z4y+"),r("Lzvl"),r("KQcO")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f){var h=new a.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),p=function(e){function t(t){var r=e.call(this,t)||this;return r.displayFieldName=null,r.exceededTransferLimit=!1,r.features=[],r.fields=null,r.geometryType=null,r.hasM=!1,r.hasZ=!1,r.queryGeometry=null,r.spatialReference=null,r}return r.__extends(t,e),t.prototype.readFeatures=function(e,t){for(var r=l.fromJSON(t.spatialReference),n=[],a=0;a<e.length;a++){var o=e[a],u=i.fromJSON(o),c=o.geometry&&o.geometry.spatialReference;s.isSome(u.geometry)&&!c&&(u.geometry.spatialReference=r),n.push(u)}return n},t.prototype.writeGeometryType=function(e,t,r,n){if(e)h.write(e,t,r,n);else{var i=this.features;if(i)for(var a=0,o=i;a<o.length;a++){var u=o[a];if(u&&s.isSome(u.geometry))return void h.write(u.geometry.type,t,r,n)}}},t.prototype.writeSpatialReference=function(e,t){if(e)t.spatialReference=e.toJSON();else{var r=this.features;if(r)for(var n=0,i=r;n<i.length;n++){var a=i[n];a&&s.isSome(a.geometry)&&a.geometry.spatialReference&&(t.spatialReference=a.geometry.spatialReference.toJSON())}}},t.prototype.toJSON=function(e){var t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var n=t.features[r];if(n.geometry){var i=e&&e[r];n.geometry=i&&i.toJSON()||n.geometry}}return t},t.prototype.quantize=function(e){for(var t=e.scale,r=t[0],n=t[1],i=e.translate,a=i[0],o=i[1],u=this.features,l=this._getQuantizationFunction(this.geometryType,(function(e){return Math.round((e-a)/r)}),(function(e){return Math.round((o-e)/n)})),c=0,f=u.length;c<f;c++)l(s.unwrap(u[c].geometry))||(u.splice(c,1),c--,f--);return this.transform=e,this},t.prototype.unquantize=function(){var e=this.geometryType,t=this.features,r=this.transform;if(!r)return this;for(var n=r.translate,i=n[0],a=n[1],o=r.scale,u=o[0],l=o[1],c=this._getHydrationFunction(e,(function(e){return e*u+i}),(function(e){return a-e*l})),f=0,h=t;f<h.length;f++){var p=h[f].geometry;s.isSome(p)&&c(p)}return this},t.prototype._quantizePoints=function(e,t,r){for(var n,i,a=[],o=0,s=e.length;o<s;o++){var u=e[o];if(o>0){var l=t(u[0]),c=r(u[1]);l===n&&c===i||(a.push([l-n,c-i]),n=l,i=c)}else n=t(u[0]),i=r(u[1]),a.push([n,i])}return a.length>0?a:null},t.prototype._getQuantizationFunction=function(e,t,r){var n=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var i=c.isPolygon(e)?e.rings:e.paths,a=[],o=0,s=i.length;o<s;o++){var u=i[o],l=n._quantizePoints(u,t,r);l&&a.push(l)}return a.length>0?(c.isPolygon(e)?e.rings=a:e.paths=a,e):null}:"multipoint"===e?function(e){var i;return(i=n._quantizePoints(e.points,t,r)).length>0?(e.points=i,e):null}:"extent"===e?function(e){return e}:null},t.prototype._getHydrationFunction=function(e,t,r){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var n,i,a=c.isPolygon(e)?e.rings:e.paths,o=0,s=a.length;o<s;o++)for(var u=a[o],l=0,f=u.length;l<f;l++){var h=u[l];l>0?(n+=h[0],i+=h[1]):(n=h[0],i=h[1]),h[0]=t(n),h[1]=r(i)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?function(e){for(var n,i,a=e.points,o=0,s=a.length;o<s;o++){var u=a[o];o>0?(n+=u[0],i+=u[1]):(n=u[0],i=u[1]),u[0]=t(n),u[1]=r(i)}}:void 0},r.__decorate([u.property({type:String,json:{write:!0}})],t.prototype,"displayFieldName",void 0),r.__decorate([u.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"exceededTransferLimit",void 0),r.__decorate([u.property({type:[i],json:{write:!0}})],t.prototype,"features",void 0),r.__decorate([u.reader("features")],t.prototype,"readFeatures",null),r.__decorate([u.property({type:[f],json:{write:!0}})],t.prototype,"fields",void 0),r.__decorate([u.property({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:h.read}}})],t.prototype,"geometryType",void 0),r.__decorate([u.writer("geometryType")],t.prototype,"writeGeometryType",null),r.__decorate([u.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasM",void 0),r.__decorate([u.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasZ",void 0),r.__decorate([u.property({types:n.geometryTypes,json:{read:c.fromJSON,write:!0}})],t.prototype,"queryGeometry",void 0),r.__decorate([u.property({type:l,json:{write:!0}})],t.prototype,"spatialReference",void 0),r.__decorate([u.writer("spatialReference")],t.prototype,"writeSpatialReference",null),r.__decorate([u.property({json:{write:!0}})],t.prototype,"transform",void 0),r.__decorate([u.subclass("esri.tasks.support.FeatureSet")],t)}(o.JSONSupport);return p.prototype.toJSON.isDefaultToJSON=!0,p||(p={}),p}.apply(null,n))||(e.exports=i)},w7fK:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("KFwS"),r("H1tY"),r("qMld"),r("2Kdy")],void 0===(i=function(e,t,n,i,a,o){var s,u,l,c,f,h;function p(e){function r(e,t,r){e[t]=r(e[t])}t._pe=e,u.init(),l.init(),c.init(),f.init(),h.init(),t.PeGCSExtent=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.destroy=function(){t._pe.destroy(this)},r}(t._pe.PeGCSExtent);for(var i=0,a=[t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];i<a.length;i++)r(a[i].prototype,"getName",(function(e){return function(){return e.call(this,new Array(u.PE_NAME_MAX))}}));for(var o=0,s=[t._pe.PeGeogtran,t._pe.PeProjcs];o<s.length;o++)r(s[o].prototype,"getParameters",(function(e){return function(){for(var r=new Array(u.PE_PARM_MAX),n=e.call(this),i=0;i<r.length;i++){var a=t._pe.getValue(n,"*");r[i]=a?t._pe.wrapPointer(a,t._pe.PeParameter):null,n+=Int32Array.BYTES_PER_ELEMENT}return r}}));r(t._pe.PeHorizon.prototype,"getCoord",(function(e){return function(){var t=this.getSize();if(!t)return null;var r=[];return v(r,t,e.call(this)),r}})),r(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",(function(e){var r=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){var n=null,i=e.call(this);if(!t._pe.compare(i,t._pe.NULL)){n=[i];var a=this.getSteps();if(a>1)for(var o=t._pe.getPointer(i),s=1;s<a;s++)n.push(t._pe.wrapPointer(o+r*s,t._pe.PeGTlistExtendedGTs))}return n}}));var p=t._pe._pe_getPeHorizonSize(),d=function(e){return function(){var r=this._cache;if(r||(r=new Map,this._cache=r),r.has(e))return r.get(e);var n=null,i=e.call(this);if(!t._pe.compare(i,t._pe.NULL)){n=[i];var a=i.getNump();if(a>1)for(var o=t._pe.getPointer(i),s=1;s<a;s++)n.push(t._pe.wrapPointer(o+p*s,t._pe.PeHorizon))}return r.set(e,n),n}};r(t._pe.PeProjcs.prototype,"horizonGcsGenerate",d),r(t._pe.PeProjcs.prototype,"horizonPcsGenerate",d),t._pe.PeObject.prototype.toString=function(e){void 0===e&&(e=u.PE_STR_OPTS_NONE),t._pe.ensureCache.prepare();var r=t._pe.getPointer(this),n=t._pe.ensureInt8(new Array(u.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(r,e,n))}}function d(e){if(e){var r=t._pe.getClass(e);if(r){var n=t._pe.getCache(r);if(n){var i=t._pe.getPointer(e);i&&delete n[i]}}}}function y(e,r){for(var n=[],i=new Array(r),a=0;a<e;a++)n.push(t._pe.ensureInt8(i));return n}function g(e){var t;return Array.isArray(e[0])?(t=[],e.forEach((function(e){t.push(e[0],e[1])}))):t=e,t}function v(e,r,n,i){if(void 0===i&&(i=!1),i)for(var a=0;a<2*r;a++)e[a]=t._pe.getValue(n+a*Float64Array.BYTES_PER_ELEMENT,"double");else{var o=0===e.length;for(a=0;a<r;a++)o&&(e[a]=new Array(2)),e[a][0]=t._pe.getValue(n,"double"),e[a][1]=t._pe.getValue(n+Float64Array.BYTES_PER_ELEMENT,"double"),n+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(t,"__esModule",{value:!0}),t._pe=null,t.isLoaded=function(){return!!t._pe},t.isSupported=function(){return!!a("esri-wasm")},t.load=function(){return s||(s=o.create((function(e,t){new Promise((function(e,t){Promise.resolve().then(function(){var t=[r("2yfh")];e.apply(null,t)}.bind(this)).catch(t.bind(this))})).then((function(r){r({locateFile:function(e){return i.getAssetUrl("esri/geometry/support/"+e)},onAbort:function(e){t(new Error(e))}}).then((function(t){p(t),e()}))}))})))},function(e){function r(e,r,n){t._pe.ensureCache.prepare();var i=g(n),a=n===i,o=t._pe.ensureFloat64(i),s=t._pe._pe_geog_to_proj(t._pe.getPointer(e),r,o);return s&&v(n,r,o,a),s}function n(e,t,r){return i(e,t,r,0)}function i(e,r,n,i){t._pe.ensureCache.prepare();var a=g(n),o=n===a,s=t._pe.ensureFloat64(a),u=t._pe._pe_proj_to_geog_center(t._pe.getPointer(e),r,s,i);return u&&v(n,r,s,o),u}e.geogToProj=r,e.projGeog=function(e,t,i,a){switch(a){case u.PE_TRANSFORM_P_TO_G:return n(e,t,i);case u.PE_TRANSFORM_G_TO_P:return r(e,t,i)}return 0},e.projToGeog=n,e.projToGeogCenter=i}(t.PeCSTransformations||(t.PeCSTransformations={})),function(e){e.init=function(){e.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=t._pe.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT,e.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_PARM_X0=t._pe.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA}}(u=t.PeDefs||(t.PeDefs={})),function(e){var r={},n={};function i(e,n){var i=null,o=r[e];if(o||(o={},r[e]=o),o.hasOwnProperty(String(n)))i=o[n];else{var s=t._pe.PeFactory.prototype.factoryByType(e,n);t._pe.compare(s,t._pe.NULL)||(i=s,o[n]=i)}return a(i)}function a(e){if(e){var r=e.getType();switch(r){case u.PE_TYPE_GEOGCS:e=t._pe.castObject(e,t._pe.PeGeogcs);break;case u.PE_TYPE_PROJCS:e=t._pe.castObject(e,t._pe.PeProjcs);break;case u.PE_TYPE_GEOGTRAN:e=t._pe.castObject(e,t._pe.PeGeogtran);break;default:r&u.PE_TYPE_UNIT&&(e=t._pe.castObject(e,t._pe.PeUnit))}}return e}e.initialize=function(){t._pe.PeFactory.prototype.initialize(null)},e.coordsys=function(e){return i(u.PE_TYPE_COORDSYS,e)},e.factoryByType=i,e.fromString=function(e,r){var i=null,o=n[e];if(o||(o={},n[e]=o),o.hasOwnProperty(r))i=o[r];else{var s=t._pe.PeFactory.prototype.fromString(e,r);t._pe.compare(s,t._pe.NULL)||(i=s,o[r]=i)}return a(i)},e.geogcs=function(e){return i(u.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return i(u.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return t._pe.PeFactory.prototype.getCode(e)},e.projcs=function(e){return i(u.PE_TYPE_PROJCS,e)},e.unit=function(e){return i(u.PE_TYPE_UNIT,e)}}(t.PeFactory||(t.PeFactory={})),t.PeGCSExtent=null,function(e){var r;e.init=function(){e.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,r=t._pe._pe_getPeGTlistExtendedEntrySize()},e.getGTlist=function(e,n,i,a,o,s){var u=null,l=new t._pe.PeInteger(s);try{var c=t._pe.PeGTlistExtended.prototype.getGTlist(e,n,i,a,o,l);if((s=l.val)&&(u=[c],s>1))for(var f=t._pe.getPointer(c),h=1;h<s;h++)u.push(t._pe.wrapPointer(f+r*h,t._pe.PeGTlistExtendedEntry))}finally{t._pe.destroy(l)}return u}}(l=t.PeGTlistExtended||(t.PeGTlistExtended={})),function(e){e.destroy=function(e){if(e&&e.length){for(var r=0,n=e;r<n.length;r++){var i=n[r];d(i),i.getEntries().forEach((function(e){d(e);var t=e.getGeogtran();d(t),t.getParameters().forEach(d),[t.getGeogcs1(),t.getGeogcs2()].forEach((function(e){d(e);var t=e.getDatum();d(t),d(t.getSpheroid()),d(e.getPrimem()),d(e.getUnit())}))}))}t._pe.PeGTlistExtendedEntry.prototype.Delete(e[0])}}}(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={})),function(e){e.geogToGeog=function(e,r,n,i,a){t._pe.ensureCache.prepare();var o=g(n),s=n===o,u=t._pe.ensureFloat64(o),l=0;i&&(l=t._pe.ensureFloat64(i));var c=t._pe._pe_geog_to_geog(t._pe.getPointer(e),r,u,l,a);return c&&v(n,r,u,s),c}}(t.PeGTTransformations||(t.PeGTTransformations={})),function(e){function r(e,r,n,i,a,o){var s,l;switch(t._pe.ensureCache.prepare(),e){case"dd":s=t._pe._pe_geog_to_dd,l=u.PE_DD_MAX;break;case"ddm":s=t._pe._pe_geog_to_ddm,l=u.PE_DDM_MAX;break;case"dms":s=t._pe._pe_geog_to_dms,l=u.PE_DMS_MAX}var c=0;r&&(c=t._pe.getPointer(r));var f=g(i),h=t._pe.ensureFloat64(f),p=y(n,l),d=s(c,n,h,a,t._pe.ensureInt32(p));if(d)for(var v=0;v<n;v++)o[v]=t._pe.UTF8ToString(p[v]);return d}function n(e,r,n,i,a){var o;switch(t._pe.ensureCache.prepare(),e){case"dd":o=t._pe._pe_dd_to_geog;break;case"ddm":o=t._pe._pe_ddm_to_geog;break;case"dms":o=t._pe._pe_dms_to_geog}var s=0;r&&(s=t._pe.getPointer(r));var u=i.map((function(e){return t._pe.ensureString(e)})),l=t._pe.ensureInt32(u),c=t._pe.ensureFloat64(new Array(2*n)),f=o(s,n,l,c);return f&&v(a,n,c),f}e.geog_to_dms=function(e,t,n,i,a){return r("dms",e,t,n,i,a)},e.dms_to_geog=function(e,t,r,i){return n("dms",e,t,r,i)},e.geog_to_ddm=function(e,t,n,i,a){return r("ddm",e,t,n,i,a)},e.ddm_to_geog=function(e,t,r,i){return n("ddm",e,t,r,i)},e.geog_to_dd=function(e,t,n,i,a){return r("dd",e,t,n,i,a)},e.dd_to_geog=function(e,t,r,i){return n("dd",e,t,r,i)}}(t.PeNotationDms||(t.PeNotationDms={})),function(e){e.init=function(){e.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},e.geog_to_mgrs_extended=function(e,r,n,i,a,o,s){t._pe.ensureCache.prepare();var l=0;e&&(l=t._pe.getPointer(e));var c=g(n),f=t._pe.ensureFloat64(c),h=y(r,u.PE_MGRS_MAX),p=t._pe.ensureInt32(h),d=t._pe._pe_geog_to_mgrs_extended(l,r,f,i,a,o,p);if(d)for(var v=0;v<r;v++)s[v]=t._pe.UTF8ToString(h[v]);return d},e.mgrs_to_geog_extended=function(e,r,n,i,a){t._pe.ensureCache.prepare();var o=0;e&&(o=t._pe.getPointer(e));var s=n.map((function(e){return t._pe.ensureString(e)})),u=t._pe.ensureInt32(s),l=t._pe.ensureFloat64(new Array(2*r)),c=t._pe._pe_mgrs_to_geog_extended(o,r,u,i,l);return c&&v(a,r,l),c}}(c=t.PeNotationMgrs||(t.PeNotationMgrs={})),function(e){e.geog_to_usng=function(e,r,n,i,a,o,s){t._pe.ensureCache.prepare();var l=0;e&&(l=t._pe.getPointer(e));var c=g(n),f=t._pe.ensureFloat64(c),h=y(r,u.PE_MGRS_MAX),p=t._pe.ensureInt32(h),d=t._pe._pe_geog_to_usng(l,r,f,i,a,o,p);if(d)for(var v=0;v<r;v++)s[v]=t._pe.UTF8ToString(h[v]);return d},e.usng_to_geog=function(e,r,n,i){t._pe.ensureCache.prepare();var a=0;e&&(a=t._pe.getPointer(e));var o=n.map((function(e){return t._pe.ensureString(e)})),s=t._pe.ensureInt32(o),u=t._pe.ensureFloat64(new Array(2*r)),l=t._pe._pe_usng_to_geog(a,r,s,u);return l&&v(i,r,u),l}}(t.PeNotationUsng||(t.PeNotationUsng={})),function(e){e.init=function(){e.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS},e.geog_to_utm=function(e,r,n,i,a){t._pe.ensureCache.prepare();var o=0;e&&(o=t._pe.getPointer(e));var s=g(n),l=t._pe.ensureFloat64(s),c=y(r,u.PE_UTM_MAX),f=t._pe.ensureInt32(c),h=t._pe._pe_geog_to_utm(o,r,l,i,f);if(h)for(var p=0;p<r;p++)a[p]=t._pe.UTF8ToString(c[p]);return h},e.utm_to_geog=function(e,r,n,i,a){t._pe.ensureCache.prepare();var o=0;e&&(o=t._pe.getPointer(e));var s=n.map((function(e){return t._pe.ensureString(e)})),u=t._pe.ensureInt32(s),l=t._pe.ensureFloat64(new Array(2*r)),c=t._pe._pe_utm_to_geog(o,r,u,i,l);return c&&v(a,r,l),c}}(f=t.PeNotationUtm||(t.PeNotationUtm={})),function(e){var r=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT},e.generate=function(n,i){var a,o;return void 0===i&&(i=e.PE_PCSINFO_OPTION_DOMAIN),r.has(n)&&(o=r.get(n))[i]&&(a=o[i]),a||(a=t._pe.PePCSInfo.prototype.generate(n,i),o||(o=[],r.set(n,o)),o[i]=a),a}}(h=t.PePCSInfo||(t.PePCSInfo={})),function(e){e.version_string=function(){return t._pe.PeVersion.prototype.version_string()}}(t.PeVersion||(t.PeVersion={})),t._init=p}.apply(null,n))||(e.exports=i)},wIC5:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("qMld"),r("w7fK"),r("OkCb"),r("2Kdy")],void 0===(i=function(e,t,n,i,a){Object.defineProperty(t,"__esModule",{value:!0});var o=null,s=null;t.isLoaded=function(){return!!o&&i.isLoaded()},t.isSupported=function(){return i.isSupported()};var u=null;t.load=function(){return u||(u=n.all([i.load(),new Promise((function(e,t){r.e(8).then(function(){var t=[r("vFDJ")];e.apply(null,t)}.bind(this)).catch(t.bind(this))})),new Promise((function(e,t){r.e(93).then(function(){var t=[r("RBE7")];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))]).then((function(e){var t=e[1],r=e[2].hydratedAdapter;s=r,(o=t)._enableProjection(i)})))},t.project=function(e,t,r){return void 0===r&&(r=null),e instanceof Array?0===e.length?[]:c(s,e,e[0].spatialReference,t,r):c(s,[e],e.spatialReference,t,r)[0]};var l={};function c(e,t,r,n,i){if(void 0===i&&(i=null),null===i){var s=a.cacheKey(r,n);void 0!==l[s]?i=l[s]:(null===(i=f(r,n,null))&&(i=new a),l[s]=i)}return o._project(e,t,r,n,i)}function f(e,t,r){void 0===r&&(r=null);var n=o._getTransformation(s,e,t,r,null==r?void 0:r.spatialReference);return null!==n?a.fromGE(n):null}t.projectMany=c,t.getTransformation=f,t.getTransformations=function(e,t,r){void 0===r&&(r=null);var n=o._getTransformationBySuitability(s,e,t,r,null==r?void 0:r.spatialReference);if(null!==n){for(var i=[],u=0,l=n;u<l.length;u++){var c=l[u];i.push(a.fromGE(c))}return i}return[]}}.apply(null,n))||(e.exports=i)},wjMf:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("LxLY"),r("jBNx"),r("aMdW"),r("Zx0K"),r("W9tT"),r("ab6c"),r("Z4y+"),r("lRq4"),r("hBh5"),r("Thzy"),r("Lzvl"),r("fw2w"),r("nrlZ"),r("nrlZ"),r("YaB4"),r("YaB4")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d,y,g,v){Object.defineProperty(t,"__esModule",{value:!0});var m=Math.PI/180,_=a.mat2df32.create(),b=s.vec2f32.create(),x=l.create();t.getBounds=function(e,t,r,n,i,a,o){if(!n||!r.symbol)return e[0]=e[1]=e[2]=e[3]=0,t[0]=t[1]=t[2]=t[3]=0,e;var s=n;if(!h.isPoint(s)){c.getBoundsXY(e,s);var u=t[0];0===u&&(u=function(e){var t=0;switch(e.symbol.type){case"simple-fill":case"picture-fill":var r=e.symbol.outline;if(!r)return 0;t=r.width;break;case"simple-line":t=e.symbol.width;break;case"simple-marker":t=e.symbol.size;break;case"picture-marker":t=Math.max(e.symbol.width,e.symbol.height);break;case"text":var n=[0,0,0,0];O(n,e.symbol,e.mosaicItem);var i=Math.max(Math.abs(n[0]),Math.abs(n[1]));t=Math.max(n[2],n[3])+i;break;case"cim":case"expanded-cim":var a=g.CIMSymbolHelper.getEnvelope(e.symbol.data);t=Math.sqrt(a.width*a.width+a.height*a.height)}return t}(r),t[0]=u);var l=i*u/2;return e[0]-=l,e[1]-=l,e[2]+=l,e[3]+=l,e}var f=s.x,d=s.y;return"text"===r.symbol.type&&0===t[2]&&0===t[3]&&O(t,r.symbol,r.mosaicItem),function(e,t,r,n,i,a,o,s){var u;switch(n.type){case"simple-marker":case"picture-marker":u=F(t,r,n,a,o,0);break;case"text":u=R(t,r,n,i,a,0);break;case"cim":case"expanded-cim":u=N(t,r,n,a,o,0)}for(var l,c,f=0,h=0;h<u.rings[0].length-1;h++)l=(t-(c=u.rings[0][h])[0])*(t-c[0])+(r-c[1])*(r-c[1]),f=Math.max(f,l);f=Math.sqrt(f);var d=p.normalizeMapX(t-f,s),g=p.normalizeMapX(t+f,s);if(d>g){var v=y.getInfo(s);if(v){var m=v.valid;d=m[0],g=m[1]}}e[0]=d,e[1]=r-f,e[2]=g,e[3]=r+f}(e,f,d,r.symbol,t,i,a,o),e},t.isMarkerSymbol=function(e){return"simple-marker"===e||"picture-marker"===e||"text"===e},t.graphicGeometryToNumber=function(e){switch(r.unwrap(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0};var S=s.vec2f32.create(),I=s.vec2f32.create(),T=s.vec2f32.create(),w=s.vec2f32.create(),P=s.vec2f32.create(),M=s.vec2f32.create(),E=s.vec2f32.create();function F(e,t,r,a,s,u){var l,c,f=n.pt2px(r.xoffset),h=n.pt2px(r.yoffset),p=m*r.angle,d=m*u;switch(r.type){case"simple-marker":var y=r;l=c=n.pt2px(y.size);break;case"picture-marker":var g=r;l=n.pt2px(g.width),c=n.pt2px(g.height)}s<.04&&(a=.04*a/s);var v=i.mat2d.identity(_);i.mat2d.translate(v,v,o.vec2.set(b,e,t)),i.mat2d.rotate(v,v,d-p),i.mat2d.scale(v,v,o.vec2.set(b,a,-a)),i.mat2d.translate(v,v,o.vec2.set(b,f,-h));var x=[0,0];o.vec2.transformMat2d(x,o.vec2.set(b,-.5*l,-.5*c),v);var S=[0,0];o.vec2.transformMat2d(S,o.vec2.set(b,-.5*l,.5*c),v);var I=[0,0];o.vec2.transformMat2d(I,o.vec2.set(b,.5*l,-.5*c),v);var T=[0,0];return o.vec2.transformMat2d(T,o.vec2.set(b,.5*l,.5*c),v),{rings:[[x,I,T,S,x]]}}function N(e,t,r,a,s,u){var l=g.CIMSymbolHelper.getEnvelope(r.data);if(!l)return null;s<.04&&(a=.04*a/s);var c=n.pt2px(l.width),f=n.pt2px(l.height),h=n.pt2px(l.x),p=n.pt2px(l.y),d=0*m,y=m*u,v=i.mat2d.identity(_);i.mat2d.translate(v,v,o.vec2.set(b,e,t)),i.mat2d.rotate(v,v,y-d),i.mat2d.scale(v,v,o.vec2.set(b,a,a));var x=[0,0];o.vec2.transformMat2d(x,o.vec2.set(b,h,p+f),v);var S=[0,0];o.vec2.transformMat2d(S,o.vec2.set(b,h,p),v);var I=[0,0];o.vec2.transformMat2d(I,o.vec2.set(b,h+c,p+f),v);var T=[0,0];return o.vec2.transformMat2d(T,o.vec2.set(b,h+c,p),v),{rings:[[x,I,T,S,x]]}}function R(e,t,r,a,s,u){var l=n.pt2px(r.xoffset),c=n.pt2px(r.yoffset),f=m*r.angle,h=m*u,p=i.mat2d.identity(_);i.mat2d.translate(p,p,o.vec2.set(b,e,t)),i.mat2d.rotate(p,p,h),i.mat2d.scale(p,p,o.vec2.set(b,s,-s));var d=a[0]+a[2]/2,y=a[1]+a[3]/2;i.mat2d.translate(p,p,o.vec2.set(b,l,-c)),i.mat2d.translate(p,p,o.vec2.set(b,d,y)),i.mat2d.rotate(p,p,f),i.mat2d.translate(p,p,o.vec2.set(b,-d,-y));var g=[0,0];o.vec2.transformMat2d(g,o.vec2.set(b,a[0],a[1]),p);var v=[0,0];o.vec2.transformMat2d(v,o.vec2.set(b,a[0],a[1]+a[3]),p);var x=[0,0];o.vec2.transformMat2d(x,o.vec2.set(b,a[0]+a[2],a[1]),p);var S=[0,0];return o.vec2.transformMat2d(S,o.vec2.set(b,a[0]+a[2],a[1]+a[3]),p),{rings:[[g,x,S,v,g]]}}function O(e,t,r){if(!r||0===r.glyphMosaicItems.length)return e;var i=g.bidiText(t.text)[1],a=r.glyphMosaicItems,o=v.shapeGlyphs(a,i,{scale:n.pt2px(t.font.size)/24,angle:t.angle,xOffset:t.xoffset,yOffset:t.yoffset,hAlign:v.alignmentUtils.getXAnchorDirection(t.horizontalAlignment||"center"),vAlign:v.alignmentUtils.getYAnchorDirection(t.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(t.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(t.lineHeight||1,4)),decoration:t.font.decoration||"none",isCIM:!1}).bounds;return e[0]=o.x-o.halfWidth,e[1]=o.y-o.halfHeight,e[2]=o.width,e[3]=o.height,e}t.isPointOnPolyline=function(e,t,r,n){o.vec2.set(T,t,r);for(var i,a,s,u,l,c,f,h,p,d=e.paths,y=1/0,g=0;g<d.length;g++){var v=d[g];if(!(v.length<2))for(var m=1;m<v.length;m++)i=v[m-1][0],s=v[m-1][1],a=v[m][0],u=v[m][1],l=Math.min(i,a)-n,c=Math.min(s,u)-n,f=Math.max(i,a)+n,h=Math.max(s,u)+n,t<l||t>f||r<c||r>h||(o.vec2.set(S,i,s),o.vec2.set(I,a,u),o.vec2.subtract(w,I,S),o.vec2.subtract(P,S,T),o.vec2.scale(M,w,o.vec2.dot(w,P)/o.vec2.dot(w,w)),o.vec2.subtract(E,P,M),y>(p=o.vec2.dot(E,E))&&(y=p))}return Math.sqrt(y)<=n},t.getMarkerSymbolBounds=F,t.getCIMMarkerBounds=N,t.getTextSymbolBounds=R,t.normalizeCentralMeridian=function(e){var t,r,n,i,a,o,s,u,l,p=null;if(!e)return null;if("mesh"===e.type)return e.toJSON();if(t=e.spatialReference,!(r=d.getInfo(t)))return e.toJSON();n=t.isWebMercator,i=A[o=n?102100:4326].maxX,a=A[o].minX,s=A[o].plus180Line,u=A[o].minus180Line;var y=e.toJSON();if(h.isPoint(y))l=L(y,i,a);else if(h.isMultipoint(y))y.points=y.points.map((function(e){return L(e,i,a)})),l=y;else if(h.isExtent(y))l=function(e,t){if(!t)return e;var r=function(e,t){var r,n=[],i=e.ymin,a=e.ymax,o=e.xmax-e.xmin,s=e.xmin,u=e.xmax,l=t.valid,c=l[0],f=l[1],h=(r=j(e.xmin,t)).x,p=r.frameId,d=(r=j(e.xmax,t)).x,y=r.frameId,g=h===d&&o>0;if(o>2*f){var v={xmin:s<u?h:d,ymin:i,xmax:f,ymax:a},m={xmin:c,ymin:i,xmax:s<u?d:h,ymax:a},_={xmin:0,ymin:i,xmax:f,ymax:a},b={xmin:c,ymin:i,xmax:0,ymax:a},x=[],S=[];G(v,_)&&x.push(p),G(v,b)&&S.push(p),G(m,_)&&x.push(y),G(m,b)&&S.push(y);for(var I=p+1;I<y;I++)x.push(I),S.push(I);n.push({extent:v,frameIds:[p]},{extent:m,frameIds:[y]},{extent:_,frameIds:x},{extent:b,frameIds:S})}else h>d||g?n.push({extent:{xmin:h,ymin:i,xmax:f,ymax:a},frameIds:[p]},{extent:{xmin:c,ymin:i,xmax:d,ymax:a},frameIds:[y]}):n.push({extent:{xmin:h,ymin:i,xmax:d,ymax:a},frameIds:[p]});return n}(e,t).map((function(e){return e.extent}));return r.length<2?r[0]||e:r.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:r.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}(y,r);else if(h.isPolygon(y)||h.isPolyline(y)){var g=x;c.getBoundsXY(g,y);var v={xmin:g[0],ymin:g[1],xmax:g[2],ymax:g[3]},m=C(v.xmin,a)*(2*i),_=0===m?y:function(e,t){for(var r=0,n=function(e){return h.isPolygon(e)?e.rings:e.paths}(e);r<n.length;r++)for(var i=0,a=n[r];i<a.length;i++)a[i][0]+=t;return e}(y,m);v.xmin+=m,v.xmax+=m,f.extentIntersectsPolyline(v,s)&&v.xmax!==i||f.extentIntersectsPolyline(v,u)&&v.xmin!==a?p=_:l=_}else l=e.clone();return null!==p?(new q).cut(p,i):l},t.getTextSymbolSize=O;var A={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:{paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator},minus180Line:{paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:u.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:u.WGS84}}};function C(e,t){return Math.ceil((e-t)/(2*t))}function j(e,t){var r,n=t.valid,i=n[0],a=n[1],o=2*a,s=0;return e>a?(e-=(r=Math.ceil(Math.abs(e-a)/o))*o,s=r):e<i&&(e+=(r=Math.ceil(Math.abs(e-i)/o))*o,s=-r),{x:e,frameId:s}}function G(e,t){var r=t.xmin,n=t.ymin,i=t.xmax,a=t.ymax;return k(e,r,n)&&k(e,r,a)&&k(e,i,a)&&k(e,i,n)}function k(e,t,r){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax}function L(e,t,r){var n;if(Array.isArray(e))if((n=e[0])>t){var i=C(n,t);e[0]=n+i*(-2*t)}else n<r&&(i=C(n,r),e[0]=n+i*(-2*r));else(n=e.x)>t?(i=C(n,t),e.x+=i*(-2*t)):n<r&&(i=C(n,r),e.x+=i*(-2*r));return e}var q=function(){function e(){}return e.prototype.cut=function(e,t){var r;if(e.rings)this.closed=!0,r=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,r=e.paths,this.minPts=2}for(var n=r.length,i=-2*t,a=0;a<n;a++){var o=r[a];if(o&&o.length>=this.minPts){for(var s=[],u=0,l=o;u<l.length;u++){var c=l[u];s.push([c[0]+i,c[1]])}r.push(s)}}return this.closed?e.rings=r:e.paths=r,e},e}()}.apply(null,n))||(e.exports=i)},yLD6:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("Fzzg"),r("/COu"),r("Jvs9")],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.optimizedFeatureQueryEngineAdapter={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new n.default(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=r.getCentroidOptimizedGeometry(new i.default,e.geometry,t.hasZ,t.hasM)),e.centroid}},t.default=t.optimizedFeatureQueryEngineAdapter}.apply(null,n))||(e.exports=i)},"yre/":function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("jZlN"),r("pcDC"),r("Z4y+"),r("ZcgO"),r("KQcO"),r("HoQt")],void 0===(i=function(e,t,r,n,i,a,o,s){function u(e,t){return t}function l(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return("lowerLeft"===e.originPosition?p:d)(e,t+n,1)}}function c(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return("lowerLeft"===e.originPosition?p:d)(e,t+n,1);case 2:return p(e,t,2)}}function f(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return("lowerLeft"===e.originPosition?p:d)(e,t+n,1);case 2:return p(e,t,3)}}function h(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return("lowerLeft"===e.originPosition?p:d)(e,t+n,1);case 2:return p(e,t,2);case 3:return p(e,t,3)}}function p(e,t,r){var n=e.translate,i=e.scale;return n[r]+t*i[r]}function d(e,t,r){var n=e.translate,i=e.scale;return n[r]-t*i[r]}Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e){this.options=e,this.geometryTypes=["point","multipoint","polyline","polygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=u,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){}}return e.prototype.createFeatureResult=function(){return new a.DehydratedFeatureSetClass},e.prototype.finishFeatureResult=function(e){if(this.options.applyTransform&&(e.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0,e.hasZ){var t=s.getGeometryZScaler(e.geometryType,this.options.sourceSpatialReference,e.spatialReference);if(t)for(var r=0,n=e.features;r<n.length;r++)t(n[r].geometry)}},e.prototype.createSpatialReference=function(){return new i},e.prototype.addField=function(e,t){e.fields.push(o.fromJSON(t));var r=e.fields.map((function(e){return e.name}));this.AttributesConstructor=function(){for(var e=0,t=r;e<t.length;e++)this[t[e]]=null}},e.prototype.addFeature=function(e,t){var r=this.options.maxStringAttributeLength?this.options.maxStringAttributeLength:0;if(r>0)for(var n in t.attributes){var i=t.attributes[n];"string"==typeof i&&i.length>r&&(t.attributes[n]="")}e.features.push(t)},e.prototype.prepareFeatures=function(e){var t=this;switch(this.options.applyTransform&&e.transform&&(this.transform=e.transform,this.applyTransform=this.deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"point":this.addCoordinate=function(e,r,n,i){return t.addCoordinatePoint(e,r,i)},this.createGeometry=function(e){return t.createPointGeometry(e)};break;case"polygon":this.addCoordinate=function(e,r,n,i){return t.addCoordinatePolygon(e,r,i)},this.createGeometry=function(e){return t.createPolygonGeometry(e)};break;case"polyline":this.addCoordinate=function(e,r,n,i){return t.addCoordinatePolyline(e,r,i)},this.createGeometry=function(e){return t.createPolylineGeometry(e)};break;case"multipoint":this.addCoordinate=function(e,r,n,i){return t.addCoordinateMultipoint(e,r,i)},this.createGeometry=function(e){return t.createMultipointGeometry(e)};break;default:n.neverReached(e.geometryType)}},e.prototype.createFeature=function(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,new a.DehydratedFeatureClass(r.generateUID(),null,new this.AttributesConstructor)},e.prototype.addLength=function(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)},e.prototype.createPointGeometry=function(e){var t={type:"point",x:0,y:0,spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM};return t.hasZ&&(t.z=0),t.hasM&&(t.m=0),t},e.prototype.addCoordinatePoint=function(e,t,r){switch(t=this.applyTransform(this.transform,t,r,0),r){case 0:e.x=t;break;case 1:e.y=t;break;case 2:e.hasZ?e.z=t:e.m=t;break;case 3:e.m=t}},e.prototype.transformPathLikeValue=function(e,t){var r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)},e.prototype.addCoordinatePolyline=function(e,t,r){this.dehydratedAddPointsCoordinate(e.paths,t,r)},e.prototype.addCoordinatePolygon=function(e,t,r){this.dehydratedAddPointsCoordinate(e.rings,t,r)},e.prototype.addCoordinateMultipoint=function(e,t,r){0===r&&e.points.push([]);var n=this.transformPathLikeValue(t,r);e.points[e.points.length-1].push(n)},e.prototype.createPolygonGeometry=function(e){return{type:"polygon",rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createPolylineGeometry=function(e){return{type:"polyline",paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createMultipointGeometry=function(e){return{type:"multipoint",points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.dehydratedAddPointsCoordinate=function(e,t,r){if(null===this.coordinateBuffer){var n=this.lengths.reduce((function(e,t){return e+t}),0);this.coordinateBuffer=new Float64Array(n*this.vertexDimension)}0===r&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);var i=this.transformPathLikeValue(t,r),a=e[e.length-1];0===r&&a.push(new Float64Array(this.coordinateBuffer.buffer,this.coordinateBufferPtr*Float64Array.BYTES_PER_ELEMENT,this.vertexDimension)),this.coordinateBuffer[this.coordinateBufferPtr++]=i},e.prototype.deriveApplyTransform=function(e){var t=e.hasZ,r=e.hasM;return t&&r?h:t?c:r?f:l},e}();t.Context=y}.apply(null,n))||(e.exports=i)},zDti:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("zOht"),r("ImIS"),r("LxLY"),r("8uEs"),r("d466"),r("Lzvl"),r("fw2w"),r("nrlZ"),r("Fzzg"),r("+6sX"),r("Jvs9"),r("Q2Em"),r("V1i6")],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d){Object.defineProperty(t,"__esModule",{value:!0});var y=new n.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});t.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var g=new h.default,v=new h.default,m=new h.default,_={esriGeometryPoint:f.convertToPoint,esriGeometryPolyline:f.convertToPolyline,esriGeometryPolygon:f.convertToPolygon,esriGeometryMultipoint:f.convertToMultipoint};function b(e,t,r,n,i){void 0===n&&(n=e.hasZ),void 0===i&&(i=e.hasM);var a=e.hasZ&&n,o=e.hasM&&i;if(r){var s=f.quantizeOptimizedGeometry(m,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,i);return f.convertToPoint(s,a,o)}return f.convertToPoint(t,a,o)}function x(e,n,a){return r.__awaiter(this,void 0,void 0,(function(){var l,c,f,h,d,y;return r.__generator(this,(function(r){switch(r.label){case 0:return e?(l=e.where,e.where=l=l&&l.trim(),(!l||/^1 *= *1$/.test(l)||n&&n===l)&&(e.where=null),e.geometry?[4,S(e)]:[2,e]):[2,null];case 1:return c=r.sent(),e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel&&(f=e.geometry.spatialReference,(c=o.getGeometryExtent(c)).spatialReference=f),e.geometry=c,[4,p.checkProjectionSupport(c.spatialReference,a)];case 2:return r.sent(),[4,u.normalizeCentralMeridian(s.fromJSON(c))];case 3:if(h=r.sent()[0],i.isNone(h))throw t.QUERY_ENGINE_EMPTY_RESULT;return d=h.toJSON(),[4,p.project(d,d.spatialReference,a)];case 4:if(!(y=r.sent()))throw t.QUERY_ENGINE_EMPTY_RESULT;return y.spatialReference=a,e.geometry=y,[2,e]}}))}))}function S(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n,i,o,s,u,c;return r.__generator(this,(function(r){switch(r.label){case 0:return t=e.geometry,n=e.distance,i=e.units,null==n||"vertexAttributes"in t?[2,t]:(o=t.spatialReference,s=i?y.fromJSON(i):a.getUnitString(o),o&&(l.isGeographic(o)||l.isWebMercator(o))?(c=t,[3,3]):[3,1]);case 1:return[4,p.checkProjectionSupport(o,l.WGS84).then((function(){return p.project(t,l.WGS84)}))];case 2:c=r.sent(),r.label=3;case 3:return u=c,[4,d.getGeodesicBufferOperator()];case 4:return[2,r.sent()(u.spatialReference,u,n,s)]}}))}))}t.transformCentroid=b,t.getCentroid=function(e,t,r){return"esriGeometryPolygon"===e.geometryType&&t&&(t.centroid||t.geometry)?(t.centroid||(t.centroid=c.getCentroidOptimizedGeometry(new h.default,t.geometry,e.hasZ,e.hasM)),b(e,t.centroid,r)):null},t.getGeometry=function(e,t,r,n,i,a,o,s){void 0===o&&(o=t),void 0===s&&(s=r);var u=t&&o,l=r&&s,c=n?"coords"in n?n:n.geometry:null;if(!c)return null;if(i){var h=f.generalizeOptimizedGeometry(v,c,t,r,e,i,o,s);return a&&(h=f.quantizeOptimizedGeometry(m,h,u,l,e,a)),_[e](h,u,l)}return a?(h=f.quantizeOptimizedGeometry(m,c,t,r,e,a,o,s),_[e](h,u,l)):(f.removeZMValues(g,c,t,r,o,s),_[e](g,u,l))},t.normalizeQuery=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,a,o,s,u;return r.__generator(this,(function(r){if(i=e.outFields,a=e.orderByFields,o=e.groupByFieldsForStatistics,s=e.outStatistics,i)for(u=0;u<i.length;u++)i[u]=i[u].trim();if(a)for(u=0;u<a.length;u++)a[u]=a[u].trim();if(o)for(u=0;u<o.length;u++)o[u]=o[u].trim();if(s)for(u=0;u<s.length;u++)s[u].onStatisticField&&(s[u].onStatisticField=s[u].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),[2,x(e,t,n)]}))}))},t.normalizeFilter=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return[2,x(e,t,n)]}))}))},t.normalizeQueryLike=x,t.cleanFromGeometryEngine=function(e){return e&&I in e?JSON.parse(JSON.stringify(e,T)):e};var I="_geVersion",T=function(e,t){return e!==I?t:void 0}}.apply(null,n))||(e.exports=i)},ztx9:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r("ZHL0"),r("1eyA")],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._cache=new r(e),this._invalidCache=new r(t)}return e.prototype.get=function(e,t){var r=t.uid+":"+e,i=this._cache.get(r);if(i)return i;if(void 0!==this._invalidCache.get(r))return null;try{var a=n.WhereClause.create(e,t);return this._cache.put(r,a),a}catch(e){return this._invalidCache.put(r,null),null}},e}();t.WhereClauseCache=i}.apply(null,n))||(e.exports=i)}}]);